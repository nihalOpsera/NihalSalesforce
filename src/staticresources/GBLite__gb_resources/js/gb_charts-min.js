var GBCharts=function(aa,i,o){var H,B,u,s=["#FFC72A","#0684FF","#2B905E","#EA4134","#95e4ff","#ffec4a","#ABEC51","#F28020","#00B4FF","#F45B5B","#50E3C2","#D85584","#6B72F4","#f7aec8"],C,l,E,e="donut",k="tile",M="-",g="RECORD_COUNT",P,ac,U,V,W,n=[],D,F=[],R=false,ag,ad=[];var aj={xs:{width:214,height:170,fullName:"Extra Small"},s:{width:320,height:256,fullName:"Small"},m:{width:480,height:384,fullName:"Medium"},l:{width:640,height:512,fullName:"Large"}};function af(aq){H=aq;if(H.def.length==0){return}GBMixpanelForChart.init(H);l=(H.formatting.LOCALE_DIGIT_SEPARATOR||",");C=(H.formatting.LOCALE_DECIMAL_SEPARATOR||".");E=(H.formatting.DEFAULT_DECIMAL_SEPARATOR||".");o.datepicker.setDefaults(o.datepicker.regional[H.formatting.currentLocale]);P=z(H.def);U=aj[P].width;V=aj[P].height;ac=p(H.def);ag=y();if(H.standalone==true){var ay,am=H.chartName;for(var au=0;au<H.def.length;au++){if(H.def[au].title==am){ay=H.def[au];break}}if(!ay||ay==undefined){ay=H.def[0]}ad.push(ay);W=(H.size&&H.size!="")?H.size:ay.size;var av=aj[W].width,ar=aj[W].height;u=o("div#chart-"+H.gridNameForAttributes);var an='<a title="Click the chart to go to the Grid page" class="standaloneAnchor" href="'+H.gridURL+'" target="_blank"></a>';u.empty().append('<div class="chartHeader" title="Click to expand and collapse this chart">'+q(ay.title)+'<span class="chartExpandOrCollapse">&#8211;</span></div><div class="chartWithAxis"><canvas class="chartCanvas" width="'+av+'" height="'+ar+'"></canvas></div><div class="nodataMessage">No chart data to display due to grid filters or chart configuration.</div>').find(".chartCanvas, .nodataMessage").wrap(an);u.addClass("size-"+W);if(ay.type==e||ay.group_by){u.css("width",av+260+30)}if(ay.type==k){u.find(".chartHeader").addClass("tileHeader")}d();Z(u);GBMixpanelForChart.track("Embedded Chart View",{Type:ay.type,Size:ay.size,Color:ay.color,"X-field":ay.x_wedge,"Y-field":ay.y_value,"Summary Type":ay.summary_type})}else{var at=o(".gridBtns.top"),ap=GBHelpers.isGridInIframe(),aw=v(),ao=o("#AppBodyHeader").length===1,ax=o(".chartIcon"),aA,az=X(H.def);at.append(aw);aA=at.find(".chartOverlay");u=o("#gridChart");u.empty().append('<div class="chartHeader">Charts</div><div class="chartBody">'+az+"</div>");o(aa).on("scroll",function(){if((ao&&!ap)||o(".msgBox.infoMsg, #pageWarnings").is(":visible")){var aB=(ax.offset().top+ax.outerHeight()-o(aa).scrollTop());GBHelpers.debounce(function(){aA.css("top",aB)})()}});o(".chartBody").css("margin-top",25);o(".chartBody").css("overflow","auto");O(u);u.addClass("size-"+P);o(aa).resize(function(){ae(V)})}}function v(am){return'<div class="chartOverlay"><div id="gridChart" class="chartContainer chartHidden none"/></div>'}function X(am){var ar="";for(var ap=0;ap<am.length;ap++){var ao=am[ap].size,aq=aj[ao].width,an=aj[ao].height;ar+='<div class="singleChartHeader"><h1>'+q(am[ap].title)+'</h1></div><div class="chartBody-'+am[ap].id+" size-"+ao+'" ><div class="chartWithAxis" id="chart-'+am[ap].id+'"><canvas class="chartCanvas" width="'+aq+'" height="'+an+'"></canvas></div><div class="nodataMessage">No chart data to display due to grid filters or chart configuration.</div></div>'}return ar}function z(am){var ap="xs",ao=aj[ap].width;for(var an=0;an<am.length;an++){if(aj[am[an].size].width>ao){ap=am[an].size;ao=aj[ap].width;if(ap=="l"){return ap}}}return ap}function p(am){var ap="xs",ao=aj[ap].width;for(var an=0;an<am.length;an++){if(t(am[an],am[an].type)||am[an].type=="donut"){if(aj[am[an].size].width>ao){ap=am[an].size;ao=aj[ap].width}}}return ap}function ae(an){var ao=w(),am=(an+140<ao)?an+140:ao;o(".chartBody").css("max-height",am)}function w(){var ar=o("#AppBodyHeader"),az=ar.length===1?ar.outerHeight(true):0,ax=o("#globalHeaderBar"),aA=ax.length===1?ax.outerHeight(true):0,av=o(".gridBtns.top").outerHeight(true),at=GBHelpers.getInfoMsgHeight(),aq=GBHelpers.isGridInIframe(),ap=GBHelpers.getPageWarningsHeight(),an=o("#gridFooter"),ao=an.length===1?an.outerHeight(true):0,ay=o(".chartHeader"),au=ay.length===1?ay.height():0,am=o(aa).height(),aw=(az+aA+at+ap+av+au+ao);return am-aw}function m(){L("Loading...");u.removeClass("none")}function Z(am){var an=am.find(".chartHeader");an.click(function(){if(am.find(".chartMessage").length>0){return}if(am.find(".nodataMessage").is(":visible")==true||am.find("div.msgDetail").length>0){return}var ap=am.find(".chartCanvas"),ao=am.find(".chart-legend-container, .xAxisLabel, .yAxisLabel");if(am.hasClass("chartHidden")){if(ap.length>0){ap.slideDown(200,function(){ao.fadeIn()})}else{am.find(".chartTile").slideDown()}if(F.length>0){ak(F)}am.removeClass("chartHidden");an.find(".chartExpandOrCollapse").html("&#8211;")}else{an.width(an.width());if(ap.length>0){ap.slideUp()}else{am.find(".chartTile").slideUp()}am.addClass("chartHidden");an.find(".chartExpandOrCollapse").text("+");ao.hide();F=[]}})}function O(am){var an=o(".chartIcon");an.keyup(function(ao){if(ao.keyCode==13){o(this).trigger("click")}});an.click(function(){var ap=o(this),at=am.find(".chartCanvas"),ao=o(".chart-legend-container"),av=am.find(".chartCanvas, .tileChart, .xAxisLabel, .yAxisLabel, .singleChartHeader"),ar=U+65;if(am.hasClass("chartHidden")){GBMixpanelForChart.track("Change Grid Display",{"Display Control":"Chart",Option:"",State:"Expand",Type:ag.chartsTypes,Size:ag.chartsSizes,Color:ag.chartsColors,"X-field":ag.chartsXAxis,"Y-field":ag.chartsYAxis,"Summary Type":ag.chartsSummary});if(!o(".gridBtns").hasClass("fixed")){var aq=(ap.offset().top+ap.outerHeight()-o(aa).scrollTop()),au=o(".gridBtns .chartOverlay");au.css("top",aq+"px")}ap.addClass("on");if((am.find("div.msgDetail").length>0)||(am.find(".chartMessage").length>0)){am.animate({width:ar+"px"},300).removeClass("chartHidden");return}if(!o(".metadataPanel").hasClass("metadataPanelHidden")){o(".metadataPanelIcon").click()}ae(V);if(ao.length>0){r();return}am.animate({width:ar+"px"},300,function(){av.fadeIn().css("display","block");o(this).removeClass("chartHidden");if(F.length>0){ak(F)}})}else{GBMixpanelForChart.track("Change Grid Display",{"Display Control":"Chart",Option:"",State:"Collapse"});if(ao.length>0){ao.fadeOut()}if(av.length>0){av.fadeOut(function(){am.animate({width:0},300).addClass("chartHidden")})}else{am.animate({width:0},300).addClass("chartHidden")}ap.removeClass("on");F=[]}})}function r(){var am=aj[ac].width,an=U>am+260?U:am+260;u.animate({width:an+65+"px"},300,function(){o(this).removeClass("chartHidden").find(".chartCanvas, .xAxisLabel, .yAxisLabel, .chart-legend-container, .singleChartHeader, .tileChart").fadeIn();o(this).find(".xAxisLabel, .yAxisLabel").css("display","block");if(R&&F.length>0){ak(F)}})}function al(am){B=am;if(am){if(am.status&&am.status=="error"){N(am.messages)}else{if(am.formatting&&am.formatting.isMultiCurrencyOrg){H.formatting.isMultiCurrencyOrg=am.formatting.isMultiCurrencyOrg}if(am.meta){am.meta.forEach(function(an){var ap;if(an.fields){for(var ao=0;ao<an.fields.length;ao++){ap=an.fields[ao];ap.isTypeDate=function(){return this.dataType=="DATE"};ap.isTypeDateTime=function(){return this.dataType=="DATETIME"};ap.isNumeric=function(){return this.dataType=="CURRENCY"||this.dataType=="PERCENT"||this.dataType=="DOUBLE"||this.dataType=="INTEGER"};ap.isTypeCurrency=function(){return this.dataType=="CURRENCY"};ap.gridId=an.gridId}}});H.meta=am.meta}b();ai(am)}}else{}b()}function N(an){if(an&&an.length>0){var am=o("div#chartMsg-"+H.gridNameForAttributes);am.find("div.msgDetail").html(an.join("<br/>"));if(u.find(".chartHeader").length>0){u.find(".chartHeader").after(am.removeClass("none"))}else{u.append(am.removeClass("none"))}u.find(".chartCanvas").hide();u.find(".chartHeader .chartExpandOrCollapse").hide();if(!H.standalone){am.width(am.width(U+30))}}}function A(an){var ap,am,ao;if(an.attributes){ap=an.attributes["type"];am=H.formatting.object_Name_to_Name_Field[ap]}else{am="Name"}if(am!==undefined&&am.length>0){ao=am}else{ao="Name"}return ao}function j(an,ap){var ao,am;if(ap.dataType=="REFERENCE"){am=an[ap.fieldRelName];if(am!=null){ao=am[A(am)]}else{ao=null}}else{ao=an[ap.name]}return ao}function t(am,an){return am.group_by!==undefined&&an!==e&&am.group_by!=0}function ai(aS){var aW=[],a0;if(H.standalone==true){a0=ad}else{a0=H.def}for(var bp=0;bp<a0.length;bp++){var am=a0[bp],aI={},aP={},aw=[],ap=[],ax=[],a2=undefined,aD=undefined,aZ=undefined,bq=undefined,ao=undefined,aX=undefined,aO=undefined,bb=undefined,bn=undefined,aF=undefined,aJ=undefined,a6=undefined,az=undefined,aH=undefined,au=undefined,ay=undefined,aB=undefined,av=undefined,at=true,aY=false,aL=undefined,br=undefined,aG=undefined,a4=undefined,aK=undefined,aA=undefined,an=Object.keys(aS),aN=undefined,bo=0,aq=undefined,aC=0,aE=0,bd=0,aR=0,aM=undefined,aT=undefined,a1=[],bi=["-","true","false"],aQ=undefined;D=(H.type&&H.type!="")?H.type:am.type;if(am.x_wedge){a2=am.x_wedge.split(":");aD=a2[0];aZ=a2[1];if(a2[2]){bq=a2[0]+":"+a2[2]}else{bq=a2[0]}}if(am.y_value){ao=am.y_value.split(":");aX=ao[0];aO=ao[1];aY=(aO==g);if(ao[2]){bb=ao[0]+":"+ao[2]}else{bb=ao[0]}}if(t(am,D)){bn=am.group_by.split(":");aF=bn[0];aJ=bn[1];if(bn[2]){a6=bn[0]+":"+bn[2]}else{a6=bn[0]}}if(aD==aX&&(aD==aF||aF==undefined)){at=false}for(var bm=0;an.length>bm;bm++){if(a(an[bm])==aD){aG=an[bm]}if(a(an[bm])==aX){a4=an[bm]}if(a(an[bm])==aF){aK=an[bm]}}for(var a9=0;H.meta.length>a9;a9++){if(H.meta[a9].fullyQualifiedObjectName==bq){for(var a8=0;H.meta[a9].fields.length>a8;a8++){if(H.meta[a9].fields[a8].name==aZ){ay=H.meta[a9].fields[a8];az=H.meta[a9].label+" - "+ay.label}}}if(H.meta[a9].fullyQualifiedObjectName==bb){for(var a5=0;H.meta[a9].fields.length>a5;a5++){if(H.meta[a9].fields[a5].name==aO){aB=H.meta[a9].fields[a5];aH=H.meta[a9].label+" - "+aB.label}else{if(aO==g){aH=H.meta[a9].label+" Record Count"}}}}if(a6&&H.meta[a9].fullyQualifiedObjectName==a6){for(var a7=0;H.meta[a9].fields.length>a7;a7++){if(H.meta[a9].fields[a7].name==aJ){av=H.meta[a9].fields[a7];au=H.meta[a9].label+" - "+av.label}}}}if(am.type==k){if(am.y_value.indexOf(g)!=-1){aQ=aS[a4].length-c(aS,a4)}else{var bg=Y(aS,a4);if(bg!=undefined){var aV=bg.afValue?bg.afValue:0;if(!isNaN(aV)){aV=aV.toString();aQ=G(aB,x(aV,aV.indexOf(J()),aB.scale))}else{aQ="NaN"}}}aW.push({chartDrawingData:{chartDefinition:am},chartData:aQ});continue}if(aS[aG].length==0){aW.push({chartDrawingData:{chartDefinition:am,error:"nodata"},chartData:[]});continue}for(var bl=0;aS[aG].length>bl;bl++){xItem=aS[aG][bl];if(xItem.afValue!=undefined){continue}aI[xItem.Id]={};aI[xItem.Id][aZ]=j(xItem,ay);if(t(am,D)&&aG==aK){aI[xItem.Id][aJ]=j(xItem,av)}if(!at){aI[xItem.Id][aO]=xItem[aO]}if(aB&&aB.isTypeCurrency()&&!aB.isoCurrencyCode){aB.CurrencyIsoCode=xItem.CurrencyIsoCode||H.formatting.defaultIsoCode}}if(at){var ar=ao[2];for(var bk=0;aS[a4].length>bk;bk++){yItem=aS[a4][bk];if(!aI[yItem[ar]][aX]){aI[yItem[ar]][aX]={}}aI[yItem[ar]][aX][yItem.Id]={};aI[yItem[ar]][aX][yItem.Id][aO]=yItem[aO];if(t(am,D)&&aG!=aK){aI[yItem[ar]][aX][yItem.Id][aJ]=j(yItem,av)}}}for(var bj in aI){aN=G(ay,aI[bj][aZ]);bo=0,aE=0;if(at){if(aI[bj][aX]){for(var bh in aI[bj][aX]){if(aY){aC=1}else{if(!isNaN(aI[bj][aX][bh][aO])){aC=aI[bj][aX][bh][aO];aC=aC.toFixed(aB.scale)}else{aC=0}}aR=K(aC);if(aR>aE){aE=aR}bo=f(bo,aC,aE);if(t(am,D)&&aG!=aK){aq=G(av,aI[bj][aX][bh][aJ]);if(aP[aq]===undefined){aP[aq]={};aP[aq][aN]=aC}else{if(aP[aq][aN]===undefined){aP[aq][aN]=aC}else{aP[aq][aN]=f(aP[aq][aN],aC,aE)}}}}}}else{if(aY){bo=1}else{if(!isNaN(aI[bj][aO])){aC=aI[bj][aO]}else{aC=0}bo=aC.toFixed(aB.scale)}}aR=K(bo);if(aR>bd){bd=aR}if(t(am,D)&&aG==aK){aq=G(av,aI[bj][aJ]);if(aP[aq]===undefined){aP[aq]={};aP[aq][aN]=bo}else{if(aP[aq][aN]===undefined){aP[aq][aN]=bo}else{aP[aq][aN]=f(aP[aq][aN],bo,bd)}}}else{if(t(am,D)==false){if(aP[aN]===undefined){aP[aN]=bo}else{aP[aN]=f(aP[aN],bo,bd)}}}if(aw.indexOf(aN)==-1&&aw.length<=250){aw.push(aN)}}if(aP[""]||aP[""]==0){aP[M]=aP[""];delete aP[""]}if(t(am,D)){for(var ba in aP){if(aP[ba][""]||aP[ba][""]==0){aP[ba][M]=aP[ba][""];delete aP[ba][""]}}}aw[aw.indexOf("")]=M;if(ay.isTypeDate()||ay.isTypeDateTime()){aw.sort(function(bs,bv){var bu=ab(bs,H.formatting.dateFormat);var bt=ab(bv,H.formatting.dateFormat);if(bu>bt||isNaN(bu.getTime())){return 1}else{return -1}})}else{if(ay.dataType=="PICKLIST"){if(typeof gridInfoMap!="undefined"){aM=gridInfoMap[ay.gridId].metaColumns;for(var a8=0;a8<aM.length;a8++){if(aM[a8].fieldName==ay.name){aT=aM[a8].getOrderedPicklistOptions()}}for(var a7=0;a7<aT.length;a7++){a1.push(aT[a7].v)}aw.sort(function(bs,bt){if(a1.indexOf(bs)>a1.indexOf(bt)){return 1}else{return -1}})}}else{if(ay.dataType=="BOOLEAN"){aw.sort(function(bs,bt){if(bi.indexOf(bs)>bi.indexOf(bt)){return 1}else{return -1}})}else{aw.sort(function(bs,bt){return(bs.toLowerCase()>bt.toLowerCase())?1:-1})}}}for(var bf=0;bf<aw.length;bf++){if(D==e){ap.push({label:aw[bf],color:s[bf%s.length],highlight:ah(s[bf%s.length],0.15),value:aP[aw[bf]]})}else{ap.push(aP[aw[bf]])}}if(t(am,D)){var aU=0;for(var be in aP){br=(D=="line")?"transparent":s[aU%s.length];ap=[];for(var bc=0;bc<aw.length;bc++){ap.push(aP[be][aw[bc]]||0)}ax.push({label:be,fillColor:br,strokeColor:s[aU%s.length],pointColor:s[aU%s.length],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:s[aU%s.length],data:ap});aU++;if(aU>=250){break}}if(av.isTypeDate()||av.isTypeDateTime()){ax.sort(function(bt,bs){var bv=ab(bt.label,H.formatting.dateFormat);var bu=ab(bs.label,H.formatting.dateFormat);if(bv>bu||isNaN(bv.getTime())){return 1}else{return -1}})}else{if(av.dataType=="PICKLIST"){if(typeof gridInfoMap!="undefined"){aM=gridInfoMap[av.gridId].metaColumns;for(var a5=0;a5<aM.length;a5++){if(aM[a5].fieldName==av.name){aT=aM[a5].getOrderedPicklistOptions()}}}else{aT=av.picklistValues}for(var a3=0;a3<aT.length;a3++){a1.push(q(aT[a3].v))}ax.sort(function(bt,bs){if(a1.indexOf(bt.label)>a1.indexOf(bs.label)){return 1}else{return -1}})}else{if(av.dataType=="BOOLEAN"){ax.sort(function(bt,bs){if(bi.indexOf(bt.label)>bi.indexOf(bs.label)){return 1}else{return -1}})}else{ax.sort(function(bt,bs){return(bt.label.toLowerCase()>bs.label.toLowerCase())?1:-1})}}}}else{br=(D=="line")?"transparent":s[0];ax=[{label:"",fillColor:br,strokeColor:s[0],pointColor:s[0],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:s[0],data:ap}]}if(D==e){aL=ap}else{aL={labels:aw,datasets:ax}}aW.push({chartDrawingData:{xAxisLabel:az,yAxisLabel:aH,groupByLabel:au,y_valueMetaCol:aB,chartDefinition:am},chartData:aL})}if(R&&u.hasClass("chartHidden")){F=aW}else{ak(aW)}}function Y(aq,ao){var ap=aq[ao],am;for(var an=0;an<ap.length;an++){if(ap[an].attributes&&ap[an].attributes.type&&ap[an].attributes.type=="AggregateResult"){am=ap[an];ap.splice(an,1);break}}return am}function c(aq,ao){var am=0,ap=aq[ao];for(var an=0;an<ap.length;an++){if(ap[an].attributes.type&&ap[an].attributes.type=="AggregateResult"){am+=1}else{break}}return am}function ak(an){if(n.length>0){for(var am=0;am<n.length;am++){n[am].destroy()}n=[]}for(var am=0;am<an.length;am++){Q(an[am].chartData,an[am].chartDrawingData)}R=true}function Q(aG,ar){var aq,ao,ap,aF,am=ar.chartDefinition,aw=(am.data_labels)?true:false,au=am.type,az=am.id,ay=H.standalone,aD=ay?aj[W].width:aj[am.size].width,aB=ay?aj[W].height:aj[am.size].height,aA=ay?u:o("div.chartBody-"+az),at=ar.xAxisLabel,aC=ar.yAxisLabel,ax=ar.groupByLabel,av=ar.y_valueMetaCol;if(ar.error&&ar.error=="nodata"){aA.find(".chartWithAxis").hide();aA.find(".nodataMessage").show();return}if(au==k){aA.find(".chartCanvas").after('<div class="chartTile"><span class="tileValue">'+aG+'</span><div class="tileDescription">'+q(am.description)+"</div></div>").remove();var an=aA.find(".tileValue").css("font-size").replace("px","")*1;var aE=(aA.find(".chartTile").width()-20)/aA.find(".tileValue").width();if(!isNaN(an)&&aE<1){aA.find(".tileValue").css("font-size",an*aE)}aA.addClass("color-"+am.color).addClass("tileChart");if(H.def.length==1&&!H.standalone){aA.closest(".chartBody").css("height",aA.find("div.chartTile").height()+70)}return}if(au==e){aF={animateRotate:false,tooltipTemplate:function(aH){return aH.label+": "+G(av,aH.value)},scaleLabel:function(aH){return G(av,aH.value)},responsive:false,showInlineValues:true,centeredInllineValues:true,pointHitDetectionRadius:1,legendTemplate:function(aI){var aK='<div class="chart-legend-container"><h3>'+at+'</h3><ul class="chart-legend">';var aJ=[];for(var aH=0;aH<aI.segments.length;aH++){aJ.push('<li><span style="background-color:'+aI.segments[aH].fillColor+'"></span>'+q(aI.segments[aH].label)+": "+q(G(av,aI.segments[aH].value))+"</li>")}aK+=aJ.join("")+"</ul></div>";return aK}};if(!H.standalone){aF.scaleFontColor="#fff";aF.tooltipFillColor="#fff";aF.tooltipTitleFontColor="#000";aF.tooltipFontColor="#000"}}else{ap={animation:false,tooltipTemplate:function(aH){return aH.label+": "+G(av,aH.value)},multiTooltipTemplate:function(aH){return aH.datasetLabel+": "+G(av,aH.value)},scaleLabel:function(aH){return G(av,aH.value)},responsive:false,showInlineValues:true,centeredInllineValues:true,pointHitDetectionRadius:1,legendTemplate:function(aI){var aK='<div class="chart-legend-container"><h3>'+ax+'</h3><ul class="chart-legend">';var aJ=[];for(var aH=0;aH<aI.datasets.length;aH++){aJ.push('<li><span style="background-color:'+aI.datasets[aH].strokeColor+'"></span>'+q(aI.datasets[aH].label)+"</li>")}aK+=aJ.join("")+"</ul></div>";return aK},metaCol:av};if(!H.standalone){ap.scaleFontColor="#fff";ap.tooltipFillColor="#fff";ap.tooltipTitleFontColor="#000";ap.tooltipFontColor="#000"}if(aw){ap.showTooltips=false;ap.tooltipCaretSize=0;ap.onAnimationComplete=function(){if(this.name=="Bar"){this.eachBars(function(aH){S(this,aH)})}else{if(this.name=="Line"){this.eachPoints(function(aH){S(this,aH)})}}}}}ao=aA.find(".chartCanvas").get(0).getContext("2d");if(au=="bar"){aq=new Chart(ao).Bar(aG,ap)}else{if(au=="line"){aq=new Chart(ao).Line(aG,ap)}else{if(au==e){aq=new Chart(ao).Doughnut(aG,aF)}}}if(aq){n.push(aq)}if(t(am,au)||au==e){aA.find(".chart-legend-container").remove();aA.find(".chartWithAxis").after(aq.generateLegend())}if(aA.find(".xAxisLabel").length==0){if(au!=e){aA.find(".chartCanvas").before('<h3 class="yAxisLabel">'+aC+"</h3>");aA.find(".chartCanvas").after('<h3 class="xAxisLabel">'+at+"</h3>");aA.find(".yAxisLabel").css({top:aB,width:aB});aA.find(".xAxisLabel").css({width:aD})}else{aA.find(".chartCanvas").after('<h3 class="xAxisLabel">'+aC+"</h3>");aA.find(".xAxisLabel").css({width:aD})}if(!H.standalone&&(u.width()>0)){aA.find(".xAxisLabel").fadeIn().css("display","block")}}if(!H.standalone&&(u.width()>10)&&(o(".chart-legend-container").length>0)){if(!R){r()}else{aA.find(".chart-legend-container").fadeIn()}}}function S(am,an){var ao=an.tooltipPosition();new Chart.Tooltip({x:Math.round(ao.x),y:am.options.centeredInllineValues?Math.round(an.y+((am.options.tooltipFontSize)/2)):Math.round(ao.y),xPadding:am.options.tooltipXPadding,yPadding:am.options.tooltipYPadding,fillColor:"transparent",textColor:"#1976D2",fontFamily:am.options.tooltipFontFamily,fontStyle:am.options.tooltipFontStyle,fontSize:am.options.tooltipFontSize,caretHeight:am.options.tooltipCaretSize,cornerRadius:am.options.tooltipCornerRadius,text:G(am.options.metaCol,an.value),chart:am.chart}).draw()}function T(am,ap){if(typeof B==="undefined"){return}var an={},ao={},ar=[];B.meta.forEach(function(au){var av=getGridInfoByApiName(au.fullyQualifiedObjectName.split(":")[0]);if(av){var aw=au.gridId+"_"+au.fullyQualifiedObjectName;ar.push(aw);ao[au.fullyQualifiedObjectName]=aw;var at=(an[au.fullyQualifiedObjectName]={});au.fields.forEach(function(ax){var ay=getMetaColByFieldName(av,ax.name);if(ay){at[ay.fieldId]=ax}})}});var aq=false;ar.forEach(function(au){var at=B[au];if(at){at.forEach(function(av){var aw=am[av.Id];if(aw){Object.keys(aw).forEach(function(ay){var ax=an[aw.nm][ay];if(ax){var az=ax.name;if(av[az]!==aw[ay]){aq=true}av[az]=h(aw[ay],ax.dataType)}})}});while(at.length>0&&at[0].Id!=undefined&&at[0].Id[0]==="-"){at.splice(0,1);aq=true}}});Object.keys(ap).forEach(function(aw){var ay=ap[aw].nm,av=an[ay],at=B[ao[ay]];if(av){var ax=null,au=ap[aw];Object.keys(au).forEach(function(aC){var aB=av[aC],aA,az;if(aB){if(!ax){ax={Id:aw};if(au.pId){ax[ay.split(":")[1]]=au.pId}at.splice(0,0,ax)}if(aB.dataType=="REFERENCE"){if(at[at.length-1][aB.fieldRelName]){aA=at[at.length-1][aB.fieldRelName].attributes;az=H.formatting.object_Name_to_Name_Field[aA.type]||"Name"}else{aA=undefined;az="Name"}ax[aB.fieldRelName]={};ax[aB.fieldRelName][az]=au[aC];ax[aB.fieldRelName].attributes=aA}else{ax[aB.name]=h(au[aC],aB.dataType)}aq=true}})}});if(aq){ai(B)}}function y(){var am=H.def,aq=[],at=[],ap=[],au=[],ao=[],an=[];if(am.length>0){for(var ar=0;ar<am.length;ar++){aq.push(am[ar].type);at.push(aj[am[ar].size].fullName);ap.push(am[ar].color);au.push(am[ar].x_wedge);ao.push(am[ar].y_value);an.push(am[ar].summary_type)}}return{chartsTypes:aq.join(","),chartsSizes:at.join(","),chartsColors:ap.join(","),chartsXAxis:au.join(","),chartsYAxis:ao.join(","),chartsSummary:an.join(",")}}function h(ap,an){var am,ao;if(an==="CURRENCY"){var aq=(localeDigitSep||","),ar=(localeDecimalSep||".");ap=ap.split(aq).join("");ap=ap.replace(ar,".");return(isNaN(ap))?0:ap*1}else{if("DOUBLE|INTEGER|PERCENT".indexOf(an)>-1){return +ap}else{if(an==="DATE"){ap=ab(ap,H.formatting.dateFormat);am=("0"+ap.getDate()).slice(-2);ao=("0"+(ap.getMonth()+1)).slice(-2);ap=ap.getFullYear()+"-"+ao+"-"+am}}}return ap}function ah(am,aq){var ar=parseInt(am.slice(1),16),an=aq<0?0:255,at=aq<0?aq*-1:aq,ap=ar>>16,ao=ar>>8&255,au=ar&255;return"#"+(16777216+(Math.round((an-ap)*at)+ap)*65536+(Math.round((an-ao)*at)+ao)*256+(Math.round((an-au)*at)+au)).toString(16).slice(1)}function a(an){var am="";if(an.indexOf(":")==-1){am=an.substring(an.indexOf("_")+1,an.length)}else{am=an.substring(an.indexOf("_")+1,an.indexOf(":"))}return am}function G(ay,ap){if(!ay){return(ap)?ap:0}if(!ap){return(ay.isNumeric())?0:""}if(ay.isTypeDate()||ay.isTypeDateTime()){ap=ap.replace("+0000","Z");var az=new Date(ap);var au=az.getTime()+(az.getTimezoneOffset()*60000)+(ay.isTypeDateTime()?H.formatting.apexTZOffset:0);var aw=new Date(au);ap=o.datepicker.formatDate(H.formatting.dateFormat,aw)}else{if(ay.isNumeric()){var at=function(aA){return aA.split("").reverse().join("")};var am=function(aA){var aC=at(aA);var aB=aC.match(/.{1,3}/g).join(l);return at(aB)};var ar=ap.toString(),av=ar.indexOf("."),ao="",an=ar;if(av>-1){ao=ar.substring(av,ar.length);ao=ao.replace(E,C);an=ar.substring(0,av)}ar=am(an);ap=ar+ao;if(ay.isTypeCurrency()){var aq;var ax=ay.CurrencyIsoCode||H.formatting.defaultIsoCode;aq=(H.formatting.isMultiCurrencyOrg?(ax.length>0?(ax+" "):""):I(ax));ap=aq+ap}}}return ap}function I(an){an=an||H.formatting.defaultIsoCode;var am=H.currencySymbolMap[an]?H.currencySymbolMap[an]:"";return am}function J(){return"."}function x(ao,an,ap){var am=ao;if(an>-1&&(ao.length-an-1>ap)){am=am*1;am=am.toFixed(ap)}return am}function L(an){var am=o("#chartMessage-"+H.gridNameForAttributes);am.find(".msgText").text(an);u.find(".chartHeader").after(am.show().css({top:(V/2)-24}))}function b(){var am=o("#chartMessage-"+H.gridNameForAttributes);am.remove()}function K(an){var am=an+"",ao=am.indexOf(C)+1;return !ao?0:am.length-ao}function f(ap,an,ao){var am=Math.pow(10,ao||2);return(Math.round(ap*am)+Math.round(an*am))/am}function q(an){if(an){an=an+"";var am=an.replace(/&/g,"&amp;");am=am.replace(/'/g,"&#39;");am=am.replace(/"/g,"&#34;");am=am.replace(/</g,"&lt;");am=am.replace(/>/g,"&gt;");return am}return an}function ab(ap,au){var at="yy",av="mm",ao="dd",ar=new Date();au=au.toLowerCase();var an=au.indexOf(at);var aq=au.indexOf(av);var am=au.indexOf(ao);ar.setYear(ap.substr(an,4));ar.setMonth(ap.substr(aq,2)*1-1);ar.setDate(ap.substr(am,2));return ar}function d(){var am=o(".chartContainer");if(GBHelpers.isIE()){am.addClass("ie")}else{if(GBHelpers.isFirefox()){am.addClass("moz")}else{if(GBHelpers.isWebkit()){am.addClass("webkit")}}}}return{init:af,showLoaderAndChart:m,updateChart:T,setChartData:al}};var GBMixpanelForChart=(function(c,a,f){function e(g){this.settings=g;if(g.isTrackingDisabled||(typeof mixpanel=="undefined")){return}mixpanel.init(g.mpToken,{cross_site_cookie:true})}function b(g,h){if(this.settings.isTrackingDisabled||(typeof mixpanel=="undefined")){return}if(!h){h={}}var i=f.extend({},h,{"Org ID":this.settings.orgId,"Grid Name":this.settings.gridName,"GridBuddy Edition":this.settings.gbEdition,"GridBuddy Version":this.settings.gridBuddyVersion,"User ID":this.settings.userId,"User Type":this.settings.abbreviatedUserType,"UI Theme":this.settings.uiTheme,"User Language":this.settings.userLanguage,"OS Version":d()});mixpanel.track(g,i);mixpanel.people.set({"User ID":this.settings.userId,"User Type":this.settings.uiTheme,"UI Theme":this.settings.abbreviatedUserType,"User Language":this.settings.userLanguage});mixpanel.identify(this.settings.userId)}return{init:e,track:b};function d(){var i="Unknown OS";var h=navigator.userAgent;if(h&&(h.indexOf("Firefox")==-1)){var g=navigator.appVersion;if(g.indexOf("Mac")!=-1){i=g.match(/([Mac]+.+)/)[1]}else{if(g.indexOf("Windows")){i=g.match(/([Windows]+.+)/)[1]}}}else{if(h.indexOf("Firefox")!=-1){i=navigator.oscpu}}return i}})(window,document,jq);