var jq=jQuery.noConflict();function setFocusOnLoad(){}var newRowCounter=0;jq(document).ready(function(){GBButtons.updateAndShowButtons();GBManageActions.setIsWebKit();jq("#actionDetails .tooltip").tooltipster().focus(function(){jq(this).tooltipster("show")}).blur(function(){jq(this).tooltipster("hide")});jq(".actionForm").attr("autocomplete","off")});var GBManageActions=(function(c,b,g){function e(m){var l=m.find(".contentSourceSelect"),k=l.find("option:selected").val(),o=l.parents("tr:first").next().find("td.fieldName").next(),i=o.find("div.inlineHelp"),h=m.find(".idParamRow").find("td.fieldName").next(),n=h.find("div.inlineHelp");if(k=="none"){if(i.length>0){i.hide()}if(n.length>0){n.hide()}}else{if(i.length==0){g('<div class="inlineHelp"/>').appendTo(o);i=o.find("div.inlineHelp")}var j=actionsLang.contentInlineHelp[k.toLowerCase()];i.html(j).show();if(n.length==0){g('<div class="inlineHelp"/>').appendTo(h);n=h.find("div.inlineHelp")}var q=m.find(".idParamRow").css("display");if(q=="none"){n.hide()}else{var p="";if(k=="Grid"){p=actionsLang.idInlinHelp[k.toLowerCase()]}p+=(p.length>0?" ":"")+actionsLang.idInlinHelp["default"];n.html(p).show()}}}function d(h){if(h=="WindowOverlay"||h=="InGrid"){return true}return false}function a(h,i){g("."+h+":last").append('<div class="inlineHelp">'+i+"</div>")}function f(){if((/AppleWebKit/).test(navigator.userAgent)){g("div.gbActionsPage").addClass("webkit")}}return{showInlineHelpText:e,isOverlayBehavior:d,addHelpTextToWindowOverlayConfigField:a,setIsWebKit:f}})(window,document,jq);jq("table").on("click",".actionInfoUnderline",function(){jq("#infoText").hide();jq(".actionRow").hide();var a=jq(this).parents(0).attr("id");jq(".highlightRow").removeClass("highlightRow");jq("#"+a).addClass("highlightRow");jq("#"+a+"details").show();jq("#actionDetails .actionTitleInput").focus()});jq("table").on("click",".confirmAction",function(){var b=jq(this).parents(".actionRow");var a=jq(b).find(".confirmMessageRow");var c=jq(this).is(":checked");if(c){jq(a).show()}else{jq(a).find("input").val("");jq(a).hide()}});jq("table#actionDetails").on("change",".execBehaviorSelect",function(){var c=jq(this).parents(".actionRow");var b=jq(c).find(".overlayConfigRow");var a=jq(this).val();if(GBManageActions.isOverlayBehavior(a)){b.show()}else{b.hide();c.find(".overlayConfigRow").find("input").val("");c.find(".overlayConfigRow").find("select").val("px")}});jq("table#actionDetails").on("change","input, select",function(){var b=jq(this);var d=b.parents(".actionRow").attr("id");d=extractId(d);jq("#"+d).removeClass("highlightRow");jq("#"+d+" .actionInfoUnderline").css({color:"orange","font-weight":"bold"});if(b.closest(".newActionTd").length>0){var a=b.closest(".newActionTd");if(b.closest("td").hasClass("actContent")&&(a.find(".contentSourcePickList option:selected").val()=="Grid")){var c=b.val();if((c!="")&&(c.indexOf("&sfname")==-1)){b.val(b.val()+"&sfname=default")}}}});jq(".actionRow").each(function(d,c){var e=jq(this);var k=jq("#"+c.id+" td.objectPickList");addSelectOptionsToElement(k,objectNames,actionsLang.defaultSelectObject,k.attr("name"));var l=e.find(".confirmAction");var b=jq(l).is(":checked");var g=e.find(".confirmMessageRow");if(b){jq(g).show()}else{jq(g).hide()}var m=jq(e).find(".overlayConfigRow");var a=e.find(".execBehaviorSelect").val();if(GBManageActions.isOverlayBehavior(a)){m.show()}else{m.hide()}var f=e.find(".actionTypeSelect").find("option:selected").val();var j=e.find(".contentSourceSelect");var n=e.find(".contentSourceSelect").find("option:selected").val();var o=e.find(".idParamRow");removeUnsupportedOptions(f,j,n);if((f=="Single"||f=="Batch")&&(n=="URL"||n=="Page"||n=="Grid")){o.show()}else{o.hide()}var h=e.find(".actionLocationPickList").parent();if(f=="Single"){jq(h).hide()}else{jq(h).show()}GBManageActions.showInlineHelpText(e)});function addNewRow(){jq(".highlightRow").removeClass("highlightRow");jq(".actionRow").hide();jq("#infoText").hide();jq("#actionDetails > tbody:last").append(getActionHTML());jq("#actionDetails .tooltip").tooltipster().focus(function(){jq(this).tooltipster("show")}).blur(function(){jq(this).tooltipster("hide")});addSelectOptionsToLastClass("execBehaviorPickList",execBehaviors,"","","execBehaviorSelect");addSelectOptionsToLastClass("contentSourcePickList",contentSourcesForNew,"","","contentSourceSelect");addSelectOptionsToLastClass("actionTypePickList",actionTypes,"","","actionTypeSelect");addSelectOptionsToLastClass("actionLocationPickList",actionLocations,"","","actionLocationSelect");addSelectOptionsToLastClass("objectPickList",objectNames,actionsLang.defaultSelectObject);addSelectOptionsToLastClass("overlayHeight",overlayConfigUnits,"","","overlayHeightUnitSelect");addSelectOptionsToLastClass("overlayWidth",overlayConfigUnits,"","","overlayWidthUnitSelect");addSelectOptionsToLastClass("overlayTopOffset",overlayConfigUnits,"","","overlayTopOffsetUnitSelect");addSelectOptionsToLastClass("overlayLeftOffset",overlayConfigUnits,"","","overlayLeftOffsetUnitSelect");GBManageActions.addHelpTextToWindowOverlayConfigField("overlayHeight",actionsLang.overlayConfigHelp.overlaySize);GBManageActions.addHelpTextToWindowOverlayConfigField("overlayWidth",actionsLang.overlayConfigHelp.overlaySize);GBManageActions.addHelpTextToWindowOverlayConfigField("overlayTopOffset",actionsLang.overlayConfigHelp.overlayOffset);GBManageActions.addHelpTextToWindowOverlayConfigField("overlayLeftOffset",actionsLang.overlayConfigHelp.overlayOffset);jq("#actionDetails > tbody:last .actionTitleInput").focus();addNewActionToLeftNav()}function getActionHTML(){var a='<tr class="actionRow newAction" id="'+(++newRowCounter)+'details"><td class="newActionTd"><table><tr><td class="fieldName">'+actionsLang.actionLabel+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.actionNameFieldHelp+'"></span></td><td class="actionTitle"><input class="actionTitleInput" type="text" value="" maxlength="100"/></td></tr><tr><td class="fieldName">'+actionsLang.descr+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.descrFieldHelp+'"></span></td><td class="descr"><input type="text" value="" maxlength="255"/></td></tr><tr><td class="fieldName">'+actionsLang.objectApiName+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.objectFieldHelp+'"></span></td><td class="objectPickList"></td></tr><tr><td class="fieldName">'+actionsLang.actionType+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.actionTypeFieldHelp+'"></span></td><td class="actionTypePickList"></td></tr><tr><td class="fieldName">'+actionsLang.actionLocation+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.actionLocationFieldHelp+'"></span></td><td class="actionLocationPickList"></td></tr><tr><td class="fieldName">'+actionsLang.displayBehavior+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.execBehaviorFieldHelp+'"></span></td><td class="execBehaviorPickList"></td></tr><tr class="overlayConfigRow"><td class="fieldName">'+actionsLang.overlayHeight+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.overlayHeightFieldHelp+'"></span></td><td class="overlayHeight"><input type="text" value="" maxlength="4"/></td></tr><tr class="overlayConfigRow"><td class="fieldName">'+actionsLang.overlayWidth+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.overlayWidthFieldHelp+'"></span></td><td class="overlayWidth"><input type="text" value="" maxlength="4"/></td></tr> <tr class="overlayConfigRow"> <td class="fieldName">'+actionsLang.overlayTopOffset+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.overlayTopPositionFieldHelp+'"></span></td><td class="overlayTopOffset"><input type="text" value="" maxlength="4"/></td> </tr> <tr class="overlayConfigRow"> <td class="fieldName">'+actionsLang.overlayLeftOffset+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.overlayLeftPositionFieldHelp+'"></span></td><td class="overlayLeftOffset"><input type="text" value="" maxlength="4"/></td></tr> <tr> <td class="fieldName">'+actionsLang.contentSource+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.contentSourceFieldHelp+'"></span></td><td class="contentSourcePickList"></td></tr> <tr> <td class="fieldName">'+actionsLang.content+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.contentFieldHelp+'"></span></td><td class="actContent"><input type="text" value="" maxlength="2000"/></td> </tr> <tr class="idParamRow"> <td class="fieldName">'+actionsLang.idParamName+'<span class="star">*</span><span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.idParamFieldHelp+'"></span></td><td class="idParam"><input type="text" value="" maxlength="150" /></td></tr><tr><td class="fieldName">'+actionsLang.confirmAction+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.confirmActionFieldHelp+'"></span></td><td><input class="confirmAction" type="checkbox"/></td></tr> <tr class="confirmMessageRow" style="display:none"><td class="fieldName">'+actionsLang.confirmMessage+'<span class="gbInfoIcon tooltip" tabindex="0" title="'+actionsLang.confirmMessageFieldHelp+'"></span></td><td><input type="text" value="" maxlength="255" class="confirmMessage"/></td></tr> </table> </td> </tr>';return a}function addNewActionToLeftNav(){jq("#actionsList > tbody:last").append(getActionTitleHTML())}function getActionTitleHTML(){var a='<tr id="'+newRowCounter+'" class="highlightRow"><td><span class="minus">&nbsp;</span></td><td class="actionInfoUnderline">'+actionsLang.unknownLabel+'</td><td class="objectInfo lastCol">'+actionsLang.unknownLabel+"</td></tr>";return a}function saveNewRows(){var a={};jq("#actionDetails tr.newAction td.newActionTd").each(function(p,g){var s=jq(this).parents(1).attr("id");var m=jq(this).children("table").children("tbody");var x=m.find("tr td.actionTitle input").val();var f=m.find("tr td.objectPickList option:selected").val();var u=m.find("tr td.actionTypePickList option:selected").val();var d=m.find("tr td.actionLocationPickList option:selected").val();var h=m.find("input.confirmAction:checkbox").is(":checked");var q=m.find("tr input.confirmMessage").val();var t=m.find("tr td.contentSourcePickList option:selected").val();var r=m.find("tr td.actContent input").val();var i=m.find("tr td.idParam input").val();var n=m.find("tr td.descr input").val();var e=m.find("tr td.execBehaviorPickList option:selected").val();var l=m.find("tr td.overlayHeight input").val();var o=m.find("tr td.overlayHeight option:selected").val();var c=m.find("tr td.overlayWidth input").val();var k=m.find("tr td.overlayWidth option:selected").val();var v=m.find("tr td.overlayTopOffset input").val();var w=m.find("tr td.overlayTopOffset option:selected").val();var j=m.find("tr td.overlayLeftOffset input").val();var b=m.find("tr td.overlayLeftOffset option:selected").val();a[s]={objectApiName:f,actionLabel:x,actionType:u,actionLocation:d,confirmAction:h,confirmMessage:q,contentSource:t,content:r,descr:n,displayBehavior:e,idParamName:i,overlayHeight:l,overlayHeightUnit:o,overlayWidth:c,overlayWidthUnit:k,overlayTopOffset:v,overlayTopOffsetUnit:w,overlayLeftOffset:j,overlayLeftOffsetUnit:b,}});jq("[id*='newActionsJson']").val(JSON.stringify(a))}jq("table").on("keyup",".actionTitleInput",function(){var b=jq(this).parents().eq(5).attr("id");b=extractId(b);var a=jq(this).val();jq("#"+b+" .actionInfoUnderline").text(a)});jq("table").on("change","td.objectPickList select",function(){var a=jq(this).find("option:selected").text();var b=jq(this).parents().eq(5).attr("id");b=extractId(b);jq("#"+b+" .objectInfo").text(a)});jq("table").on("click",".minus",function(){var c=jq(this).parents().eq(1).attr("id");var b=jq("tr#"+c+"details");b.remove();var a=jq("tr#"+c);a.remove();jq("#infoText").show()});jq(".deleteButton").click(function(){var a=jq("input:checkbox:checked.deleteChk");if(a==null||a.length<1){alert(actionsLang.noActionsToDeleteError);return false}if(confirm(actionsLang.deleteActionsWarning)){return true}else{return false}});jq(".objectPickList").change(function(){if(confirm(actionsLang.changeObjectWarning)){var b=jq(this).parents(".actionRow");var f=b.find("input:text");for(var d=1;d<f.length;d++){var e=f[d];jq(e).attr("value","")}var c=b.find("input:checkbox");jq(c[0]).prop("checked",false);jq(b).find(".confirmMessageRow").hide();var g=b.find("select");for(var d=1;d<g.length;d++){var e=g[d];jq(e).val(jq(e).find("option:first").val())}var h=g[0];var a=jq(h).find("option:selected").val();jq(h).parents(0).attr({name:a});jq(h).prev().val(a)}else{return false}});jq("table#actionDetails").on("change",".contentSourceSelect, .actionTypeSelect",function(){var d=jq(this).parents(".actionRow");var b=jq(d).find(".contentSourceSelect").find("option:selected").val();var c=jq(d).find(".idParamRow");var e=jq(d).find(".actionTypeSelect").find("option:selected").val();if((e=="Single"||e=="Batch")&&(b=="URL"||b=="Page"||b=="Grid")){c.show()}else{jq(c).find("input").val("");c.hide()}var a=jq(d).find(".actionLocationPickList");var f=jq(a).parent();if(e=="Single"){jq(f).hide();jq(a).find(".actionLocationSelect").find("option:selected").val("Menu")}else{jq(f).show()}GBManageActions.showInlineHelpText(d)});jq("table#actionDetails").on("change",".actionTypeSelect",function(){var c=jq(this).find("option:selected").val();var b=jq(this).parents(".actionRow");var d=jq(b).find(".contentSourceSelect");var a=jq(d).find("option:selected").val();if(a=="Conductor"||a=="Composer"){resetSelectOptions(d,contentSources)}else{resetSelectOptions(d,contentSourcesForNew)}removeUnsupportedOptions(c,d,a);jq(d).val(a);GBManageActions.showInlineHelpText(b)});function resetSelectOptions(b,a){jq(b).find("option").remove();createSelectOptions(a,null,null,null,b)}function removeUnsupportedOptions(b,c,a){if(b=="Single"){jq(c).find("option[value='Conductor']").remove();if(a!="Composer"){jq(c).find("option[value='Composer']").remove()}}if(b=="Batch"){jq(c).find("option[value='Composer']").remove();jq(c).find("option[value='Button']").remove();jq(c).find("option[value='Formula']").remove();if(a!="Conductor"){jq(c).find("option[value='Conductor']").remove()}}if(b=="Global"){jq(c).find("option[value='Composer']").remove();jq(c).find("option[value='Conductor']").remove();jq(c).find("option[value='Button']").remove();jq(c).find("option[value='Formula']").remove()}}function addSelectOptionsToLastClass(b,f,c,e,a){var d=createSelectOptions(f,c,e,a);jq("."+b+":last").append(d)}function addSelectOptionsToElement(e,f,b,d,a){var c=createSelectOptions(f,b,d,a);e.append(c)}function createSelectOptions(f,c,d,b,e){if(!e){var a=jq("<select/>");a.addClass(b)}else{a=e}if(!d&&c){a.append(jq("<option/>").attr("value","").text(c))}jq.each(f,function(){jq.each(this,function(g,h){if(d&&d==g){a.append(jq("<option/>").prop("selected",true).val(g).text(h))}else{a.append(jq("<option/>").attr("value",g).text(h))}})});return a}function extractId(a){var b=a.indexOf("details");if(b>-1){return a.substring(0,b)}else{return a}}jq(".actionForm").submit(function(){showSubmitInProgress()});function showSubmitInProgress(){jq("input[type=submit], input.saveActionsBtn").addClass("none");jq("input.gbBtnDisabled").removeClass("none");jq(document.body).css("cursor","progress")}function enableButtons(){jq("input[type=submit], input.saveActionsBtn").removeClass("none");jq("input.gbBtnDisabled").addClass("none");jq(document.body).css("cursor","")};