var jq=jQuery.noConflict();jq(document).ready(function(){var f=jq("select.parentObjectSelect option:selected");var g=jq("#oldField1").val();GBMixpanel.init(mpToken);GBMixpanel.track("Page View",{Page:"GW1"});jq.fn.center=function(h){return this.each(function(){var i=jq(this);i.css({position:h?"absolute":"fixed",left:"50%",top:"50%",zIndex:"99"}).css({marginLeft:"-"+(i.outerWidth()/2)+"px",marginTop:"-"+(i.outerHeight()/2)+"px"});if(h){i.css({marginTop:parseInt(i.css("marginTop"),10)+jq(window).scrollTop(),marginLeft:parseInt(i.css("marginLeft"),10)+jq(window).scrollLeft()})}})};GBButtons.updateAndShowButtons();c();setIsIE();setIsWebKit();setIsFirefox();appendGridName();jq("select.parentObjectSelect").change(function(){c()});jq("select.parentObjectSelect").one("change",function(){if(g!=""&&g!=null){if(!confirm(lang.changeParent)){f.prop("selected",true);c()}}});jq(".showSidebarChkBx").click(function(){if(jq(this).is(":checked")){jq(".showHeaderChkBx").prop("checked",true)}});jq(".showHeaderChkBx").click(function(){if(!(jq(this).is(":checked"))){jq(".showSidebarChkBx").prop("checked",false)}});jq(".isDeleteAllChkBx").click(function(){if(jq(this).is(":checked")){jq(".isDeletableChkBx").prop("checked",true).change()}});jq(".isDeletableChkBx").change(function(){if(!jq(this).is(":checked")){jq(".isDeleteAllChkBx").prop("checked",false);jq(".isRollbackDeleteChkBx").prop("checked",false)}else{jq(".isRollbackDeleteChkBx").prop("checked",true)}});jq(".isCreateableChkBx, .massUpdatesChkBx").click(function(){if(jq(this).is(":checked")){jq(".isEditableChkBx").prop("checked",true)}else{if(jq(this).hasClass("isCreateableChkBx")&&!jq(this).is(":checked")){jq(".massCreatesChkBx").prop("checked",false)}}});jq(".massCreatesChkBx").click(function(){if(jq(this).is(":checked")){jq(".isCreateableChkBx").prop("checked",true);jq(".isEditableChkBx").prop("checked",true)}});jq(".isEditableChkBx").click(function(){if(!jq(this).is(":checked")){jq(".isCreateableChkBx").prop("checked",false);jq(".massUpdatesChkBx").prop("checked",false);jq(".massCreatesChkBx").prop("checked",false)}});jq(".showRecordDetailsChk").change(function(){if(jq(this).is(":checked")){jq(".expandGroupingsChk").prop("checked",true)}});jq(".expandGroupingsChk").change(function(){if(!jq(this).is(":checked")){jq(".showRecordDetailsChk").prop("checked",false)}});jq(".deleteButton").click(function(){if(confirm(lang.delGrid)){return true}else{return false}});jq(".gbUrl").click(function(){a();var h=jq(this).hasClass("metaEnable")?lang.enabling:jq(this).hasClass("metaDisable")?lang.disabling:jq(this).hasClass("mf")?lang.loading:lang.retrieving;showProcessingMsg(h)});jq(".nonAdminSection, .lightningStylesEnabledSection, .usageTrackingDisabledSection, .recordLockingSection").on("click",function(){var h=lang.saving;showProcessingMsg(h)});jq(".gbwForm").find(".gridList").change(function(){showSubmitInProgress()});jq(".gbwForm").submit(function(){showSubmitInProgress();folderDataField.value=d();jq('[id*="selectedCustomCSSIds"]').val(GBCustomCode.getSelectedCSSIds());jq('[id*="selectedCustomJSIds"]').val(GBCustomCode.getSelectedJSIds());jq('[id*="selectedThemeIds"]').val(GBCustomTheme.getSelectedThemeIds());jq(".gridList").prop("disabled",true)});jq(".gbwForm").find(".gridConfigOptions .tooltip").tooltipster().focus(function(){jq(this).tooltipster("show")}).blur(function(){jq(this).tooltipster("hide")});GBEmbed.init();GBCustomCode.init();GBCustomTheme.init();var b=jq("#folders div.content-wrap").attr("id");if(b!=""){jq.each(folderData,function(j,m){var l=m;var k=l.grids;if(k&&k!=""){var h=k.split(",");jq.each(h,function(n,p){if(p==b){var o=jq(".folder input");jq.each(o,function(r,s){var q=jq(s);if(q.attr("id")==l.fId){q.prop("checked",true);if(q.next().html()==lang.allGrids){q.prop("disabled",true)}return false}});return false}})}})}else{var e=jq(".folder input");jq.each(e,function(j,k){var h=jq(k);if(h.next().html()==lang.allGrids){h.prop("checked",true);h.prop("disabled",true);return false}})}jq(".folder span").click(function(){var h=jq(this).prev().attr("id");jq(".highlight").removeClass("highlight");jq(this).parent().addClass("highlight");jq("ul.gridList-ro").empty();jq("ul.profileList-ro").empty();jq("#defaultMessage").hide();jq("#gridsAndProfiles").show();jq("#gridsAndProfiles").parent().attr("width",jq("#gridsAndProfiles").children()[0].offsetWidth);jq.each(folderData,function(n,q){if(q.fId==h){var p=q.pIds;var m=q.grids;var l=jq("#nogrid");var o=jq("#noprofile");if(p&&p!=""){o.hide();var j=p.split(",");jq.each(j,function(r,s){jq("ul.profileList-ro").append("<li>"+htmlEscape(s)+"</li>")})}else{o.show()}if(m&&m!=""){l.hide();var k=m.split(",");jq.each(k,function(r,s){jq("ul.gridList-ro").append("<li>"+s+"</li>")})}else{l.show()}return false}})});jq("#selectAllFol").click(function(){var h=jq(this).prop("checked");var i=jq(".folder input:not(:disabled)");i.prop("checked",h)});function d(){var h=jq(".folder input:checked");var i="";jq.each(h,function(k,l){if(jq(l).prop("disabled")!=true){var j=jq(l).attr("id");if(k==0){i=i+j}else{i=i+","+j}}});return i}function a(){jq(".gbUrl").addClass("disabledLink");jq(".gridList").prop("disabled",true)}function c(){var n=jq("select.parentObjectSelect option:selected").val(),l=jq(".isEditableChkBx"),m=jq(".massUpdatesChkBx"),h=jq(".isDeletableChkBx, .isDeleteAllChkBx, .isRollbackDeleteChkBx"),k=jq(".isCreateableChkBx"),j=jq(".isRollbackSavedChkBx"),i=jq.trim(jq("#oldParentObject").val())=="";if(jq.inArray(n,readOnlyObjects)>-1){l.prop("checked",false).prop("disabled",true);j.prop("checked",false).prop("disabled",true);m.prop("checked",false).prop("disabled",true)}else{j.prop("disabled",false);l.prop("disabled",false);m.prop("disabled",false);if(i){l.prop("checked",true);m.prop("checked",true)}}if(jq.inArray(n,noDeleteObjects)>-1){h.prop("checked",false).prop("disabled",true)}else{h.prop("disabled",false)}if(jq.inArray(n,noCreateObjects)>-1){k.prop("checked",false).prop("disabled",true)}else{k.prop("disabled",false);if(i){k.prop("checked",true)}}}jq(".launchGridLink").on("click",function(){GBWindowsUtil.openWindow(launchGridURL)});jq(".gbwForm").attr("autocomplete","off");setDefaultCustomPerPageValue();jq(".recordsPerPageSelect").on("change",function(){jq(".adminRecordsPerPage .pageSizeInputField").val("")});jq(".pageSizeInputField").on("keypress",function(h){if(h.which<48||h.which>57){h.preventDefault()}})});jq(document).keyup(function(a){if(a.keyCode==27){jq("#embedGrid span.closeX").click()}});function showSubmitInProgress(){jq("input[type=submit], input.actionBtn").addClass("none");jq("input.gbBtnDisabled").removeClass("none");jq(document.body).css("cursor","progress")}function endSubmitInProgress(){jq("input.gbBtnDisabled").addClass("none");jq("input[type=submit], input.actionBtn").removeClass("none");jq(document.body).css("cursor","default")}function showProcessingMsg(a){jq("#gridStatus .msgText").text(a);jq("#gridStatus").center();jq("#gridStatus").show()}function hideProcessingMsg(a){jq("#gridStatus").hide();if(a){window.location.reload(false)}}function setIsIE(){if((/Trident\/7\./).test(navigator.userAgent)){jq("div.gbwPage").addClass("ie")}}function setIsWebKit(){if((/AppleWebKit/).test(navigator.userAgent)){jq("div.gbwPage").addClass("webkit")}}function setIsFirefox(){if((/Firefox/).test(navigator.userAgent)){jq("div.gbwPage").addClass("moz")}}function appendGridName(){url=window.location.href;if(url.indexOf("gname")==-1){var a;if(url.indexOf("?")==-1){a="?"}else{a="&"}window.history.pushState(null,null,url+a+"gname="+gridName)}}function htmlEscape(b){if(b){var a=b.replace(/&/g,"&amp;");a=a.replace(/'/g,"&#39;");a=a.replace(/"/g,"&#34;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a}return b}function setDefaultCustomPerPageValue(){var d=jq(".recordsPerPageSelect"),c=jq(".pageSizeInputField"),b=c.val(),a=false;d.find("option").each(function(){if(jq(this).val()==b){a=true;return}});if(a){c.val("")}else{d.val("20")}}var GBEmbed=(function(h,i,d){var k=d("#embedGrid"),b=k.find(".fpfInput"),a="id",o=d(".objectListLabel"),f=k.find("select.embedParentObjectSelect").find("option:selected").index();function n(){if(metaServiceDisabled){k.find("input.embedCreate").prop("disabled",true).removeClass("gbBtn").addClass("gbBtnDisabled").attr("title","Enable the GridBuddy Meta Data service to be able to create Visualforce pages for embedding grids.")}j()}function j(){c();d(".embedBtn").click(function(){m(true);GBMixpanel.track("GW1 Button Click",{Type:"Embed Grid"})});k.find("span.closeX, input.embedCancel").click(function(){m(false)}).keyup(function(p){if(p.keyCode==13){d(this).trigger("click")}});k.find("input.fpfRadio").change(function(){if(d(this).is(":checked")){b.prop("disabled",false);a="fpf";o.css("color","#000000");c()}});k.find("input.idRadio").change(function(){if(d(this).is(":checked")){b.prop("disabled",true).removeClass("gbrq");a="id";o.css("color","#808080");k.find("select.embedParentObjectSelect").prop("selectedIndex",f);c()}});k.find("input#fpf, input#fpv").keyup(function(){c();d(this).removeClass("gbrq")});k.find("input#embedTabName").keyup(function(){c()});k.find("select.embedParentObjectSelect").change(function(){c()});k.find("input.embedCreate").click(function(){var r=k.find("input#fpf"),p=k.find("input#fpv"),q=k.find("select.embedParentObjectSelect");if(!l(r,p,q)){alert("Please enter values for required fields.");return}showProcessingMsg(lang.processing);showSubmitInProgress();GBMixpanel.track("GW1 Button Click",{Type:"Create Embedded Page"});createVFpageForGridAF(q.find("option:selected").val(),a,r.val(),p.val(),htmlEscape(k.find("input#embedTabName").val()))})}function l(v,r,t){var u=true,s=v.val(),p=r.val(),q=t.find("option:selected").val();if(q==null||q==""){t.addClass("gbrq");u=false}if(a=="fpf"){if(s==null||s==""){v.addClass("gbrq");u=false}if(p==null||p==""){r.addClass("gbrq");u=false}}return u}function e(){hideProcessingMsg();endSubmitInProgress()}function m(p){if(p){d("#gbOverlay").show();k.center();k.show()}else{k.hide();d("#gbOverlay").hide()}}function c(){var r,w=k.find("input#embedTabName").val(),y=k.find("select.embedParentObjectSelect option:selected").val(),u="",s="",q="\t",v,t=false;if(a=="fpf"){var x=k.find("input#fpf").val(),p=k.find("input#fpv").val();r="fpf="+x+"&fpv="+p}else{r="id={!"+y+".Id}"}if(w&&d.trim(w)){t=true;u='\t<apex:tabPanel switchType="client" selectedTab="tabdetails" tabClass="activeTab" inactiveTabClass="inactiveTab">\n\t\t<apex:tab label="'+htmlEscape(w)+'">\n';s="\t\t</apex:tab>\n\t</apex:tabPanel>\n";q="\t\t\t"}v='<apex:page standardController="'+y+'" sidebar="false" showHeader="false">\n'+(t==true?'\t<apex:stylesheet value="/sCSS/25.0/sprites/1342034628000/Theme3/default/gc/versioning.css" />\n\t<apex:stylesheet value="/sCSS/25.0/sprites/1342034628000/Theme3/default/gc/extended.css" />\n\n':"")+"\t<"+nameSpacePrefix+':EmbedComponent baseGridUrl="{!$Page.'+nameSpace+'Grid}" />\n\n'+u+q+'<iframe id="gridFrame" scrolling="auto" height="480" width="100%" frameborder="0" src="{!gridPage}gname='+gridName+"&"+r+'&sh=0&ssb=0&sbb=1&sfname=default"></iframe>\n'+s+"</apex:page>";k.find("#embedVfText").text(v)}function g(){showProcessingMsg(lang.processing);showSubmitInProgress();checkEmbedStatusForGridAF()}return{init:n,completeEmbedRequest:e,getEmbedStatus:g}})(window,document,jq);var GBMixpanel=(function(f,g,c){function i(j){if(isTrackingDisabled||(typeof mixpanel=="undefined")){return}mixpanel.init(j,{cross_site_cookie:true});e()}function b(j,k){if(isTrackingDisabled||(typeof mixpanel=="undefined")){return}if(!k){k={}}var l=c.extend({},k,{"Org ID":orgId,"Grid Name":gridName,"GridBuddy Edition":gbEdition,"GridBuddy Version":gridBuddyVersion,"User ID":userId,"User Type":abbreviatedUserType,"UI Theme":uiTheme,"User Language":userLanguage,"Lightning Style Enabled":lightningStylesEnabled,"OS Version":h()});mixpanel.track(j,l);mixpanel.people.set({"User ID":userId,"User Type":uiTheme,"UI Theme":abbreviatedUserType,"User Language":userLanguage});mixpanel.identify(userId)}function h(){var l="Unknown OS";var k=navigator.userAgent;if(k&&(k.indexOf("Firefox")==-1)){var j=navigator.appVersion;if(j.indexOf("Mac")!=-1){l=j.match(/([Mac]+.+)/)[1]}else{if(j.indexOf("Windows")){l=j.match(/([Windows]+.+)/)[1]}}}else{if(k.indexOf("Firefox")!=-1){l=navigator.oscpu}}return l}function e(){c(".gbwForm").on("click",".gbBtn",function(k){var j=c(this);if(j.hasClass("cloneButton")){GBMixpanel.track("GW1 Button Click",{Type:"Clone"})}else{if(j.hasClass("goToMfButton")){GBMixpanel.track("GW1 Button Click",{Type:"Manage Folders"})}else{if(j.hasClass("saveButton")||j.hasClass("nextButton")){d();a()}}}})}function a(){var l=k(),m=j();GBMixpanel.track("GW1 Save",{"UDF Enabled":c(".UDFChkBx").prop("checked"),"Mass Update Enabled":c(".massUpdatesChkBx").prop("checked"),"UDC Enabled":c(".UDCChkBx").prop("checked"),"Export Enabled":c(".exportChkBx").prop("checked"),"Edit Enabled":c(".isEditableChkBx").prop("checked"),"Create Enabled":c(".isCreateableChkBx").prop("checked"),"Mass Create Enabled":c(".massCreatesChkBx").prop("checked"),"Read Only Default":c(".readOnlyChkBx").prop("checked"),"Repeat Header":c(".repeatParentHeaderChkBx").prop("checked"),"Compact View":c(".compactViewChkBx").prop("checked"),"# Page Records":c(".recordsPerPageSelect").val(),"Related Object Options":l,"Grouping Option":m,"# Folders Selected":c(".folderBox .content-wrap").find(".folder").find("input[type=checkbox]:enabled:checked").length,"# Components Selected":c("#selectedCSSCode, #selectedJSCode").find(".customCode:not(.customCodeInfo, .globalCustomCode)").length,"# Global Themes":c(".globalCustomTheme").length,"# Grid-level Themes":c(".customTheme.gbSortable").length,"Enforce Sharing Rules":c(".ESRChkBx").prop("checked")});function k(){var o="",n=c("tr.relatedObjectOptionsRow .rightCell").find("input[type=radio]:checked").val();if(n=="Show_Related_Expanded"){o="Expanded"}else{if(n=="Show_Related_Collapsed"){o="Collapsed"}else{if(n=="Hide_Related"){o="Hidden"}}}return o}function j(){var q=c("tr.groupingOptionsRow").find(".expandGroupingsChk").prop("checked"),p=c("tr.groupingOptionsRow").find(".showRecordDetailsChk").prop("checked"),o=(q&&p),n=(!q&&!p);if(n){return"None"}else{if(o){return"Both"}else{if(q){return"Expanded"}else{if(p){return"Details"}}}}}mixpanel.people.increment("GW1 Save")}function d(){var l=c(".pageSizeInputField"),j=l.val();if(!j||j==undefined||j.trim()==""||!/^\d+$/.test(j)){var k=c(".recordsPerPageSelect option:selected").val();l.val(k)}}return{init:i,track:b}})(window,document,jq);var GBCustomCode=(function(j,p,e){var o=false,i=[],f={},a=[],g=[];function b(r){o=r.customCodeEnabled;i=r.customCodeRecords;a=r.selectedCustomCSSIds;g=r.selectedCustomJSIds}function q(){if(!o){return}l();c()}function d(){return h("#selectedCSSCode")}function n(){return h("#selectedJSCode")}function h(r){var t=e(r).find("div.customCode:not(.customCodeInfo, .globalCustomCode)");if(t.length>0){var s=[];t.each(function(){s.push(e(this).attr("id"))});return s.join(", ")}return null}function l(){var u=[],w=[],y=[],z=[],x,r,v=false,s=false;for(var t=0;t<i.length;t++){x=i[t];f[x.codeId]=x;if(x.codeType=="CSS"){r=a.indexOf(x.codeId)>-1;v=true;if(!r){u=u.concat(k(x,true))}}else{if(x.codeType=="JavaScript"){r=g.indexOf(x.codeId)>-1;s=true;if(!r){w=w.concat(k(x,true))}}else{if(x.codeType=="Global CSS"){y=y.concat(k(x,false,true))}else{if(x.codeType=="Global JavaScript"){z=z.concat(k(x,false,true))}}}}}for(var t=0;t<a.length;t++){x=f[a[t]];if(!x){continue}y=y.concat(k(x,false))}for(var t=0;t<g.length;t++){x=f[g[t]];if(!x){continue}z=z.concat(k(x,false))}if(u.length>0){e("#availableCSSCode").find(".customCodeInfo").addClass("none")}if(v){e("#availableCSSCode").find(".customCodeInfo").text("All selected.")}if(w.length>0){e("#availableJSCode").find(".customCodeInfo").addClass("none")}if(s){e("#availableJSCode").find(".customCodeInfo").text("All selected.")}if(y.length>0){e("#selectedCSSCode").find(".customCodeInfo").addClass("none")}if(z.length>0){e("#selectedJSCode").find(".customCodeInfo").addClass("none")}e("#availableCSSCode").append(u.join(""));e("#availableJSCode").append(w.join(""));e("#selectedCSSCode").append(y.join(""));e("#selectedJSCode").append(z.join(""));e("#selectedCSSCode .tooltip").tooltipster().focus(function(){e(this).tooltipster("show")}).blur(function(){e(this).tooltipster("hide")});e("#selectedJSCode .tooltip").tooltipster().focus(function(){e(this).tooltipster("show")}).blur(function(){e(this).tooltipster("hide")})}function k(v,t,s){var r=[],u=["customCode"];if(!t&&!s){u.push("gbSortable")}if(s){u.push("globalCustomCode")}r.push('<div class="'+u.join(" ")+'" id="'+v.codeId+'">');if(t){r.push('<span class="gbAddCode"></span>')}else{if(!s){r.push('<span class="gbRemoveCode"></span>')}else{r.push('<span class="gbInfoIcon tooltip" title="This is global code that\'s applied to all grids." tabindex="0"/>')}}r.push("<span>"+v.summary+"</span>");r.push("</div>");return r}function c(){e(".customCodeBlock").on("click",".gbAddCode, .gbRemoveCode",function(){m(e(this))});e("#selectedCSSCode, #selectedJSCode").sortable({items:"div.gbSortable"})}function m(r){var t=r.closest(".customCodeBlock.css").length>0,v=(t?e("#availableCSSCode"):e("#availableJSCode")),s=(t?e("#selectedCSSCode"):e("#selectedJSCode")),u=r.closest("div.customCode").attr("id");if(r.hasClass("gbAddCode")){v.find("#"+u).remove();s.append(k(f[u],false).join(""));s.sortable({items:"div.gbSortable"});s.find(".customCodeInfo").addClass("none");if(v.find(".customCode").length==1){v.find(".customCodeInfo").removeClass("none")}}else{s.find("#"+u).remove();v.append(k(f[u],true).join(""));if(s.find(".customCode").length==1){s.find(".customCodeInfo").removeClass("none")}if(v.find(".customCode").length>1){v.find(".customCodeInfo").addClass("none")}}}return{setProps:b,init:q,getSelectedCSSIds:d,getSelectedJSIds:n}})(window,document,jq);var GBCustomTheme=(function(j,k,d){var m=false,i=[],l={},g=[];function a(p){m=p.customThemeEnabled;i=p.customThemeRecords;g=p.selectedCustomThemeIds}function o(){if(!m){return}e();c()}function f(){return h("#selectedThemes")}function h(p){var r=d(p).find("div.customTheme:not(.customThemeInfo, .globalCustomTheme)");if(r.length>0){var q=[];r.each(function(){q.push(d(this).attr("id"))});return q.join(", ")}return null}function e(){var u=[],q=[],t,p,s=false;for(var r=0;r<i.length;r++){t=i[r];l[t.themeId]=t;if(t.themeType=="Grid"){p=g.indexOf(t.themeId)>-1;s=true;if(!p){u=u.concat(n(t,true))}}else{if(t.themeType=="Global"){q=q.concat(n(t,false,true))}}}for(var r=0;r<g.length;r++){t=l[g[r]];if(!t){continue}q=q.concat(n(t,false))}if(u.length>0){d("#availableThemes").find(".customThemeInfo").addClass("none")}if(s){d("#availableThemes").find(".customThemeInfo").text("All selected.")}if(q.length>0){d("#selectedThemes").find(".customThemeInfo").addClass("none")}d("#availableThemes").append(u.join(""));d("#selectedThemes").append(q.join(""));d("#selectedThemes .tooltip").tooltipster().focus(function(){d(this).tooltipster("show")}).blur(function(){d(this).tooltipster("hide")})}function n(t,r,q){var p=[],s=["customTheme"];if(!r&&!q){s.push("gbSortable")}if(q){s.push("globalCustomTheme")}p.push('<div class="'+s.join(" ")+'" id="'+t.themeId+'">');if(r){p.push('<span class="gbAddTheme"></span>')}else{if(!q){p.push('<span class="gbRemoveTheme"></span>')}else{p.push('<span class="gbInfoIcon tooltip" title="This is global theme that\'s applied to all grids." tabindex="0"/>')}}p.push("<span>"+t.summary+"</span>");p.push("</div>");return p}function c(){d(".customThemeBlock").on("click",".gbAddTheme, .gbRemoveTheme",function(){b(d(this))});d("#selectedThemes").sortable({items:"div.gbSortable"})}function b(p){var s=d("#availableThemes"),r=d("#selectedThemes"),q=p.closest("div.customTheme").attr("id");if(p.hasClass("gbAddTheme")){s.find("#"+q).remove();r.append(n(l[q],false).join(""));r.sortable({items:"div.gbSortable"});r.find(".customThemeInfo").addClass("none");if(s.find(".customTheme").length==1){s.find(".customThemeInfo").removeClass("none")}GBMixpanel.track("Add Custom Theme",{Page:"GW1","Theme Added to Grid":true})}else{r.find("#"+q).remove();s.append(n(l[q],true).join(""));if(r.find(".customTheme").length==1){r.find(".customThemeInfo").removeClass("none")}if(s.find(".customTheme").length>1){s.find(".customThemeInfo").addClass("none")}}}return{setProps:a,init:o,getSelectedThemeIds:f}})(window,document,jq);