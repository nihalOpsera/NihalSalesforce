var jq=jQuery.noConflict();jq(document).ready(function(){GBButtons.updateAndShowButtons();GBCustomThemeConfig.init();GBMixpanel.init(mpToken);GBMixpanel.track("Page View",{Page:"MCT"})});var GBCustomThemeConfig=(function(A,a,f){var p="Global",t="Grid",J,h={},g={},c=-1;function m(M){for(var L=0;L<M.customThemeRecords.length;L++){M.customThemeRecords[L].themeBody=JSON.parse(M.customThemeRecords[L].themeBody)}J=M.customThemeRecords}function E(){x();v();G();f(".gbForm").attr("autocomplete","off")}function G(){var L=n("cid");if(L){var M=f('#customThemeList tr[id="'+L+'"]');if(M.length>0){M.find("td.themeSummary").click()}}}function n(N){var M=A.location.search,O="";if(M){var L=M.split("&");f.each(L,function(P,Q){if(Q.match(N+"=")){O=Q.substring(Q.indexOf("=")+1);return false}})}return O}function v(){f("#customThemeList").on("click","td.themeSummary",function(L){b(f(this).parent("tr").attr("id"));e(f(this).parent("tr"));B()});f(".gbwPage").on("click",".addNewBtn",function(L){D();GBMixpanel.track("New Theme",{"New Theme":""})});f("#customThemeList").on("click","span.minus",function(L){H(f(this).closest("tr"))});f(".gbwPage").on("click",".saveThemeBtn",function(L){K(L)});f(".gbwPage").on("click",".deleteBtn",function(L){z()});f("#themeDetails").on("change","input, select",function(){s(f(this));F();B()});f("#themeDetails").on("click",".addLink",function(){o();s(f(this));B()});f("#themeDetails").on("click",".clearLink",function(){y(f(this));s(f(this));B()});f("#themeDetails").on("click",".colorPickerRow > div",function(){var L=f(this);if(L.hasClass("selected")){L.removeClass("selected")}else{L.closest(".colorPickerDiv").find(".colorPickerRow > div").removeClass("selected");L.addClass("selected")}s(f(this));B()});f("#themeDetails").on("change",".hexCheckBox",function(){d(f(this))});f(".closeX").click(function(){C()}).keyup(function(L){if(L.keyCode==13){f(this).trigger("click")}});f(a).keyup(function(L){if(L.keyCode==27){C()}});f(a).keydown(function(L){if(!L){L=A.event}if(L){if(L.keyCode==83&&(L.ctrlKey||L.metaKey)){K(L);L.preventDefault()}}});f("#themeDetails .tooltip").tooltipster().focus(function(){f(this).tooltipster("show")}).blur(function(){f(this).tooltipster("hide")})}function K(M){if(f.isEmptyObject(g)){alert("No changes since last save.");return}var L=q();if(L==null){w()}else{l(f(".saveThemeBtn"),L,M)}}function l(P,O,L){var M=f("#vldWarning"),N=f(P).position();M.find(".msgBody").html(O);M.css("top",(N.top*1+23));M.css("left",(N.left*1+10));M.show();L.stopPropagation();f(A).scrollTop(N.top)}function C(){if(f("#vldWarning").is(":visible")==true){f("#vldWarning").hide()}}function y(L){L.closest(".themeConfigItem").remove();f("#themeConfigContainer .themeConfigItem").each(function(M){var O=M+1,N=f(this);N.attr("data-index",O);N.find(".themeConfigIndex").text(O+". ")})}function z(){var O=f("#customThemeList input.themeCheck:checked"),N=[],M,P,L="Delete selected theme? This will remove the custom functionality from any associated grids.";if(O.length==0){alert("No records marked for deletion.");return}O.each(function(){M=f(this).closest("tr.themeRow").attr("id");P=(g[M]||h[M]);if(P.themeType==p){L+=" Deleting the global theme will impact all grids.";return false}});if(confirm(L)){O.each(function(){N.push(f(this).closest("tr.themeRow").attr("data-recordId"))});f('[id*="idsToDelete"]').val(JSON.stringify(N));deleteCustomTheme()}return}function s(N){var M=f("#themeDetails").attr("data-themeId"),L=f("#customThemeList").find("tr#"+M);if(N.hasClass("themeSummary")){L.find("td.themeSummary").text(N.val())}else{if(N.hasClass("themeType")){L.find("td.themeType").text(N.val())}}L.find("td.themeSummary, td.themeType").addClass("orange")}function F(){var M=f("#themeDetails").attr("data-themeId"),L=f("#customThemeList").find("tr#"+M);if(f("#themeDetails").find("input.themeSummary").val()){L.find("td.themeSummary").removeClass("red")}if(f("#themeDetails").find("select.themeType").val()){L.find("td.themeType").removeClass("red")}}function x(){var N,L=[];if(J.length==0){return}for(var M=0;M<J.length;M++){N=J[M];L=L.concat(k(N,false))}f("#customThemeList").append(L.join(""));f("#customThemeList .themeListInfo").addClass("none")}function k(N,M){var L=[];L.push('<tr class ="themeRow" id="'+N.themeId+'" data-recordId="'+N.recordId+'">');L.push("<td>");if(M){L.push('<span class="minus">&nbsp;</span>')}else{L.push('<input class="themeCheck" type="checkbox"/>')}L.push("</td>");L.push('<td class="themeSummary">');L.push(N.summary);L.push("</td>");L.push('<td class="themeType">');L.push(N.themeType);L.push("</td>");L.push("</tr>");h[N.themeId]=N;return L}function D(){var M={},L=[];M.themeId=c;M.summary="New theme";M.themeType="Grid";M.themeBody=[];L=L.concat(k(M,true));c--;f("#customThemeList").append(L.join(""));f("#customThemeList").find("#"+M.themeId+" td.themeSummary").addClass("orange").click();f("#customThemeList .themeListInfo").addClass("none");f("#themeDetails .inputs .themeSummary").change()}function H(L){delete h[L.attr("id")];delete g[L.attr("id")];f("#themeDetails").removeAttr("data-themeId").addClass("none");f("#themeDetails").find("input, select, textarea").val("");f("#themeDetailsInfo").removeClass("none");L.remove();if(f("#customThemeList").find("tr").length==2){f("#customThemeList .themeListInfo").removeClass("none")}}function B(){var L=f("#themeDetails").attr("data-themeId"),M={};M.summary=f("#themeDetails").find("input.themeSummary").val();M.themeType=f("#themeDetails").find("select.themeType").val();M.recordId=f("#themeDetails").attr("data-recordId");M.themeBody=[];f("#themeConfigContainer .themeConfigItem").each(function(){var S=f(this),R,T,Q,U=S.find(".bgColorPicker .hexCheckBox").prop("checked"),N=S.find(".textColorPicker .hexCheckBox").prop("checked"),P=S.find(".bgColorPicker .hexInput").val(),O=S.find(".textColorPicker .hexInput").val();R=S.find(".elementDropdown").val();if(U){if(P!==""){T="#"+P}}else{T=S.find(".bgColorPicker .selected").attr("data-colorid")}if(N){if(O!==""){Q="#"+O}}else{Q=S.find(".textColorPicker .selected").attr("data-colorid")}M.themeBody.push({elem:R,bgColor:T,textColor:Q})});g[L]=M}function q(){var U,L,T,S=false,N=[],V=[],Q=[],O=[],M;for(U in g){T=g[U];O=[];if(!T.summary||!T.themeType||!T.themeBody){if(!S){Q.push("Theme Name and Type are both required for all custom themes.");S=true}N.push(U)}if(T.themeBody.length==0){Q.push("Please add at least one rule to the "+T.summary+' theme by clicking the blue "Add" link.')}for(var P=0;P<T.themeBody.length;P++){M=T.themeBody[P];if(O.indexOf(M.elem)==-1){O.push(M.elem)}else{Q.push('An element can only be used once in a theme. Please remove one of the "'+M.elem+'" elements from the '+T.summary+" theme.")}if(M.bgColor==undefined&&M.textColor==undefined){Q.push("Each theme rule should have a background color or a text color. Please correct the "+T.summary+" theme.");break}if(M.elem==undefined||M.elem=="0"){Q.push("Each theme rule should have an element selected. Please correct the "+T.summary+" theme.")}}if(T.themeType=="Global"){V.push(U)}}for(U in h){L=h[U];T=g[U];if(L.themeType=="Global"&&!T){V.push(U)}}if(V.length>1){Q.push("There can only be one global theme.");N=N.concat(V)}if(Q.length>0){for(var R=0;R<N.length;R++){f('#customThemeList tr[id="'+N[R]+'"] td').addClass("red")}return Q.join("<br/>")}return null}function w(){for(var L in g){GBMixpanel.track("Save Theme",{Scope:g[L].themeType,"Element Count":g[L].themeBody.length,Elements:g[L].themeBody.map(function(M){return M.elem})});g[L].themeBody=JSON.stringify(g[L].themeBody)}f('[id*="editedCustomThemeInput"]').val(JSON.stringify(g));GBMixpanel.trackSave();saveCustomTheme()}function b(L){var M=(g[L]||h[L]);f("#themeDetails").attr("data-themeId",L);f("#themeDetails").attr("data-recordId",M.recordId);f("#themeDetails").find("input.themeSummary").val(j(M.summary));f("#themeDetails").find("select.themeType").val(M.themeType);f("#themeDetails").find("input.themeSummary").focus();f("#themeDetailsInfo").addClass("none");f("#themeDetails").removeClass("none");u(M);i(M)}function u(O){var M=f("#themeConfigContainer"),L=[];if(O.themeBody.length==0){L.push(r(1))}for(var N=0;N<O.themeBody.length;N++){L.push(r(N+1))}L.push('<a class="addLink">Add</a>');M.empty().append(L.join(""))}function i(L){f("#themeConfigContainer .themeConfigItem").each(function(N){var O=f(this),Q=L.themeBody[N];if(Q==undefined){return}O.find(".elementDropdown").val(Q.elem);if(Q.bgColor!=undefined){var P=Q.bgColor.length>2;bgHexCheckBox=O.find(".bgColorPicker .hexCheckBox");if(P){bgHexCheckBox.prop("checked",true);d(bgHexCheckBox);O.find(".bgColorPicker .hexInput").val(Q.bgColor.substring(1,Q.bgColor.length))}else{O.find(".bgColorPicker .color-"+Q.bgColor).addClass("selected")}}if(Q.textColor!=undefined){var M=Q.textColor.length>2,R=O.find(".textColorPicker .hexCheckBox");if(M){R.prop("checked",true);d(R);O.find(".textColorPicker .hexInput").val(Q.textColor.substring(1,Q.textColor.length))}else{O.find(".textColorPicker .color-"+Q.textColor).addClass("selected")}}})}function d(M){var L=M.closest(".colorPickerContainer"),N=M.prop("checked");if(N){L.find(".colorPickerDiv").hide();L.find(".colorPickerDiv .selected").removeClass("selected");L.find(".hexInputContainer").show()}else{L.find(".colorPickerDiv").show();L.find(".hexInput").val("");L.find(".hexInputContainer").hide()}}function o(){var M=f("#themeConfigContainer .themeConfigItem:last"),N=M.attr("data-index")*1,L=N+1;if(M.length>0){M.after(r(L))}else{f("#themeConfigContainer").prepend(r(1))}}function r(M){var L=[];L.push('<div class="themeConfigItem" data-index="'+M+'">');L.push('<div class="themeConfigRow">');L.push('<span class="themeConfigIndex">'+M+". </span>");L.push('<select class="elementDropdown">');L.push('<option value="0">--Select--</option>');L.push('<option value="Parent headers">Parent headers</option>');L.push('<option value="Related object headers">Related object headers</option>');L.push('<option value="Data rows">Data rows</option>');L.push('<option value="Data row hover/selection">Data row hover/selection</option>');L.push('<option value="Summary rows">Summary rows</option>');L.push('<option value="Grouping rows">Grouping rows</option>');L.push('<option value="Buttons:Standard">Standard Buttons</option>');L.push('<option value="Buttons:Quick Filters">Quick Filter Buttons</option>');L.push('<option value="Buttons:Custom Actions">Custom Action Buttons</option>');L.push("</select>");L.push('<a class="clearLink">Clear</a>');L.push("</div>");L.push('<div class="themeConfigRow clearfix">');L.push('<div class="bgColorPicker">'+I("bgColor")+"</div>");L.push('<div class="textColorPicker">'+I("textColor")+"</div>");L.push("</div>");L.push("</div>");return L.join("")}function I(O){var L=[];L.push('<div class="colorPickerContainer">');L.push('<div class="colorPickerHeader">'+((O=="bgColor")?"Background":"Text")+" color:</div>");L.push('<div class="colorPickerDiv">');L.push('<div class="colorPickerRow">');for(var N=1;N<=6;N++){L.push('<div class="color-'+N+'" data-colorId="'+N+'"></div>')}L.push("</div>");L.push('<div class="colorPickerRow">');for(var M=7;M<=12;M++){L.push('<div class="color-'+M+'" data-colorId="'+M+'"></div>')}L.push("</div>");L.push("</div>");L.push('<input type="checkbox" class="hexCheckBox" name="isUseHex"/>Use hex code');L.push('<div class="hexInputContainer">#<input type="text" class="hexInput" name="hexCode" maxlength="6"/></div>');L.push("</div>");return L.join("")}function e(L){f("#customThemeList tr").removeClass("highlightRow");L.addClass("highlightRow")}function j(M){if(M){var L=M.replace(/&#39;/g,"'");L=L.replace(/&#34;/g,'"');L=L.replace(/&lt;/g,"<");L=L.replace(/&gt;/g,">");L=L.replace(/&amp;/g,"&");return L}return M}return{setProps:m,init:E,TYPE_GLOBAL:p,TYPE_GRID:t}})(window,document,jq);var GBMixpanel=(function(d,e,b){function h(j){if(i()){return}mixpanel.init(j,{cross_site_cookie:true})}function a(j,k){if(i()){return}if(!k){k={}}var l=b.extend({},k,{"Org ID":orgId,"GridBuddy Edition":gbEdition,"GridBuddy Version":gridBuddyVersion,"User ID":userId,"User Type":abbreviatedUserType,"UI Theme":uiTheme,"User Language":userLanguage,"Lightning Style Enabled":lightningStylesEnabled,"OS Version":f()});mixpanel.track(j,l);mixpanel.people.set({"User ID":userId,"User Type":uiTheme,"UI Theme":abbreviatedUserType,"User Language":userLanguage});mixpanel.identify(userId)}function f(){var l="Unknown OS";var k=navigator.userAgent;if(k&&(k.indexOf("Firefox")==-1)){var j=navigator.appVersion;if(j.indexOf("Mac")!=-1){l=j.match(/([Mac]+.+)/)[1]}else{if(j.indexOf("Windows")){l=j.match(/([Windows]+.+)/)[1]}}}else{if(k.indexOf("Firefox")!=-1){l=navigator.oscpu}}return l}function c(){if(i()){return}var j=g();a("MCT Save",j)}function g(){var j=false,k=0,l;b("#customThemeList .themeRow .themeType").each(function(){l=b(this).text();if(l==GBCustomThemeConfig.TYPE_GLOBAL){j=true;k++}else{if(l==GBCustomThemeConfig.TYPE_GRID){k++}}});return{"Has Global Themes":j,"# Themes":k}}function i(){if(isTrackingDisabled||(typeof mixpanel=="undefined")){return true}return false}return{init:h,track:a,trackSave:c}})(window,document,jq);