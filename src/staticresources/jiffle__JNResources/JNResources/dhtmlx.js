function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}if(void 0===window.dhx4&&(window.dhx4={version:"4.2",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var i=document.createElement("DIV");i.className=t,null!=document.body.firstChild?document.body.insertBefore(i,document.body.firstChild):document.body.appendChild(i);var s=i[e||"offsetWidth"];return i.parentNode.removeChild(i),i=null,s},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(t){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,l=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=s.clientTop||i.clientTop||0,r=s.clientLeft||i.clientLeft||0,a=e.top+n-o,h=e.left+l-r;return{top:Math.round(a),left:Math.round(h)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&void 0===t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var i in t)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i]}else for(e=[],i=0;i<t.length;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,i){var s=(t="string"==typeof t?document.getElementById(t):t).value.length;if(e=Math.max(Math.min(e,s),0),i=Math.min(i,s),t.setSelectionRange)try{t.setSelectionRange(e,i)}catch(t){}else if(t.createTextRange){var n=t.createTextRange();n.moveStart("character",e),n.moveEnd("character",i-s);try{n.select()}catch(t){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=null!=t.childNodes[i].nodeValue?t.childNodes[i].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),void 0===window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,i){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],s=window.dhx4.trim(arguments[3]),n=null,l=[e[t]];if(s.length>0){s=s.split(":");for(var o=[],r=0;r<s.length;r++)r>0&&null!=o[o.length-1].match(/\\$/)?o[o.length-1]=o[o.length-1].replace(/\\$/,"")+":"+s[r]:o.push(s[r]);n=o[0];for(r=1;r<o.length;r++)l.push(o[r])}return"string"==typeof n&&"function"==typeof window.dhx4.template[n]?window.dhx4.template[n].apply(window.dhx4.template,l):t.length>0&&void 0!==e[t]?1==i?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):null!=(t=t.toString()).match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t:""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,i,s){var n=window.dhx4.template._parseFmt(e,i,s);return 0==n?t:window.dhx4.template._getFmtValue(t,n)},window.dhx4.template.lowercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,i){var s=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==s||4!=s.length)return!1;var n={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof i?i:".",s_bef:"string"==typeof s[1]?s[1]:"",s_aft:"string"==typeof s[3]?s[3]:""},l=s[2].split(".");null!=l[1]&&(n.d_len=l[1].length);var o=l[0].split(",");return o.length>1&&(n.i_len=o[o.length-1].length),n},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,!1!==fmt.i_len){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(!1!==fmt.d_len){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft,v0}return value}),void 0===window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,i){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var s=function(t){return 1==String(t).length?"0"+String(t):t},n=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,function(e){switch(e){case"%d":return s(t.getDate());case"%j":return t.getDate();case"%D":return i.dayShortName[t.getDay()];case"%l":return i.dayFullName[t.getDay()];case"%m":return s(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return i.monthShortName[t.getMonth()];case"%F":return i.monthFullName[t.getMonth()];case"%y":return s(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return s((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return s(t.getHours());case"%i":return s(t.getMinutes());case"%s":return s(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var n=t.getTimezoneOffset(),l=Math.abs(Math.floor(n/60)),o=Math.abs(n)-60*l;return(n>0?"-":"+")+s(l)+":"+s(o);default:return e}});return n||String(t)},window.dhx4.str2date=function(t,e,i){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]);var s=[],n=[];e=(e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&")).replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return n.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return n.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return n.push(t),"(\\d{1,2})";case"%Y":return n.push(t),"(\\d{4})";case"%a":return n.push(t),"([am|pm])";case"%A":return n.push(t),"([AM|PM])";case"%u":return n.push(t),"(\\d{1,6})";case"%P":return n.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var l=new RegExp(e,"i"),o=t.match(l);if(null==o||o.length-1!=n.length)return"Invalid Date";for(var r=1;r<o.length;r++)s.push(o[r]);var a={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},h={},d={};for(r=0;r<n.length;r++)if(void 0!==a[n[r]]){var c=a[n[r]];h[c]||(h[c]=[],d[c]=[]),h[c].push(s[r]),d[c].push(n[r])}s=[],n=[];for(r=1;r<=7;r++)if(null!=h[r])for(var _=0;_<h[r].length;_++)s.push(h[r][_]),n.push(d[r][_]);var u=new Date;u.setDate(1),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0);var f=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()==t)return i;return-1};for(r=0;r<s.length;r++)switch(n[r]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(s[r])||u[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[n[r]]](Number(s[r])+("%m"==n[r]||"%n"==n[r]?-1:0));break;case"%M":case"%F":var p=f(s[r].toLowerCase(),i[{"%M":"monthShortName","%F":"monthFullName"}[n[r]]]);p>=0&&u.setMonth(p);break;case"%y":if(!isNaN(s[r])){var m=Number(s[r]);u.setFullYear(m+(m>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(s[r]))(m=Number(s[r]))<=12&&m>=0&&u.setHours(m+(f("pm",s)>=0?12==m?0:12:12==m?-12:0));break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=s[r])}return u}),void 0===window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){(e=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)}return e},xmltop:function(t,e,i){if((void 0===e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(t){}return-1!==i&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var i,s=[],n=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=n.iterateNext();)s.push(i);return s}try{return e.selectNodes(t)||[]}catch(t){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,i){return this._call("PUT",t,e,!0,i)},del:function(t,e,i){return this._call("DELETE",t,e,!0,i)},post:function(t,e,i){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(i=e,e=""),this._call("POST",t,e,!0,i)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,i){2!=arguments.length||"function"!=typeof e&&(window[e],0)||(i=e,e=""),this._call("POST",t,e,!0,i,{url:t,postData:e})},_call:function(t,e,i,s,n,l,o){var r=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==s&&(r.onreadystatechange=function(){if(4==r.readyState||1==a&&3==r.readyState){if((200!=r.status||""==r.responseText)&&!dhx4.callEvent("onAjaxError",[r]))return;window.setTimeout(function(){"function"==typeof n&&n.apply(window,[{xmlDoc:r,filePath:e,async:s}]),null!=l&&(void 0!==l.postData?dhx4.ajax.postLong(l.url,l.postData,n):dhx4.ajax.getLong(l.url,n)),n=null,r=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),r.open(t,e,s),null!=o)for(var h in o)r.setRequestHeader(h,o[h]);else"POST"==t||"PUT"==t||"DELETE"==t?r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(i=null);return r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(i),{xmlDoc:r,filePath:e,async:s}}}),void 0===window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,i,s,n){if("clear"==n){for(var l in t._dhxdataload)t._dhxdataload[l]=null,delete t._dhxdataload[l];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:i,xmlRootTag:s,onBeforeXLS:null},t._loadData=function(t,e,i){2==arguments.length&&(i=e,e=null);var s=null;if(3==arguments.length&&(i=arguments[2]),"string"==typeof t){var n=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");if(new RegExp("^<"+this._dhxdataload.xmlRootTag).test(n.replace(/^<\?xml[^\?]*\?>\s*/,""))&&null!=(s=dhx4.ajax.parse(t))&&(s=this[this._dhxdataload.xmlToJson].apply(this,[s])),null!=s||null==n.match(/^\{.*\}$/)&&null==n.match(/^\[.*\]$/)||(s=dhx4.s2j(n)),null==s){this.callEvent("onXLS",[]);var l=[];if("function"==typeof this._dhxdataload.onBeforeXLS)if(null!=(n=this._dhxdataload.onBeforeXLS.apply(this,[t]))&&"object"==typeof n&&(null!=n.url&&(t=n.url),null!=n.params))for(var o in n.params)l.push(o+"="+encodeURIComponent(n.params[o]));var r=this,a=function(e){var s=null;null!=(s=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?r[r._dhxdataload.xmlToJson].apply(r,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText))&&r[r._dhxdataload.initObj].apply(r,[s,t]),r.callEvent("onXLE",[]),null!=i&&("function"==typeof i?i.apply(r,[]):"function"==typeof window[i]&&window[i].apply(r,[])),a=i=null,s=e=r=null};return l=l.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,l,a):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(l.length>0?(t.indexOf("?")>0?"&":"?")+l:""),a))}}else s="object"==typeof t.documentElement||void 0!==t.tagName&&void 0!==t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=s&&this[this._dhxdataload.initObj].apply(this,[s]),null!=i&&("function"==typeof i?i.apply(this,[]):"function"==typeof window[i]&&window[i].apply(this,[]),i=null)},null!=n){var o={struct:"loadStruct",data:"load"};for(var l in n)1==n[l]&&(t[o[l]]=function(){return this._loadData.apply(this,arguments)})}t=null}),void 0===window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){if("clear"==e)return t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null);t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var i=window.dhx4.newId();return this.dhxevs.data[t][i]=e,i},t.detachEvent=function(t){for(var e in this.dhxevs.data){var i=0;for(var s in this.dhxevs.data[e])s==t?(this.dhxevs.data[e][s]=null,delete this.dhxevs.data[e][s]):i++;0==i&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var i=!0;for(var s in this.dhxevs.data[t])i=this.dhxevs.data[t][s].apply(this,e)&&i;return i},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},t=null},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return!!t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)},isValidSSN:function(t){return!!t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)},isValidSIN:function(t){return!!t.toString().match(/^\d{9}$/)}},dhtmlxValidation=new dhtmlxValidation),void 0===window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var i in e)t[i]||(t[i]=e[i]);return t},extend_api:function(t,e,i){var s=window[t];s&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var i=s.apply(this,e._init?e._init(t):arguments);for(var n in dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(var n in t)e[n]?this[e[n]](t[n]):0===n.indexOf("on")&&this.attachEvent(n,t[n])}else i=s.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=s.prototype,i&&dhtmlx.extend(window[t].prototype,i))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var i=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var s=document.createElement("Div");s.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=s.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)n=t.srcElement;else var n=t.target;dragger.checkLanding(n,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,s=0;e;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var n=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*n.split("_")[0],s+=1*n.split("_")[1]}if(t)return i+"_"+s;this.fx=i,this.fy=s}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var i=dragger.lastLanding;dragger.lastLanding=null,i&&i.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,i,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),void 0===window.dhtmlxEvent)function dhtmlxEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}if(null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),void 0===dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){var t,e,i,s;function n(){if(e){var i=document.createEvent("HTMLEvents");i.initEvent("dblclick",!0,!0),e.dispatchEvent(i),t=e=null}}dhtmlxEvent(document.body,"touchstart",function(l){e=l.touches[0].target,i=l.touches[0].clientX,s=l.touches[0].clientY,t=window.setTimeout(n,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(n){t&&(Math.abs(n.touches[0].clientX-i)>50||Math.abs(n.touches[0].clientY-s)>50)&&(window.clearTimeout(t),t=e=!1)}),dhtmlxEvent(document.body,"touchend",function(i){t&&(window.clearTimeout(t),t=e=!1)}),dhtmlxEvent.initTouch=function(){}}),void 0===window.dhx4&&(window.dhx4={version:"4.2",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var i=document.createElement("DIV");i.className=t,null!=document.body.firstChild?document.body.insertBefore(i,document.body.firstChild):document.body.appendChild(i);var s=i[e||"offsetWidth"];return i.parentNode.removeChild(i),i=null,s},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(t){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,l=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=s.clientTop||i.clientTop||0,r=s.clientLeft||i.clientLeft||0,a=e.top+n-o,h=e.left+l-r;return{top:Math.round(a),left:Math.round(h)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&void 0===t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var i in t)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i]}else for(e=[],i=0;i<t.length;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,i){var s=(t="string"==typeof t?document.getElementById(t):t).value.length;if(e=Math.max(Math.min(e,s),0),i=Math.min(i,s),t.setSelectionRange)try{t.setSelectionRange(e,i)}catch(t){}else if(t.createTextRange){var n=t.createTextRange();n.moveStart("character",e),n.moveEnd("character",i-s);try{n.select()}catch(t){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=null!=t.childNodes[i].nodeValue?t.childNodes[i].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0,window.dhx4.isKHTML=navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0),void 0===window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,i){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],s=window.dhx4.trim(arguments[3]),n=null,l=[e[t]];if(s.length>0){s=s.split(":");for(var o=[],r=0;r<s.length;r++)r>0&&null!=o[o.length-1].match(/\\$/)?o[o.length-1]=o[o.length-1].replace(/\\$/,"")+":"+s[r]:o.push(s[r]);n=o[0];for(r=1;r<o.length;r++)l.push(o[r])}return"string"==typeof n&&"function"==typeof window.dhx4.template[n]?window.dhx4.template[n].apply(window.dhx4.template,l):t.length>0&&void 0!==e[t]?1==i?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):null!=(t=t.toString()).match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t:""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,i,s){var n=window.dhx4.template._parseFmt(e,i,s);return 0==n?t:window.dhx4.template._getFmtValue(t,n)},window.dhx4.template.lowercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return void 0!==t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,i){var s=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==s||4!=s.length)return!1;var n={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof i?i:".",s_bef:"string"==typeof s[1]?s[1]:"",s_aft:"string"==typeof s[3]?s[3]:""},l=s[2].split(".");null!=l[1]&&(n.d_len=l[1].length);var o=l[0].split(",");return o.length>1&&(n.i_len=o[o.length-1].length),n},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,!1!==fmt.i_len){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(!1!==fmt.d_len){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft,v0}return value}),void 0===window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,i){if(null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var s=function(t){return 1==String(t).length?"0"+String(t):t},n=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,function(e){switch(e){case"%d":return s(t.getDate());case"%j":return t.getDate();case"%D":return i.dayShortName[t.getDay()];case"%l":return i.dayFullName[t.getDay()];case"%m":return s(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return i.monthShortName[t.getMonth()];case"%F":return i.monthFullName[t.getMonth()];case"%y":return s(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return s((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return s(t.getHours());case"%i":return s(t.getMinutes());case"%s":return s(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var n=t.getTimezoneOffset(),l=Math.abs(Math.floor(n/60)),o=Math.abs(n)-60*l;return(n>0?"-":"+")+s(l)+":"+s(o);default:return e}});return n||String(t)},window.dhx4.str2date=function(t,e,i){null!=e&&"undefnied"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefnied"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]);var s=[],n=[];e=(e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&")).replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return n.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return n.push(t),"([a-zéûäа-яё]{1,})";case"%j":case"%n":case"%g":case"%G":return n.push(t),"(\\d{1,2})";case"%Y":return n.push(t),"(\\d{4})";case"%a":return n.push(t),"([am|pm])";case"%A":return n.push(t),"([AM|PM])";case"%u":return n.push(t),"(\\d{1,6})";case"%P":return n.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var l=new RegExp(e,"i"),o=t.match(l);if(null==o||o.length-1!=n.length)return"Invalid Date";for(var r=1;r<o.length;r++)s.push(o[r]);var a={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},h={},d={};for(r=0;r<n.length;r++)if(void 0!==a[n[r]]){var c=a[n[r]];h[c]||(h[c]=[],d[c]=[]),h[c].push(s[r]),d[c].push(n[r])}s=[],n=[];for(r=1;r<=7;r++)if(null!=h[r])for(var _=0;_<h[r].length;_++)s.push(h[r][_]),n.push(d[r][_]);var u=new Date;u.setDate(1),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0);var f=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()==t)return i;return-1};for(r=0;r<s.length;r++)switch(n[r]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(s[r])||u[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[n[r]]](Number(s[r])+("%m"==n[r]||"%n"==n[r]?-1:0));break;case"%M":case"%F":var p=f(s[r].toLowerCase(),i[{"%M":"monthShortName","%F":"monthFullName"}[n[r]]]);p>=0&&u.setMonth(p);break;case"%y":if(!isNaN(s[r])){var m=Number(s[r]);u.setFullYear(m+(m>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(s[r]))(m=Number(s[r]))<=12&&m>=0&&u.setHours(m+(f("pm",s)>=0?12==m?0:12:12==m?-12:0));break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=s[r])}return u}),void 0===window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else window.ActiveXObject!==window.undefined&&((e=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t));return e},xmltop:function(t,e,i){if((void 0===e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(t){}return-1!==i&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var i,s=[],n=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=n.iterateNext();)s.push(i);return s}try{return e.selectNodes(t)||[]}catch(t){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,i){return this._call("PUT",t,e,!0,i)},del:function(t,e,i){return this._call("DELETE",t,e,!0,i)},post:function(t,e,i){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(i=e,e=""),this._call("POST",t,e,!0,i)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,i){2!=arguments.length||"function"!=typeof e&&(window[e],0)||(i=e,e=""),this._call("POST",t,e,!0,i,{url:t,postData:e})},_call:function(t,e,i,s,n,l,o){var r=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==s&&(r.onreadystatechange=function(){if(4==r.readyState||1==a&&3==r.readyState){if((200!=r.status||""==r.responseText)&&!dhx4.callEvent("onAjaxError",[r]))return;window.setTimeout(function(){"function"==typeof n&&n.apply(window,[{xmlDoc:r,filePath:e,async:s}]),null!=l&&(void 0!==l.postData?dhx4.ajax.postLong(l.url,l.postData,n):dhx4.ajax.getLong(l.url,n)),n=null,r=null},1)}}),"GET"==t&&1!=this.cache&&(e+=(e.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),r.open(t,e,s),null!=o)for(var h in o)r.setRequestHeader(h,o[h]);else"POST"==t||"PUT"==t||"DELETE"==t?r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(i=null);return r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(i),{xmlDoc:r,filePath:e,async:s}}}),void 0===window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,i,s,n){if("clear"==n){for(var l in t._dhxdataload)t._dhxdataload[l]=null,delete t._dhxdataload[l];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:i,xmlRootTag:s,onBeforeXLS:null},t._loadData=function(t,e,i){2==arguments.length&&(i=e,e=null);var s=null;if(3==arguments.length&&(i=arguments[2]),"string"==typeof t){var n=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");if(new RegExp("^<"+this._dhxdataload.xmlRootTag).test(n.replace(/^<\?xml[^\?]*\?>\s*/,""))&&null!=(s=dhx4.ajax.parse(t))&&(s=this[this._dhxdataload.xmlToJson].apply(this,[s])),null!=s||null==n.match(/^\{.*\}$/)&&null==n.match(/^\[.*\]$/)||(s=dhx4.s2j(n)),null==s){this.callEvent("onXLS",[]);var l=[];if("function"==typeof this._dhxdataload.onBeforeXLS)if(null!=(n=this._dhxdataload.onBeforeXLS.apply(this,[t]))&&"object"==typeof n&&(null!=n.url&&(t=n.url),null!=n.params))for(var o in n.params)l.push(o+"="+encodeURIComponent(n.params[o]));var r=this,a=function(e){var s=null;null!=(s=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?r[r._dhxdataload.xmlToJson].apply(r,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText))&&r[r._dhxdataload.initObj].apply(r,[s,t]),r.callEvent("onXLE",[]),null!=i&&("function"==typeof i?i.apply(r,[]):"function"==typeof window[i]&&window[i].apply(r,[])),a=i=null,s=e=r=null};return l=l.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,l,a):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(l.length>0?(t.indexOf("?")>0?"&":"?")+l:""),a))}}else s="object"==typeof t.documentElement||void 0!==t.tagName&&void 0!==t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=s&&this[this._dhxdataload.initObj].apply(this,[s]),null!=i&&("function"==typeof i?i.apply(this,[]):"function"==typeof window[i]&&window[i].apply(this,[]),i=null)},null!=n){var o={struct:"loadStruct",data:"load"};for(var l in n)1==n[l]&&(t[o[l]]=function(){return this._loadData.apply(this,arguments)})}t=null}),void 0===window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){if("clear"==e)return t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null);t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var i=window.dhx4.newId();return this.dhxevs.data[t][i]=e,i},t.detachEvent=function(t){for(var e in this.dhxevs.data){var i=0;for(var s in this.dhxevs.data[e])s==t?(this.dhxevs.data[e][s]=null,delete this.dhxevs.data[e][s]):i++;0==i&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var i=!0;for(var s in this.dhxevs.data[t])i=this.dhxevs.data[t][s].apply(this,e)&&i;return i},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},t=null},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return!!t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)},isValidSSN:function(t){return!!t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)},isValidSIN:function(t){return!!t.toString().match(/^\d{9}$/)}},dhtmlxValidation=new dhtmlxValidation),void 0===window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var i in e)t[i]||(t[i]=e[i]);return t},extend_api:function(t,e,i){var s=window[t];s&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var i=s.apply(this,e._init?e._init(t):arguments);for(var n in dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(var n in t)e[n]?this[e[n]](t[n]):0===n.indexOf("on")&&this.attachEvent(n,t[n])}else i=s.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=s.prototype,i&&dhtmlx.extend(window[t].prototype,i))},url:function(t){return-1!=t.indexOf("?")?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var i=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var s=document.createElement("Div");s.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=s.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)n=t.srcElement;else var n=t.target;dragger.checkLanding(n,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,s=0;e;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var n=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*n.split("_")[0],s+=1*n.split("_")[1]}if(t)return i+"_"+s;this.fx=i,this.fy=s}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var i=dragger.lastLanding;dragger.lastLanding=null,i&&i.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,i,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),void 0===window.dhtmlxEvent)function dhtmlxEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}function dataProcessor(t){return this.serverProcessor=t,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhx4._eventable(this),this}function dhtmlXCalendarObject(t,e){this.i={};var i=null;if("string"==typeof t)var s=document.getElementById(t);else s=t;s&&"object"==typeof s&&s.tagName&&"input"!=String(s.tagName).toLowerCase()&&(i=s),s=null,"object"==typeof t&&t.length||(t=[t]);for(var n=0;n<t.length;n++)"string"==typeof t[n]&&(t[n]=document.getElementById(t[n])||null),null!=t[n]&&t[n].tagName&&"input"==String(t[n].tagName).toLowerCase()?this.i[window.dhx4.newId()]={input:t[n]}:t[n]instanceof Array||!(t[n]instanceof Object)||null==t[n].input&&null==t[n].button||(null!=t[n].input&&"string"==typeof t[n].input&&(t[n].input=document.getElementById(t[n].input)),null!=t[n].button&&"string"==typeof t[n].button&&(t[n].button=document.getElementById(t[n].button)),this.i[window.dhx4.newId()]=t[n]),t[n]=null;this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhtmlxcalendar")||"dhx_skyblue",zi:window.dhx4.newId(),touch:!window.dhx4.isIE,ws_first:!0},this.setSkin=function(t,e){(this.conf.skin!=t||e)&&(this.conf.skin=t,this.base.className="dhtmlxcalendar_"+this.conf.skin,this._ifrSize())},this.base=document.createElement("DIV"),this.base.style.display="none",this.base.appendChild(document.createElement("DIV")),null!=i?(this._hasParent=!0,i.appendChild(this.base),i=null):document.body.appendChild(this.base),this.setParent=function(t){this._hasParent&&("object"==typeof t?t.appendChild(this.base):"string"==typeof t&&document.getElementById(t).appendChild(this.base))},this.setSkin(this.conf.skin,!0),this.base.onclick=function(t){(t=t||event).preventDefault&&t.preventDefault(),t.cancelBubble=!0},this.base.onmousedown=function(){return!1},this.conf.touch&&(this.base.ontouchstart=this.base.onclick),this.loadUserLanguage=function(t){if(this.langData[t]&&(this.lang=t,this.setWeekStartDay(this.langData[this.lang].weekstart),this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d"),this.msCont))for(var e=0,i=0;i<this.msCont.childNodes.length;i++)for(var s=0;s<this.msCont.childNodes[i].childNodes.length;s++)this.msCont.childNodes[i].childNodes[s].innerHTML=this.langData[this.lang].monthesSNames[e++]},this.contMonth=document.createElement("DIV"),this.contMonth.className="dhtmlxcalendar_month_cont",this.contMonth.onselectstart=function(t){return(t=t||event).cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.firstChild.appendChild(this.contMonth),(o=document.createElement("UL")).className="dhtmlxcalendar_line",this.contMonth.appendChild(o),(a=document.createElement("LI")).className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr",a.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>",o.appendChild(a);var l=this;a.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(e.className&&0===e.className.indexOf("dhtmlxcalendar_month_arrow")){l._hideSelector();var i=e.parentNode.firstChild==e?-1:1,s=new Date(l._activeMonth);return l._drawMonth(new Date(l._activeMonth.getFullYear(),l._activeMonth.getMonth()+i,1,0,0,0,0)),void l._evOnArrowClick([s,new Date(l._activeMonth)])}return e.className&&"dhtmlxcalendar_month_label_month"==e.className?(t.cancelBubble=!0,void l._showSelector("month",Math.round(e.offsetLeft+e.offsetWidth/2),e.offsetTop+e.offsetHeight+2,"selector_month",!0)):e.className&&"dhtmlxcalendar_month_label_year"==e.className?(t.cancelBubble=!0,void l._showSelector("year",Math.round(e.offsetLeft+e.offsetWidth/2),e.offsetTop+e.offsetHeight+2,"selector_year",!0)):void l._hideSelector()},1==this.conf.touch&&(a.ontouchstart=a.onclick),this.contDays=document.createElement("DIV"),this.contDays.className="dhtmlxcalendar_days_cont",this.base.firstChild.appendChild(this.contDays),this.setWeekStartDay=function(t){0==t&&(t=7),this._wStart=Math.min(Math.max(isNaN(t)?1:t,1),7),this._drawDaysOfWeek()},this._drawDaysOfWeek=function(){if(0==this.contDays.childNodes.length)(t=document.createElement("UL")).className="dhtmlxcalendar_line",this.contDays.appendChild(t);else var t=this.contDays.firstChild;var e=this._wStart,i=this.langData[this.lang].daysSNames;i.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var s=0;s<8;s++){if(null==t.childNodes[s]){var n=document.createElement("LI");t.appendChild(n)}else n=t.childNodes[s];0==s?(n.className="dhtmlxcalendar_cell_wn",n.innerHTML="<div class='dhtmlxcalendar_label'>"+(this.langData[this.lang].weekname||"w")+"</div>"):(n.className="dhtmlxcalendar_cell"+(e>=6?" dhtmlxcalendar_day_weekday_cell":"")+(1==s?"_first":""),n.innerHTML=i[e],++e>7&&(e=1))}null!=this._activeMonth&&this._drawMonth(this._activeMonth)},this._wStart=this.langData[this.lang].weekstart,this.setWeekStartDay(this._wStart),this.contDates=document.createElement("DIV"),this.contDates.className="dhtmlxcalendar_dates_cont",this.base.firstChild.appendChild(this.contDates),this.contDates.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(null!=e.parentNode&&null!=e.parentNode._date&&(e=e.parentNode),null!=e._date&&!e._css_dis){var i=l._activeDate.getHours(),s=l._activeDate.getMinutes(),n=e._date;if(l.checkEvent("onBeforeChange")&&!l.callEvent("onBeforeChange",[new Date(e._date.getFullYear(),e._date.getMonth(),e._date.getDate(),i,s)]))return;null!=l._activeDateCell&&(l._activeDateCell._css_date=!1,l._updateCellStyle(l._activeDateCell._q,l._activeDateCell._w));var o=l._activeDate.getFullYear()+"_"+l._activeDate.getMonth()!=n.getFullYear()+"_"+n.getMonth();l._nullDate=!1,l._activeDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),i,s),l._activeDateCell=e,l._activeDateCell._css_date=!0,l._activeDateCell._css_hover=!1,l._updateCellStyle(l._activeDateCell._q,l._activeDateCell._w),o&&l._drawMonth(l._activeDate),l._activeInp&&l.i[l._activeInp]&&null!=l.i[l._activeInp].input&&(l.i[l._activeInp].input.value=l._dateToStr(new Date(l._activeDate.getTime()))),l._hasParent||("touchstart"==t.type?window.setTimeout(function(){l._hide()},400):l._hide()),l._evOnClick([new Date(l._activeDate.getTime())])}},1==this.conf.touch&&(this.contDates.ontouchstart=this.contDates.onclick),this.contDates.onmouseover=function(t){var e=(t=t||event).target||t.srcElement;if(null!=e.parentNode&&null!=e.parentNode._date&&(e=e.parentNode),null!=e._date){if(l._lastHover==e||e._css_hover)return;e._css_hover=!0,l._updateCellStyle(e._q,e._w),l._lastHover=e,l._evOnMouseOver([new Date(e._date.getFullYear(),e._date.getMonth(),e._date.getDate(),0,0,0,0),t]),e=null}},this.contDates.onmouseout=function(t){l._clearDayHover(t||event)},this._lastHover=null,this._clearDayHover=function(t){this._lastHover&&(this._lastHover._css_hover=!1,this._updateCellStyle(this._lastHover._q,this._lastHover._w),l._evOnMouseOut([new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0),t]),this._lastHover=null)};for(n=0;n<6;n++){var o;(o=document.createElement("UL")).className="dhtmlxcalendar_line",this.contDates.appendChild(o);for(var r=0;r<=7;r++){(a=document.createElement("LI")).className=0==r?"dhtmlxcalendar_cell_wn":"dhtmlxcalendar_cell",o.appendChild(a)}}this.contTime=document.createElement("DIV"),this.contTime.className="dhtmlxcalendar_time_cont",this.base.firstChild.appendChild(this.contTime),this.showTime=function(){this.contTime.style.display="",this._ifrSize()},this.hideTime=function(){this.contTime.style.display="none",this._ifrSize()},(o=document.createElement("UL")).className="dhtmlxcalendar_line",this.contTime.appendChild(o);var a=document.createElement("LI");for(var h in a.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr",a.innerHTML="<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'> : </span><span class='dhtmlxcalendar_label_minutes'></span>",o.appendChild(a),a.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(null!=e.tagName&&"span"==e.tagName.toLowerCase()&&1==e._par&&null!=e.parentNode&&(e=e.parentNode),e.className&&"dhtmlxcalendar_label_hours"==e.className){t.cancelBubble=!0;var i=l.contMonth.offsetHeight+l.contDays.offsetHeight+l.contDates.offsetHeight+e.offsetTop;l._showSelector("hours",Math.round(e.offsetLeft+e.offsetWidth/2),i-2,"selector_hours",!0)}else if(e.className&&"dhtmlxcalendar_label_minutes"==e.className){if(t.cancelBubble=!0,1==l._minutesInterval){var s=l.getFormatedDate("%i");e.innerHTML="<span class='dhtmlxcalendar_selected_date'>"+s.charAt(0)+"</span>"+s.charAt(1),e.firstChild._par=!0,l._selectorMode=1}i=l.contMonth.offsetHeight+l.contDays.offsetHeight+l.contDates.offsetHeight+e.offsetTop;l._showSelector("minutes",Math.round(e.offsetLeft+e.offsetWidth/2),i-2,"selector_minutes",!0)}else l._hideSelector()},1==this.conf.touch&&(a.ontouchstart=a.onclick),this._activeMonth=null,this._activeDate=new Date,this._activeDateCell=null,this.setDate=function(t){window.dhx4.temp_calendar={tz:null},this._nullDate=void 0===t||""===t||!t,t instanceof Date||("Invalid Date"==(t=this._strToDate(String(t||"")))?t=new Date:this.conf.tz=window.dhx4.temp_calendar.tz,window.dhx4.temp_calendar=null),null==this.conf.tz&&(this.conf.tz=window.dhx4.date2str(t,"%P"));var e=t.getTime();this._isOutOfRange(e)||(this._activeDate=new Date(e),this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleHours(),this._updateVisibleMinutes())},this.getDate=function(t){if(this._nullDate)return null;var e=new Date(this._activeDate.getTime());if(t){window.dhx4.temp_calendar={tz:this.conf.tz};var i=this._dateToStr(e);return window.dhx4.temp_calendar=null,i}return e},this._drawMonth=function(t){if(t instanceof Date){isNaN(t.getFullYear())&&(t=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0)),this._activeMonth=new Date(t.getFullYear(),t.getMonth(),1,0,0,0,0),this._activeDateCell=null;var e=new Date(this._activeMonth.getTime()),i=e.getDay()-this._wStart;i<0&&(i+=7),e.setDate(e.getDate()-i);for(var s=t.getMonth(),n=new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime(),l=0,o=0;o<6;o++)for(var r=this._wStart,a=0;a<=7;a++)if(0==a){var h=this.getWeekNumber(new Date(e.getFullYear(),e.getMonth(),e.getDate()+l,0,0,0,0));if(h>=52&&1==this.conf.ws_first&&0==this._activeMonth.getMonth()){var d=this.getWeekNumber(new Date(e.getFullYear(),e.getMonth(),e.getDate()+l+7,0,0,0,0));d<h&&d>1&&(h=1)}this.contDates.childNodes[o].childNodes[a].innerHTML="<div class='dhtmlxcalendar_label'>"+h+"</div>"}else{var c=new Date(e.getFullYear(),e.getMonth(),e.getDate()+l,0,0,0,0);if(0!=c.getHours()){var _=c.getHours()>12?24-c.getHours():c.getHours();c.setTime(c.getTime()+36e5*_)}c.getDay();var u=c.getTime(),f="dhtmlxcalendar_label";null!=this._tipData[u]?(this._tipData[u].usePopup&&"function"==typeof window.dhtmlXPopup?(this.contDates.childNodes[o].childNodes[a].removeAttribute("title"),this._initTooltipPopup()):this.contDates.childNodes[o].childNodes[a].setAttribute("title",this._tipData[u].text),this._tipData[u].showIcon&&(f+=" dhtmlxcalendar_label_title")):this.contDates.childNodes[o].childNodes[a].removeAttribute("title"),this.contDates.childNodes[o].childNodes[a].innerHTML="<div class='"+f+"'>"+c.getDate()+"</div>",this.contDates.childNodes[o].childNodes[a]._date=new Date(u),this.contDates.childNodes[o].childNodes[a]._q=o,this.contDates.childNodes[o].childNodes[a]._w=a,this.contDates.childNodes[o].childNodes[a]._css_month=c.getMonth()==s,this.contDates.childNodes[o].childNodes[a]._css_date=!this._nullDate&&u==n,this.contDates.childNodes[o].childNodes[a]._css_weekend=r>=6,this.contDates.childNodes[o].childNodes[a]._css_dis=this._isOutOfRange(u),this.contDates.childNodes[o].childNodes[a]._css_holiday=1==this._holidays[u],this._updateCellStyle(o,a),u==n&&(this._activeDateCell=this.contDates.childNodes[o].childNodes[a]),++r>7&&(r=1),l++}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this._buildMonthHdr(t)}},this._updateCellStyle=function(t,e){var i=this.contDates.childNodes[t].childNodes[e],s="dhtmlxcalendar_cell dhtmlxcalendar_cell";s+=i._css_month?"_month":"",s+=i._css_date?"_date":"",s+=i._css_weekend?"_weekend":"",s+=i._css_holiday?"_holiday":"",s+=i._css_dis?"_dis":"",s+=i._css_hover&&!i._css_dis?"_hover":"",i.className=s,i=null},this._minutesInterval=5,this._initSelector=function(t,e){if(this._selCover||(this._selCover=document.createElement("DIV"),this._selCover.className="dhtmlxcalendar_selector_cover",this.base.firstChild.appendChild(this._selCover)),this._sel||(this._sel=document.createElement("DIV"),this._sel.className="dhtmlxcalendar_selector_obj",this.base.firstChild.appendChild(this._sel),this._sel.appendChild(document.createElement("TABLE")),this._sel.firstChild.className="dhtmlxcalendar_selector_table",this._sel.firstChild.cellSpacing=0,this._sel.firstChild.cellPadding=0,this._sel.firstChild.border=0,this._sel.firstChild.appendChild(document.createElement("TBODY")),this._sel.firstChild.firstChild.appendChild(document.createElement("TR")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left",this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle",this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right",this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"},this._sel.onmouseover=function(t){var e=(t=t||event).target||t.srcElement;!0===e._cell&&(l._selHover!=e&&l._clearSelHover(),null!=String(e.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)&&(e.className+=" dhtmlxcalendar_selector_cell_hover",l._selHover=e))},this._sel.onmouseout=function(){l._clearSelHover()},this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,l._scrollYears(-1)},this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,l._scrollYears(1)},1==this.conf.touch&&(this._sel.firstChild.firstChild.firstChild.childNodes[0].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick,this._sel.firstChild.firstChild.firstChild.childNodes[2].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick),this._sel._ta={},this._selHover=null,this._sel.appendChild(document.createElement("DIV")),this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"),1!=this._sel._ta[t]){if("month"==t){this._msCells={},this.msCont=document.createElement("DIV"),this.msCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);for(var i=0,s=0;s<4;s++){(h=document.createElement("UL")).className="dhtmlxcalendar_selector_line",this.msCont.appendChild(h);for(var n=0;n<3;n++){(d=document.createElement("LI")).innerHTML=this.langData[this.lang].monthesSNames[i],d.className="dhtmlxcalendar_selector_cell",h.appendChild(d),d._month=i,d._cell=!0,this._msCells[i++]=d}}this.msCont.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._month&&(l._hideSelector(),l._updateActiveMonth(),l._drawMonth(new Date(l._activeMonth.getFullYear(),e._month,1,0,0,0,0)),l._doOnSelectorChange())},1==this.conf.touch&&(this.msCont.ontouchstart=this.msCont.onclick)}if("year"==t){this._ysCells={},this.ysCont=document.createElement("DIV"),this.ysCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(s=0;s<4;s++){(h=document.createElement("UL")).className="dhtmlxcalendar_selector_line",this.ysCont.appendChild(h);for(n=0;n<3;n++){(d=document.createElement("LI")).className="dhtmlxcalendar_selector_cell",d._cell=!0,h.appendChild(d)}}this.ysCont.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._year&&(l._hideSelector(),l._drawMonth(new Date(e._year,l._activeMonth.getMonth(),1,0,0,0,0)),l._doOnSelectorChange())},1==this.conf.touch&&(this.ysCont.ontouchstart=this.ysCont.onclick)}if("hours"==t){this._hsCells={},this.hsCont=document.createElement("DIV"),this.hsCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);for(i=0,s=0;s<4;s++){(h=document.createElement("UL")).className="dhtmlxcalendar_selector_line",this.hsCont.appendChild(h);for(n=0;n<6;n++){(d=document.createElement("LI")).innerHTML=this._fixLength(i,2),d.className="dhtmlxcalendar_selector_cell",h.appendChild(d),d._hours=i,d._cell=!0,this._hsCells[i++]=d}}this.hsCont.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._hours&&(l._hideSelector(),l._activeDate.setHours(e._hours),l._updateActiveHours(),l._updateVisibleHours(),l._doOnSelectorChange(),l.callEvent("onTimeChange",[new Date(l._activeDate.getTime())]))},1==this.conf.touch&&(this.hsCont.ontouchstart=this.hsCont.onclick)}if("minutes"==t){var o=4,r=3,a=2;1==this._minutesInterval&&(1==this._selectorMode?(o=2,r=3,a=1):(o=2,r=5,a=1,e+="5")),10==this._minutesInterval&&(o=2),15==this._minutesInterval&&(o=1,r=4,e+="4"),this._rsCells={},this.rsCont=document.createElement("DIV"),this.rsCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);for(i=0,s=0;s<o;s++){var h;(h=document.createElement("UL")).className="dhtmlxcalendar_selector_line",this.rsCont.appendChild(h);for(n=0;n<r;n++){var d;(d=document.createElement("LI")).innerHTML=a>1?this._fixLength(i,a):i,d.className="dhtmlxcalendar_selector_cell",h.appendChild(d),d._minutes=i,d._cell=!0,this._rsCells[i]=d,i+=this._minutesInterval}}this.rsCont.onclick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;if(null!=e._minutes){if(1==l._minutesInterval){var i=l.getFormatedDate("%i");if(i=1==l._selectorMode?e._minutes.toString()+i.charAt(1):i.charAt(0)+e._minutes.toString(),l._activeDate.setMinutes(Number(i)),l.callEvent("onTimeChange",[new Date(l._activeDate.getTime())]),l._hideSelector(),1==l._selectorMode)return l._updateVisibleMinutes(!0),l._selectorMode=2,l._showSelector("minutes",l._sel._x,l._sel._y,"selector_minutes",!0),void l._updateActiveMinutes();l._selectorMode=1}else l._hideSelector(),l._activeDate.setMinutes(e._minutes),l._updateActiveMinutes(),l.callEvent("onTimeChange",[new Date(l._activeDate.getTime())]);l._updateVisibleMinutes(),l._doOnSelectorChange()}},1==this.conf.touch&&(this.rsCont.ontouchstart=this.rsCont.onclick)}this._sel._ta[t]=!0}},this._showSelector=function(t,e,i,s,n){if(!0===n&&null!=this._sel&&this._isSelectorVisible()&&t==this._sel._t)this._hideSelector();else{"dhx_terrace"==this.conf.skin&&(e+=12),this._sel&&this._sel._ta[t]||this._initSelector(t,s),t!=this._sel._t&&"minutes"==this._sel._t&&1==this._minutesInterval&&(this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i")),this._sel._x=e,this._sel._y=i,this._sel.style.visibility="hidden",this._sel.style.display="",this._selCover.style.width=this.base.offsetWidth-2+"px",this._selCover.style.top=this.contMonth.offsetHeight+"px",this._selCover.style.height=this.contDates.offsetHeight+this.contDays.offsetHeight-1+"px",this._selCover.style.display="",this._sel._t=t,this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+s,this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display=this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display="year"==t?"":"none";var l=Math.max(0,e-Math.round(this._sel.offsetWidth/2));l+this._sel.offsetWidth>this._sel.parentNode.offsetWidth&&(l=this._sel.parentNode.offsetWidth-this._sel.offsetWidth),this._sel.style.left=l+"px",this._sel.style.top="hours"==t||"minutes"==t?i-this._sel.offsetHeight+"px":i+"px",this._sel.childNodes[1].style.width=this._sel.childNodes[0].offsetWidth+"px",this._sel.style.visibility="visible",this._doOnSelectorShow(t)}},this._doOnSelectorShow=function(t){"month"==t&&this._updateActiveMonth(),"year"==t&&this._updateYearsList(this._activeMonth),"hours"==t&&this._updateActiveHours(),"minutes"==t&&this._updateActiveMinutes()},this._hideSelector=function(t){this._sel&&(this._sel.style.display="none",this._sel.style.visible="hidden",this._selCover.style.display="none","minutes"==this._sel._t&&1==this._minutesInterval&&(this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i"),this._unloadSelector("minutes")))},this._isSelectorVisible=function(){return!!this._sel&&"none"!=this._sel.style.display},this._doOnSelectorChange=function(t){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),!0===t])},this._clearSelHover=function(){this._selHover&&(this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,"")),this._selHover=null)},this._unloadSelector=function(t){if(this._sel&&this._sel._ta[t]){if("month"==t){for(var e in this.msCont.onclick=this.msCont.ontouchstart=null,this._msActive=null,this._msCells)this._msCells[e]._cell=null,this._msCells[e]._month=null,this._msCells[e].parentNode.removeChild(this._msCells[e]),this._msCells[e]=null;for(this._msCells=null;this.msCont.childNodes.length>0;)this.msCont.removeChild(this.msCont.lastChild);this.msCont.parentNode.removeChild(this.msCont),this.msCont=null}if("year"==t){for(var e in this.ysCont.onclick=this.ysCont.ontouchstart=null,this._ysCells)this._ysCells[e]._cell=null,this._ysCells[e]._year=null,this._ysCells[e].parentNode.removeChild(this._ysCells[e]),this._ysCells[e]=null;for(this._ysCells=null;this.ysCont.childNodes.length>0;)this.ysCont.removeChild(this.ysCont.lastChild);this.ysCont.parentNode.removeChild(this.ysCont),this.ysCont=null}if("hours"==t){for(var e in this.hsCont.onclick=this.hsCont.ontouchstart=null,this._hsActive=null,this._hsCells)this._hsCells[e]._cell=null,this._hsCells[e]._hours=null,this._hsCells[e].parentNode.removeChild(this._hsCells[e]),this._hsCells[e]=null;for(this._hsCells=null;this.hsCont.childNodes.length>0;)this.hsCont.removeChild(this.hsCont.lastChild);this.hsCont.parentNode.removeChild(this.hsCont),this.hsCont=null}if("minutes"==t){for(var e in this.rsCont.onclick=this.rsCont.ontouchstart=null,this._rsActive=null,this._rsCells)this._rsCells[e]._cell=null,this._rsCells[e]._minutes=null,this._rsCells[e].parentNode.removeChild(this._rsCells[e]),this._rsCells[e]=null;for(this._rsCells=null;this.rsCont.childNodes.length>0;)this.rsCont.removeChild(this.rsCont.lastChild);this.rsCont.parentNode.removeChild(this.rsCont),this.rsCont=null}this._sel._ta[t]=null}},this.setMinutesInterval=function(t){1!=t&&5!=t&&10!=t&&15!=t||(this._minutesInterval=t,this._unloadSelector("minutes"))},this._updateActiveMonth=function(){void 0!==this._msActive&&void 0!==this._msCells[this._msActive]&&(this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell"),this._msActive=this._activeMonth.getMonth(),this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"},this._updateActiveYear=function(){var t=this._activeMonth.getFullYear();this._ysCells[t]&&(this._ysCells[t].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active")},this._updateYearsList=function(t){for(var e in this._ysCells)this._ysCells[e]=null,delete this._ysCells[e];for(var i=12*Math.floor(t.getFullYear()/12),s=0;s<4;s++)for(var n=0;n<3;n++)this.ysCont.childNodes[s].childNodes[n].innerHTML=i,this.ysCont.childNodes[s].childNodes[n]._year=i,this.ysCont.childNodes[s].childNodes[n].className="dhtmlxcalendar_selector_cell",this._ysCells[i++]=this.ysCont.childNodes[s].childNodes[n];this._updateActiveYear()},this._scrollYears=function(t){var e=(t<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+t,i=new Date(e,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(i)},this._updateActiveHours=function(){void 0!==this._hsActive&&void 0!==this._hsCells[this._hsActive]&&(this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell"),this._hsActive=this._activeDate.getHours(),this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"},this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)},this._updateActiveMinutes=function(){null!=this._rsActive&&void 0!==this._rsActive&&void 0!==this._rsCells[this._rsActive]&&(this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell"),1==this._minutesInterval?this._rsActive=this.getFormatedDate("%i").toString().charAt(1==this._selectorMode?0:1):this._rsActive=this._activeDate.getMinutes(),void 0!==this._rsCells[this._rsActive]&&(this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active")},this._updateVisibleMinutes=function(t){var e=this._fixLength(this._activeDate.getMinutes(),2).toString();1==t&&(e=e.charAt(0)+"<span class='dhtmlxcalendar_selected_date'>"+e.charAt(1)+"</span>"),this.contTime.firstChild.firstChild.childNodes[3].innerHTML=e,1==t&&(this.contTime.firstChild.firstChild.childNodes[3].lastChild._par=!0)},this._fixLength=function(t,e){for(;String(t).length<e;)t="0"+String(t);return t},this._dateFormat="",this._dateFormatRE=null,this.setDateFormat=function(t){var e={};if(null!=this._strToDate)for(var i in this.i)if(null!=this.i[i].input&&this.i[i].input.value.length>0){var s=this._strToDate(this.i[i].input.value,this._dateFormat||this.langData[this.lang].dateformat||"%Y-%m-%d");s instanceof Date&&(e[i]=s)}this._dateFormat=t;var n=String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(t){switch(t.replace(/%/,"")){case"n":case"h":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+l.langData[l.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+l.langData[l.lang].monthesFNames.join("|").toLowerCase()+"){1,}";case"D":return"[a-z]{2}";case"a":case"A":return"AM|PM";case"u":return"\\d{1,6}";case"P":return"[\\+\\-]\\d{1,2}\\:\\d{1,2}"}return t});for(var i in this._dateFormatRE=new RegExp(n,"i"),e)this.i[i].input.value=this._dateToStr(e[i]);e=null},this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d"),this._updateDateStr=function(t){if(this._dateFormatRE&&t.match(this._dateFormatRE)&&t!=this.getFormatedDate()){var e=this._strToDate(t);e instanceof Date&&(!this.checkEvent("onBeforeChange")||this.callEvent("onBeforeChange",[new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())])?(this._nullDate=!1,this._activeDate=e,this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleMinutes(),this._updateVisibleHours(),this._sel&&this._isSelectorVisible()&&this._doOnSelectorShow(this._sel._t),this._doOnSelectorChange(!0)):null!=this.i&&null!=this._activeInp&&null!=this.i[this._activeInp]&&null!=this.i[this._activeInp].input&&(this.i[this._activeInp].input.value=this.getFormatedDate()))}},this.showMonth=function(t){"string"==typeof t&&(t=this._strToDate(t)),t instanceof Date&&this._drawMonth(t)},this.setFormatedDate=function(t,e,i,s){var n=this._strToDate(e,t);if(s)return n;this.setDate(n)},this.getFormatedDate=function(t,e){if(!(e&&e instanceof Date)){if(this._nullDate)return"";e=new Date(this._activeDate)}return this._dateToStr(e,t)},this.getWeekNumber=function(t){if("string"==typeof t&&(t=this._strToDate(t)),!(t instanceof Date))return"Invalid Date";void 0===this._ftDay&&(this._ftDay=4);var e=this._wStart,i=4,s=new Date(t.getFullYear(),0,1,0,0,0,0).getDay();0==s&&(s=7),i<e&&(i+=7,s+=7);var n=0;s>=e&&s<=i||(n=1);var l=s-e,o=new Date(t.getFullYear(),0,1-l+7*n,0,0,0,0),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),a=Math.ceil((r.getTime()-o.getTime())/6048e5);if(0==a){var h=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),d=h.getDay()-this._wStart;d<0&&(d+=7),h.setDate(h.getDate()-d),a=this.getWeekNumber(h)}return a},this.showWeekNumbers=function(){this.base.firstChild.className="dhtmlxcalendar_wn"},this.hideWeekNumbers=function(){this.base.firstChild.className=""},this.show=function(t){if(t||!this._hasParent)if("object"!=typeof t||void 0===t._dhtmlxcalendar_uid||this.i[t._dhtmlxcalendar_uid]!=t){if(void 0===t)for(var e in this.i)t||(t=e);t&&this._show(t)}else this._show(t._dhtmlxcalendar_uid);else this._show()},this.hide=function(){this._isVisible()&&this._hide()},this.isVisible=function(){return this._isVisible()},this._activeInp=null,this.pos="bottom",this.setPosition=function(t,e){this._px=null,this._py=null,"right"==t||"bottom"==t?this.pos=t:(this.pos="int",void 0===t||isNaN(t)||(this.base.style.left=t+"px",this._px=t),void 0===e||isNaN(e)||(this.base.style.top=e+"px",this._py=e),this._ifrSize())},this._show=function(t,e){if(!0===e&&this._activeInp==t&&this._isVisible())this._hide();else{if(this.base.style.visibility="hidden",this.base.style.display="",t){-1==this.base.className.indexOf("dhtmlxcalendar_in_input")&&(this.base.className+=" dhtmlxcalendar_in_input");var i=this.i[t].input||this.i[t].button,s=-1!=navigator.appVersion.indexOf("MSIE"),n=Math.max((s?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop)+(s?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight);if("right"==this.pos)this.base.style.left=this._getLeft(i)+i.offsetWidth+"px",this.base.style.top=Math.min(this._getTop(i),n-this.base.offsetHeight)+"px";else if("bottom"==this.pos){var l=this._getTop(i)+i.offsetHeight+1;l+this.base.offsetHeight>n&&(l=this._getTop(i)-this.base.offsetHeight),this.base.style.left=this._getLeft(i)+"px",this.base.style.top=l+"px"}else this.base.style.left=(this._px||0)+"px",this.base.style.top=(this._py||0)+"px";this._activeInp=t,i=null}else this._px&&this._py?(this.base.style.left=this._px+"px",this.base.style.top=this._py+"px"):(this.base.style.left="0px",this.base.style.top="0px");this._hideSelector(),this.base.style.visibility="visible",this.base.style.zIndex=window.dhx4.zim.reserve(this.conf.zi),this._ifrSize(),this._ifr&&(this._ifr.style.display=""),this.callEvent("onShow",[])}},this._hide=function(){this._hideSelector(),this.base.style.display="none",window.dhx4.zim.clear(this.conf.zi),this.base.className.indexOf("dhtmlxcalendar_in_input")>=0&&(this.base.className=this.base.className.replace(/\s{0,}dhtmlxcalendar_in_input/gi,"")),this._activeInp=null,this._ifr&&(this._ifr.style.display="none"),this.callEvent("onHide",[])},this._isVisible=function(){return"none"!=this.base.style.display},this._getLeft=function(t){return this._posGetOffset(t).left},this._getTop=function(t){return this._posGetOffset(t).top},this._posGetOffsetSum=function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},this._posGetOffsetRect=function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,l=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=s.clientTop||i.clientTop||0,r=s.clientLeft||i.clientLeft||0,a=e.top+n-o,h=e.left+l-r;return{top:Math.round(a),left:Math.round(h)}},this._posGetOffset=function(t){return this[t.getBoundingClientRect?"_posGetOffsetRect":"_posGetOffsetSum"](t)},this._rangeActive=!1,this._rangeFrom=null,this._rangeTo=null,this._rangeSet={},this.setInsensitiveDays=function(t){for(var e=this._extractDates(t),i=0;i<e.length;i++)this._rangeSet[new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime()]=!0;this._drawMonth(this._activeMonth)},this.clearInsensitiveDays=function(){this._clearRangeSet(),this._drawMonth(this._activeMonth)},this._holidays={},this.setHolidays=function(t){if(null==t)this._clearHolidays();else if(null!=t)for(var e=this._extractDates(t),i=0;i<e.length;i++)this._holidays[new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime()]=!0;this._drawMonth(this._activeMonth)},this._extractDates=function(t){("string"==typeof t||t instanceof Date)&&(t=[t]);for(var e=[],i=0;i<t.length;i++)if("string"==typeof t[i])for(var s=t[i].split(","),n=0;n<s.length;n++)e.push(this._strToDate(s[n]));else t[i]instanceof Date&&e.push(t[i]);return e},this._clearRange=function(){this._rangeActive=!1,this._rangeType=null,this._rangeFrom=null,this._rangeTo=null},this._clearRangeSet=function(){for(var t in this._rangeSet)this._rangeSet[t]=null,delete this._rangeSet[t]},this._clearHolidays=function(){for(var t in this._holidays)this._holidays[t]=null,delete this._holidays[t]},this._isOutOfRange=function(t){if(1==this._rangeSet[t])return!0;if(this._rangeActive){if("in"==this._rangeType&&(t<this._rangeFrom||t>this._rangeTo))return!0;if("out"==this._rangeType&&t>=this._rangeFrom&&t<=this._rangeTo)return!0;if("from"==this._rangeType&&t<this._rangeFrom)return!0;if("to"==this._rangeType&&t>this._rangeTo)return!0}var e=new Date(t);return!(!this._rangeWeek||!0!==this._rangeWeekData[e.getDay()])||(!(!this._rangeMonth||!0!==this._rangeMonthData[e.getDate()])||!(!this._rangeYear||!0!==this._rangeYearData[e.getMonth()+"_"+e.getDate()]))},this.clearSensitiveRange=function(){this._clearRange(),this._drawMonth(this._activeMonth)},this.setSensitiveRange=function(t,e,i){var s=!1;if(null!=t&&null!=e){if(t instanceof Date||(t=this._strToDate(t)),e instanceof Date||(e=this._strToDate(e)),t.getTime()>e.getTime())return;this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),this._rangeActive=!0,this._rangeType="in",s=!0}s||null==t||null!=e||(t instanceof Date||(t=this._strToDate(t)),this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=null,!0===i&&this._rangeFrom++,this._rangeActive=!0,this._rangeType="from",s=!0),s||null!=t||null==e||(e instanceof Date||(e=this._strToDate(e)),this._rangeFrom=null,this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),!0===i&&this._rangeTo--,this._rangeActive=!0,this._rangeType="to",s=!0),s&&this._drawMonth(this._activeMonth)},this.setInsensitiveRange=function(t,e){if(null!=t&&null!=e){if(t instanceof Date||(t=this._strToDate(t)),e instanceof Date||(e=this._strToDate(e)),t.getTime()>e.getTime())return;return this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),this._rangeActive=!0,this._rangeType="out",void this._drawMonth(this._activeMonth)}null==t||null!=e?null!=t||null==e||this.setSensitiveRange(e,null,!0):this.setSensitiveRange(null,t,!0)},this.disableDays=function(t,e){if("week"==t){for(var i in"object"!=typeof e&&void 0===e.length&&(e=[e]),this._rangeWeekData||(this._rangeWeekData={}),this._rangeWeekData)this._rangeWeekData[i]=!1,delete this._rangeWeekData[i];for(var s=0;s<e.length;s++)this._rangeWeekData[e[s]]=!0,7==e[s]&&(this._rangeWeekData[0]=!0);this._rangeWeek=!0}if("month"==t){for(var i in"object"!=typeof e&&void 0===e.length&&(e=[e]),this._rangeMonthData||(this._rangeMonthData={}),this._rangeMonthData)this._rangeMonthData[i]=!1,delete this._rangeMonthData[i];for(s=0;s<e.length;s++)this._rangeMonthData[e[s]]=!0;this._rangeMonth=!0}if("year"==t){var n=this._extractDates(e);for(var i in this._rangeYearData||(this._rangeYearData={}),this._rangeYearData)this._rangeYearData[i]=!1,delete this._rangeYearData[i];for(s=0;s<n.length;s++)this._rangeYearData[n[s].getMonth()+"_"+n[s].getDate()]=!0;this._rangeYear=!0}this._drawMonth(this._activeMonth)},this.enableDays=function(t){"week"==t&&(this._rangeWeek=!1),"month"==t&&(this._rangeMonth=!1),"year"==t&&(this._rangeYear=!1),this._drawMonth(this._activeMonth)},this._tipData={},this._tipTM=null,this._tipTMTime=400,this._tipEvs=!1,this._tipPopup=null,this._tipCellDate=null,this._tipCellDim=null,this.setTooltip=function(t,e,i,s){for(var n=this._extractDates(t),l=0;l<n.length;l++){var o=new Date(n[l].getFullYear(),n[l].getMonth(),n[l].getDate(),0,0,0,0).getTime();this._tipData[o]={text:e,showIcon:i,usePopup:s}}this._drawMonth(this._activeMonth)},this.clearTooltip=function(t){for(var e=this._extractDates(t),i=0;i<e.length;i++){var s=new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime();this._tipData[s]=null,delete this._tipData[s]}this._drawMonth(this._activeMonth)},this._initTooltipPopup=function(){this._tipEvs||(this.attachEvent("onMouseOver",function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime();null!=this._tipData[e]&&(this._tipTM&&window.clearTimeout(this._tipTM),this._tipCellDate=t,this._tipCellDim=this.getCellDimension(t),this._tipText=this._tipData[e].text,this._tipTM=window.setTimeout(this._showTooltipPopup,this._tipTMTime))}),this.attachEvent("onMouseOut",this._hideTooltipPopup),this._tipEvs=!0)},this._showTooltipPopup=function(t,e,i,s,n){l._tipPopup||(l._tipPopup=new dhtmlXPopup({mode:"top"})),l._tipPopup.attachHTML(l._tipText),l._tipPopup.show(l._tipCellDim.x,l._tipCellDim.y,l._tipCellDim.w,l._tipCellDim.h),l.callEvent("onPopupShow",[l._tipCellDate])},this._hideTooltipPopup=function(){this._tipTM&&window.clearTimeout(this._tipTM),null!=this._tipPopup&&this._tipPopup.isVisible()&&(this._tipPopup.hide(),this.callEvent("onPopupHide",[this._tipCellDate]))},this.getPopup=function(){return this._tipPopup},this.getCellDimension=function(t){if("string"==typeof t&&(t=this._strToDate(t)),!(t instanceof Date))return null;for(var e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),i=null,s=0;s<this.contDates.childNodes.length;s++)for(var n=0;n<this.contDates.childNodes[s].childNodes.length;n++){var l=this.contDates.childNodes[s].childNodes[n];null!=l._date&&l._date.getTime()==e&&(i={x:this._getLeft(l),y:this._getTop(l),w:l.offsetWidth,h:l.offsetHeight}),l=null}return i},this._updateFromInput=function(t){if(this._nullInInput&&0==t.value.replace(/\s/g,"").length){if(this.checkEvent("onBeforeChange")&&!this.callEvent("onBeforeChange",[null]))return void(null!=this.i&&null!=this._activeInp&&null!=this.i[this._activeInp]&&null!=this.i[this._activeInp].input&&(this.i[this._activeInp].input.value=this.getFormatedDate()));this.setDate(null)}else this._updateDateStr(t.value);t=null},this._doOnClick=function(t){var e=(t=t||event).target||t.srcElement;e._dhtmlxcalendar_uid&&e._dhtmlxcalendar_uid!=l._activeInp&&l._isVisible()&&l._activeInp?l._hide():e._dhtmlxcalendar_uid&&l.i[e._dhtmlxcalendar_uid]||(l._isSelectorVisible()?l._hideSelector():!l._hasParent&&l._isVisible()&&l._hide())},this._doOnKeyDown=function(t){27!=(t=t||event).keyCode&&13!=t.keyCode||(l._isSelectorVisible()?l._hideSelector():l._isVisible()&&!l._hasParent&&l._hide())},this._doOnInpClick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;e._dhtmlxcalendar_uid&&(l._listenerEnabled||l._updateFromInput(e),l._show(e._dhtmlxcalendar_uid,!0))},this._doOnInpKeyUp=function(t){var e=(t=t||event).target||t.srcElement;13!=t.keyCode&&e._dhtmlxcalendar_uid&&(l._listenerEnabled||l._updateFromInput(e))},this._doOnBtnClick=function(t){"touchstart"==(t=t||event).type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;e._dhtmlxcalendar_uid&&(null!=l.i[e._dhtmlxcalendar_uid].input&&l._updateFromInput(l.i[e._dhtmlxcalendar_uid].input),l._show(e._dhtmlxcalendar_uid,!0))},this._doOnUnload=function(){l&&l.unload&&l.unload()},"function"==typeof window.addEventListener?(document.body.addEventListener("click",l._doOnClick,!1),window.addEventListener("keydown",l._doOnKeyDown,!1),window.addEventListener("unload",l._doOnUnload,!1),1==this.conf.touch&&document.body.addEventListener("touchstart",l._doOnClick,!1)):(document.body.attachEvent("onclick",l._doOnClick),document.body.attachEvent("onkeydown",l._doOnKeyDown),window.attachEvent("onunload",l._doOnUnload)),this.attachObj=function(t){var e=window.dhx4.newId();return"string"==typeof t?this.i[e]={input:document.getElementById(t)}:void 0!==t.tagName?this.i[e]={input:t}:"object"!=typeof t||null==t.input&&null==t.button||(this.i[e]={},null!=t.input&&(this.i[e].input="string"==typeof t.input?document.getElementById(t.input):t.input),null!=t.button&&(this.i[e].button="string"==typeof t.button?document.getElementById(t.button):t.button)),this._attachEventsToObject(e),e},this.detachObj=function(t){var e=null;if(null!=this.i[t]?e=t:"string"==typeof t?e=(t=document.getElementById(t))._dhtmlxcalendar_uid:void 0!==t.tagName?e=t._dhtmlxcalendar_uid:"object"!=typeof t||null==t.input&&null==t.button||(null==e&&null!=t.input&&(e=("string"==typeof t.input?document.getElementById(t.input):t.input)._dhtmlxcalendar_uid),null==e&&null!=t.button&&(e=("string"==typeof t.button?document.getElementById(t.button):t.button)._dhtmlxcalendar_uid)),null!=e&&null!=this.i[e]){for(var i in this._detachEventsFromObject(e),this.i[i])this.i[e][i]._dhtmlxcalendar_uid=null,this.i[e][i]=null,delete this.i[e][i];return this.i[e]=null,delete this.i[e],!0}return!1},this._attachEventsToObject=function(t){null!=this.i[t].button?(this.i[t].button._dhtmlxcalendar_uid=t,"function"==typeof window.addEventListener?(this.i[t].button.addEventListener("click",l._doOnBtnClick,!1),1==this.conf.touch&&this.i[t].button.addEventListener("touchstart",l._doOnBtnClick,!1)):this.i[t].button.attachEvent("onclick",l._doOnBtnClick)):null!=this.i[t].input&&(this.i[t].input._dhtmlxcalendar_uid=t,"function"==typeof window.addEventListener?(this.i[t].input.addEventListener("click",l._doOnInpClick,!1),this.i[t].input.addEventListener("keyup",l._doOnInpKeyUp,!1),1==this.conf.touch&&this.i[t].input.addEventListener("touchstart",l._doOnInpClick,!1)):(this.i[t].input.attachEvent("onclick",l._doOnInpClick),this.i[t].input.attachEvent("onkeyup",l._doOnInpKeyUp)))},this._detachEventsFromObject=function(t){null!=this.i[t].button?"function"==typeof window.addEventListener?(this.i[t].button.removeEventListener("click",l._doOnBtnClick,!1),1==this.conf.touch&&this.i[t].button.removeEventListener("touchstart",l._doOnBtnClick,!1)):this.i[t].button.detachEvent("onclick",l._doOnBtnClick):null!=this.i[t].input&&("function"==typeof window.addEventListener?(this.i[t].input.removeEventListener("click",l._doOnInpClick,!1),this.i[t].input.removeEventListener("keyup",l._doOnInpKeyUp,!1),1==this.conf.touch&&this.i[t].input.removeEventListener("touchstart",l._doOnInpClick,!1)):(this.i[t].input.detachEvent("onclick",l._doOnInpClick),this.i[t].input.detachEvent("onkeyup",l._doOnInpKeyUp)))},this.enableListener=function(t){t&&("function"==typeof window.addEventListener?(t.addEventListener("focus",l._listenerEvFocus,!1),t.addEventListener("blur",l._listenerEvBlur,!1)):(t.attachEvent("onfocus",l._listenerEvFocus),t.attachEvent("onblur",l._listenerEvBlur)),t=null)},this.disableListener=function(t){t&&(t._f0=!1,this._tmListener&&window.clearTimeout(this._tmListener),"function"==typeof window.addEventListener?(t.removeEventListener("focus",l._listenerEvFocus,!1),t.removeEventListener("blur",l._listenerEvBlur,!1)):(t.detachEvent("onfocus",l._listenerEvFocus),t.detachEvent("onblur",l._listenerEvBlur)),t=null)},this._startListener=function(t){this._tmListener&&window.clearTimeout(this._tmListener),void 0===t._v1&&(t._v1=t.value),t._v1!=t.value&&(this._updateFromInput(t),t._v1=t.value),t._f0&&(this._tmListener=window.setTimeout(function(){l._startListener(t)},100))},this._listenerEvFocus=function(t){var e=(t=t||event).target||t.srcElement;e._f0=!0,l._startListener(e),e=null},this._listenerEvBlur=function(t){var e=(t=t||event).target||t.srcElement;e._f0=!1,e=null},this.i)this._attachEventsToObject(h);return window.dhx4._eventable(this),this._evOnArrowClick=function(t){return this.callEvent("onArrowClick",t)},this._evOnClick=function(t){return this.callEvent("onClick",t)},this._evOnMouseOut=function(t){return this.callEvent("onMouseOut",t)},this._evOnMouseOver=function(t){return this.callEvent("onMouseOver",t)},this.unload=function(){for(var t in this._activeDate=null,this._activeDateCell=null,this._activeInp=null,this._activeMonth=null,this._dateFormat=null,this._dateFormatRE=null,this._lastHover=null,this._tmListener&&window.clearTimeout(this._tmListener),this._tmListener=null,"function"==typeof window.addEventListener?(document.body.removeEventListener("click",l._doOnClick,!1),window.removeEventListener("keydown",l._doOnKeyDown,!1),window.removeEventListener("unload",l._doOnUnload,!1),1==this.conf.touch&&document.body.removeEventListener("touchstart",l._doOnClick,!1)):(document.body.detachEvent("onclick",l._doOnClick),document.body.detachEvent("onkeydown",l._doOnKeyDown),window.detachEvent("onunload",l._doOnKeyDown)),this._doOnClick=null,this._doOnKeyDown=null,this._doOnUnload=null,this.i)this.i[t]._dhtmlxcalendar_uid=null,this._detachEventsFromObject(t),this.disableListener(this.i[t].input),this.i[t]=null,delete this.i[t];for(this.i=null,this._doOnInpClick=null,this._doOnInpKeyUp=null,window.dhx4._eventable(this,"clear"),this.contMonth.onselectstart=null,this.contMonth.firstChild.firstChild.onclick=null,this.contMonth.firstChild.firstChild.ontouchstart=null,this.contMonth.firstChild.firstChild.firstChild.onmouseover=null,this.contMonth.firstChild.firstChild.firstChild.onmouseout=null,this.contMonth.firstChild.firstChild.lastChild.onmouseover=null,this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;this.contMonth.firstChild.firstChild.childNodes.length>0;)this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild);for(this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild),this.contMonth.removeChild(this.contMonth.firstChild),this.contMonth.parentNode.removeChild(this.contMonth),this.contMonth=null;this.contDays.firstChild.childNodes.length>0;)this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild);for(this.contDays.removeChild(this.contDays.firstChild),this.contDays.parentNode.removeChild(this.contDays),this.contDays=null,this.contDates.onclick=null,this.contDates.ontouchstart=null,this.contDates.onmouseover=null,this.contDates.onmouseout=null;this.contDates.childNodes.length>0;){for(;this.contDates.lastChild.childNodes.length>0;)this.contDates.lastChild.lastChild._css_date=null,this.contDates.lastChild.lastChild._css_month=null,this.contDates.lastChild.lastChild._css_weekend=null,this.contDates.lastChild.lastChild._css_hover=null,this.contDates.lastChild.lastChild._date=null,this.contDates.lastChild.lastChild._q=null,this.contDates.lastChild.lastChild._w=null,this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild);this.contDates.removeChild(this.contDates.lastChild)}for(this.contDates.parentNode.removeChild(this.contDates),this.contDates=null,this.contTime.firstChild.firstChild.onclick=null,this.contTime.firstChild.firstChild.ontouchstart=null;this.contTime.firstChild.firstChild.childNodes.length>0;)this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild);if(this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild),this.contTime.removeChild(this.contTime.firstChild),this.contTime.parentNode.removeChild(this.contTime),this.contTime=null,this._lastHover=null,this._unloadSelector("month"),this._unloadSelector("year"),this._unloadSelector("hours"),this._unloadSelector("minutes"),this._selCover&&(this._selCover.parentNode.removeChild(this._selCover),this._selCover=null),this._sel){for(var t in this._sel._ta)this._sel._ta[t]=null;for(this._sel._ta=null,this._sel._t=null,this._sel.onmouseover=null,this._sel.onmouseout=null;this._sel.firstChild.firstChild.firstChild.childNodes.length>0;)this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null,this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild);for(this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild),this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);this._sel.childNodes.length>0;)this._sel.removeChild(this._sel.lastChild);this._sel.parentNode.removeChild(this._sel),this._sel=null}for(var t in this.base.onclick=null,this.base.onmousedown=null,this.base.ontouchstart=null,this.base.onmouseout=null,this.base.parentNode.removeChild(this.base),this.base=null,this._clearDayHover=null,this._clearSelHover=null,this._doOnSelectorChange=null,this._doOnSelectorShow=null,this._drawMonth=null,this._fixLength=null,this._getLeft=null,this._getTop=null,this._ifrSize=null,this._hide=null,this._hideSelector=null,this._initSelector=null,this._isSelectorVisible=null,this._isVisible=null,this._posGetOffset=null,this._posGetOffsetRect=null,this._posGetOffsetSum=null,this._scrollYears=null,this._show=null,this._showSelector=null,this._strToDate=null,this._updateActiveHours=null,this._updateActiveMinutes=null,this._updateActiveMonth=null,this._updateActiveYear=null,this._updateCellStyle=null,this._updateDateStr=null,this._updateVisibleHours=null,this._updateVisibleMinutes=null,this._updateYearsList=null,this.enableIframe=null,this.hide=null,this.hideTime=null,this.setDate=null,this.setDateFormat=null,this.setYearsRange=null,this.show=null,this.showTime=null,this.unload=null,null!=this._tipPopup&&(this._tipPopup.unload(),this._tipPopup=null),this)delete this[t];t=l=null},this.setDate(this._activeDate),this}function dhtmlXCombo(t,e,i,s,n){var l=this,o=null,r=null;"object"!=typeof t||t.tagName||(t=(o=t).parent,i=o.width,e=o.name,s=o.mode,r=o.skin),this.cont="string"==typeof t?document.getElementById(t):t,this.conf={skin:null,form_name:e||"dhxcombo",combo_width:(parseInt(i)||this.cont.offsetWidth||120)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),combo_image:!1,combo_focus:!1,opts_type:"string"==typeof s&&void 0!==this.modes[s]?s:"option",opts_count:8,opts_count_min:3,opts_width:null,item_h:null,list_zi_id:window.dhx4.newId(),allow_free_text:!0,allow_empty_value:!0,enabled:!0,img_path:"",img_def:"",img_def_dis:!0,template:{input:"#text#",option:"#text#"},f_func:null,f_mode:!1,f_url:!1,f_cache:!1,f_cache_data:{},f_dyn:!1,f_dyn_end:!1,f_mask:"",f_ac:!0,f_ac_text:"",f_server_tm:null,f_server_last:"",f_loading:!1,s_tm:null,s_time:200,s_mode:"select",last_hover:null,last_selected:null,last_match:null,last_text:"",last_value:"",tm_hover:null,tm_confirm_blur:null,clear_click:!1,clear_blur:!1,clear_bsp:!1,clear_key:!1,sp:{dhx_skyblue:{list_ofs:1,hdr_ofs:1,scr_ofs:1},dhx_web:{list_ofs:0,hdr_ofs:1,scr_ofs:0},dhx_terrace:{list_ofs:1,hdr_ofs:1,scr_ofs:1}},col_w:null},this.conf.combo_image=1==this.modes[this.conf.opts_type].image,this.t={},this.base=document.createElement("DIV"),this.base.style.width=this.conf.combo_width+"px",this.base.innerHTML="<input type='text' class='dhxcombo_input' style='width:"+(this.conf.combo_width-24-(this.conf.combo_image?23:0))+"px;"+(this.conf.combo_image?"margin-left:23px;":"")+"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>"+(this.conf.combo_image?"<div class='dhxcombo_top_image'>"+this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)+"</div>":""),this.cont.appendChild(this.base),this.list=document.createElement("DIV"),this.list._listId=window.dhx4.newId(),this.list.style.display="none",document.body.insertBefore(this.list,document.body.firstChild),this._doOnListScroll=function(){null!=l.conf.s_tm&&window.clearTimeout(l.conf.s_tm),l.conf.s_tm=window.setTimeout(l._doOnListScrollAction,l.conf.s_time)},this._doOnListScrollAction=function(){l.conf.s_tm=null,"scroll"==l.conf.s_mode&&l.list.scrollHeight-l.list.scrollTop-10<l.list.clientHeight&&l._subloadRequest()},"function"==typeof window.addEventListener?this.list.addEventListener("scroll",this._doOnListScroll,!1):this.list.attachEvent("onscroll",this._doOnListScroll),this.setSkin(r||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxcombo")||"dhx_skyblue"),this._updateTopImage=function(t){this.conf.combo_image&&(this.base.lastChild.innerHTML=null!=t?this.t[t].obj.getTopImage(this.t[t].item,this.conf.enabled):this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled))},this._filterOpts=function(t){this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm);var e=String(this.base.firstChild.value).replace(new RegExp(this.conf.f_ac_text+"$","i"),"");if(this.conf.f_server_last!=e.toLowerCase()){if(null!=this.conf.f_url&&this.checkEvent("onDynXLS"))return this.conf.f_server_last=e.toLowerCase(),void this.callEvent("onDynXLS",[e]);if(null!=this.conf.f_url){if(0==e.length)return this.conf.f_server_last=e.toLowerCase(),void this.clearAll();if(1==this.conf.f_cache&&null!=this.conf.f_cache_data[e]){this.clearAll(),this.conf.f_server_last=e.toLowerCase();for(var i=0;i<this.conf.f_cache_data[e].data.length;i++)this.load(this.conf.f_cache_data[e].data[i]);this.conf.f_dyn&&(this.conf.f_dyn_end=this.conf.f_cache_data[e].dyn_end,this.conf.f_mask=this.conf.f_cache_data[e].mask),!0!==t&&(this._showList(!0),this._checkForMatch())}else this.conf.f_server_tm=window.setTimeout(function(){l.conf.f_server_last=e.toLowerCase(),l.conf.f_mask=e;var i="mask="+encodeURIComponent(e);l.conf.f_dyn&&(i+="&pos=0",l.conf.f_dyn_end=!1);var s=function(i){if(l.conf.f_cache&&(l.conf.f_cache_data[e]||(l.conf.f_cache_data[e]={data:[],dyn_end:!1,mask:e}),l.conf.f_cache_data[e].data.push(i.xmlDoc.responseXML)),l.clearAll(),l.load(i.xmlDoc.responseXML),1==(l.base.offsetWidth>0&&l.base.offsetHeight>0)&&1==l.conf.enabled&&1==l.conf.combo_focus&&!0!==t){if(l.conf.f_ac&&"start"==l.conf.f_mode&&0==l.conf.clear_bsp&&null!=l.list.firstChild){var n=l.list.firstChild._optId,o=String(l.t[n].obj.getText(l.list.firstChild,!0));0===String(o).toLowerCase().indexOf(String(e).toLowerCase())&&(l.base.firstChild.value=o,l._selectRange(e.length,o.length))}l._showList(!0),l._checkForMatch()}s=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(l.conf.f_url,i,s):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(l.conf.f_url+(String(l.conf.f_url).indexOf("?")>=0?"&":"?")+i,s)},200)}else{this.conf.f_server_last=e.toLowerCase();var s=0==e.length||new RegExp(("start"==this.conf.f_mode?"^":"")+String(e).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi,"\\$&"),"i"),n=null;for(var o in this.t){var r=!1;if(!0!==s)if(null!=this.conf.f_func){var a=this._getOption(this.t[o].item._optId,i);r=1==this.conf.f_func.apply(window,[e,a])}else{var h=this.t[o].obj.getText(this.t[o].item,!0);r=1==s.test(h)}!0===s||1==r?(this.t[o].item.style.display="",null==n&&e.length>0&&(n=String(this.t[o].obj.getText(this.t[o].item,!0)))):this.t[o].item.style.display="none"}this.conf.f_ac&&"start"==this.conf.f_mode&&0==this.conf.clear_bsp&&null!=n&&(this.conf.f_ac_text=n.replace(new RegExp("^"+e,"i"),""),this.base.firstChild.value=n,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)),"between"==this.conf.f_mode&&1==this.conf.clear_bsp&&this._checkForMatch(!0),!0!==t&&(this._showList(!0),this._checkForMatch())}}else this._checkForMatch()},this._initObj=function(t){void 0!==t.template&&this.setTemplate(t.template),1!=t.add&&1!=this.conf.f_loading&&this.clearAll(!1),this.addOption(t.options)},this._xmlToObj=function(t,e,i){var s={add:!1,options:[]},n=1==e?t:t.getElementsByTagName("complete");if(n.length>0){1==window.dhx4.s2b(n[0].getAttribute("add"))&&(s.add=!0);for(var l=n[0].childNodes,o=0;o<l.length;o++)if(void 0!==l[o].tagName){if("template"==String(l[o].tagName).toLowerCase()){for(var r={},a=0;a<l[o].childNodes.length;a++){if(null!=(g=l[o].childNodes[a]).tagName){var h=g.tagName;if(void 0!==this.conf.template[h]&&(r[h]=window.dhx4._xmlNodeValue(g)),"columns"==h)for(var d=0;d<g.childNodes.length;d++){var c=g.childNodes[d];if(null!=c.tagName&&"column"==c.tagName){var _={};for(var u in{width:1,css:1,header:1,option:1})null!=c.getAttribute(u)&&(_[u]=c.getAttribute(u));for(var u in{header:1,option:1}){var f=c.getElementsByTagName(u);null!=f[0]&&null!=f[0].firstChild&&(_[u]=window.dhx4._xmlNodeValue(f[0]))}null==r.columns&&(r.columns=[]),r.columns.push(_)}c=null}}g=null}this.setTemplate(r)}if("option"==String(l[o].tagName).toLowerCase()){var p=!1;p=1==e?s.options.length==i:window.dhx4.s2b(l[o].getAttribute("selected"));var m={value:l[o].getAttribute("value"),text:window.dhx4._xmlNodeValue(l[o]),selected:p,checked:window.dhx4.s2b(l[o].getAttribute("checked"))};for(var u in{img:1,img_dis:1,img_src:1,img_src_dis:1,css:1})null!=l[o].getAttribute(u)&&(m[u]=l[o].getAttribute(u));for(a=0;a<l[o].childNodes.length;a++)if(null!=l[o].childNodes[a].tagName&&"text"==String(l[o].childNodes[a].tagName).toLowerCase()){m.text={};var g=l[o].childNodes[a];for(d=0;d<g.childNodes.length;d++)null!=g.childNodes[d].tagName&&(m.text[g.childNodes[d].tagName]=window.dhx4._xmlNodeValue(g.childNodes[d]))}s.options.push(m)}}n=l=null}return s},window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","complete",{data:!0}),window.dhx4._eventable(this),this._getNearItem=function(t,e){for(var i=null;null!=t;)t=t[e<0?"previousSibling":"nextSibling"],null==i&&null!=t&&""==t.style.display&&null!=t._optId&&(i=t,t=null);return i},this.setName(this.conf.form_name),this._doOnListMouseMove=function(t){for(var e=(t=t||event).target||t.srcElement;null!=e&&e!=this;)void 0!==e._optId&&(l.conf.tm_hover&&window.clearTimeout(l.conf.tm_hover),l._setSelected(e._optId)),e=e.parentNode;e=null},this._doOnListMouseDown=function(t){(t=t||event).cancelBubble=!0,l.conf.clear_click=!0,window.setTimeout(function(){l.base.firstChild.focus()},1)},this._doOnListMouseUp=function(t){for(var e=(t=t||event).target||t.srcElement;null!=e&&e!=this;){if(void 0!==e._optId){var i=!0;"function"==typeof l.t[e._optId].obj.optionClick&&!0!==l.t[e._optId].obj.optionClick(e,t,l)&&(i=!1),i&&(l._setSelected(e._optId,null,!0),l._confirmSelect("click"))}e=e.parentNode}e=null},this._doOnListMouseOut=function(t){l.conf.tm_hover&&window.clearTimeout(l.conf.tm_hover),l.conf.tm_hover=window.setTimeout(function(){var t=l.conf.last_match||l.conf.last_selected;null==l.conf.last_match&&null!=l.t[t]&&l.base.firstChild.value!=l.t[t].obj.getText(l.t[t].item,!0)&&(t=null),l._setSelected(t,null,!0)},1)},this._doOnBaseMouseDown=function(t){if(l.conf.enabled){l.conf.clear_click=!0;var e=(t=t||event).target||t.srcElement;if(e!=this.firstChild){window.setTimeout(function(){l.base.firstChild.focus()},1);for(var i=e;i!=this&&null!=i;)if(i==this.lastChild){if("function"==typeof l.modes[l.conf.opts_type].topImageClick){var s=l.conf.last_hover||l.conf.last_selected,n=null!=s?l.t[s].item:null;if(!0!==l.modes[l.conf.opts_type].topImageClick(n,l))return void(s=n=null)}i=null}else i=i.parentNode}l._isListVisible()?l._hideList():(e!=this.firstChild&&(l.conf.clear_blur=!0),l._showList(),l._setSelected(l.conf.last_selected,!0,!0)),e=null}},this._doOnBodyMouseDown=function(){l.conf.clear_click?l.conf.clear_click=!1:l._confirmSelect("blur")},this._doOnInputFocus=function(){l.conf.clear_blur=!1,l.conf.tm_confirm_blur&&window.clearTimeout(l.conf.tm_confirm_blur),0==l.conf.combo_focus&&(l.conf.combo_focus=!0,l.callEvent("onFocus",[]))},this._doOnInputBlur=function(){1!=l.conf.clear_blur?(l.conf.tm_confirm_blur&&window.clearTimeout(l.conf.tm_confirm_blur),l.conf.tm_confirm_blur=window.setTimeout(function(){0==l.conf.clear_click&&(l._confirmSelect("blur"),l.conf.combo_focus=!1,l.callEvent("onBlur",[]))},20)):l.conf.clear_blur=!1},this._doOnInputKeyUp=function(t){if(t=t||event,0!=l.conf.f_mode)return l.conf.clear_bsp=8==t.keyCode||46==t.keyCode,void l._filterOpts();l._checkForMatch()},this._doOnInputKeyDown=function(t){38!=(t=t||event).keyCode&&40!=t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,l._keyOnUpDown(38==t.keyCode?-1:1)),113==t.keyCode&&(l._isListVisible()||(l._showList(),l.base.firstChild.value==l.conf.last_text?(l._setSelected(l.conf.last_selected,!0,!0),l.base.firstChild.value=l.conf.last_text,l.conf.f_server_last=l.base.firstChild.value.toLowerCase()):(l.conf.f_server_last=l.base.firstChild.value.toLowerCase(),0==l.conf.f_mode&&l._checkForMatch()))),27==t.keyCode&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,l._cancelSelect()),13==t.keyCode&&(t.preventDefault&&t.preventDefault(),l._confirmSelect("kbd")),l.conf.clear_key=!0,l.callEvent("onKeyPressed",[t.keyCode||t.charCode])},this._doOnInputKeyPress=function(t){l.conf.clear_key?l.conf.clear_key=!1:(t=t||event,l.callEvent("onKeyPressed",[t.keyCode||t.charCode]))},this._keyOnUpDown=function(t){var e=null;if(this.conf.last_hover?e=this.t[this.conf.last_hover].item:this.conf.last_selected&&(e=this.t[this.conf.last_selected].item),(e||0!=this._getListVisibleCount())&&(null!=e&&""!=e.style.display&&(e=null),this._showList(),null!=e?this.t[e._optId].obj.isSelected(e)&&(e=this._getNearItem(e,t)):""!=(e=this.list.firstChild).style.display&&(e=this._getNearItem(e,1)),null!=e)){if(this._setSelected(e._optId,!0,!0),0==this.conf.f_mode)this.base.firstChild.value=this.t[e._optId].obj.getText(e,!0);else{var i=String(this.t[e._optId].obj.getText(e,!0));"start"==this.conf.f_mode&&1==this.conf.f_ac?0===i.toLowerCase().indexOf(this.conf.f_server_last)?(this.conf.f_ac_text=i.substring(this.conf.f_server_last.length,i.length),this.base.firstChild.value=i,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)):(this.base.firstChild.value=i,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this._selectRange(0,this.base.firstChild.value.length)):(this.base.firstChild.value=i,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())}e=null}},this.conf.evs_nodes=[{node:document.body,evs:{mousedown:"_doOnBodyMouseDown"}},{node:this.base,evs:{mousedown:"_doOnBaseMouseDown"}},{node:this.base.firstChild,evs:{keyup:"_doOnInputKeyUp",keydown:"_doOnInputKeyDown",keypress:"_doOnInputKeyPress",focus:"_doOnInputFocus",blur:"_doOnInputBlur"}},{node:this.list,evs:{mousemove:"_doOnListMouseMove",mousedown:"_doOnListMouseDown",mouseup:"_doOnListMouseUp",mouseout:"_doOnListMouseOut"}}];for(var a=0;a<this.conf.evs_nodes.length;a++)for(var h in this.conf.evs_nodes[a].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[a].node.addEventListener(h,this[this.conf.evs_nodes[a].evs[h]],!1):this.conf.evs_nodes[a].node.attachEvent("on"+h,this[this.conf.evs_nodes[a].evs[h]]);return this.unload=function(){this.clearAll(),this.t=null;for(var t=0;t<this.conf.evs_nodes.length;t++){for(var e in this.conf.evs_nodes[t].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[t].node.removeEventListener(e,this[this.conf.evs_nodes[t].evs[e]],!1):this.conf.evs_nodes[t].node.detachEvent("on"+e,this[this.conf.evs_nodes[t].evs[e]]),this.conf.evs_nodes[t].evs[e]=null,delete this.conf.evs_nodes[t].evs[e];this.conf.evs_nodes[t].node=null,this.conf.evs_nodes[t].evs=null,delete this.conf.evs_nodes[t].node,delete this.conf.evs_nodes[t].evs,this.conf.evs_nodes[t]=null}for(var e in window.dhx4._eventable(this,"clear"),window.dhx4._enableDataLoading(this,null,null,null,"clear"),this._mcDetachHeader(),this.DOMelem_input=this.DOMelem_button=this.DOMlist=this.DOMelem=this.DOMParent=null,this.conf)this.conf[e]=null,delete this.conf[e];for(var e in this.conf=null,"function"==typeof window.addEventListener?this.list.removeEventListener("scroll",this._doOnListScroll,!1):this.list.detachEvent("onscroll",this._doOnListScroll),this.base.parentNode.removeChild(this.base),this.list.parentNode.removeChild(this.list),this.base=this.list=this.cont=null,this.modes=null,this)"function"==typeof this[e]&&(this[e]=null);l=null},this.DOMelem_input=this.base.firstChild,this.DOMelem_button=this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)],this.DOMlist=this.list,this.DOMelem=this.base,this.DOMParent=t,t=null,null!=o&&(null!=o.filter&&("string"==typeof o.filter?this.enableFilteringMode(!0,o.filter,window.dhx4.s2b(o.filter_cache),window.dhx4.s2b(o.filter_sub_load)):this.enableFilteringMode(!0)),null!=o.image_path&&this.setImagePath(o.image_path),null==o.default_image&&null==o.default_image_dis||this.setDefaultImage(o.default_image,o.default_image_dis),(o.items||o.options)&&this.addOption(o.items||o.options),(o.xml||o.json)&&this.load(o.xml||o.json),void 0!==o.readonly&&this.readonly(o.readonly),o=null),this}function dhtmlXComboFromSelect(t){"string"==typeof t&&(t=document.getElementById(t));var e=t.offsetWidth,i=t.getAttribute("name")||null,s=document.createElement("SPAN");t.parentNode.insertBefore(s,t);var n=new dhtmlXCombo(s,i,e,t.getAttribute("mode")||t.getAttribute("opt_type")||"option");s=null;var l=t.getAttribute("imagePath");l&&n.setImagePath(l);var o=t.getAttribute("defaultImage"),r=t.getAttribute("defaultImageDis");1==window.dhx4.s2b(r)&&(r=!0),null==o&&null==r||n.setDefaultImage(o,r);var a=n._xmlToObj([t],!0,t.selectedIndex);return a.options.length>0&&n.addOption(a.options),a=null,t.parentNode.removeChild(t),t=null,n}function dhtmlXComboExtend(t,e){for(var i in dhtmlXCombo.prototype.modes[e])void 0===dhtmlXCombo.prototype.modes[t][i]&&(dhtmlXCombo.prototype.modes[t][i]=dhtmlXCombo.prototype.modes[e][i])}function dhtmlXMenuObject(t,e){var i=this;if(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"dhx_skyblue",mode:"web",align:"left",is_touched:!1,selected:-1,last_click:-1,fixed_pos:!1,rtl:!1,icons_path:"",arrow_ff_fix:navigator.userAgent.indexOf("MSIE")>=0&&"BackCompat"==document.compatMode,live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:!0,top_tmtime:200,v_enabled:!1,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:!1,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,tm_sec:400,tm_handler:null,dload:!1,dload_url:"",dload_icon:!1,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:!1,ctx_zoneid:!1,ctx_autoshow:!0,ctx_autohide:!0,ctx_hideall:!0,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]},"object"==typeof t&&null!=t&&void 0===t.tagName){for(var s in null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.skin&&(this.conf.skin=t.skin),t.visible_area&&(this.conf.v_enabled=!0,this.conf.v={x1:t.visible_area.x1,x2:t.visible_area.x2,y1:t.visible_area.y1,y2:t.visible_area.y2}),{json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1})null!=t[s]&&(this.conf.autoload[s]=t[s]);t=t.parent}if(null==t)this.base=document.body;else{var n="string"==typeof t?document.getElementById(t):t;null!=n?(this.base=n,this.base.id||(this.base.id=(new Date).valueOf()),this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left",this.base._autoSkinUpdate=!0,this.base.oncontextmenu&&(this.base._oldContextMenuHandler=this.base.oncontextmenu),this.conf.ctx_baseid=this.base.id,this.base.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1}):this.base=document.body}for(var s in this.idPrefix="",this.topId="dhxWebMenuTopId",this.idPull={},this.itemPull={},this.userData={},this.radio={},this.setSkin=function(t){var e=this.conf.skin;switch(this.conf.skin=t,this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2,this.conf.tl_rmarg=1,this.conf.tl_ofsleft=1;break;case"dhx_terrace":this.conf.tl_botmarg=0,this.conf.tl_rmarg=0,this.conf.tl_ofsleft=0}for(var i in this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+e+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle"),this.idPull)this.idPull[i].className=String(this.idPull[i].className).replace(e,this.conf.skin)},this.setSkin(this.conf.skin),this._addSubItemToSelected=function(t,e){for(var i=!0,s=0;s<this.conf.selected_sub.length;s++)this.conf.selected_sub[s][0]==t&&this.conf.selected_sub[s][1]==e&&(i=!1);return 1==i&&this.conf.selected_sub.push(new Array(t,e)),i},this._removeSubItemFromSelected=function(t,e){for(var i=new Array,s=!1,n=0;n<this.conf.selected_sub.length;n++)this.conf.selected_sub[n][0]==t&&this.conf.selected_sub[n][1]==e?s=!0:i[i.length]=this.conf.selected_sub[n];return 1==s&&(this.conf.selected_sub=i),s},this._getSubItemToDeselectByPolygon=function(t){for(var e=new Array,i=0;i<this.conf.selected_sub.length;i++)if(this.conf.selected_sub[i][1]==t){e[e.length]=this.conf.selected_sub[i][0],e=e.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[i][0]));for(var s=!0,n=0;n<this.conf.opened_poly.length;n++)this.conf.opened_poly[n]==this.conf.selected_sub[i][0]&&(s=!1);1==s&&(this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[i][0]),this.conf.selected_sub[i][0]=-1,this.conf.selected_sub[i][1]=-1}return e},this._hidePolygon=function(t){if(null!=this.idPull["polygon_"+t]){if(null!=this.idPull["polygon_"+t]._zId&&window.dhx4.zim.clear(this.idPull["polygon_"+t]._zId),void 0!==this._menuEffect&&!1!==this._menuEffect)this._hidePolygonEffect("polygon_"+t);else{if("none"==this.idPull["polygon_"+t].style.display)return;this.idPull["polygon_"+t].style.display="none",null!=this.idPull["arrowup_"+t]&&(this.idPull["arrowup_"+t].style.display="none"),null!=this.idPull["arrowdown_"+t]&&(this.idPull["arrowdown_"+t].style.display="none"),this._updateItemComplexState(t,!0,!1),window.dhx4.isIE6&&null!=this.idPull["polygon_"+t+"_ie6cover"]&&(this.idPull["polygon_"+t+"_ie6cover"].style.display="none")}(t=String(t).replace(this.idPrefix,""))==this.topId&&(t=null),this.callEvent("onHide",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!0)}},this._showPolygon=function(t,e){var i=this._countVisiblePolygonItems(t);if(0!=i){var s="polygon_"+t;if(null!=this.idPull[s]&&null!=this.idPull[t]){if(this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&!this.idPull[t]._mouseOver&&e==this.conf.dir_toplv)return;this.conf.fixed_pos||this._autoDetectVisibleArea();var n=0,l=0,o=null,r=null;if(null==this.idPull[s]._zId&&(this.idPull[s]._zId=window.dhx4.newId()),this.idPull[s]._zInd=window.dhx4.zim.reserve(this.idPull[s]._zId),this.idPull[s].style.visibility="hidden",this.idPull[s].style.left="0px",this.idPull[s].style.top="0px",this.idPull[s].style.display="",this.idPull[s].style.zIndex=this.idPull[s]._zInd,this.conf.auto_overflow)if(this.idPull[s].childNodes[1].childNodes[0].offsetHeight>this.conf.v.y1+this.conf.v.y2){var a=Math.floor((this.conf.v.y2-this.conf.v.y1-35)/24);this.conf.overflow_limit=a}else this.conf.overflow_limit=0,null!=this.idPull["arrowup_"+t]&&this._removeUpArrow(String(t).replace(this.idPrefix,"")),null!=this.idPull["arrowdown_"+t]&&this._removeDownArrow(String(t).replace(this.idPrefix,""));if(this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(null==this.idPull["arrowup_"+t]&&this._addUpArrow(String(t).replace(this.idPrefix,"")),null==this.idPull["arrowdown_"+t]&&this._addDownArrow(String(t).replace(this.idPrefix,"")),(o=this.idPull["arrowup_"+t]).style.display="none",(r=this.idPull["arrowdown_"+t]).style.display="none"),this.conf.overflow_limit>0&&(this.conf.overflow_limit<i?(this.idPull[s].childNodes[1].style.height=24*this.conf.overflow_limit+"px",o.style.width=r.style.width=this.idPull[s].childNodes[1].style.width=this.idPull[s].childNodes[1].childNodes[0].offsetWidth+"px",this.idPull[s].childNodes[1].scrollTop=0,o.style.display="",n=o.offsetHeight,r.style.display="",l=r.offsetHeight):(this.idPull[s].childNodes[1].style.height="",this.idPull[s].childNodes[1].style.width="")),null!=this.itemPull[t])this.itemPull[t].parent;else if(this.conf.context)this.idPull[this.idPrefix+this.topId];var h=null!=this.idPull[t].tagName?window.dhx4.absLeft(this.idPull[t]):this.idPull[t][0],d=null!=this.idPull[t].tagName?window.dhx4.absTop(this.idPull[t]):this.idPull[t][1],c=null!=this.idPull[t].tagName?this.idPull[t].offsetWidth:0,_=null!=this.idPull[t].tagName?this.idPull[t].offsetHeight:0,u=0,f=0,p=this.idPull[s].offsetWidth,m=this.idPull[s].childNodes[1].offsetHeight+n+l;if("bottom"==e&&(u=this.conf.rtl?h+(null!=c?c:0)-p:"right"==this.conf.align?h+c-p:h-1+(e==this.conf.dir_toplv?this.conf.tl_rmarg:0),f=d-1+_+this.conf.tl_botmarg),"right"==e&&(u=h+c-1,f=d+2),"left"==e&&(u=h-this.idPull[s].offsetWidth+2,f=d+2),"top"==e&&(u=h-1,f=d-m+2),this.conf.fixed_pos)var g=65536,v=65536;else{g=null!=this.conf.v.x2?this.conf.v.x2:0,v=null!=this.conf.v.y2?this.conf.v.y2:0;0==g&&(window.innerWidth?(g=window.innerWidth,v=window.innerHeight):(g=document.body.offsetWidth,v=document.body.scrollHeight))}if(u+p>g&&!this.conf.rtl&&(u=h-p+2),u<this.conf.v.x1&&this.conf.rtl&&(u=h+c-2),u<0&&(u=0),f+m>v&&null!=this.conf.v.y2&&(f=Math.max(d+_-m+2,this.conf.v_enabled?this.conf.v.y1+2:2),this.conf.context&&this.idPrefix+this.topId==t&&null!=r&&(f-=2),null==this.itemPull[t]||this.conf.context||this.itemPull[t].parent==this.idPrefix+this.topId&&(f-=this.base.offsetHeight)),this.idPull[s].style.left=u+"px",this.idPull[s].style.top=f+"px",void 0!==this._menuEffect&&!1!==this._menuEffect)this._showPolygonEffect(s);else if(this.idPull[s].style.visibility="",this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(this.idPull[s].childNodes[1].scrollTop=0,this._checkArrowsState(t)),window.dhx4.isIE6){var b=s+"_ie6cover";if(null==this.idPull[b]){var x=document.createElement("IFRAME");x.className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin,x.frameBorder=0,x.setAttribute("src","javascript:false;"),document.body.insertBefore(x,document.body.firstChild),this.idPull[b]=x}this.idPull[b].style.left=u+"px",this.idPull[b].style.top=f+"px",this.idPull[b].style.width=this.idPull[s].offsetWidth+"px",this.idPull[b].style.height=this.idPull[s].offsetHeight+"px",this.idPull[b].style.zIndex=this.idPull[s].style.zIndex-1,this.idPull[b].style.display=""}(t=String(t).replace(this.idPrefix,""))==this.topId&&(t=null),this.callEvent("onShow",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!1)}}},this._redistribSubLevelSelection=function(t,e){for(;this.conf.opened_poly.length>0;)this.conf.opened_poly.pop();var i=this._getSubItemToDeselectByPolygon(e);this._removeSubItemFromSelected(-1,-1);for(var s=0;s<i.length;s++)null!=this.idPull[i[s]]&&i[s]!=t&&"enabled"==this.itemPull[i[s]].state&&(this.idPull[i[s]].className="sub_item");for(s=0;s<this.conf.opened_poly.length;s++)this.conf.opened_poly[s]!=e&&this._hidePolygon(this.conf.opened_poly[s]);if("enabled"==this.itemPull[t].state){if(this.idPull[t].className="sub_item_selected",this.itemPull[t].complex&&this.conf.dload&&"no"==this.itemPull[t].loaded){1==this.conf.dload_icon&&this._updateLoaderIcon(t,!0),this.itemPull[t].loaded="get";var n=t.replace(this.idPrefix,"");this._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in t.params[this.conf.dload_pid]=n,this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)}(this.itemPull[t].complex||this.conf.dload&&"yes"==this.itemPull[t].loaded)&&this.itemPull[t].complex&&null!=this.idPull["polygon_"+t]&&(this._updateItemComplexState(t,!0,!0),this._showPolygon(t,this.conf.dir_sublv)),this._addSubItemToSelected(t,e),this.conf.selected=t}},this._doOnClick=function(t,e,i){if(this.conf.last_click=t,null!=this.itemPull[this.idPrefix+t].href_link&&"enabled"==this.itemPull[this.idPrefix+t].state){var s=document.createElement("FORM"),n=String(this.itemPull[this.idPrefix+t].href_link).split("?");if(s.action=n[0],null!=n[1])for(var l=String(n[1]).split("&"),o=0;o<l.length;o++){var r=String(l[o]).split("="),a=document.createElement("INPUT");a.type="hidden",a.name=r[0]||"",a.value=r[1]||"",s.appendChild(a)}return null!=this.itemPull[this.idPrefix+t].href_target&&(s.target=this.itemPull[this.idPrefix+t].href_target),s.style.display="none",document.body.appendChild(s),s.submit(),void(null!=s&&(document.body.removeChild(s),s=null))}if("c"!=e.charAt(0)&&"d"!=e.charAt(1)&&"s"!=e.charAt(2)){if(this.checkEvent("onClick"))this.callEvent("onClick",[t,this.conf.ctx_zoneid,i]);else if("d"==e.charAt(1)||"win"==this.conf.mode&&"t"==e.charAt(2))return;this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide?this._hideContextMenu():this._clearAndHide&&this._clearAndHide()}},this._doOnTouchMenu=function(t){0==this.conf.is_touched&&(this.conf.is_touched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[t]))},this._searchMenuNode=function(t,e){for(var i=new Array,s=0;s<e.length;s++)if("object"==typeof e[s]){5==e[s].length&&"object"!=typeof e[s][0]&&e[s][0].replace(this.idPrefix,"")==t&&0==s&&(i=e);var n=this._searchMenuNode(t,e[s]);n.length>0&&(i=n)}return i},this._getMenuNodes=function(t){var e=new Array;for(var i in this.itemPull)this.itemPull[i].parent==t&&(e[e.length]=i);return e},this._genStr=function(t){for(var e="",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=0;s<t;s++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.getItemType=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:this.itemPull[t].type},this.forEachItem=function(t){for(var e in this.itemPull)t(String(e).replace(this.idPrefix,""))},this._clearAndHide=function(){for(i.conf.selected=-1,i.conf.last_click=-1;i.conf.opened_poly.length>0;)i.conf.opened_poly.pop();for(var t=0;t<i.conf.selected_sub.length;t++){var e=i.conf.selected_sub[t][0];null!=i.idPull[e]&&"enabled"==i.itemPull[e].state&&("sub_item_selected"==i.idPull[e].className&&(i.idPull[e].className="sub_item"),i.idPull[e].className=="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected"&&(null!=i.itemPull[e].cssNormal?i.idPull[e].className=i.itemPull[e].cssNormal:i.idPull[e].className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal")),i._hidePolygon(e)}i.conf.is_touched=!1,i.conf.context&&i.conf.ctx_hideall&&i._hidePolygon(i.idPrefix+i.topId)},this._showSubLevelItem=function(t,e){null!=document.getElementById("arrow_"+this.idPrefix+t)&&(document.getElementById("arrow_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById("image_"+this.idPrefix+t)&&(document.getElementById("image_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById(this.idPrefix+t)&&(document.getElementById(this.idPrefix+t).style.display=e?"":"none")},this._hideSubLevelItem=function(t){this._showSubLevelItem(t,!0)},this.idPrefix=this._genStr(12)+"_",this._bodyClick=function(t){2==(t=t||event).button||window.dhx4.isOpera&&1==t.ctrlKey||(i.conf.context?i.conf.ctx_autohide&&(!window.dhx4.isOpera||i._isContextMenuVisible()&&window.dhx4.isOpera)&&i._hideContextMenu():i._clearAndHide&&i._clearAndHide())},this._bodyContext=function(t){t=t||event;var e=String((t.srcElement||t.target).className);if(-1==e.search("dhtmlxMenu")||-1==e.search("SubLevelArea")){for(var s=!0,n=t.target||t.srcElement;null!=n;)null!=n.id&&i.isContextZone(n.id)&&(s=!1),n==document.body&&(s=!1),n=n.parentNode;s&&i.hideContextMenu()}},void 0!==window.addEventListener?(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1)):(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)),this.unload=function(){window.dhx4._eventable(this,"clear"),dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(t){}if(this.conf.live_id=null,"function"==typeof window.addEventListener?(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1)):(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)),this._bodyClick=null,this._bodyContext=null,this.removeItem(this.idPrefix+this.topId,!0),this.itemPull=null,this.idPull=null,this.conf.context)for(var t in this.conf.ctx_zones)this.removeContextZone(t);for(var t in null!=this.cont&&(this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null),null!=this.base&&(this.conf.context||(this.base.className=""),this.conf.context||(this.base.oncontextmenu=this.base._oldContextMenuHandler||null),this.base.onselectstart=null,this.base=null),this)this[t]=null;i=null},dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this,window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:!0}),window.dhx4._eventable(this),1==window.dhx4.s2b(this.conf.autoload.context)&&this.renderAsContextMenu(),null!=this.conf.autoload.dynamic?this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon)):null!=this.conf.autoload.items?this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload):null!=this.conf.autoload.json?this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload):null!=this.conf.autoload.xml&&this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload),{onclick:1,oncheckboxclick:1,onradioclick:1})null!=this.conf.autoload[s]&&("function"==typeof this.conf.autoload[s]?this.attachEvent(s,this.conf.autoload[s]):"function"==typeof window[this.conf.autoload[s]]&&this.attachEvent(s,window[this.conf.autoload[s]]));for(var s in null!=this.conf.autoload.top_text&&this.setTopText(this.conf.autoload.top_text),null!=this.conf.autoload.align&&this.setAlign(this.conf.autoload.align),null!=this.conf.autoload.open_mode&&this.setOpenMode(this.conf.autoload.open_mode),null!=this.conf.autoload.overflow&&this.setOverflowHeight(this.conf.autoload.overflow),this.conf.autoload)this.conf.autoload[s]=null,delete this.conf.autoload[s];return this.conf.autoload=null,this}function dhtmlXToolbarObject(t,e){var i=this;for(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtoolbar")||"dhx_skyblue",align:"left",align_autostart:"left",icons_path:"",iconSize:18,sel_ofs_x:0,sel_ofs_y:0,xml_autoload:null,items_autoload:null},"object"==typeof t&&null!=t&&void 0===t.tagName&&(null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.icons_size&&(this.conf.icons_size_autoload=t.icons_size),null!=t.json&&(this.conf.json_autoload=t.json),null!=t.xml&&(this.conf.xml_autoload=t.xml),null!=t.onload&&(this.conf.onload_autoload=t.onload),null==t.onclick&&null==t.onClick||(this.conf.auto_onclick=t.onclick||t.onClick),null!=t.items&&(this.conf.items_autoload=t.items),null!=t.skin&&(this.conf.skin=t.skin),null!=t.align&&(this.conf.align_autostart=t.align),t=t.parent),this.cont="object"!=typeof t?document.getElementById(t):t;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);return t=null,this.cont.dir="ltr",this.base=document.createElement("DIV"),this.base.className="dhxtoolbar_float_left",this.cont.appendChild(this.base),window.dhx4.isIPad&&(this.cont.ontouchstart=function(t){return t=t||event,"input"==String(t.target.tagName||"").toLowerCase()||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1)}),this.setSkin(this.conf.skin),this.objPull={},this.anyUsed="none",this._genStr=function(t){for(var e="",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=0;s<t;s++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput"),this.idPrefix=this._genStr(12),window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson","toolbar",{struct:!0}),window.dhx4._eventable(this),this._getObj=function(t,e){for(var i=null,s=0;s<t.childNodes.length;s++)null!=t.childNodes[s].tagName&&String(t.childNodes[s].tagName).toLowerCase()==String(e).toLowerCase()&&(i=t.childNodes[s]);return i},this._addImgObj=function(t){var e=document.createElement("IMG");return t.childNodes.length>0?t.insertBefore(e,t.childNodes[0]):t.appendChild(e),e},this._setItemImage=function(t,e,i){if(1==i?t.imgEn=e:t.imgDis=e,!(!t.state&&1==i||t.state&&0==i)){var s=this._getObj(t.obj,"img");null==s&&(s=this._addImgObj(t.obj)),s.src=this.conf.icons_path+e}},this._clearItemImage=function(t,e){if(1==e?t.imgEn="":t.imgDis="",!(!t.state&&1==e||t.state&&0==e)){var i=this._getObj(t.obj,"img");null!=i&&i.parentNode.removeChild(i)}},this._setItemText=function(t,e){var i=this._getObj(t.obj,"div");null!=e&&0!=e.length?(null==i&&((i=document.createElement("DIV")).className="dhxtoolbar_text",t.obj.appendChild(i)),i.innerHTML=e):null!=i&&i.parentNode.removeChild(i)},this._getItemText=function(t){var e=this._getObj(t.obj,"div");return null!=e?e.innerHTML:""},this._enableItem=function(t){if(!t.state){t.state=!0,"buttonTwoState"==this.objPull[t.id].type&&1==this.objPull[t.id].obj.pressed?(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",t.obj.renderAs=t.obj.className),t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgEn?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgEn):null!=e&&e.parentNode.removeChild(e)}},this._disableItem=function(t){if(t.state){t.state=!1,t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+("buttonTwoState"==this.objPull[t.id].type&&t.obj.pressed?"pres_":"")+"dis",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgDis?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgDis):null!=e&&e.parentNode.removeChild(e),null!=t.polygon&&"none"!=t.polygon.style.display&&(window.dhx4.zim.clear(t.polygon._idd),t.polygon.style.display="none",t.polygon._ie6cover&&(t.polygon._ie6cover.style.display="none"),"dhx_terrace"==this.conf.skin&&this._improveTerraceButtonSelect(t.id,!0)),this.anyUsed="none"}},this.clearAll=function(){for(var t in this.objPull)this._removeItem(String(t).replace(this.idPrefix,""))},this._doOnClick=function(t){i&&i.forEachItem&&i.forEachItem(function(t){if("buttonSelect"==i.objPull[i.idPrefix+t].type){var e=i.objPull[i.idPrefix+t];!0===e.arw._skip?e.arw._skip=!1:"none"!=e.polygon.style.display&&(e.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",e.obj.className=e.obj.renderAs,e.arw.className=String(e.obj.renderAs).replace("btn","arw"),i.anyUsed="none",window.dhx4.zim.clear(e.polygon._idd),e.polygon.style.display="none",e.polygon._ie6cover&&(e.polygon._ie6cover.style.display="none"),"dhx_terrace"==i.conf.skin&&i._improveTerraceButtonSelect(e.id,!0))}})},window.dhx4.isIPad?document.addEventListener("touchstart",this._doOnClick,!1):void 0!==window.addEventListener?window.addEventListener("mousedown",this._doOnClick,!1):document.body.attachEvent("onmousedown",this._doOnClick),null!=this.conf.icons_size_autoload&&(this.setIconSize(this.conf.icons_size_autoload),this.conf.icons_size_autoload=null),null!=this.conf.items_autoload?(this.loadStruct(this.conf.items_autoload,this.conf.onload_autoload),this.conf.items_autoload=null):null!=this.conf.json_autoload?(this.loadStruct(this.conf.json_autoload,this.conf.onload_autoload),this.conf.json_autoload=null):null!=this.conf.xml_autoload&&(this.loadStruct(this.conf.xml_autoload,this.conf.onload_autoload),this.conf.xml_autoload=null),this.conf.align_autostart!=this.conf.align&&(this.setAlign(this.conf.align_autostart),this.conf.align_autostart=null),"function"==typeof this.conf.auto_onclick?this.attachEvent("onClick",this.conf.auto_onclick):"string"==typeof this.conf.auto_onclick&&"function"==typeof window[this.conf.auto_onclick]&&this.attachEvent("onClick",window[this.conf.auto_onclick]),this}var globalActiveDHTMLGridObject;function dhtmlxArray(t){return dhtmlx.extend(t||new Array,dhtmlxArray._master)}function dhtmlXGridObject(id){if(dhtmlxEvent.initTouch&&dhtmlxEvent.initTouch(),_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}id?"object"==typeof id?(this.entBox=id,this.entBox.id||(this.entBox.id="cgrid2_"+this.uid())):this.entBox=document.getElementById(id):(this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid()),this.entBox.innerHTML="",dhx4._eventable(this);var self=this;this._wcorr=0,this.fontWidth=7,this.cell=null,this.row=null,this.iconURL="",this.editor=null,this._f2kE=!0,this._dclE=!0,this.combos=new Array(0),this.defVal=new Array(0),this.rowsAr={},this.rowsBuffer=dhtmlxArray(),this.rowsCol=dhtmlxArray(),this._data_cache={},this._ecache={},this._ud_enabled=!0,this.xmlLoader=this.doLoadDetails,this._maskArr=[],this.selectedRows=dhtmlxArray(),this.UserData={},this._sizeFix=this._borderFix=0,this.entBox.className+=" gridbox",this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,null).width:this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%",this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%",this.entBox.style.cursor="default",this.entBox.onselectstart=function(){return!1};var t_creator=function(t){var e=document.createElement("TABLE");return e.cellSpacing=e.cellPadding=0,e.style.cssText="width:100%;table-layout:fixed;",e.className=t.substr(2),e};return this.obj=t_creator("c_obj"),this.hdr=t_creator("c_hdr"),this.hdr.style.marginRight="20px",this.hdr.style.paddingRight="20px",this.objBox=document.createElement("DIV"),this.objBox.style.width="100%",this.objBox.style.overflow="auto",this.objBox.appendChild(this.obj),this.objBox.className="objbox",dhtmlx.$customScroll&&dhtmlx.CustomScroll.enable(this),this.hdrBox=document.createElement("DIV"),this.hdrBox.style.width="100%",this.hdrBox.style.height="25px",this.hdrBox.style.overflow="hidden",this.hdrBox.className="xhdr",this.preloadImagesAr=new Array(0),this.sortImg=document.createElement("DIV"),this.sortImg.style.display="none",this.hdrBox.appendChild(this.sortImg),this.hdrBox.appendChild(this.hdr),this.hdrBox.style.position="relative",this.entBox.appendChild(this.hdrBox),this.entBox.appendChild(this.objBox),this.entBox.grid=this,this.objBox.grid=this,this.hdrBox.grid=this,this.obj.grid=this,this.hdr.grid=this,this.cellWidthPX=[],this.cellWidthPC=[],this.cellWidthType=this.entBox.cellwidthtype||"px",this.delim=this.entBox.delimiter||",",this._csvDelim=",",this.hdrLabels=[],this.columnIds=[],this.columnColor=[],this._hrrar=[],this.cellType=dhtmlxArray(),this.cellAlign=[],this.initCellWidth=[],this.fldSort=[],this._srdh=_isIE&&"BackCompat"!=document.compatMode?22:20,this.imgURL=window.dhx_globalImgPath||"",this.isActive=!1,this.isEditable=!0,this.useImagesInHeader=!1,this.pagingOn=!1,this.rowsBufferOutSize=0,dhtmlxEvent(window,"unload",function(){try{self.destructor&&self.destructor()}catch(t){}}),this.setSkin=function(t){this._srdh=window.dhx4.readFromCss("dhxgrid_rh_"+t)+4,this.skin_name=t,this._imgURL&&this.setImagePath(this._imgURL);var e=this.entBox.className.split(" gridbox")[0];switch(this.entBox.className=e+" gridbox gridbox_"+t+(_isIE?" isIE":" isModern"),this.skin_h_correction=0,this.enableAlterCss("ev_"+t,"odd_"+t,this.isTreeGrid()),this._fixAlterCss(),t){case"dhx_terrace":this._srdh=33,this.forceDivInHeader=!0;break;case"dhx_skyblue":case"dhx_web":this.forceDivInHeader=!0}if(_isIE&&this.hdr){var i=this.hdr.parentNode;i.removeChild(this.hdr),i.appendChild(this.hdr)}this.setSizes()},_isIE&&this.preventIECaching(!0),window.dhtmlDragAndDropObject&&(this.dragger=new dhtmlDragAndDropObject),this._doOnScroll=function(t,e){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]),this.doOnScroll(t,e)},this.doOnScroll=function(t,e){this.hdrBox.scrollLeft=this.objBox.scrollLeft,this.ftr&&(this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft),e||this._srnd&&(this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){self._update_srnd_view&&self._update_srnd_view()},100))},this.attachToObject=function(t){t.appendChild(this.globalBox?this.globalBox:this.entBox),this.setSizes()},this.init=function(t){if(this.isTreeGrid()&&!this._h2&&(this._h2=this._createHierarchy(),this._fake&&!this._realfake&&(this._fake._h2=this._h2),this._tgc={imgURL:null}),this._hstyles){if(this.skin_name||this.setSkin(window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxgrid")||"dhx_skyblue"),this.editStop(),this.lastClicked=null,this.resized=null,this.fldSorted=this.r_fldSorted=null,this.cellWidthPX=[],this.cellWidthPC=[],this.hdr.rows.length>0){var e=this.xmlFileUrl;this.clearAll(!0),this.xmlFileUrl=e}for(var i=this.hdr.insertRow(0),s=0;s<this.hdrLabels.length;s++)i.appendChild(document.createElement("TH")),i.childNodes[s]._cellIndex=s,i.childNodes[s].style.height="0px";_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?i.style.position="absolute":i.style.height="auto",(i=this.hdr.insertRow(_isKHTML?2:1))._childIndexes=new Array;var n=0;for(s=0;s<this.hdrLabels.length;s++)i._childIndexes[s]=s-n,this.hdrLabels[s]!=this.splitSign||0==s?(i.insertCell(s-n),i.childNodes[s-n]._cellIndex=s,i.childNodes[s-n]._cellIndexS=s,this.setColumnLabel(s,this.hdrLabels[s])):(_isKHTML&&i.insertCell(s-n),i.cells[s-n-1].colSpan=(i.cells[s-n-1].colSpan||1)+1,i.childNodes[s-n-1]._cellIndex++,n++,i._childIndexes[s]=s-n);0==n&&(i._childIndexes=null),this._cCount=this.hdrLabels.length,_isIE&&window.setTimeout(function(){self.setSizes&&self.setSizes()},1),this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var l=this.obj.firstChild;if(!l.firstChild){l.appendChild(document.createElement("TR")),l=l.firstChild,_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?l.style.position="absolute":l.style.height="auto";for(s=0;s<this.hdrLabels.length;s++)l.appendChild(document.createElement("TH")),l.childNodes[s].style.height="0px"}this._c_order=null,1!=this.multiLine&&(this.obj.className+=" row20px"),this.sortImg.style.position="absolute",this.sortImg.style.display="none",this.sortImg.className="dhxgrid_sort_desc",this.sortImg.defLeft=0,this.noHeader?this.hdrBox.style.display="none":this.noHeader=!1,this._ivizcol&&this.setColHidden(),this.attachHeader(),this.attachHeader(0,0,"_aFoot"),this.setSizes(),t&&this.parseXML(),this.obj.scrollTop=0,this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this),this._initDrF&&this._initD(),dhx4.callEvent("onGridCreated",[this])}},this.setColumnSizes=function(t){for(var e=0,i=[],s=0,n=0;n<this._cCount;n++)if("*"!=this.initCellWidth[n]||this._hrrar[n]){if("%"==this.cellWidthType){void 0===this.cellWidthPC[n]&&(this.cellWidthPC[n]=this.initCellWidth[n]);var l=t*this.cellWidthPC[n]/100||0;s>.5&&(l++,s--);s=s+l-(this.cellWidthPX[n]=Math.floor(l))}else void 0===this.cellWidthPX[n]&&(this.cellWidthPX[n]=this.initCellWidth[n]);this._hrrar[n]||(e+=1*this.cellWidthPX[n])}else this._awdth=!1,i.push(n);if(i.length){var o=Math.floor((t-e)/i.length);o<0&&(o=1);for(n=0;n<i.length;n++){var r=Math.max(this._drsclmW&&this._drsclmW[i[n]]||0,o);this.cellWidthPX[i[n]]=r,e+=r}if(t>e){var a=i[i.length-1];this.cellWidthPX[a]=this.cellWidthPX[a]+(t-e),e=t}this._setAutoResize()}return this.obj.style.width=e+"px",this.hdr.style.width=e+"px",this.ftr&&(this.ftr.style.width=e+"px"),this.chngCellWidth(),e},this.setSizes=function(){if(this.hdr.rows[0]){var t=this.quirks=_isIE&&"BackCompat"==document.compatMode,e=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){var i=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var s=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x,this.entBox.style.width=Math.max(0,this.globalBox.clientWidth+(t?2*i:0)-this._fake.entBox.clientWidth)+"px",s!=this.globalBox.clientWidth&&this._fake._correctSplit(this._fake.entBox.clientWidth)}this._delta_y&&!this._realfake&&(this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(t?2*i:0)+"px")}else this._delta_x&&(this.entBox.parentNode&&"TD"==this.entBox.parentNode.tagName?(this.entBox.style.width="1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-2*e+"px"):this.entBox.style.width=this._delta_x),this._delta_y&&(this.entBox.style.height=this._delta_y);if(window.clearTimeout(this._sizeTime),this.entBox.offsetWidth||this.globalBox&&this.globalBox.offsetWidth){var n=this._wthB||!this.entBox.cmp&&!this._delta_x||0!=(this.skin_name||"").indexOf("dhx")||t?0:2,l=this._wthB||!this.entBox.cmp&&!this._delta_y||0!=(this.skin_name||"").indexOf("dhx")||t?0:2;this._sizeFix&&(n-=this._sizeFix,l-=this._sizeFix);var o=!this.parentGrid&&this.objBox.scrollHeight>this.objBox.offsetHeight,r=dhtmlx.$customScroll?0:18,a=this.entBox.clientWidth-(this.skin_h_correction||0)*(t?0:1)-n,h=this.entBox.clientWidth-(this.skin_h_correction||0)-n,d=this.entBox.clientHeight-l,c=this.setColumnSizes(h-(o?r:0)-(this._correction_x||0)),_=!this.parentGrid&&(this.objBox.scrollWidth>this.objBox.offsetWidth||"scroll"==this.objBox.style.overflowX),u=this.hdr.clientHeight,f=this.ftr?this.ftr.clientHeight:0,p=a,m=d-u-f;if(this._awdth&&this._awdth[0]&&99999==this._awdth[1]&&(_=0),this._ahgr&&(m=this._ahgrMA?this.entBox.parentNode.clientHeight-u-f:this.obj.offsetHeight+(_?r:0)+(this._correction_y||0),this._ahgrM&&(m=this._ahgrF?Math.min(this._ahgrM,m+u+f)-u-f:Math.min(this._ahgrM,m)),o&&m>=this.obj.scrollHeight+(_?r:0)&&(o=!1,this.setColumnSizes(h-(this._correction_x||0)))),this._awdth&&this._awdth[0]){"%"==this.cellWidthType&&(this.cellWidthType="px"),this._fake&&(c+=this._fake.entBox.clientWidth);p=Math.min(Math.max(c+(o?r:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this.objBox.style.overflowX=!o&&this.objBox.scrollWidth<=p?"hidden":"auto",this._fake&&(p-=this._fake.entBox.clientWidth)}m=Math.max(0,m),this._ff_size_delta=.1==this._ff_size_delta?.2:.1,_isFF||(this._ff_size_delta=0),this.dontSetSizes||(this.entBox.style.width=Math.max(0,p+(t?2:0)*e+this._ff_size_delta)+"px",this.entBox.style.height=m+(t?2:0)*e+u+f+"px"),this.objBox.style.height=m+(t&&!o?2:0)*e+"px",this.hdrBox.style.height=u+"px",m!=d&&this.doOnScroll(0,!this._srnd);var g=this["setSizes_"+this.skin_name];g&&g.call(this),this.setSortImgPos(),u!=this.hdr.clientHeight&&this._ahgr&&this.setSizes(),this.callEvent("onSetSizes",[])}else this._sizeTime=window.setTimeout(function(){self.setSizes&&self.setSizes()},250)}},this.chngCellWidth=function(){_isOpera&&this.ftr&&(this.ftr.width=this.objBox.scrollWidth+"px");for(var t=this._cCount,e=0;e<t;e++)this.hdr.rows[0].cells[e].style.width=this.cellWidthPX[e]+"px",this.obj.rows[0].childNodes[e].style.width=this.cellWidthPX[e]+"px",this.ftr&&(this.ftr.rows[0].cells[e].style.width=this.cellWidthPX[e]+"px")},this.setDelimiter=function(t){this.delim=t},this.setInitWidthsP=function(t){this.cellWidthType="%",this.initCellWidth=t.split(this.delim.replace(/px/gi,"")),arguments[1]||this._setAutoResize()},this._setAutoResize=function(){if(!this._realfake){window;var t=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(t._resize_timer),t._setAutoResize&&(t._resize_timer=window.setTimeout(function(){t.setSizes&&t.setSizes(),t._fake&&t._fake._correctSplit()},100))})}},this.setInitWidths=function(t){if(this.cellWidthType="px",this.initCellWidth=t.split(this.delim),_isFF)for(var e=0;e<this.initCellWidth.length;e++)"*"!=this.initCellWidth[e]&&(this.initCellWidth[e]=parseInt(this.initCellWidth[e]))},this.enableMultiline=function(t){this.multiLine=dhx4.s2b(t)},this.enableMultiselect=function(t){this.selMultiRows=dhx4.s2b(t)},this.setImagePath=function(t){t=t.replace(/imgs\/dhxgrid_[a-z]*\/$/,"imgs/"),this._imgURL=t,this.imgURL=t+"dhxgrid_"+(this.skin_name||"dhx_skyblue").replace("dhx_","")+"/",this.iconTree=this.imgURL+"tree/"},this.setImagesPath=this.setImagePath,this.setIconPath=function(t){this.iconURL=t},this.setIconsPath=this.setIconPath,this.changeCursorState=function(t){var e=t.target||t.srcElement;if("TD"!=e.tagName&&(e=this.getFirstParentOfType(e,"TD")),e){if("TD"==e.tagName&&this._drsclmn&&!this._drsclmn[e._cellIndex])return e.style.cursor="default";var i=(t.layerX||0)+(_isIE||"DIV"!=t.target.tagName?0:e.offsetLeft);e.offsetWidth-(t.offsetX||-1*(parseInt(this.getPosition(e,this.hdrBox))-i))<(_isOpera?20:10)?e.style.cursor="E-resize":e.style.cursor="default",_isOpera&&(this.hdrBox.scrollLeft=this.objBox.scrollLeft)}},this.startColResize=function(t){this.resized&&this.stopColResize(),this.resized=null;var e=t.target||t.srcElement;"TD"!=e.tagName&&(e=this.getFirstParentOfType(e,"TD"));var i=t.clientX,s=this.hdr.offsetWidth,n=parseInt(e.offsetWidth);if("TD"==e.tagName&&"default"!=e.style.cursor){if(this._drsclmn&&!this._drsclmn[e._cellIndex])return;self._old_d_mm=document.body.onmousemove,self._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(t){self&&self.doColResize(t||window.event,e,n,i,s)},document.body.onmouseup=function(){self&&self.stopColResize()}}},this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"",document.body.onmouseup=self._old_d_mu||"",this.setSizes(),this.doOnScroll(0,1),this.callEvent("onResizeEnd",[this])},this.doColResize=function(t,e,i,s,n){e.style.cursor="E-resize",this.resized=e;var l=i+(t.clientX-s);t.clientX;if(this.callEvent("onResize",[e._cellIndex,l,this])){_isIE&&(this.objBox.scrollLeft=this.hdrBox.scrollLeft);var o=!1;if(e.colSpan>1){for(var r=new Array,a=0;a<e.colSpan;a++)r[a]=Math.round(l*this.hdr.rows[0].childNodes[e._cellIndexS+a].offsetWidth/e.offsetWidth);for(a=0;a<e.colSpan;a++)o=this._setColumnSizeR(e._cellIndexS+1*a,r[a])}else o=this._setColumnSizeR(e._cellIndex,l);return this.doOnScroll(0,1),this.setSizes(),this._fake&&this._awdth&&this._fake._correctSplit(),o}},this._setColumnSizeR=function(t,e){if(!(e>(this._drsclmW&&!this._notresize&&this._drsclmW[t]||10)))return!1;if(this.obj.rows[0].childNodes[t].style.width=e+"px",this.hdr.rows[0].childNodes[t].style.width=e+"px",this.ftr&&(this.ftr.rows[0].childNodes[t].style.width=e+"px"),"px"==this.cellWidthType)this.cellWidthPX[t]=e;else{var i=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(i-=17);var s=Math.round(e/i*100);this.cellWidthPC[t]=s}"none"!=this.sortImg.style.display&&this.setSortImgPos()},this.setSortImgState=function(t,e,i,s){if(i=(i||"asc").toLowerCase(),!dhx4.s2b(t))return this.sortImg.style.display="none",void(this.fldSorted=this.r_fldSorted=null);this.sortImg.className="asc"==i?"dhxgrid_sort_asc":"dhxgrid_sort_desc",this.sortImg.style.display="",this.fldSorted=this.hdr.rows[0].childNodes[e];var n=this.hdr.rows[s||1];if(n){for(var l=0;l<n.childNodes.length;l++)if(n.childNodes[l]._cellIndexS==e)return this.r_fldSorted=n.childNodes[l],this.setSortImgPos();return this.setSortImgState(t,e,i,(s||1)+1)}},this.setSortImgPos=function(t,e,i,s){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:t]){if(!s)if(t)s=this.hdr.rows[i||0].cells[t];else var s=this.r_fldSorted;if(null!=s){var n=this.getPosition(s,this.hdrBox),l=s.offsetWidth;this.sortImg.style.left=Number(n[0]+l-13)+"px",this.sortImg.defLeft=parseInt(this.sortImg.style.left),this.sortImg.style.top=Number(n[1]+5)+"px",this.useImagesInHeader||e||(this.sortImg.style.display="inline"),this.sortImg.style.left=this.sortImg.defLeft+"px"}}},this.setActive=function(t){if(0==arguments.length)t=!0;1==t?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))},this._doClick=function(t){var e=0,i=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(i&&i.parentNode&&i.parentNode.idd){if(this.markedCells){var s=0;return(t.shiftKey||t.metaKey)&&(s=1),t.ctrlKey&&(s=2),this.doMark(i,s),!0}return 0!=this.selMultiRows&&(t.shiftKey&&null!=this.row&&this.selectedRows.length&&(e=1),(t.ctrlKey||t.metaKey)&&(e=2)),this.doClick(i,!0,e,!1)}},this._doContClick=function(t){var e=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(!e||void 0===e.parentNode.idd)return this.callEvent("onEmptyClick",[t]),!0;if(2==t.button||_isMacOS&&t.ctrlKey){if(!this.callEvent("onRightClick",[e.parentNode.idd,e._cellIndex,t])){var i=function(t){return(t||event).cancelBubble=!0,!1};return(t.srcElement||t.target).oncontextmenu=i,i(t)}if(this._ctmndx){if(!this.callEvent("onBeforeContextMenu",[e.parentNode.idd,e._cellIndex,this]))return!0;if(_isIE&&(t.srcElement.oncontextmenu=function(){return event.cancelBubble=!0,!1}),this._ctmndx.showContextMenu){var s=window.document.documentElement,n=window.document.body,l=new Array(s.scrollLeft||n.scrollLeft,s.scrollTop||n.scrollTop);if(_isIE)var o=t.clientX+l[0],r=t.clientY+l[1];else o=t.pageX,r=t.pageY;this._ctmndx.showContextMenu(o-1,r-1),this.contextID=this._ctmndx.contextMenuZoneId=e.parentNode.idd+"_"+e._cellIndex,this._ctmndx._skip_hide=!0}else e.contextMenuId=e.parentNode.idd+"_"+e._cellIndex,e.contextMenu=this._ctmndx,e.a=this._ctmndx._contextStart,e.a(e,t),e.a=null;return t.cancelBubble=!0,!1}}else this._ctmndx&&(this._ctmndx.hideContextMenu?this._ctmndx.hideContextMenu():this._ctmndx._contextEnd());return!0},this.doClick=function(t,e,i,s){this.selMultiRows||(i=0);var n=this.row?this.row.idd:0;if(this.setActive(!0),i||(i=0),null!=this.cell&&(this.cell.className=this.cell.className.replace(/cellselected/g,"")),"TD"==t.tagName){if(this.checkEvent("onSelectStateChanged"))var l=this.getSelectedId();var o=this.row;if(1==i){var r=this.rowsCol._dhx_find(t.parentNode),a=this.rowsCol._dhx_find(this.lastClicked);if(r>a)var h=a,d=r;else h=r,d=a;for(var c=0;c<this.rowsCol.length;c++)if(c>=h&&c<=d){if(!this.rowsCol[c]||this.rowsCol[c]._sRow)return this.clearSelection(),this.doClick(t,e,0,s);-1==this.rowsCol[c].className.indexOf("rowselected")&&this.callEvent("onBeforeSelect",[this.rowsCol[c].idd,n,t._cellIndex])&&(this.rowsCol[c].className+=" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[c])}}else if(2==i&&-1!=t.parentNode.className.indexOf("rowselected")){t.parentNode.className=t.parentNode.className.replace(/rowselected/g,""),this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(t.parentNode));var _=!0;s=!1}if(this.editStop(),void 0===t.parentNode.idd)return!0;if(_||t.parentNode._sRow||(this.callEvent("onBeforeSelect",[t.parentNode.idd,n,t._cellIndex])?this.getSelectedRowId()!=t.parentNode.idd?(0==i&&this.clearSelection(),this.cell=t,o==t.parentNode&&this._chRRS&&(e=!1),this.row=t.parentNode,this.row.className+=" rowselected",-1==this.selectedRows._dhx_find(this.row)&&(this.selectedRows[this.selectedRows.length]=this.row)):(this.cell=t,this.row=t.parentNode):e=!1),this.cell&&-1!=this.cell.parentNode.className.indexOf("rowselected")&&(this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"),1!=i&&!this.row)return;this.lastClicked=t.parentNode;var u=this.row.idd,f=this.cell;if(e&&void 0!==u&&f&&!_?self.onRowSelectTime=setTimeout(function(){self.callEvent&&self.callEvent("onRowSelect",[u,f._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[u]),this.checkEvent("onSelectStateChanged")){var p=this.getSelectedId();l!=p&&this.callEvent("onSelectStateChanged",[p,l])}if(_)return!1}this.isActive=!0,!1!==s&&this.cell&&this.cell.parentNode.idd&&this.moveToVisible(this.cell)},this.selectAll=function(){this.clearSelection();var t=this.rowsBuffer;this.pagingOn&&(t=this.rowsCol);for(var e=0;e<t.length;e++)this.render_row(e).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(t)),this.selectedRows.length&&(this.row=this.selectedRows[0],this.cell=this.row.cells[0]),this._fake&&!this._realfake&&this._fake.selectAll()},this.selectCell=function(t,e,i,s,n,l){if(i||(i=!1),"object"!=typeof t&&(t=this.render_row(t)),!t||-1==t)return null;if(t._childIndexes)var o=t.childNodes[t._childIndexes[e]];else o=t.childNodes[e];o||(o=t.childNodes[0]),this.markedCells?this.doMark(o,s?2:0):s?this.doClick(o,i,3,l):this.doClick(o,i,0,l),n&&this.editCell()},this.moveToVisible=function(t,e){if(this.pagingOn){var i=Math.floor(this.getRowIndex(t.parentNode.idd)/this.rowsBufferOutSize)+1;i!=this.currentPage&&this.changePage(i)}try{if(t.offsetHeight){var s=t.offsetLeft+t.offsetWidth+20,n=0;s>this.objBox.offsetWidth+this.objBox.scrollLeft?t.offsetLeft>this.objBox.scrollLeft&&(n=t.offsetLeft-(this.objBox.offsetWidth-t.offsetWidth)+5):t.offsetLeft<this.objBox.scrollLeft&&(s-=2*t.offsetWidth/3)<this.objBox.scrollLeft&&(n=t.offsetLeft-5),n&&!e&&(this.objBox.scrollLeft=n)}if(t.offsetHeight)s=t.offsetTop;else{var l=this._realfake?this._fake.rowsAr[t.parentNode.idd]:t.parentNode;s=this.rowsBuffer._dhx_find(l)*this._srdh}if(s+t.offsetHeight+38>this.objBox.offsetHeight+this.objBox.scrollTop)var o=s;else if(s<this.objBox.scrollTop)o=s-5;o&&(this.objBox.scrollTop=o)}catch(t){}},this.editCell=function(){if(!this.editor||this.cell!=this.editor.cell){if(this.editStop(),1!=this.isEditable||!this.cell)return!1;var t=this.cell;if(t.parentNode._locked)return!1;if(this.editor=this.cells4(t),null!=this.editor){if(this.editor.isDisabled())return this.editor=null,!1;0!=this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),t.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}},this.editStop=function(t){if(_isOpera&&this._Opera_stop){if(1*this._Opera_stop+50>(new Date).valueOf())return;this._Opera_stop=null}if(this.editor&&null!=this.editor){if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),t){var e=this.editor.val;return this.editor.detach(),this.editor.setValue(e),this.editor=null,void this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,e])}this.editor.detach()&&(this.cell.wasChanged=!0);var i=this.editor;if(null==i)return;this.editor=null;var s=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,i.getValue(),i.val]);"string"==typeof s||"number"==typeof s?i[i.setImage?"setLabel":"setValue"](s):s||i[i.setImage?"setLabel":"setValue"](i.val),this._ahgr&&this.multiLine&&this.setSizes()}},this._nextRowCell=function(t,e,i){return(t=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(t),e))?t.childNodes[t._childIndexes?t._childIndexes[i]:i]:null},this._getNextCell=function(t,e,i){var s=(t=t||this.cell).parentNode;this._tabOrder?void 0!==(i=this._tabOrder[t._cellIndex])&&(t=i<0?this._nextRowCell(s,e,Math.abs(i)-1):s.childNodes[i]):(i=t._cellIndex+e)>=0&&i<this._cCount?(s._childIndexes&&(i=s._childIndexes[t._cellIndex]+e),t=s.childNodes[i]):t=this._nextRowCell(s,e,1==e?0:this._cCount-1);return t?"none"==t.style.display||this.smartTabOrder&&this.cells(t.parentNode.idd,t._cellIndex).isDisabled()?this._getNextCell(t,e):t:(1==e&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),-1==e&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null)},this._nextRow=function(t,e){var i=this.render_row(t+e);return i&&-1!=i?i&&"none"==i.style.display?this._nextRow(t+e,e):i:null},this.scrollPage=function(t){if(this.rowsBuffer.length){var e=this._realfake?this._fake:this,i=Math.floor((e._r_select||this.getRowIndex(this.row.idd)||0)+t*this.objBox.offsetHeight/(this._srdh||20));i<0&&(i=0),i>=this.rowsBuffer.length&&(i=this.rowsBuffer.length-1),this._srnd&&!this.rowsBuffer[i]?(this.objBox.scrollTop+=Math.floor(t*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20),this._fake&&(this._fake.objBox.scrollTop=this.objBox.scrollTop),e._r_select=i):(this.selectCell(i,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd),this.multiLine||this._srnd||this._realfake||(this.objBox.scrollTop=this.getRowById(this.getRowId(i)).offsetTop,this._fake&&(this._fake.objBox.scrollTop=this.objBox.scrollTop)),e._r_select=null)}},this.doKey=function(t){if(!t)return!0;if((t.target||t.srcElement).value!==window.undefined){var e=t.target||t.srcElement;if("dhxcombo_input"!=e.className&&(!e.parentNode||-1==e.parentNode.className.indexOf("editable")))return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(t);if(0==this.isActive)return!0;if(this._htkebl)return!0;if(!this.callEvent("onKeyPress",[t.keyCode,t.ctrlKey,t.shiftKey,t]))return!1;var i="k"+t.keyCode+"_"+(t.ctrlKey?1:0)+"_"+(t.shiftKey?1:0);if(this.cell){if(this._key_events[i])return!1===this._key_events[i].call(this)||(t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1);this._key_events.k_other&&this._key_events.k_other.call(this,t)}return!0},this.selectRow=function(t,e,i,s){"object"!=typeof t&&(t=this.render_row(t)),this.selectCell(t,0,e,i,!1,s)},this.wasDblClicked=function(t){var e=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(e){var i=e.parentNode.idd;return this.callEvent("onRowDblClicked",[i,e._cellIndex,t])}},this._onHeaderClick=function(t,e){var i=this.grid;if(e=e||i.getFirstParentOfType(_isIE?event.srcElement:t.target,"TD"),null==this.grid.resized){if(!this.grid.callEvent("onHeaderClick",[e._cellIndexS,t||window.event]))return!1;i.sortField(e._cellIndexS,!1,e)}this.grid.resized=null},this.deleteSelectedRows=function(){var t=this.selectedRows.length;if(0!=t){var e=this.selectedRows;this.selectedRows=dhtmlxArray();for(var i=t-1;i>=0;i--){var s=e[i];if(this.deleteRow(s.idd,s)){if(s==this.row)var n=i}else this.selectedRows[this.selectedRows.length]=s}if(n)try{n+1>this.rowsCol.length&&n--,this.selectCell(n,0,!0)}catch(t){this.row=null,this.cell=null}}},this.getSelectedRowId=function(){for(var t=new Array(0),e={},i=0;i<this.selectedRows.length;i++){var s=this.selectedRows[i].idd;e[s]||(t[t.length]=s,e[s]=!0)}return 0==t.length?null:t.join(this.delim)},this.getSelectedCellIndex=function(){return null!=this.cell?this.cell._cellIndex:-1},this.getColWidth=function(t){return parseInt(this.cellWidthPX[t])},this.setColWidth=function(t,e){if("*"==e)this.initCellWidth[t]="*";else{if(this._hrrar[t])return;"px"==this.cellWidthType?this.cellWidthPX[t]=parseInt(e):this.cellWidthPC[t]=parseInt(e)}this.setSizes()},this.getRowIndex=function(t){for(var e=0;e<this.rowsBuffer.length;e++)if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==t)return e;return-1},this.getRowId=function(t){return this.rowsBuffer[t]?this.rowsBuffer[t].idd:this.undefined},this.setRowId=function(t,e){this.changeRowId(this.getRowId(t),e)},this.changeRowId=function(t,e){if(t!=e){var i=this.rowsAr[t];i.idd=e,this.UserData[t]&&(this.UserData[e]=this.UserData[t],this.UserData[t]=null),this._h2&&this._h2.get[t]&&(this._h2.get[e]=this._h2.get[t],this._h2.get[e].id=e,delete this._h2.get[t]),this.rowsAr[t]=null,this.rowsAr[e]=i;for(var s=0;s<i.childNodes.length;s++)i.childNodes[s]._code&&(i.childNodes[s]._code=this._compileSCL(i.childNodes[s]._val,i.childNodes[s]));if(this._mat_links&&this._mat_links[t]){var n=this._mat_links[t];for(var l in delete this._mat_links[t],n)for(s=0;s<n[l].length;s++)this._compileSCL(n[l][s].original,n[l][s])}this.callEvent("onRowIdChange",[t,e])}},this.setColumnIds=function(t){this.columnIds=t.split(this.delim)},this.setColumnId=function(t,e){this.columnIds[t]=e},this.getColIndexById=function(t){for(var e=0;e<this.columnIds.length;e++)if(this.columnIds[e]==t)return e},this.getColumnId=function(t){return this.columnIds[t]},this.getColumnLabel=function(t,e,i){for(var s=(i||this.hdr).rows[(e||0)+1],n=0;n<s.cells.length;n++)if(s.cells[n]._cellIndexS==t)return _isIE?s.cells[n].innerText:s.cells[n].textContent;return""},this.getColLabel=this.getColumnLabel,this.getFooterLabel=function(t,e){return this.getColumnLabel(t,e,this.ftr)},this.setRowTextBold=function(t){var e=this.getRowById(t);e&&(e.style.fontWeight="bold")},this.setRowTextStyle=function(t,e){var i=this.getRowById(t);if(i)for(var s=0;s<i.childNodes.length;s++){var n=i.childNodes[s]._attrs.style||"";this._hrrar&&this._hrrar[s]&&(n="display:none;"),_isIE,i.childNodes[s].style.cssText=n+"width:"+i.childNodes[s].style.width+";"+e}},this.setRowColor=function(t,e){for(var i=this.getRowById(t),s=0;s<i.childNodes.length;s++)i.childNodes[s].bgColor=e},this.setCellTextStyle=function(t,e,i){var s=this.getRowById(t);if(s){var n=s.childNodes[s._childIndexes?s._childIndexes[e]:e];if(n){var l="";this._hrrar&&this._hrrar[e]&&(l="display:none;"),_isIE,n.style.cssText=l+"width:"+n.style.width+";"+i}}},this.setRowTextNormal=function(t){var e=this.getRowById(t);e&&(e.style.fontWeight="normal")},this.doesRowExist=function(t){return null!=this.getRowById(t)},this.getColumnsNum=function(){return this._cCount},this.moveRowUp=function(t){var e=this.getRowById(t);if(this.isTreeGrid())return this.moveRowUDTG(t,-1);var i=this.rowsCol._dhx_find(e);if(e.previousSibling&&0!=i){e.parentNode.insertBefore(e,e.previousSibling),this.rowsCol._dhx_swapItems(i,i-1),this.setSizes();var s=this.rowsBuffer._dhx_find(e);this.rowsBuffer._dhx_swapItems(s,s-1),this._cssEven&&this._fixAlterCss(i-1)}},this.moveRowDown=function(t){var e=this.getRowById(t);if(this.isTreeGrid())return this.moveRowUDTG(t,1);var i=this.rowsCol._dhx_find(e);if(e.nextSibling){this.rowsCol._dhx_swapItems(i,i+1),e.nextSibling.nextSibling?e.parentNode.insertBefore(e,e.nextSibling.nextSibling):e.parentNode.appendChild(e),this.setSizes();var s=this.rowsBuffer._dhx_find(e);this.rowsBuffer._dhx_swapItems(s,s+1),this._cssEven&&this._fixAlterCss(i)}},this.getCombo=function(t){return this.combos[t]||(this.combos[t]=new dhtmlXGridComboObject),this.combos[t]},this.setUserData=function(t,e,i){t||(t="gridglobaluserdata"),this.UserData[t]||(this.UserData[t]=new Hashtable),this.UserData[t].put(e,i)},this.getUserData=function(t,e){t||(t="gridglobaluserdata"),this.getRowById(t);var i=this.UserData[t];return i?i.get(e):""},this.setEditable=function(t){this.isEditable=dhx4.s2b(t)},this.selectRowById=function(t,e,i,s){s||(s=!1),this.selectCell(this.getRowById(t),0,s,e,!1,i)},this.clearSelection=function(){this.editStop();for(var t=0;t<this.selectedRows.length;t++){var e=this.rowsAr[this.selectedRows[t].idd];e&&(e.className=e.className.replace(/rowselected/g,""))}this.selectedRows=dhtmlxArray(),this.row=null,null!=this.cell&&(this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null),this.callEvent("onSelectionCleared",[])},this.copyRowContent=function(t,e){var i=this.getRowById(t);if(this.isTreeGrid())this._copyTreeGridRowContent(i,t,e);else for(var s=0;s<i.cells.length;s++)this.cells(e,s).setValue(this.cells(t,s).getValue());_isIE||(this.getRowById(t).cells[0].height=i.cells[0].offsetHeight)},this.setFooterLabel=function(t,e,i){return this.setColumnLabel(t,e,i,this.ftr)},this.setColumnLabel=function(t,e,i,s){var n=(s||this.hdr).rows[i||1],l=n._childIndexes?n._childIndexes[t]:t;if(n.cells[l]){if(this.useImagesInHeader){n.cells[l].style.textAlign="left",n.cells[l].innerHTML="<img src='"+e+"'>";var o=new Image;o.src=""+e.replace(/(\.[a-z]+)/,".des$1"),this.preloadImagesAr[this.preloadImagesAr.length]=o;var r=new Image;r.src=""+e.replace(/(\.[a-z]+)/,".asc$1"),this.preloadImagesAr[this.preloadImagesAr.length]=r}else{var a="<div class='hdrcell'>";if(-1!=e.indexOf("img:[")){var h=e.replace(/.*\[([^>]+)\].*/,"$1");e=e.substr(e.indexOf("]")+1,e.length),a+="<img width='18px' height='18px' align='absmiddle' src='"+h+"' hspace='2'>"}a+=e,a+="</div>",n.cells[l].innerHTML=a,this._hstyles[l]&&(n.cells[l].style.cssText=this._hstyles[l])}if(-1!=(e||"").indexOf("#")){var d=e.match(/(^|{)#([^}]+)(}|$)/);if(d){var c="_in_header_"+d[2];this[c]&&this[c](this.forceDivInHeader?n.cells[l].firstChild:n.cells[l],l,e.split(d[0]))}}}},this.setColLabel=function(t,e,i,s){return this.setColumnLabel(t,e,(i||0)+1,s)},this.clearAll=function(t){if(this.obj.rows[0]){this._h2&&(this._h2=this._createHierarchy(),this._fake&&(this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2)),this.limit=this._limitC=0,this.editStop(!0),this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dload&&(this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0);this.rowsCol.length;for(var e=this.obj.rows.length-1;e>0;e--){(i=this.obj.rows[e]).parentNode.removeChild(i)}if(t){this._master_row=null,this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(e=this.hdr.rows.length-1;e>=0;e--){var i;(i=this.hdr.rows[e]).parentNode.removeChild(i)}this.ftr&&(this.ftr.parentNode.removeChild(this.ftr),this.ftr=null),this._aHead=this.ftr=this.cellWidth=this._aFoot=null,this.cellType=dhtmlxArray(),this._hrrar=[],this.columnIds=[],this.combos=[],this._strangeParams=[],this.defVal=[],this._ivizcol=null}this.row=null,this.cell=null,this.rowsCol=dhtmlxArray(),this.rowsAr={},this._RaSeCol=[],this.rowsBuffer=dhtmlxArray(),this.UserData=[],this.selectedRows=dhtmlxArray(),(this.pagingOn||this._srnd)&&(this.xmlFileUrl=""),this.pagingOn&&this.changePage(1),this._contextCallTimer&&window.clearTimeout(this._contextCallTimer),this._sst&&this.enableStableSorting(!0),this._fillers=this.undefined,this.setSortImgState(!1),this.setSizes(),this.callEvent("onClearAll",[])}},this.sortField=function(t,e,i){if(0==this.getRowsNum())return!1;var s=this.hdr.rows[0].cells[t];if(s&&"TH"==s.tagName&&this.fldSort.length-1>=s._cellIndex&&"na"!=this.fldSort[s._cellIndex]){var n=this.getSortingState(),l=n[0]==t&&"asc"==n[1]?"des":"asc";if(!this.callEvent("onBeforeSorting",[t,this.fldSort[t],l]))return;if(this.sortImg.className="dhxgrid_sort_"+("asc"==l?"asc":"desc"),this.useImagesInHeader){var o=this.hdr.rows[1].cells[s._cellIndex].firstChild;if(null!=this.fldSorted){var r=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;r.src=r.src.replace(/(\.asc\.)|(\.des\.)/,".")}o.src=o.src.replace(/(\.[a-z]+)$/,"."+l+"$1")}this.sortRows(s._cellIndex,this.fldSort[s._cellIndex],l),this.fldSorted=s,this.r_fldSorted=i;var a=this.hdr.rows[1];(a=i.parentNode)._childIndexes?a._childIndexes[s._cellIndex]:s._cellIndex;this.setSortImgPos(!1,!1,!1,i)}},this.setCustomSorting=function(func,col){this._customSorts||(this._customSorts=new Array),this._customSorts[col]="string"==typeof func?eval(func):func,this.fldSort[col]="cus"},this.enableHeaderImages=function(t){this.useImagesInHeader=t},this.setHeader=function(t,e,i){if("object"!=typeof t)var s=this._eSplit(t);else s=[].concat(t);for(var n=new Array(0),l=new dhtmlxArray(0),o=new Array(0),r=new Array(0),a=new Array(0),h=0;h<s.length;h++)n[n.length]=Math.round(100/s.length),l[l.length]="ed",o[o.length]="left",r[r.length]="middle",a[a.length]="na";this.splitSign=e||"#cspan",this.hdrLabels=s,this.cellWidth=n,this.initCellWidth.length||this.setInitWidthsP(n.join(this.delim),!0),this.cellType=l,this.cellAlign=o,this.cellVAlign=r,this.fldSort=a,this._hstyles=i||[]},this._eSplit=function(t){if(![].push)return t.split(this.delim);var e="r"+(new Date).valueOf(),i=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(t||"").replace(RegExp(i,"g"),e).replace(RegExp("\\\\"+e,"g"),this.delim).split(e)},this.getColType=function(t){return this.cellType[t]},this.getColTypeById=function(t){return this.cellType[this.getColIndexById(t)]},this.setColTypes=function(t){this.cellType=dhtmlxArray(t.split(this.delim)),this._strangeParams=new Array;for(var e=0;e<this.cellType.length;e++){if(-1!=this.cellType[e].indexOf("[")){var i=this.cellType[e].split(/[\[\]]+/g);this.cellType[e]=i[0],this.defVal[e]=i[1],0==i[1].indexOf("=")&&(this.cellType[e]="math",this._strangeParams[e]=i[0])}window["eXcell_"+this.cellType[e]]||dhx4.callEvent("onConfigurationError",["Incorrect cell type: "+this.cellType[e],this,this.cellType[e]])}},this.setColSorting=function(t){this.fldSort=t.split(this.delim);for(var e={str:1,int:1,date:1},i=0;i<this.fldSort.length;i++)e[this.fldSort[i]]||"function"!=typeof window[this.fldSort[i]]||(this._customSorts||(this._customSorts=new Array),this._customSorts[i]=window[this.fldSort[i]],this.fldSort[i]="cus")},this.setColAlign=function(t){this.cellAlign=t.split(this.delim);for(var e=0;e<this.cellAlign.length;e++)this.cellAlign[e]=this.cellAlign[e]._dhx_trim()},this.setColVAlign=function(t){this.cellVAlign=t.split(this.delim)},this.setNoHeader=function(t){this.noHeader=dhx4.s2b(t)},this.showRow=function(t){this.getRowById(t),this._h2&&this.openItem(this._h2.get[t].parent.id);for(var e=this.getRowById(t).childNodes[0];e&&"none"==e.style.display;)e=e.nextSibling;e&&this.moveToVisible(e,!0)},this.setStyle=function(t,e,i,s){this.ssModifier=[t,e,i,i,s];for(var n=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],l=0;!_isIE;){try{document.styleSheets[l].cssRules.length}catch(t){l++;continue}break}for(var o=0;o<n.length;o++)this.ssModifier[o]&&(_isIE?document.styleSheets[0].addRule(n[o],this.ssModifier[o]):document.styleSheets[l].insertRule(n[o]+" { "+this.ssModifier[o]+" }",document.styleSheets[l].cssRules.length))},this.setColumnColor=function(t){this.columnColor=t.split(this.delim)},this.enableAlterCss=function(t,e,i,s){(t||e)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss(),this._fake&&this._fake._fixAlterCss()}),this._cssSP=i,this._cssSU=s,this._cssEven=t,this._cssUnEven=e},this._fixAlterCss=function(t){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(t);if(this._cssEven||this._cssUnEven)for(var e=t=t||0,i=t;i<this.rowsCol.length;i++)if(this.rowsCol[i]&&"none"!=this.rowsCol[i].style.display){if(this.rowsCol[i]._cntr){e=1;continue}-1!=this.rowsCol[i].className.indexOf("rowselected")?this.rowsCol[i].className=e%2==1?this._cssUnEven+" rowselected "+(this.rowsCol[i]._css||""):this._cssEven+" rowselected "+(this.rowsCol[i]._css||""):this.rowsCol[i].className=e%2==1?this._cssUnEven+" "+(this.rowsCol[i]._css||""):this._cssEven+" "+(this.rowsCol[i]._css||""),e++}},this.clearChangedState=function(){for(var t=0;t<this.rowsCol.length;t++){var e=this.rowsCol[t];if(e&&e.childNodes)for(var i=e.childNodes.length,s=0;s<i;s++)e.childNodes[s].wasChanged=!1}},this.getChangedRows=function(t){var e=new Array;return this.forEachRow(function(i){var s=this.rowsAr[i];if("TR"==s.tagName){var n=s.childNodes.length;if(t&&s._added)e[e.length]=s.idd;else for(var l=0;l<n;l++)if(s.childNodes[l].wasChanged){e[e.length]=s.idd;break}}}),e.join(this.delim)},this._sUDa=!1,this._sAll=!1,this.setSerializationLevel=function(t,e,i,s,n,l){this._sUDa=t,this._sAll=e,this._sConfig=i,this._chAttr=s,this._onlChAttr=n,this._asCDATA=l},this.setSerializableColumns=function(t){if(t){this._srClmn=(t||"").split(",");for(var e=0;e<this._srClmn.length;e++)this._srClmn[e]=dhx4.s2b(this._srClmn[e])}else this._srClmn=null},this._serialise=function(t,e,i){this.editStop();var s=[],n="</"+this.xml.s_row+">";if(this.isTreeGrid())this._h2.forEachChildF(0,function(t){var e=this._serializeRow(this.render_row_tree(-1,t.id));return s.push(e),!!e},this,function(){s.push(n)});else for(var l=0;l<this.rowsBuffer.length;l++)if(this.rowsBuffer[l]){if(this._chAttr&&this.rowsBuffer[l]._locator)continue;var o=this._serializeRow(this.render_row(l));s.push(o),o&&s.push(n)}return[s.join("")]},this._serializeRow=function(t,e){var i=[],s=this.xml.row_attrs,n=this.xml.cell_attrs;if(i.push("<"+this.xml.s_row),i.push(" id='"+t.idd+"'"),this._sAll&&-1!=this.selectedRows._dhx_find(t)&&i.push(" selected='1'"),this._h2&&"minus"==this._h2.get[t.idd].state&&i.push(" open='1'"),s.length)for(e=0;e<s.length;e++)i.push(" "+s[e]+"='"+t._attrs[s[e]]+"'");if(i.push(">"),this._sUDa&&this.UserData[t.idd]){keysAr=this.UserData[t.idd].getKeys();for(var l=0;l<keysAr.length;l++)i.push("<userdata name='"+keysAr[l]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[t.idd].get(keysAr[l])+(this._asCDATA?"]]>":"")+"</userdata>")}for(var o=!1,r=0;r<this._cCount;r++)if(!this._srClmn||this._srClmn[r]){var a=this.cells3(t,r);if(i.push("<cell"),n.length)for(e=0;e<n.length;e++)i.push(" "+n[e]+"='"+a.cell._attrs[n[e]]+"'");if(zxVal=a[this._agetm](),this._asCDATA&&(zxVal="<![CDATA["+zxVal+"]]>"),this._ecspn&&a.cell.colSpan&&a.cell.colSpan>1&&i.push(' colspan="'+a.cell.colSpan+'" '),this._chAttr?a.wasChanged()&&(i.push(' changed="1"'),o=!0):this._onlChAttr&&a.wasChanged()&&(o=!0),this._sAll&&"tree"==this.cellType[r]?i.push((this._h2?" image='"+this._h2.get[t.idd].image+"'":"")+">"+zxVal+"</cell>"):i.push(">"+zxVal+"</cell>"),this._ecspn&&a.cell.colSpan)for(var h=0;h<a.cell.colSpan-1;h++)i.push("<cell/>"),r++}return!this._onlChAttr||o||t._added?i.join(""):""},this._serialiseConfig=function(){for(var t="<head>",e=0;e<this.hdr.rows[0].cells.length;e++)if(!this._srClmn||this._srClmn[e]){var i=this.fldSort[e];"cus"==i&&(i=(i=this._customSorts[e].toString()).replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")),t+="<column width='"+this.getColWidth(e)+"' align='"+this.cellAlign[e]+"' type='"+this.cellType[e]+"' sort='"+(i||"na")+"' color='"+this.columnColor[e]+"'"+(this.columnIds[e]?" id='"+this.columnIds[e]+"'":"")+">",this._asCDATA?t+="<![CDATA["+this.getColumnLabel(e)+"]]>":t+=this.getColumnLabel(e);var s=this.getCombo(e);if(s)for(var n=0;n<s.keys.length;n++)t+="<option value='"+s.keys[n]+"'>"+s.values[n]+"</option>";t+="</column>"}return t+"</head>"},this.serialize=function(){var t='<?xml version="1.0"?><rows>';if(this._mathSerialization?this._agetm="getMathValue":this._agetm="getValue",this._sUDa&&this.UserData.gridglobaluserdata)for(var e=this.UserData.gridglobaluserdata.getKeys(),i=0;i<e.length;i++)t+="<userdata name='"+e[i]+"'>"+this.UserData.gridglobaluserdata.get(e[i])+"</userdata>";return this._sConfig&&(t+=this._serialiseConfig()),t+=this._serialise(),t+="</rows>"},this.getPosition=function(t,e){if(!e){var i=dhx4.getOffset(t);return[i.left,i.top]}e=e||document.body;for(var s=t,n=0,l=0;s&&s!=e;)n+=s.offsetLeft-s.scrollLeft,l+=s.offsetTop-s.scrollTop,s=s.offsetParent;return e==document.body&&(_isIE?(l+=document.body.offsetTop||document.documentElement.offsetTop,n+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(n+=document.body.offsetLeft,l+=document.body.offsetTop)),[n,l]},this.getFirstParentOfType=function(t,e){for(;t&&t.tagName!=e&&"BODY"!=t.tagName;)t=t.parentNode;return t},this.objBox.onscroll=function(){this.grid._doOnScroll()},this.hdrBox.onscroll=function(){this._try_header_sync||(this._try_header_sync=!0,Math.abs(this.grid.objBox.scrollLeft-this.scrollLeft)>1&&(this.grid.objBox.scrollLeft=this.scrollLeft),this._try_header_sync=!1)},(!_isOpera||_OperaRv>8.5)&&(this.hdr.onmousemove=function(t){this.grid.changeCursorState(t||window.event)},this.hdr.onmousedown=function(t){return this.grid.startColResize(t||window.event)}),this.obj.onmousemove=this._drawTooltip,this.objBox.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onclick=function(t){!1!==this.grid._doClick(t||window.event)&&(this.grid._sclE?this.grid.editCell(t||window.event):this.grid.editStop()),(t||event).cancelBubble=!0},_isMacOS?this.entBox.oncontextmenu=function(t){t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1;var e=this.grid;return e._realfake&&(e=e._fake),e._doContClick(t||window.event)}:(this.entBox.onmousedown=function(t){return this.grid._doContClick(t||window.event)},this.entBox.oncontextmenu=function(t){return this.grid._ctmndx&&((t||event).cancelBubble=!0),!this.grid._ctmndx}),this.obj.ondblclick=function(t){if(!this.grid.wasDblClicked(t||window.event))return!1;this.grid._dclE&&(this.grid.getFirstParentOfType(_isIE?event.srcElement:t.target,"TR")==this.grid.row&&this.grid.editCell(t||window.event));return(t||event).cancelBubble=!0,!_isOpera&&void 0},this.hdr.onclick=this._onHeaderClick,this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])},this.hdr.ondblclick=this._onHeaderDblClick,document.body._dhtmlxgrid_onkeydown||(dhtmlxEvent(document,"keydown",function(t){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(t||window.event)}),document.body._dhtmlxgrid_onkeydown=!0),dhtmlxEvent(document.body,"click",function(){self.editStop&&self.editStop(),self.isActive&&self.setActive(!1)}),-1!=this.entBox.style.height.toString().indexOf("%")&&(this._delta_y=this.entBox.style.height),-1!=this.entBox.style.width.toString().indexOf("%")&&(this._delta_x=this.entBox.style.width),(this._delta_x||this._delta_y)&&this._setAutoResize(),this.setColHidden=this.setColumnsVisibility,this.enableCollSpan=this.enableColSpan,this.setMultiselect=this.enableMultiselect,this.setMultiLine=this.enableMultiline,this.deleteSelectedItem=this.deleteSelectedRows,this.getSelectedId=this.getSelectedRowId,this.getHeaderCol=this.getColumnLabel,this.isItemExists=this.doesRowExist,this.getColumnCount=this.getColumnsNum,this.setSelectedRow=this.selectRowById,this.setHeaderCol=this.setColumnLabel,this.preventIECashing=this.preventIECaching,this.enableAutoHeigth=this.enableAutoHeight,this.getUID=this.uid,dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path),dhtmlx.skin&&this.setSkin(dhtmlx.skin),this}function dhtmlXGridCellObject(t){this.destructor=function(){return this.cell.obj=null,this.cell=null,this.grid=null,this.base=null,null},this.cell=t,this.getValue=function(){return this.cell.firstChild&&"TEXTAREA"==this.cell.firstChild.tagName?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()},this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()},this.getFont=function(){return arOut=new Array(3),this.cell.style.fontFamily&&(arOut[0]=this.cell.style.fontFamily),"bold"!=this.cell.style.fontWeight&&"bold"!=this.cell.parentNode.style.fontWeight||(arOut[1]="bold"),"italic"!=this.cell.style.fontStyle&&"italic"!=this.cell.parentNode.style.fontWeight||(arOut[1]+="italic"),this.cell.style.fontSize?arOut[2]=this.cell.style.fontSize:arOut[2]="",arOut.join("-")},this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"},this.getBgColor=function(){return this.cell.bgColor?this.cell.bgColor:"#FFFFFF"},this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:this.cell.style.textAlign?this.cell.style.textAlign:"left"},this.getWidth=function(){return this.cell.scrollWidth},this.setFont=function(t){fntAr=t.split("-"),this.cell.style.fontFamily=fntAr[0],this.cell.style.fontSize=fntAr[fntAr.length-1],3==fntAr.length&&(/bold/.test(fntAr[1])&&(this.cell.style.fontWeight="bold"),/italic/.test(fntAr[1])&&(this.cell.style.fontStyle="italic"),/underline/.test(fntAr[1])&&(this.cell.style.textDecoration="underline"))},this.setTextColor=function(t){this.cell.style.color=t},this.setBgColor=function(t){""==t&&(t=null),this.cell.style.background=t},this.setHorAlign=function(t){1==t.length?this.cell.style.textAlign="c"==t?"center":"l"==t?"left":"right":this.cell.style.textAlign=t},this.wasChanged=function(){return!!this.cell.wasChanged},this.isCheckbox=function(){var t=this.cell.firstChild;return!(!t||"INPUT"!=t.tagName)&&(type=t.type,"radio"==type||"checkbox"==type)},this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked},this.isDisabled=function(){return this.cell._disabled},this.setChecked=function(t){this.isCheckbox()&&("true"!=t&&1!=t&&(t=!1),this.cell.firstChild.checked=t)},this.setDisabled=function(t){"true"!=t&&1!=t&&(t=!1),this.isCheckbox()&&(this.cell.firstChild.disabled=t,this.disabledF&&this.disabledF(t)),this.cell._disabled=t}}function eXcell(){this.obj=null,this.val=null,this.changeState=function(){return!1},this.edit=function(){this.val=this.getValue()},this.detach=function(){return!1},this.getPosition=function(t){for(var e=t,i=0,s=0;"BODY"!=e.tagName;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;return new Array(i,s)}}function eXcell_ed(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){this.cell.atag=this.grid.multiLine?"TEXTAREA":"INPUT",this.val=this.getValue(),this.obj=document.createElement(this.cell.atag),this.obj.setAttribute("autocomplete","off"),this.obj.style.height=this.cell.offsetHeight-(_isIE,4)+"px",this.obj.className="dhx_combo_edit",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.val,this.cell.innerHTML="",this.cell.appendChild(this.obj),this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0},_isIE&&(this.obj.focus(),this.obj.blur()),this.obj.focus()},this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()},this.detach=function(){return this.setValue(this.obj.value),this.val!=this.getValue()}}function eXcell_edtxt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)}}function eXcell_edn(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&"TEXTAREA"==this.cell.firstChild.tagName?this.cell.firstChild.value:this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)},this.detach=function(){var t=this.obj.value;return this.setValue(t),this.val!=this.getValue()}}function eXcell_ch(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.disabledF=function(t){this.cell.innerHTML=1==t||1==t?this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")},this.changeState=function(t){!0!==t||this.grid.isActive||(null!=window.globalActiveDHTMLGridObject&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0)),!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"},this.isCheckbox=function(){return!0},this.isChecked=function(){return"1"==this.getValue()},this.setChecked=function(t){this.setValue(t.toString())},this.detach=function(){return this.val!=this.getValue()},this.edit=null}function eXcell_ra(t){this.base=eXcell_ch,this.base(t),this.grid=t.parentNode.grid,this.disabledF=function(t){this.cell.innerHTML=1==t||1==t?this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")},this.changeState=function(t){!1===t&&1==this.getValue()||!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(0!=this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.edit=null}function eXcell_txt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_textarea",this.obj.onclick=function(t){(t||event).cancelBubble=!0};var t=this.grid.getPosition(this.cell);if(this.obj.value=this.val,this.obj.style.display="",this.obj.style.textAlign=this.cell.style.textAlign,document.body.appendChild(this.obj),_isOpera&&(this.obj.onkeypress=function(t){if(9==t.keyCode)return!1}),this.obj.onkeydown=function(t){var e=t||event;if(9==e.keyCode)return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:e.keyCode,shiftKey:e.shiftKey,srcElement:"0"}),!1},this.obj.style.left=t[0]+"px",this.obj.style.top=t[1]+this.cell.offsetHeight+"px",this.cell.offsetWidth<200)var e=200;else e=this.cell.offsetWidth;this.obj.style.width=e+16+"px",_isIE&&(this.obj.select(),this.obj.value=this.obj.value),this.obj.focus()},this.detach=function(){var t;return t=this.obj.value,this.cell._clearCell=""==t,this.setValue(t),document.body.removeChild(this.obj),this.obj=null,this.val!=this.getValue()},this.getValue=function(){return this.obj?this.obj.value:this.cell._clearCell?"":void 0!==this.cell._brval?this.cell._brval:this.grid.multiLine?this.cell._brval||this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}function eXcell_txttxt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&"TEXTAREA"==this.cell.firstChild.tagName?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){this.cell._brval=t,t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)}}function eXcell_co(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0),this.shiftNext=function(){var t=this.list.options[this.list.selectedIndex+1];return t&&(t.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text,!0},this.shiftPrev=function(){if(0!=this.list.selectedIndex){var t=this.list.options[this.list.selectedIndex-1];t&&(t.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text}return!0},this.edit=function(){this.val=this.getValue(),this.text=this.getText()._dhx_trim();var t=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_combo_edit",this.obj.style.height=this.cell.offsetHeight-(_isIE,4)+"px",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.text,this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0};var e=this;this.obj.onkeyup=function(t){var i=(t||event).keyCode;if(38!=i&&40!=i&&9!=i)for(var s=this.readonly?String.fromCharCode(i):this.value,n=e.list.options,l=0;l<n.length;l++)if(0==n[l].text.indexOf(s))return n[l].selected=!0},this.list=document.createElement("SELECT"),this.list.className="dhx_combo_select",this.list.style.width=this.cell.offsetWidth+"px",this.list.style.left=t[0]+"px",this.list.style.top=t[1]+this.cell.offsetHeight+"px",this.list.onclick=function(t){var i=t||window.event,s=i.target||i.srcElement;"OPTION"==s.tagName&&(s=s.parentNode),e.editable=!1,e.grid.editStop(),i.cancelBubble=!0};for(var i=this.combo.getKeys(),s=!1,n=0,l=0;l<i.length;l++){var o=this.combo.get(i[l]);this.list.options[this.list.options.length]=new Option(o,i[l]),i[l]==this.val&&(n=this.list.options.length-1,s=!0)}0==s&&(this.list.options[this.list.options.length]=new Option(this.text,null===this.val?"":this.val),n=this.list.options.length-1),document.body.appendChild(this.list),this.list.size="6",this.cstate=1,this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px"),this.cell.appendChild(this.obj),this.list.options[n].selected=!0,this.editable&&(this.obj.focus(),this.obj.focus()),this.editable||(this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(t){if(t=t||window.event,e.grid.setActive(!0),t.keyCode<30)return e.grid.doKey({target:e.cell,keyCode:t.keyCode,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey})})},this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value},this.detach=function(){if(this.val!=this.getValue()&&(this.cell.wasChanged=!0),null!=this.list.parentNode)if(this.editable){var t=this.list.options[this.list.selectedIndex];if(t&&t.text==this.obj.value)this.setValue(this.list.value);else{var e=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),i=e.values._dhx_find(this.obj.value);-1!=i?this.setValue(e.keys[i]):this.setValue(this.cell.combo_value=this.obj.value)}}else this.setValue(this.list.value);return this.list.parentNode&&this.list.parentNode.removeChild(this.list),this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_coro(t){this.base=eXcell_co,this.base(t),this.editable=!1}function eXcell_cotxt(t){this.base=eXcell_co,this.base(t)}function eXcell_corotxt(t){this.base=eXcell_co,this.base(t),this.editable=!1}function eXcell_cp(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("SPAN"),this.obj.style.border="1px solid black",this.obj.style.position="absolute";var t=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj),document.body.appendChild(this.obj),this.obj.style.left=t[0]+"px",this.obj.style.zIndex=1e3,this.obj.style.top=t[1]+this.cell.offsetHeight+"px"},this.toolDNum=function(t){return 1==t.length&&(t="0"+t),t},this.colorPanel=function(t,e){var i=document.createElement("TABLE");e.appendChild(i),i.cellSpacing=0,i.editor_obj=this,i.style.cursor="default",i.onclick=function(t){var e=t||window.event,i=e.target||e.srcElement,s=i.parentNode.parentNode.parentNode.editor_obj;s.setValue(i._bg),s.grid.editStop()};for(var s=256/t,n=0;n<=256/s;n++)for(var l=i.insertRow(n),o=0;o<=256/s;o++)for(var r=0;r<=256/s;r++){R=new Number(s*n)-(0==n?0:1),G=new Number(s*o)-(0==o?0:1),B=new Number(s*r)-(0==r?0:1);var a=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+this.toolDNum(B.toString(16)),h=l.insertCell(o);h.width="10px",h.innerHTML="&nbsp;",h.title=a.toUpperCase(),h.style.backgroundColor="#"+a,h._bg="#"+a,null!=this.val&&"#"+a.toUpperCase()==this.val.toUpperCase()&&(h.style.border="2px solid white")}},this.getValue=function(){return this.cell.firstChild._bg||""},this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))},this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))},this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))},this.detach=function(){return null!=this.obj.offsetParent&&document.body.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_img(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.getValue=function(){if("IMG"==this.cell.firstChild.tagName)return this.cell.firstChild.src+(null!=this.cell.titFl?"^"+this.cell._brval:"");if("A"==this.cell.firstChild.tagName){var t=this.cell.firstChild.firstChild.src+(null!=this.cell.titFl?"^"+this.cell._brval:"");return t+="^"+this.cell.lnk,this.cell.trg&&(t+="^"+this.cell.trg),t}},this.isDisabled=function(){return!0}}function eXcell_price(t){this.base=eXcell_ed,this.base(t),this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}function eXcell_dyn(t){this.base=eXcell_ed,this.base(t),this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}function eXcell_ro(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}function eXcell_ron(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}function eXcell_rotxt(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.setValue=function(t){t?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)},this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}function dhtmlXGridComboObject(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this.put=function(t,e){for(var i=0;i<this.keys.length;i++)if(this.keys[i]==t)return this.values[i]=e,!0;this.values[this.values.length]=e,this.keys[this.keys.length]=t},this.get=function(t){for(var e=0;e<this.keys.length;e++)if(this.keys[e]==t)return this.values[e];return null},this.clear=function(){this.keys=new dhtmlxArray,this.values=new dhtmlxArray},this.remove=function(t){for(var e=0;e<this.keys.length;e++)if(this.keys[e]==t)return this.keys._dhx_removeAt(e),this.values._dhx_removeAt(e),!0},this.size=function(){for(var t=0,e=0;e<this.keys.length;e++)null!=this.keys[e]&&t++;return t},this.getKeys=function(){for(var t=new Array(0),e=0;e<this.keys.length;e++)null!=this.keys[e]&&(t[t.length]=this.keys[e]);return t},this.save=function(){this._save=new Array;for(var t=0;t<this.keys.length;t++)this._save[t]=[this.keys[t],this.values[t]]},this.restore=function(){if(this._save){this.keys[t]=new Array,this.values[t]=new Array;for(var t=0;t<this._save.length;t++)this.keys[t]=this._save[t][0],this.values[t]=this._save[t][1]}},this}function Hashtable(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this}function dragContext(t,e,i,s,n,l,o,r,a,h){return this.source=t||"grid",this.target=e||"grid",this.mode=i||"move",this.dropmode=s||"child",this.sid=n||0,this.tid=l,this.sobj=o||null,this.tobj=r||null,this.sExtra=a||null,this.tExtra=h||null,this}function eXcell_stree(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_trees)return;if(this._sub=this.grid._sub_trees[t._cellIndex],!this._sub)return;this._sub=this._sub[0]}this.getValue=function(){return this.cell._val},this.setValue=function(t){this.cell._val=t,t=this._sub.getItemText(this.cell._val),this.setCValue(t||"&nbsp;",t)},this.edit=function(){this._sub.parentObject.style.display="block";var t=this.grid.getPosition(this.cell);this._sub.parentObject.style.top=t[1]+"px",this._sub.parentObject.style.left=t[0]+"px",this._sub.parentObject.style.position="absolute";var e=this.grid.editStop;this.grid.editStop=function(){},this.grid.editStop=e},this.detach=function(){if(this._sub.parentObject.style.display="none",null!=this.grid._sub_id){var t=this.cell._val;return this.setValue(this._sub.getSelectedItemId()),this.grid._sub_id=null,this.cell._val!=t}}}function eXcell_link(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.isDisabled=function(){return!0},this.edit=function(){},this.getValue=function(){if(this.cell.firstChild.getAttribute){var t=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(t?"^"+t:"")}return""},this.setValue=function(t){if("number"!=typeof t&&(!t||""==t.toString()._dhx_trim()))return this.setCValue("&nbsp;",e),this.cell._clearCell=!0;var e=t.split("^");1==e.length?e[1]="":e.length>1&&(e[1]="href='"+e[1]+"'",3==e.length?e[1]+=" target='"+e[2]+"'":e[1]+=" target='_blank'"),this.setCValue("<a "+e[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+e[0]+"</a>",e)}}function eXcell_grid(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_grids)return;if(this._sub=this.grid._sub_grids[t._cellIndex],!this._sub)return;this._sindex=this._sub[1],this._sub=this._sub[0]}this.getValue=function(){return this.cell.val},this.setValue=function(t){this.cell.val=t,this._sub.getRowById(t)&&(t=(t=this._sub.cells(t,this._sindex))?t.getValue():""),this.setCValue(t||"&nbsp;",t)},this.edit=function(){this.val=this.cell.val,this._sub.entBox.style.display="block";var t=this.grid.getPosition(this.cell);this._sub.entBox.style.top=t[1]+"px",this._sub.entBox.style.left=t[0]+"px",this._sub.entBox.style.position="absolute",this._sub.setSizes();var e=this.grid.editStop;this.grid.editStop=function(){},this._sub.getRowById(this.cell.val)&&this._sub.setSelectedRow(this.cell.val),this._sub.setActive(!0),this.grid.editStop=e},this.detach=function(){var t=this.cell.val;return this._sub.entBox.style.display="none",null!==this._sub.getSelectedId()&&(this.setValue(this._sub.getSelectedId()),this.grid.setActive(!0),this.cell.val!=t)}}function eXcell_dhxCalendar(t){if(t&&(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var e=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[e]);var i=this.grid;e.attachEvent("onClick",function(){return this._last_operation_calendar=!0,window.setTimeout(function(){i.editStop()},1),!0});dhtmlxEvent(e.base,"click",function(t){(t||event).cancelBubble=!0}),e=null}}function eXcell_dhxCalendarA(t){if(t&&(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var e=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[e]);var i=this.grid;e.attachEvent("onClick",function(){return this._last_operation_calendar=!0,window.setTimeout(function(){i.editStop()},1),!0});dhtmlxEvent(e.base,"click",function(t){(t||event).cancelBubble=!0})}}function eXcell_cntr(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=!0,this.grid._h2&&this.grid.attachEvent("onOpenEn",function(e){this.resetCounter(t._cellIndex)});var e=function(){var e=this;return window.setTimeout(function(){e.resetCounter&&(e._fake&&!e._realfake&&t._cellIndex<e._fake._cCount?e._fake.resetCounter(t._cellIndex):e.resetCounter(t._cellIndex))},1),!0};this.grid.attachEvent("onBeforeSorting",e),this.grid.attachEvent("onFilterEnd",e)}this.edit=function(){},this.getValue=function(){return this.cell.innerHTML},this.setValue=function(t){this.cell.style.paddingRight="2px";var e=this.cell;window.setTimeout(function(){if(e.parentNode){var t=e.parentNode.rowIndex;(e.parentNode.grid.currentPage||t<0||e.parentNode.grid._srnd)&&(t=e.parentNode.grid.rowsBuffer._dhx_find(e.parentNode)+1),t<=0||(e.innerHTML=t,e.parentNode.grid._fake&&e._cellIndex<e.parentNode.grid._fake._cCount&&e.parentNode.grid._fake.rowsAr[e.parentNode.idd]&&e.parentNode.grid._fake.cells(e.parentNode.idd,e._cellIndex).setCValue(t),e=null)}},100)}}function eXcell_acheck(t){try{this.cell=t,this.grid=this.cell.parentNode.grid,this.cell.obj=this}catch(t){}this.changeState=function(){!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(0!=this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("<checkbox state='false'>"):this.setValue("<checkbox state='true'>"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.getValue=function(){try{return this.cell.chstate.toString()}catch(t){return null}},this.isCheckbox=function(){return!0},this.isChecked=function(){return"1"==this.getValue()},this.setChecked=function(t){this.setValue(t.toString())},this.detach=function(){return this.val!=this.getValue()},this.drawCurrentState=function(){return 1==this.cell.chstate?"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>":"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>"}}function eXcell_context(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_context)return;if(this._sub=this.grid._sub_context[t._cellIndex],!this._sub)return;this._sindex=this._sub[1],this._sub=this._sub[0]}this.getValue=function(){return _isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){this.cell._val=t;var e=this._sub.itemPull[this._sub.idPrefix+this.cell._val];t=e?e.title:t,this.setCValue(t||"&nbsp;",t)},this.edit=function(){var t=this.grid.getPosition(this.cell);this._sub.showContextMenu(t[0]+this.cell.offsetWidth,t[1]);var e=this.grid.editStop;this.grid.editStop=function(){},this.grid.editStop=e},this.detach=function(){if(null!=this.grid._sub_id){var t=this.cell._val;return this.setValue(this.grid._sub_id),this.grid._sub_id=null,this.cell._val!=t}this._sub.hideContextMenu()}}function dhtmlXGridFromTable(obj,init){"object"!=typeof obj&&(obj=document.getElementById(obj));var w=document.createElement("DIV");w.setAttribute("width",obj.getAttribute("gridWidth")||(obj.offsetWidth?obj.offsetWidth+"px":0)||(window.getComputedStyle?window.getComputedStyle(obj,null).width:obj.currentStyle?obj.currentStyle.width:0)),w.setAttribute("height",obj.getAttribute("gridHeight")||(obj.offsetHeight?obj.offsetHeight+"px":0)||(window.getComputedStyle?window.getComputedStyle(obj,null).height:obj.currentStyle?obj.currentStyle.height:0)),w.className=obj.className,obj.className="",obj.id&&(w.id=obj.id);var mr=obj,drag=obj.getAttribute("dragAndDrop");mr.parentNode.insertBefore(w,mr);var f=mr.getAttribute("name")||"name_"+(new Date).valueOf(),windowf=new dhtmlXGridObject(w);window[f]=windowf;var acs=mr.getAttribute("onbeforeinit"),acs2=mr.getAttribute("oninit");acs&&eval(acs),windowf.setImagePath(windowf.imgURL||mr.getAttribute("imgpath")||mr.getAttribute("image_path")||"");var skin=mr.getAttribute("skin");skin&&windowf.setSkin(skin),init&&init(windowf);for(var hrow=mr.rows[0],za="",zb="",zc="",zd="",ze="",i=0;i<hrow.cells.length;i++){za+=(za?",":"")+hrow.cells[i].innerHTML;var width=hrow.cells[i].getAttribute("width")||hrow.cells[i].offsetWidth||(window.getComputedStyle?window.getComputedStyle(hrow.cells[i],null).width:hrow.cells[i].currentStyle?hrow.cells[i].currentStyle.width:0);zb+=(zb?",":"")+("*"==width?width:parseInt(width)),zc+=(zc?",":"")+(hrow.cells[i].getAttribute("align")||"left"),zd+=(zd?",":"")+(hrow.cells[i].getAttribute("type")||"ed"),ze+=(ze?",":"")+(hrow.cells[i].getAttribute("sort")||"str");var f_a=hrow.cells[i].getAttribute("format");f_a&&(-1!=hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar")?windowf._dtmask=f_a:windowf.setNumberFormat(f_a,i))}windowf.setHeader(za),windowf.setInitWidths(zb),windowf.setColAlign(zc),windowf.setColTypes(zd),windowf.setColSorting(ze),"auto"==obj.getAttribute("gridHeight")&&windowf.enableAutoHeigth(!0),obj.getAttribute("multiline")&&windowf.enableMultiline(!0);var lmn=mr.getAttribute("lightnavigation");lmn&&windowf.enableLightMouseNavigation(lmn);var evr=mr.getAttribute("evenrow"),uevr=mr.getAttribute("unevenrow");return(evr||uevr)&&windowf.enableAlterCss(evr,uevr),drag&&windowf.enableDragAndDrop(!0),windowf.init(),obj.getAttribute("split")&&windowf.splitAt(obj.getAttribute("split")),windowf._process_inner_html(mr,1),acs2&&eval(acs2),obj.parentNode&&obj.parentNode.removeChild&&obj.parentNode.removeChild(obj),windowf}function eXcell_math(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){this.grid.editor=new eXcell_ed(this.cell),this.grid.editor.fix_self=!0,this.grid.editor.getValue=this.cell.original?function(){return this.cell.original}:this.getValue,this.grid.editor.setValue=this.setValue,this.grid.editor.edit()},this.isDisabled=function(){return!this.grid._mathEdit},this.setValue=function(t){t=this.grid._compileSCL(t,this.cell,this.fix_self),this.grid._strangeParams[this.cell._cellIndex]?this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).setValue(t):(this.setCValue(t),this.cell._clearCell=!1)},this.getValue=function(){return this.grid._strangeParams[this.cell._cellIndex]?this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).getValue():this.cell.innerHTML}}function eXcell_time(t){this.base=eXcell_ed,this.base(t),this.getValue=function(){return this.cell.innerHTML.toString()},this.setValue=function(t){var e=new RegExp(" ","i");if(""==(t=t.replace(e,":")))t="00:00";else{e=new RegExp("[a-zA-Z]","i");if(t.match(e))t="00:00";else{e=new RegExp("[0-9]+[\\.\\/;\\-,_\\]\\[\\?\\: ][0-9]+","i");if(-1!=t.search(e)){e=new RegExp("[\\./\\;\\-\\,\\_\\]\\[ \\?]","i");t=t.replace(e,":")}else{e=new RegExp("[^0-9]","i");if(res1=t.search(e),t.match(e))t="00:00";else if(1==t.length)t="00:0"+t;else if(parseInt(t)<60)t="00:"+t;else if(t.length<5){var i=parseInt(t);i-=60*(s=Math.floor(i/60));var s=s.toString();for(i=i.toString();s.length<2;)s="0"+s;for(;i.length<2;)i="0"+i;t=s+":"+i}}}}this.cell.innerHTML=t}}function eXcell_sub_row(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")},this._setState=function(t,e){(e||this.cell).innerHTML="<img src='"+this.grid.imgURL+t+"' width='18' height='18' />",(e||this.cell).firstChild.onclick=this.grid._expandMonolite},this.open=function(){this.cell.firstChild.onclick(null,!0)},this.close=function(){this.cell.firstChild.onclick(null,!1,!0)},this.isOpen=function(){return!!this.cell.parentNode._expanded},this.setValue=function(t){t&&this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",t),this._setState(t?"plus.gif":"blank.gif")},this.setContent=function(t){this.cell.parentNode._expanded?(this.cell.parentNode._expanded.innerHTML=t,this.resize()):(this.cell._previous_content=null,this.setValue(t),this.cell._sub_row_type=null)},this.resize=function(){this.grid._detectHeight(this.cell.parentNode._expanded,this.cell,this.cell.parentNode._expanded.scrollHeight)},this.isDisabled=function(){return!0},this.getTitle=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")?"click to expand|collapse":""}}function eXcell_sub_row_ajax(t){this.base=eXcell_sub_row,this.base(t),this.setValue=function(t){t&&this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",t),this.cell._sub_row_type="ajax",this.cell._previous_content=null,this._setState(t?"plus.gif":"blank.gif")}}function eXcell_sub_row_grid(t){this.base=eXcell_sub_row,this.base(t),this.setValue=function(t){t&&this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",t),this.cell._sub_row_type="grid",this._setState(t?"plus.gif":"blank.gif")},this.getSubGrid=function(){return t._sub_grid?t._sub_grid:null}}function eXcell_ra_str(t){t&&(this.base=eXcell_ra,this.base(t),this.grid=t.parentNode.grid)}function eXcell_combo(t){t&&(this.cell=t,this.grid=t.parentNode.grid,this._combo_pre="",this.edit=function(){window.dhx_globalImgPath||(window.dhx_globalImgPath=this.grid.imgURL),this.val=this.getValue();var t=this.getText();this.cell._clearCell&&(t=""),this.cell.innerHTML="",this.cell._brval?this.combo=this.cell._brval:this.combo=(this.grid._realfake?this.grid._fake:this.grid)._col_combos[this.cell._cellIndex],this.cell.appendChild(this.combo.DOMParent),this.combo.DOMParent.style.margin="0",this.combo.DOMelem_input.focus(),this.combo.setSize(this.cell.offsetWidth-2),this.combo._xml?this.combo.setComboText(t):-1!=this.combo.getIndexByValue(this.cell.combo_value)?this.combo.selectOption(this.combo.getIndexByValue(this.cell.combo_value)):this.combo.getOptionByLabel(t)?this.combo.selectOption(this.combo.getIndexByValue(this.combo.getOptionByLabel(t).value)):this.combo.setComboText(t),this.combo.openSelect()},this.selectComboOption=function(t,e){e.selectOption(e.getIndexByValue(e.getOptionByLabel(t).value))},this.getValue=function(t){return this.cell.combo_value||""},this.getText=function(t){var e=this.cell;return""==this._combo_pre&&e.childNodes[1]?e=e.childNodes[1]:e.childNodes[0].childNodes[1],_isIE?e.innerText:e.textContent},this.setValue=function(t){if("object"==typeof t){this.cell._brval=this.initCombo();var e=this.cell._cellIndex,i=this.cell.parentNode.idd;t.firstChild?this.cell.combo_value=t.firstChild.data:(this.cell.combo_value="&nbsp;",this.cell._clearCell=!0),this.setComboOptions(this.cell._brval,t,this.grid,e,i)}else{this.cell.combo_value=t;var s=null;(s=this.cell._brval)&&"object"==typeof this.cell._brval?t=(s.getOption(t)||{}).text||t:(s=this.grid._col_combos[this.cell._cellIndex]||this.grid._fake&&(s=this.grid._fake._col_combos[this.cell._cellIndex]))&&(t=(s.getOption(t)||{}).text||t),""==(t||"").toString()._dhx_trim()&&(t=null),null!==t?this.setComboCValue(t):(this.setComboCValue("&nbsp;",""),this.cell._clearCell=!0)}},this.detach=function(){var t=this.combo.getParent();if(t.parentNode!=this.cell)return!1;this.cell.removeChild(t);var e=this.cell.combo_value;return this.combo.getComboText()&&""!=this.combo.getComboText().toString()._dhx_trim()?(this.setComboCValue(this.combo.getComboText().replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.combo.getActualValue()),this.cell._clearCell=!1):(this.setComboCValue("&nbsp;"),this.cell._clearCell=!0),this.combo._confirmSelect(),this.cell.combo_value=this.combo.getActualValue(),this.combo.closeAll(),this.grid._still_active=!0,this.grid.setActive(1),e!=this.cell.combo_value})}function eXcell_clist(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.edit=function(){this.val=this.getValue();var t=this.cell._combo||this.grid.clists[this.cell._cellIndex];if(t){this.obj=document.createElement("DIV");for(var e=this.val.split(","),i="",s=0;s<t.length;s++){for(var n=!1,l=0;l<e.length;l++)t[s]==e[l]&&(n=!0);i+=n?"<div><input type='checkbox' id='dhx_clist_"+s+"' checked='true' /><label for='dhx_clist_"+s+"'>"+t[s]+"</label></div>":"<div><input type='checkbox' id='dhx_clist_"+s+"'/><label for='dhx_clist_"+s+"'>"+t[s]+"</label></div>"}i+="<div><input type='button' value='"+(this.grid.applyButtonText||"Apply")+"' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>",this.obj.editor=this,this.obj.innerHTML=i,document.body.appendChild(this.obj),this.obj.style.position="absolute",this.obj.className="dhx_clist",this.obj.onclick=function(t){return(t||event).cancelBubble=!0,!0};var o=this.grid.getPosition(this.cell);this.obj.style.left=o[0]+"px",this.obj.style.top=o[1]+this.cell.offsetHeight+"px",this.obj.getValue=function(){for(var t="",e=0;e<this.childNodes.length-1;e++)this.childNodes[e].childNodes[0].checked&&(t&&(t+=", "),t+=this.childNodes[e].childNodes[1].innerHTML);return t.replace(/&amp;/g,"&")}}},this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim().replace(/&amp;/g,"&").replace(/, /g,",")},this.detach=function(t){return this.obj&&(this.setValue(this.obj.getValue()),this.obj.editor=null,this.obj.parentNode.removeChild(this.obj),this.obj=null),this.val!=this.getValue()}}function eXcell_calck(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.edit=function(){this.val=this.getValue();var t=this.grid.getPosition(this.cell);this.obj=new calcX(t[0],t[1]+this.cell.offsetHeight,this,this.val)},this.getValue=function(){return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)},this.detach=function(){return this.obj&&(this.setValue(this.obj.inputZone.value),this.obj.removeSelf()),this.obj=null,this.val!=this.getValue()}}function calcX(left,top,onReturnSub,val){if(this.top=top||0,this.left=left||0,this.onReturnSub=onReturnSub||null,this.operandA=0,this.operandB=0,this.operatorA="",this.state=0,this.dotState=0,this.calckGo=function(){return eval(this.operandA+"*1"+this.operatorA+this.operandB+"*1")},this.isNumeric=function(t){return-1==t.search(/[^1234567890]/gi)},this.isOperation=function(t){return-1==t.search(/[^\+\*\-\/]/gi)},this.onCalcKey=function(t){that=this.calk;var e=this.innerHTML,i=that.inputZone;0!=that.state&&2!=that.state||!that.isNumeric(e)||("0"!=i.value?i.value+=e:i.value=e),0!=that.state&&2!=that.state||"."!=e||0!=that.dotState||(that.dotState=1,i.value+=e),"C"==e&&(i.value=0,that.dotState=0,that.state=0),0==that.state&&that.isOperation(e)&&(that.operatorA=e,that.operandA=i.value,that.state=1),2==that.state&&that.isOperation(e)&&(that.operandB=i.value,i.value=that.calckGo(),that.operatorA=e,that.operandA=i.value,that.state=1),2==that.state&&"="==e&&(that.operandB=i.value,i.value=that.calckGo(),that.operatorA=e,that.operandA=i.value,that.state=3),1==that.state&&that.isNumeric(e)&&(i.value=e,that.state=2,that.dotState=0),3==that.state&&that.isNumeric(e)&&(i.value=e,that.state=0),3==that.state&&that.isOperation(e)&&(that.operatorA=e,that.operandA=i.value,that.state=1),"e"==e&&(i.value=Math.E,1==that.state&&(that.state=2),that.dotState=0),"p"==e&&(i.value=Math.PI,1==that.state&&(that.state=2),that.dotState=0),"Off"==e&&that.topNod.parentNode.removeChild(that.topNod),(t||event)&&((t||event).cancelBubble=!0)},this.sendResult=function(){if(that=this.calk,2==that.state){var t=that.inputZone;that.operandB=t.value,t.value=that.calckGo(),that.operatorA=e,that.operandA=t.value,that.state=3}var e=that.inputZone.value;that.topNod.parentNode.removeChild(that.topNod),that.onReturnSub.grid.editStop(!1)},this.removeSelf=function(){this.topNod.parentNode&&this.topNod.parentNode.removeChild(this.topNod)},this.keyDown=function(){this.className="calcPressed"},this.keyUp=function(){this.className="calcButton"},this.init_table=function(){var t=this.topNod.childNodes[0];if(t&&"TABLE"==t.tagName){for(i=1;i<t.childNodes[0].childNodes.length;i++)for(j=0;j<t.childNodes[0].childNodes[i].childNodes.length;j++)t.childNodes[0].childNodes[i].childNodes[j].onclick=this.onCalcKey,t.childNodes[0].childNodes[i].childNodes[j].onmousedown=this.keyDown,t.childNodes[0].childNodes[i].childNodes[j].onmouseout=this.keyUp,t.childNodes[0].childNodes[i].childNodes[j].onmouseup=this.keyUp,t.childNodes[0].childNodes[i].childNodes[j].calk=this;this.inputZone=this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0],this.onReturnSub?(this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].onclick=this.sendResult,this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].calk=this):this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].innerHTML=""}},this.drawSelf=function(){var t=document.createElement("div");t.className="calcTable",t.style.position="absolute",t.style.top=this.top+"px",t.style.left=this.left+"px",t.innerHTML="<table cellspacing='0' id='calc_01' class='calcTable'><tr><td colspan='4'><table cellpadding='1' cellspacing='0' width='100%'><tr><td width='100%' style='overflow:hidden;'><input style='width:100%' class='calcInput' value='0' align='right' readonly='true' style='text-align:right'></td><td class='calkSubmit'>=</td></tr></table></td></tr><tr><td class='calcButton' width='25%'>Off</td><td class='calcButton' width='25%'>p</td><td class='calcButton' width='25%'>e</td><td class='calcButton' width='25%'>/</td></tr><tr><td class='calcButton'>7</td><td class='calcButton'>8</td><td class='calcButton'>9</td><td class='calcButton'>*</td></tr><tr><td class='calcButton'>4</td><td class='calcButton'>5</td><td class='calcButton'>6</td><td class='calcButton'>+</td></tr><tr><td class='calcButton'>1</td><td class='calcButton'>2</td><td class='calcButton'>3</td><td class='calcButton'>-</td></tr><tr><td class='calcButton'>0</td><td class='calcButton'>.</td><td class='calcButton'>C</td><td class='calcButton'>=</td></tr></table>",t.onclick=function(t){(t||event).cancelBubble=!0},document.body.appendChild(t),this.topNod=t},this.drawSelf(),this.init_table(),val){var rZone=this.inputZone;rZone.value=1*val,this.operandA=1*val,this.state=3}return this}function dtmlXMLLoaderObject(t,e,i,s){return this.xmlDoc="",this.async=void 0===i||i,this.onloadAction=t||null,this.mainObject=e||null,this.waitCall=null,this.rSeed=s||!1,this}function callerFunction(t,e){return this.handler=function(i){return i||(i=window.event),t(i,e),!0},this.handler}function getAbsoluteLeft(t){return getOffset(t).left}function getAbsoluteTop(t){return getOffset(t).top}function getOffsetSum(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}}function getOffsetRect(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,n=window.pageYOffset||s.scrollTop||i.scrollTop,l=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=s.clientTop||i.clientTop||0,r=s.clientLeft||i.clientLeft||0,a=e.top+n-o,h=e.left+l-r;return{top:Math.round(a),left:Math.round(h)}}function getOffset(t){return t.getBoundingClientRect?getOffsetRect(t):getOffsetSum(t)}function convertStringToBoolean(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(t){return-1!=t.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(t,e,i){return this.catches||(this.catches=[]),this}function dhtmlXHeir(t,e){for(var i in e)"function"==typeof e[i]&&(t[i]=e[i]);return t}function dataProcessor(t){return this.serverProcessor=t,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this}null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),void 0===dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){var t,e,i,s;function n(){if(e){var i=document.createEvent("HTMLEvents");i.initEvent("dblclick",!0,!0),e.dispatchEvent(i),t=e=null}}dhtmlxEvent(document.body,"touchstart",function(l){e=l.touches[0].target,i=l.touches[0].clientX,s=l.touches[0].clientY,t=window.setTimeout(n,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(n){t&&(Math.abs(n.touches[0].clientX-i)>50||Math.abs(n.touches[0].clientY-s)>50)&&(window.clearTimeout(t),t=e=!1)}),dhtmlxEvent(document.body,"touchend",function(i){t&&(window.clearTimeout(t),t=e=!1)}),dhtmlxEvent.initTouch=function(){}}),dataProcessor.prototype={setTransactionMode:function(t,e){"object"==typeof t?(this._tMode=t.mode||this._tMode,this._headers=this._headers||t.headers,this._payload=this._payload||t.payload):(this._tMode=t,this._tSend=e),"REST"==this._tMode&&(this._tSend=!1,this._endnm=!0)},escape:function(t){return this._utf?encodeURIComponent(t):escape(t)},enableUTFencoding:function(t){this._utf=dhx4.s2b(t)},setDataColumns:function(t){this._columns="string"==typeof t?t.split(","):t},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(t){this._endnm=dhx4.s2b(t)},enablePartialDataSend:function(t){this._changed=dhx4.s2b(t)},setUpdateMode:function(t,e){this.autoUpdate="cell"==t,this.updateMode=t,this.dnd=e},ignore:function(t,e){this._silent_mode=!0,t.call(e||window),this._silent_mode=!1},setUpdated:function(t,e,i){if(!this._silent_mode){var s=this.findRow(t);i=i||"updated";var n=this.obj.getUserData(t,this.action_param);n&&"updated"==i&&(i=n),e?(this.set_invalid(t,!1),this.updatedRows[s]=t,this.obj.setUserData(t,this.action_param,i),this._in_progress[t]&&(this._in_progress[t]="wait")):this.is_invalid(t)||(this.updatedRows.splice(s,1),this.obj.setUserData(t,this.action_param,"")),e||this._clearUpdateFlag(t),this.markRow(t,e,i),e&&this.autoUpdate&&this.sendData(t)}},_clearUpdateFlag:function(t){},markRow:function(t,e,i){var s="",n=this.is_invalid(t);if(n&&(s=this.styles[n],e=!0),this.callEvent("onRowMark",[t,e,i,n])&&(s=this.styles[e?i:"clear"]+s,this.obj[this._methods[0]](t,s),n&&n.details)){s+=this.styles[n+"_cell"];for(var l=0;l<n.details.length;l++)n.details[l]&&this.obj[this._methods[1]](t,l,s)}},getState:function(t){return this.obj.getUserData(t,this.action_param)},is_invalid:function(t){return this._invalid[t]},set_invalid:function(t,e,i){i&&(e={value:e,details:i,toString:function(){return this.value.toString()}}),this._invalid[t]=e},checkBeforeUpdate:function(t){return!0},sendData:function(t){if(!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2){if(this.obj.editStop&&this.obj.editStop(),void 0===t||this._tSend)return this.sendAllData();if(this._in_progress[t])return!1;if(this.messages=[],"deleted"!==this.getState(t)&&!this.checkBeforeUpdate(t)&&this.callEvent("onValidationError",[t,this.messages]))return!1;this._beforeSendData(this._getRowData(t),t)}},_beforeSendData:function(t,e){if(!this.callEvent("onBeforeUpdate",[e,this.getState(e),t]))return!1;this._sendData(t,e)},serialize:function(t,e){if("string"==typeof t)return t;if(void 0!==e)return this.serialize_one(t,"");var i=[],s=[];for(var n in t)t.hasOwnProperty(n)&&(i.push(this.serialize_one(t[n],n+this.post_delim)),s.push(n));return i.push("ids="+this.escape(s.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(t,e){if("string"==typeof t)return t;var i=[];for(var s in t)if(t.hasOwnProperty(s)){if(("id"==s||s==this.action_param)&&"REST"==this._tMode)continue;i.push(this.escape((e||"")+s)+"="+this.escape(t[s]))}return i.join("&")},_sendData:function(t,e){if(t){if(!this.callEvent("onBeforeDataSending",e?[e,this.getState(e),t]:[null,null,t]))return!1;e&&(this._in_progress[e]=(new Date).valueOf());var i=this,s=function(s){var n=[];if(e)n.push(e);else if(t)for(var l in t)n.push(l);return i.afterUpdate(i,s,n)},n=this.serverProcessor+(this._user?dhtmlx.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode)dhx4.ajax.get(n+(-1!=n.indexOf("?")?"&":"?")+this.serialize(t,e),s);else if("POST"==this._tMode)dhx4.ajax.post(n,this.serialize(t,e),s);else if("REST"==this._tMode){var l=this.getState(e),o=n.replace(/(\&|\?)editing\=true/,""),r=o.split("?");r[1]&&(r[1]="?"+r[1]);var a="",h="post";if("inserted"==l?a=this.serialize(t,e):"deleted"==l?(h="DELETE",o=r[0]+e+r[1]):(h="PUT",a=this.serialize(t,e),o=r[0]+e+r[1]),this._payload)for(var d in this._payload)o=o+(-1===o.indexOf("?")?"?":"&")+this.escape(d)+"="+this.escape(this._payload[d]);dhx4.ajax.query({url:o,method:h,headers:this._headers,data:a,callback:s})}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var t=!0,e=0;e<this.updatedRows.length;e++)"deleted"!==this.getState(this.updatedRows[e])&&(t&=this.checkBeforeUpdate(this.updatedRows[e]));if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(e=0;e<this.updatedRows.length;e++)if(!this._in_progress[this.updatedRows[e]]){if(this.is_invalid(this.updatedRows[e]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[e]),this.updatedRows[e]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(t){for(var e={},i=!1,s=0;s<this.updatedRows.length;s++){var n=this.updatedRows[s];this._in_progress[n]||this.is_invalid(n)||this.callEvent("onBeforeUpdate",[n,this.getState(n),this._getRowData(n)])&&(e[n]=this._getRowData(n,n+this.post_delim),i=!0,this._in_progress[n]=(new Date).valueOf())}return i?e:null},setVerificator:function(t,e){this.mandatoryFields[t]=e||function(t){return""!==t}},clearVerificator:function(t){this.mandatoryFields[t]=!1},findRow:function(t){var e=0;for(e=0;e<this.updatedRows.length&&t!=this.updatedRows[e];e++);return e},defineAction:function(t,e){this._uActions||(this._uActions=[]),this._uActions[t]=e},afterUpdateCallback:function(t,e,i,s){var n=t,l="error"!=i&&"invalid"!=i;if(l||this.set_invalid(t,i),this._uActions&&this._uActions[i]&&!this._uActions[i](s))return delete this._in_progress[n];"wait"!=this._in_progress[n]&&this.setUpdated(t,!1);var o=t;switch(i){case"inserted":case"insert":e!=t&&(this.obj[this._methods[2]](t,e),t=e);break;case"delete":case"deleted":return this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj[this._methods[3]](t),delete this._in_progress[n],this.callEvent("onAfterUpdate",[t,i,e,s])}"wait"!=this._in_progress[n]?(l&&this.obj.setUserData(t,this.action_param,""),delete this._in_progress[n]):(delete this._in_progress[n],this.setUpdated(e,!0,this.obj.getUserData(t,this.action_param))),this.callEvent("onAfterUpdate",[o,i,e,s])},afterUpdate:function(t,e,i){if(window.JSON)try{var s=JSON.parse(e.xmlDoc.responseText),n=s.action||this.getState(i)||"updated",l=s.sid||i[0],o=s.tid||i[0];return t.afterUpdateCallback(l,o,n,s),void t.finalizeUpdate()}catch(t){}var r=dhx4.ajax.xmltop("data",e.xmlDoc);if(!r||"DIV"==r.tagName)return this.cleanUpdate(i);var a=dhx4.ajax.xpath("//data/action",r);if(!a.length)return this.cleanUpdate(i);for(var h=0;h<a.length;h++){var d=a[h];n=d.getAttribute("type"),l=d.getAttribute("sid"),o=d.getAttribute("tid");t.afterUpdateCallback(l,o,n,d)}t.finalizeUpdate()},cleanUpdate:function(t){if(t)for(var e=0;e<t.length;e++)delete this._in_progress[t[e]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(t){this.obj=t,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(t){this.attachEvent("onAfterUpdate",t)},enableDebug:function(t){},setOnBeforeUpdateHandler:function(t){this.attachEvent("onBeforeDataSending",t)},setAutoUpdate:function(t,e){t=t||2e3,this._user=e||(new Date).valueOf(),this._need_update=!1,this._loader=null,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(t,e,i,s){this.afterAutoUpdate(t,e,i,s)}),this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},t)},afterAutoUpdate:function(t,e,i,s){return"collision"!=e||(this._need_update=!0,!1)},fullSync:function(){return 1==this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(t,e){if(this._update_busy)return!1;this._update_busy=!0,this._loader=this._loader||new dtmlXMLLoaderObject(!0),this._loader.async=!0,this._loader.waitCall=e,this._loader.loadXML(t)},_v:function(t){return t.firstChild?t.firstChild.nodeValue:""},_a:function(t){for(var e=[],i=0;i<t.length;i++)e[i]=this._v(t[i]);return e},loadUpdate:function(){var t=this,e=this.obj.getUserData(0,"version"),i=this.serverProcessor+dhtmlx.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&");i=i.replace("editing=true&",""),this.getUpdates(i,function(){var e=t._loader.doXPath("//userdata");t.obj.setUserData(0,"version",t._v(e[0]));var i=t._loader.doXPath("//update");if(i.length){t._silent_mode=!0;for(var s=0;s<i.length;s++){var n=i[s].getAttribute("status"),l=i[s].getAttribute("id"),o=i[s].getAttribute("parent");switch(n){case"inserted":t.callEvent("insertCallback",[i[s],l,o]);break;case"updated":t.callEvent("updateCallback",[i[s],l,o]);break;case"deleted":t.callEvent("deleteCallback",[i[s],l,o])}}t._silent_mode=!1}t._update_busy=!1,t=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(t){this.init_original(t),t._dataprocessor=this,this.setTransactionMode("POST",!0),this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"}),dhtmlXCalendarObject.prototype.lang="en",dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",hdrformat:"%F %Y",monthesFNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthesSNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysSNames:["Su","Mo","Tu","We","Th","Fr","Sa"],weekstart:1,weekname:"w"}},dhtmlXCalendarObject.prototype._buildMonthHdr=function(t){var e=this,i=function(t){return 1==String(t).length?"0"+String(t):t},s=function(t,e){return"<span class='dhtmlxcalendar_month_label_"+t+"'>"+e+"</span>"},n=String(this.langData[this.lang].hdrformat||"%F %Y").replace(/%[a-z]/gi,function(n){switch(n){case"%m":return s("month",i(t.getMonth()+1));case"%n":return s("month",t.getMonth()+1);case"%M":return s("month",e.langData[e.lang].monthesSNames[t.getMonth()]);case"%F":return s("month",e.langData[e.lang].monthesFNames[t.getMonth()]);case"%y":return s("year",i(t.getYear()%100));case"%Y":return s("year",t.getFullYear());case"%%":return"%";default:return n}});return e=i=s=null,n},dhtmlXCalendarObject.prototype.enableIframe=function(t){1==t?this._ifr||(this._ifr=document.createElement("IFRAME"),this._ifr.frameBorder=0,this._ifr.border=0,this._ifr.setAttribute("src","javascript:false;"),this._ifr.className="dhtmlxcalendar_ifr",this._ifr.onload=function(){this.onload=null,this.contentWindow.document.open("text/html","replace"),this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")},this.base.parentNode.insertBefore(this._ifr,this.base),this._ifrSize()):this._ifr&&(this._ifr.parentNode.removeChild(this._ifr),this._ifr=null)},dhtmlXCalendarObject.prototype._ifrSize=function(){this._ifr&&(this._ifr.style.left=this.base.style.left,this._ifr.style.top=this.base.style.top,this._ifr.style.width=this.base.offsetWidth+"px",this._ifr.style.height=this.base.offsetHeight+"px")},dhtmlxCalendarObject=dhtmlXCalendarObject,dhtmlXCalendarObject.prototype._dateStrings=function(){var t=this.langData[this.lang];return{monthFullName:t.monthesFNames,monthShortName:t.monthesSNames,dayFullName:t.daysFNames,dayShortName:t.daysSNames}},dhtmlXCalendarObject.prototype._strToDate=function(t,e){return window.dhx4.str2date(t,e||this._dateFormat,this._dateStrings())},dhtmlXCalendarObject.prototype._dateToStr=function(t,e){return window.dhx4.date2str(t,e||this._dateFormat,this._dateStrings())},window.dhtmlxDblCalendarObject=window.dhtmlXDoubleCalendarObject=window.dhtmlXDoubleCalendar=function(t){var e=this;return this.leftCalendar=new dhtmlXCalendarObject(t),this.leftCalendar.hideTime(),this.rightCalendar=new dhtmlXCalendarObject(t),this.rightCalendar.hideTime(),this.leftCalendar.attachEvent("onClick",function(t){e._updateRange("rightCalendar",t,null),e._evOnClick(["left",t])}),this.rightCalendar.attachEvent("onClick",function(t){e._updateRange("leftCalendar",null,t),e._evOnClick(["right",t])}),this.leftCalendar.attachEvent("onBeforeChange",function(t){return e._evOnBeforeChange(["left",t])}),this.rightCalendar.attachEvent("onBeforeChange",function(t){return e._evOnBeforeChange(["right",t])}),this.show=function(){this.leftCalendar.show(),this.rightCalendar.base.style.marginLeft=this.leftCalendar.base.offsetWidth-1+"px",this.rightCalendar.show()},this.hide=function(){this.leftCalendar.hide(),this.rightCalendar.hide()},this.setDateFormat=function(t){this.leftCalendar.setDateFormat(t),this.rightCalendar.setDateFormat(t)},this.setDates=function(t,e){null!=t&&this.leftCalendar.setDate(t),null!=e&&this.rightCalendar.setDate(e),this._updateRange()},this._updateRange=function(t,e,i){3==arguments.length?("leftCalendar"==t?this.leftCalendar:this.rightCalendar).setSensitiveRange(e,i):(this.leftCalendar.setSensitiveRange(null,this.rightCalendar.getDate()),this.rightCalendar.setSensitiveRange(this.leftCalendar.getDate(),null))},this.getFormatedDate=function(){return this.leftCalendar.getFormatedDate.apply(this.leftCalendar,arguments)},this.unload=function(){window.dhx4._eventable(this,"clear"),this.leftCalendar.unload(),this.rightCalendar.unload(),this.leftCalendar=this.rightCalendar=null,this._updateRange=null,this._evOnClick=null,this._evOnBeforeChange=null,this.show=null,this.hide=null,this.setDateFormat=null,this.setDates=null,this.getFormatedDate=null,this.unload=null,e=null},this._evOnClick=function(t){return this.callEvent("onClick",t)},this._evOnBeforeChange=function(t){return this.callEvent("onBeforeChange",t)},window.dhx4._eventable(this),this},dhtmlXCombo.prototype.setName=function(t){this.conf.form_name=t,this.base.childNodes[1].name=t,this.base.childNodes[2].name=t.replace(/(\[.*)?$/,"_new_value$1")},dhtmlXCombo.prototype.readonly=function(t){window.dhx4.s2b(t)?this.base.firstChild.setAttribute("readOnly","true"):this.base.firstChild.removeAttribute("readOnly")},dhtmlXCombo.prototype.setPlaceholder=function(t){void 0!==t&&null!=t||(t=""),this.base.firstChild.setAttribute("placeholder",String(t))},dhtmlXCombo.prototype.setTemplate=function(t){for(var e in t)void 0!==this.conf.template[e]&&(this.conf.template[e]=String(t[e]));for(var e in null!=t.columns?this._mcMakeTemplate(t.columns):this._mcDetachHeader(),this.t)this.t[e].obj.setText(this.t[e].item,this.t[e].item._conf.text);this._confirmSelect()},dhtmlXCombo.prototype.setSkin=function(t){t!=this.conf.skin&&(this.conf.skin=t,this.base.className="dhxcombo_"+this.conf.skin+(this.conf.enabled?"":" dhxcombo_disabled"),this.list.className="dhxcombolist_"+this.conf.skin+(null!=this.hdr?" dhxcombolist_multicolumn":""),null!=this.hdr&&(this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr"))},dhtmlXCombo.prototype.getInput=function(){return this.base.firstChild},dhtmlXCombo.prototype.getButton=function(){return this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)]},dhtmlXCombo.prototype.getList=function(){return this.list},dhtmlXCombo.prototype.getBase=function(){return this.base},dhtmlXCombo.prototype.getParent=function(){return this.DOMParent},dhtmlXCombo.prototype.forEachOption=function(t){for(var e=0;e<this.list.childNodes.length;e++)t.apply(window,[this._getOption(this.list.childNodes[e]._optId,e)])},dhtmlXCombo.prototype.setFocus=function(){this.conf.enabled&&this.base.firstChild.focus()},dhtmlXCombo.prototype.setFontSize=function(t,e){null!=t&&(this.base.firstChild.style.fontSize=t),null!=e&&(this.list.style.fontSize=e)},dhtmlXCombo.prototype.getOption=function(t){for(var e=null,i=null,s=0;s<this.list.childNodes.length;s++)if(null==e){var n=this.list.childNodes[s]._optId;this.t[n].obj.getValue(this.t[n].item)==t&&(e=n,i=s)}return null==e?null:this._getOption(e,i)},dhtmlXCombo.prototype.getOptionByIndex=function(t){return t<0?null:null==this.list.childNodes[t]?null:this._getOption(this.list.childNodes[t]._optId,t)},dhtmlXCombo.prototype.getOptionByLabel=function(t){for(var e=null,i=null,s=0;s<this.list.childNodes.length;s++)if(null==e){var n=this.list.childNodes[s]._optId;this.t[n].obj.getText(this.t[n].item,!0)==t&&(e=n,i=s)}return null==e?null:this._getOption(e,i)},dhtmlXCombo.prototype.getSelectedIndex=function(){return this._getOptionProp(this.conf.last_selected,"index",-1)},dhtmlXCombo.prototype.getSelectedText=function(){return this._getOptionProp(this.conf.last_selected,"text","")},dhtmlXCombo.prototype.getSelectedValue=function(){return this._getOptionProp(this.conf.last_selected,"value",null)},dhtmlXCombo.prototype.getActualValue=function(){return this.base.childNodes[1].value},dhtmlXCombo.prototype.getComboText=function(){return this.base.childNodes[0].value},dhtmlXCombo.prototype.getIndexByValue=function(t){var e=this.getOption(t);return null!=e?e.index:-1},dhtmlXCombo.prototype.setComboText=function(t){1==this.conf.allow_free_text&&(this.unSelectOption(),this.conf.last_text=this.base.firstChild.value=t,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())},dhtmlXCombo.prototype.setComboValue=function(t){var e=this.getOption(t);null!=e?this.selectOption(e.index):(this.conf.last_value=t,this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="true")},dhtmlXCombo.prototype.selectOption=function(t,e,i){if(!(t<0||t>=this.list.childNodes.length)){var s=this.list.childNodes[t]._optId;this._setSelected(s,this._isListVisible(),!0),this._confirmSelect("script")}},dhtmlXCombo.prototype.unSelectOption=function(){null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null),this.base.firstChild.value="",0!=this.conf.f_mode&&this._filterOpts(!0),this._hideList(),this._updateTopImage(null),this._confirmSelect("script")},dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelect("script")},dhtmlXCombo.prototype.enable=function(t){t=void 0===t||window.dhx4.s2b(t),this.conf.enabled!=t&&(this.conf.enabled=t,t?(this.base.className="dhxcombo_"+this.conf.skin,this.base.firstChild.removeAttribute("disabled")):(this._hideList(),this.base.className="dhxcombo_"+this.conf.skin+" dhxcombo_disabled",this.base.firstChild.setAttribute("disabled","true")),this._updateTopImage(this.conf.last_selected))},dhtmlXCombo.prototype.disable=function(t){t=void 0===t||window.dhx4.s2b(t),this.enable(!t)},dhtmlXCombo.prototype.isEnabled=function(){return 1==this.conf.enabled},dhtmlXCombo.prototype.show=function(t){t=void 0===t||window.dhx4.s2b(t),this.base.style.display=1==t?"":"none"},dhtmlXCombo.prototype.hide=function(t){void 0===t&&(t=!0),this.show(!t)},dhtmlXCombo.prototype.isVisible=function(){return""==this.base.style.display},dhtmlXCombo.prototype.setFilterHandler=function(t){"function"==typeof t?(this.conf.f_func=t,this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):"string"==typeof t&&"function"==typeof window[t]?(this.conf.f_func=window[t],this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):this.conf.f_func=null},dhtmlXCombo.prototype.enableFilteringMode=function(t,e,i,s){1==t||"between"==t?(this.conf.f_mode=1==t?"start":"between",null!=e?(this.conf.f_url=e,this.conf.f_cache=window.dhx4.s2b(i),this.conf.f_dyn=window.dhx4.s2b(s)):(this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)):(this.conf.f_mode=!1,this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)},dhtmlXCombo.prototype.filter=function(t,e){for(var i=0;i<this.list.childNodes.length;i++){var s=t.apply(window,[this._getOption(this.list.childNodes[i]._optId,i)]);this.list.childNodes[i].style.display=!0===s?"":"none"}void 0!==e&&1!=e||this._showList(!0)},dhtmlXCombo.prototype.sort=function(t){for(var e=[],i=0;i<this.list.childNodes.length;i++){var s=this.list.childNodes[i]._optId;e.push([s,this._getOption(s,i)])}for("asc"==t||"desc"==t?(k=!0,e.sort(function(e,i){e=e[1].text_option.toLowerCase(),i=i[1].text_option.toLowerCase();var s="asc"==t?1:-1;return e>i?s:-1*s})):"function"!=typeof t&&"function"!=typeof window[t]||("function"==typeof window[t]&&(t=window[t]),e.sort(function(e,i){return t.apply(window,[e[1],i[1]])}));this.list.childNodes.length>0;)this.list.removeChild(this.list.lastChild);for(i=0;i<e.length;i++)this.list.appendChild(this.t[e[i][0]].item)},dhtmlXCombo.prototype.enableAutocomplete=function(t){t=void 0===t||window.dhx4.s2b(t),this.conf.f_ac=t},dhtmlXCombo.prototype.disableAutocomplete=function(t){t=void 0===t||window.dhx4.s2b(t),this.enableAutocomplete(!t)},dhtmlXCombo.prototype.allowFreeText=function(t){this.conf.allow_free_text=void 0===t||window.dhx4.s2b(t)},dhtmlXCombo.prototype._checkForMatch=function(t){for(var e=window.dhx4.trim(this.base.firstChild.value).toLowerCase(),i=null,s=this.list.firstChild;null!=s;){if(""==s.style.display&&null!=s._optId)e==window.dhx4.trim(this.t[s._optId].obj.getText(s,!0)).toLowerCase()&&(i=s._optId,s=null);null!=s&&(s=s.nextSibling)}null==this.conf.last_match?null!=i?(this._setSelected(i,!0,!0),this.conf.last_match=i):"between"==this.conf.f_mode&&1!=t||(this._setSelected(null,!0,!0),this.conf.last_match=null):null!=i?i!=this.conf.last_match&&(this._setSelected(i,!0,!0),this.conf.last_match=i):(this._setSelected(null,!0,!0),this.conf.last_match=null)},dhtmlXCombo.prototype._selectRange=function(t,e){1==this.conf.combo_focus&&window.dhx4.selectTextRange(this.base.firstChild,t,e)},dhtmlXCombo.prototype.openSelect=function(){this._isListVisible()||this._showList()},dhtmlXCombo.prototype.closeAll=function(){this._hideList()},dhtmlXCombo.prototype._showList=function(t){if(0!=this._getListVisibleCount())if(this._isListVisible())this._checkListHeight();else{this.list.style.zIndex=window.dhx4.zim.reserve(this.conf.list_zi_id),null!=this.hdr&&(this.hdr.style.zIndex=Number(this.list.style.zIndex)+1),this.list.style.visibility="hidden",this.list.style.display="",null!=this.hdr&&(this.hdr.style.visibility=this.list.style.visibility,this.hdr.style.display=this.list.style.display);var e=null!=this.hdr?this.hdr.offsetHeight:0;this.list.style.width=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width)+"px",this.list.style.top=window.dhx4.absTop(this.base)+e+this.base.offsetHeight-1+"px",this.list.style.left=window.dhx4.absLeft(this.base)+"px",null!=this.hdr&&(this.hdr.style.width=this.list.style.width,this.hdr.style.left=this.list.style.left,this.hdr.style.top=parseInt(this.list.style.top)-e+"px"),this._checkListHeight(),this.list.style.visibility="visible",null!=this.hdr&&(this.hdr.style.visibility="visible"),this.callEvent("onOpen",[])}else t&&this._isListVisible()&&this._hideList()},dhtmlXCombo.prototype._hideList=function(){this._isListVisible()&&(window.dhx4.zim.clear(this.conf.list_zi_id),this.list.style.display="none",null!=this.hdr&&(this.hdr.style.display="none"),this.conf.clear_click=!1,this.callEvent("onClose",[]))},dhtmlXCombo.prototype._isListVisible=function(){return""==this.list.style.display},dhtmlXCombo.prototype._getListVisibleCount=function(){for(var t=0,e=0;e<this.list.childNodes.length;e++)t+=""==this.list.childNodes[e].style.display?1:0;return t},dhtmlXCombo.prototype._checkListHeight=function(){if(this._isListVisible()){if(null==this.conf.item_h){for(var t=this.list.firstChild;null!=t;)""==t.style.display?(this.conf.item_h=t.offsetHeight+(null!=this.hdr?-1:0),t=null):t=t.nextSibling;t=null}var e=window.dhx4.screenDim(),i=window.dhx4.absTop(this.base),s=this.base.offsetHeight,n=null!=this.hdr?this.hdr.offsetHeight:0,l=Math.max(0,Math.floor((i+n-e.top)/this.conf.item_h)),o=Math.max(0,Math.floor((e.bottom-(i+s+n))/this.conf.item_h)),r=this._getListVisibleCount();o<Math.min(this.conf.opts_count_min,r)&&l>o&&(o=null);var a=Math.min(null==o?l:o,this.conf.opts_count,r),h=a<r?a*this.conf.item_h+"px":"",d=this.conf.sp[this.conf.skin][null!=this.hdr?"hdr_ofs":"list_ofs"];this.list.style.height=h,this.list.style.top=(null==o?i-this.list.offsetHeight+d:i+s+n-d)+"px",null!=this.hdr&&(this.hdr.style.top=(null==o?i-n-this.list.offsetHeight+d:i+s-d)+"px")}},dhtmlXCombo.prototype._scrollToItem=function(t){var e=this.t[t].item.offsetTop,i=e+this.t[t].item.offsetHeight,s=this.list.scrollTop,n=s+this.list.clientHeight;e<s?this.list.scrollTop=e+(null!=this.hdr?1:0):i>n&&(this.list.scrollTop=i-this.list.clientHeight+(null!=this.hdr?-this.conf.sp[this.conf.skin].scr_ofs:0))},dhtmlXCombo.prototype._setSelected=function(t,e,i){i&&this._updateTopImage(t),null==t||this.conf.last_hover!=t?(null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null,null==t&&this.callEvent("onSelectionChange",[])),null!=t&&(this.t[t].obj.setSelected(this.t[t].item,!0),this.conf.last_hover=t,this.callEvent("onSelectionChange",[]),"select"==this.conf.s_mode&&this.t[t].item==this.t[t].item.parentNode.lastChild&&this._subloadRequest(),e&&this._scrollToItem(t))):e&&this._scrollToItem(t)},dhtmlXCombo.prototype._subloadRequest=function(){if(null!=this.conf.f_url&&1==this.conf.f_dyn&&0==this.conf.f_dyn_end){var t="mask="+encodeURIComponent(this.conf.f_mask)+"&pos="+this.list.childNodes.length,e=this,i=function(t){e.conf.f_cache&&e.conf.f_cache_data[e.conf.f_mask].data.push(t.xmlDoc.responseXML);var s=e.list.childNodes.length;e.conf.f_loading=!0,e.load(t.xmlDoc.responseXML),e.conf.f_loading=!1,s==e.list.childNodes.length&&(e.conf.f_dyn_end=!0,e.conf.f_cache&&(e.conf.f_cache_data[e.conf.f_mask].dyn_end=!0)),i=e=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(this.conf.f_url,t,i):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(this.conf.f_url+(String(this.conf.f_url).indexOf("?")>=0?"&":"?")+t,i)}},dhtmlXCombo.prototype.addOption=function(t,e,i,s,n){var l=null;if(t instanceof Array){for(var o=0;o<t.length;o++)if(void 0!==t[o])if(t[o]instanceof Array)r=this._renderOption({value:t[o][0],text:t[o][1],css:t[o][2],img:t[o][3]}),null==l&&1==window.dhx4.s2b(t[o][4])&&(l=r);else{r=this._renderOption(t[o]);null==l&&1==window.dhx4.s2b(t[o].selected)&&(l=r)}}else{var r=this._renderOption({value:t,text:e,css:i,img:s});null==l&&1==window.dhx4.s2b(n)&&(l=r)}null!=l&&(this._setSelected(l,this._isListVisible(),!0),this._confirmSelect("onInit"))},dhtmlXCombo.prototype.updateOption=function(t,e,i,s){var n=this._getOptionId(t);null!=n&&(this.t[n].obj.update(this.t[n].item,{value:e,text:i,css:s}),this.conf.last_selected==n&&(this.conf.last_text=this.base.firstChild.value=this.t[n].obj.getText(this.t[n].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase()))},dhtmlXCombo.prototype.deleteOption=function(t){for(var e in this.t){this.t[e].obj.getValue(this.t[e].item)==t&&this._removeOption(e)}this._isListVisible()&&this._showList(!0)},dhtmlXCombo.prototype.clearAll=function(t){for(var e in t=void 0===t||window.dhx4.s2b(t),this.t)this._removeOption(e);this.conf.tm_hover&&window.clearTimeout(this.conf.tm_hover),this.conf.last_hover=null,this.conf.last_selected=null,this.list.scrollTop=0,1==t&&this._hideList()},dhtmlXCombo.prototype._renderOption=function(t){var e=window.dhx4.newId(),i=document.createElement("DIV");i._optId=e,i._tpl=this.conf.template,void 0===t.img&&void 0!==t.img_src&&(t.img=t.img_src,delete t.img_src),void 0===t.img_dis&&void 0!==t.img_src_dis&&(t.img_dis=t.img_src_dis,delete t.img_src_dis),t.img_path=this.conf.img_path,t.img_def=this.conf.img_def,t.img_def_dis=this.conf.img_def_dis,this.list.appendChild(i);var s=this._isListVisible()&&1==window.dhx4.isFF;if(1==s){this.list.scrollTop;this.list.scrollTop-=1}return null!=this.hdr&&(t.multicol=!0),this.t[i._optId]={obj:this.modes[this.conf.opts_type].render(i,t),item:i,conf:{type:this.conf.opts_type}},i=null,1==s&&(this.list.scrollTop+=1),e},dhtmlXCombo.prototype._removeOption=function(t){this.t[t].obj.destruct(this.t[t].item),this.t[t].obj=null,this.t[t].item.parentNode.removeChild(this.t[t].item),this.t[t].item=null,this.t[t].conf=null,this.t[t]=null,delete this.t[t],this.conf.last_hover==t&&(this.conf.last_hover=null),this.conf.last_selected==t&&(this.conf.last_selected=null,this._confirmSelect("onDelete"))},dhtmlXCombo.prototype._confirmSelect=function(t){var e=!1;if(this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm),null!=this.conf.last_hover)e=e||this.conf.last_value!=this._getOptionValue(this.conf.last_hover),this.conf.last_match=this.conf.last_selected=this.conf.last_hover,this.conf.last_value=this._getOptionValue(this.conf.last_selected),this.conf.last_text=this.base.firstChild.value=this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="false";else{if(!(this.conf.allow_free_text||""==this.base.firstChild.value&&this.conf.allow_empty_value))return this._cancelSelect(),void this._updateTopImage(this.conf.last_selected);e=e||this.conf.last_text!=this.base.firstChild.value,this.conf.last_match=this.conf.last_value=this.conf.last_selected=null,this.conf.last_text=this.base.firstChild.value,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_text,this.base.childNodes[2].value="true"}this.conf.f_ac&&"start"==this.conf.f_mode&&(this.conf.f_ac_text="","blur"!=t&&this._selectRange(this.base.firstChild.value.length,this.base.firstChild.value.length)),this._hideList(),1==e&&"onInit"!=t&&"onDelete"!=t&&this.callEvent("onChange",[this.conf.last_value,this.conf.last_text])},dhtmlXCombo.prototype._cancelSelect=function(){this._hideList(),this.base.firstChild.value=this.conf.last_text,0!=this.conf.f_mode&&this._filterOpts(!0)},dhtmlXCombo.prototype._getOption=function(t,e){if(!this.t[t])return null;if(void 0===e&&(e=-1),e<0)for(var i=0;i<this.list.childNodes.length;i++)e<0&&this.list.childNodes[i]._optId==t&&(e=i);var s={value:this.t[t].obj.getValue(this.t[t].item),text:this.t[t].obj.getText(this.t[t].item),text_input:this.t[t].obj.getText(this.t[t].item,!0),text_option:this.t[t].obj.getText(this.t[t].item,null,!0),css:this.t[t].obj.getCss(this.t[t].item),selected:t==this.conf.last_selected,index:e};if("function"==typeof this.t[t].obj.getExtraData){var n=this.t[t].obj.getExtraData(this.t[t].item);for(var l in n)void 0===s[l]&&(s[l]=n[l])}return s},dhtmlXCombo.prototype._getOptionProp=function(t,e,i){if(null!=t){var s=this._getOption(t);if(null!=s)return s[e]}return i},dhtmlXCombo.prototype._getOptionId=function(t){for(var e=null,i=0;i<this.list.childNodes.length;i++)if(null==e){var s=this.list.childNodes[i]._optId;t==this.t[s].obj.getValue(this.t[s].item)&&(e=s)}return e},dhtmlXCombo.prototype._getOptionValue=function(t){return this._getOptionProp(t,"value",null)},dhtmlXCombo.prototype.setSize=function(t){this.conf.combo_width=parseInt(t)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),this.base.style.width=Math.max(0,this.conf.combo_width)+"px",this._adjustBase()},dhtmlXCombo.prototype._adjustBase=function(){this.base.firstChild.style.width=Math.max(0,this.conf.combo_width-24-(this.conf.combo_image?23:0))+"px",this.base.firstChild.style.marginLeft=this.conf.combo_image?"23px":"0px"},dhtmlXCombo.prototype.setOptionWidth=function(t){this.conf.opts_width=parseInt(t)||null},dhtmlXCombo.prototype.setOptionIndex=function(t,e){if(!(isNaN(e)||e<0)){var i=this.getOption(t);if(null!=i&&e!=i.index){var s=this.list.childNodes[i.index];s.parentNode.removeChild(s),null!=this.list.childNodes[e]?this.list.insertBefore(s,this.list.childNodes[e]):this.list.appendChild(s),s=null}}},dhtmlXCombo.prototype.getOptionsCount=function(){return this.list.childNodes.length},dhtmlXCombo.prototype._mcMakeTemplate=function(t){var e="",i="";this.conf.col_w=0;for(var s=0;s<t.length;s++){var n=Number(parseInt(t[s].width)||50),l=t[s].css||"",o=0==s&&1==window.dhx4.isIE6?"_first":"";i+="<div class='dhxcombo_cell"+o+" "+l+"' style='width:"+n+"px;'><div class='dhxcombo_cell_text'>"+(t[s].option||"&nbsp;")+"</div></div>",e+="<div class='dhxcombo_hdrcell"+o+" "+l+"' style='width:"+n+"px;'><div class='dhxcombo_hdrcell_text'>"+(t[s].header||"&nbsp;")+"</div></div>",this.conf.col_w+=n+1}n=500;var r=document.createElement("DIV");r.style.position="absolute",r.style.top="10px",r.style.left=2*-n+"px",r.style.width=n+"px",r.style.height="50px",r.style.overflowY="scroll",r.innerHTML="<div>&nbsp;</div>",document.body.appendChild(r),this.conf.col_w+=n-r.firstChild.offsetWidth+10,r.parentNode.removeChild(r),r=null,this.conf.template.option=i,this._mcAttachHeader(e),this.list.className+=" dhxcombolist_multicolumn"},dhtmlXCombo.prototype._mcAttachHeader=function(t){null==this.hdr&&(this.hdr=document.createElement("DIV"),this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr",this.hdr.style.display="none",this.list.parentNode.insertBefore(this.hdr,this.list),"function"==typeof window.addEventListener?this.hdr.addEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.attachEvent("onmousedown",this._doOnListMouseDown),"checkbox"==this.conf.opts_type&&1==this.conf.combo_image&&(this.conf.combo_image=!1,null!=this.base.lastChild.className.match(/dhxcombo_top_image/)&&this.base.removeChild(this.base.lastChild),this._adjustBase())),this.hdr.innerHTML="<div class='dhxcombo_hdrtext'>"+t+"</div>"},dhtmlXCombo.prototype._mcDetachHeader=function(){null!=this.hdr&&("function"==typeof window.addEventListener?this.hdr.removeEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.detachEvent("onmousedown",this._doOnListMouseDown),this.hdr.parentNode.removeChild(this.hdr),this.hdr=null),this.conf.col_w=null,this.conf.item_h=null},dhtmlXCombo.prototype.modes={},dhtmlXCombo.prototype.doWithItem=function(t,e,i,s){var n=t>=0&&t<this.list.childNodes.length?this.list.childNodes[t]._optId:null;if(null==n)return null;if("function"!=typeof this.t[n].obj[e])return null;for(var l=[this.t[n].item],o=2;o<arguments.length;o++)l.push(arguments[o]);return this.t[n].obj[e].apply(this.t[n].obj,l)},dhtmlXCombo.prototype.modes.option={image:!1,option_css:"dhxcombo_option_text",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText=e.css,t._conf.css=e.css),this.setText(t,e.text),this},destruct:function(t){t._conf=null},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text)},setText:function(t,e){t._conf.text=e;var i="object"==typeof e?window.dhx4.template(t._tpl.option,t._conf.text,!0):window.dhx4.trim(t._conf.text||"");t.lastChild.innerHTML=0==i.length?"&nbsp;":i},getText:function(t,e,i){return window.dhx4.s2b(e)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.input,t._conf.text,!0):window.dhx4.s2b(i)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.option,t._conf.text,!0):t._conf.text},getValue:function(t){return t._conf.value},getCss:function(t){return t._conf.css},setSelected:function(t,e){t.className="dhxcombo_option"+(e?" dhxcombo_option_selected":"")},isSelected:function(t){return String(t.className).indexOf("dhxcombo_option_selected")>=0},getExtraData:function(t){return{type:"option"}}},dhtmlXCombo.prototype.modes.checkbox={image:!0,image_css:"dhxcombo_checkbox dhxcombo_chbx_#state#",option_css:"dhxcombo_option_text dhxcombo_option_text_chbx",render:function(t,e){return null==this.image_css_regexp&&(this.image_css_regexp=new RegExp(this.image_css.replace("#state#","\\d*"))),t._conf={value:e.value,css:"",checked:window.dhx4.s2b(e.checked)},t.className="dhxcombo_option",1==e.multicol?(e.text.checkbox="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div>&nbsp;",t.innerHTML="<div class='"+dhtmlXCombo.prototype.modes.option.option_css+"'></div>"):t.innerHTML="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text),this},setChecked:function(t,e){t._conf.checked=window.dhx4.s2b(e);var i=String(this.image_css).replace("#state#",t._conf.checked?"1":"0");this._changeChbxCss(t.childNodes,i)},_changeChbxCss:function(t,e){for(var i=0;i<t.length;i++)null!=t[i].tagName&&null!=t[i].className&&null!=t[i].className.match(this.image_css_regexp)?t[i].className=e:t[i].childNodes.length>0&&this._changeChbxCss(t[i].childNodes,e)},isChecked:function(t){return 1==t._conf.checked},getExtraData:function(t){return{type:"checkbox",checked:t._conf.checked}},optionClick:function(t,e,i){for(var s=!0,n=e.target||e.srcElement;1==s&&null!=n&&n!=t&&null!=n.className;)null!=n.className.match(this.image_css_regexp)?(!0===i.callEvent("onCheck",[t._conf.value,!t._conf.checked])&&this.setChecked(t,!this.isChecked(t)),s=!1):n=n.parentNode;return n=i=t=null,s},getTopImage:function(t,e){return""},topImageClick:function(t,e){return!0}},dhtmlXComboExtend("checkbox","option"),dhtmlXCombo.prototype.setChecked=function(t,e){this.doWithItem(t,"setChecked",e)},dhtmlXCombo.prototype.getChecked=function(t){for(var e=[],i=0;i<this.list.childNodes.length;i++)this.isChecked(i)&&e.push(this._getOptionProp(this.list.childNodes[i]._optId,"value",""));return e},dhtmlXCombo.prototype.isChecked=function(t){return this.doWithItem(t,"isChecked")},dhtmlXCombo.prototype.modes.image={image:!0,image_css:"dhxcombo_image",option_css:"dhxcombo_option_text dhxcombo_option_text_image",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.image_css+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis),this},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis)},setImage:function(t,e,i,s,n,l){e=null!=e&&e.length>0?s+e:null!=n&&n.length>0?s+n:null,i=null!=i&&i.length>0?s+i:null!=l&&l.length>0?s+l:1==l?e:null,t._conf.img=e,t._conf.img_dis=i,t.firstChild.style.backgroundImage=null!=e?"url("+e+")":"none"},getExtraData:function(t){return{type:"image"}},getTopImage:function(t,e){var i=e?"img":"img_dis";return null!=t&&null!=t._conf[i]?"<div class='"+this.image_css+"' style='background-image:url("+t._conf[i]+");'></div>":""}},dhtmlXComboExtend("image","option"),dhtmlXCombo.prototype.setDefaultImage=function(t,e){null!=t&&(this.conf.img_def=t),null!=e&&(this.conf.img_def_dis=e)},dhtmlXCombo.prototype.setImagePath=function(t){this.conf.img_path=t},dhtmlXMenuObject.prototype._init=function(){1!=this._isInited&&(this.conf.dload?(this._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)):(this._initTopLevelMenu(),this._isInited=!0))},dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(t){var e=0;for(var i in this.itemPull){var s=this.itemPull[i].parent,n=this.itemPull[i].type;null!=this.idPull[i]&&(s!=t||"item"!=n&&"radio"!=n&&"checkbox"!=n||"none"==this.idPull[i].style.display||e++)}return e},dhtmlXMenuObject.prototype._redefineComplexState=function(t){if(this.idPrefix+this.topId!=t&&null!=this.idPull["polygon_"+t]&&null!=this.idPull[t]){var e=this._countVisiblePolygonItems(t);e>0&&!this.itemPull[t].complex&&this._updateItemComplexState(t,!0,!1),0==e&&this.itemPull[t].complex&&this._updateItemComplexState(t,!1,!1)}},dhtmlXMenuObject.prototype._updateItemComplexState=function(t,e,i){if(this.conf.context||"TopLevel"!=this._getItemLevelType(t.replace(this.idPrefix,""))){if(null!=this.idPull[t]&&null!=this.itemPull[t]&&(this.itemPull[t].complex=e,t!=this.idPrefix+this.topId)){var s=null,n=this.idPull[t].childNodes[this.conf.rtl?0:2];if(n.childNodes[0]&&0===String(n.childNodes[0].className).search("complex_arrow")&&(s=n.childNodes[0]),this.itemPull[t].complex){if(null==s){for((s=document.createElement("DIV")).className="complex_arrow",s.id="arrow_"+t;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.appendChild(s)}this.conf.dload&&"get"==this.itemPull[t].loaded&&this.conf.dload_icon?"complex_arrow_loading"!=s.className&&(s.className="complex_arrow_loading"):s.className="complex_arrow"}else this.itemPull[t].complex||null==s||(n.removeChild(s),null!=this.itemPull[t].hotkey_backup&&this.setHotKey&&this.setHotKey(t.replace(this.idPrefix,""),this.itemPull[t].hotkey_backup))}}else this.itemPull[t].complex=e},dhtmlXMenuObject.prototype._getItemLevelType=function(t){return this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"},dhtmlXMenuObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXMenuObject.prototype._updateItemImage=function(t,e){t=this.idPrefix+t;var i=this.itemPull[t].type;if("checkbox"!=i&&"radio"!=i){var s=this.itemPull[t].parent==this.idPrefix+this.topId&&!this.conf.context,n=null;if(s)for(var l=0;l<this.idPull[t].childNodes.length;l++)try{"dhtmlxMenu_TopLevel_Item_Icon"==this.idPull[t].childNodes[l].className&&(n=this.idPull[t].childNodes[l])}catch(t){}else{try{n=this.idPull[t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){}null!=n&&void 0!==n.className&&"sub_icon"==n.className||(n=null)}var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(o.length>0)if(null!=n)n.src=this.conf.icons_path+o;else if(s){(n=document.createElement("IMG")).className="dhtmlxMenu_TopLevel_Item_Icon",n.src=this.conf.icons_path+o,n.border="0",n.id="image_"+t,!this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(n,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(n)}else{(n=document.createElement("IMG")).className="sub_icon",n.src=this.conf.icons_path+o,n.border="0",n.id="image_"+t;for(var r=this.idPull[t].childNodes[this.conf.rtl?2:0];r.childNodes.length>0;)r.removeChild(r.childNodes[0]);r.appendChild(n)}else if(null!=n){var a=n.parentNode;a.removeChild(n),a.innerHTML="&nbsp;",a=n=null}}},dhtmlXMenuObject.prototype._getAllParents=function(t){var e=new Array;for(var i in this.itemPull)if(this.itemPull[i].parent==t&&(e[e.length]=this.itemPull[i].id,this.itemPull[i].complex))for(var s=this._getAllParents(this.itemPull[i].id),n=0;n<s.length;n++)e[e.length]=s[n];return e},dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(!this.conf.v_enabled){var t=window.dhx4.screenDim();this.conf.v.x1=t.left,this.conf.v.x2=t.right,this.conf.v.y1=t.top,this.conf.v.y2=t.bottom}},dhtmlXMenuObject.prototype.getItemPosition=function(t){t=this.idPrefix+t;var e=-1;if(null==this.itemPull[t])return e;for(var i=this.itemPull[t].parent,s=null!=this.idPull["polygon_"+i]?this.idPull["polygon_"+i].tbd:this.cont,n=0;n<s.childNodes.length;n++)s.childNodes[n]!=this.idPull["separator_"+t]&&s.childNodes[n]!=this.idPull[t]||(e=n);return e},dhtmlXMenuObject.prototype.setItemPosition=function(t,e){if(t=this.idPrefix+t,null!=this.idPull[t]){var i=this.itemPull[t].parent==this.idPrefix+this.topId,s=this.idPull[t],n=this.getItemPosition(t.replace(this.idPrefix,"")),l=this.itemPull[t].parent,o=null!=this.idPull["polygon_"+l]?this.idPull["polygon_"+l].tbd:this.cont;o.removeChild(o.childNodes[n]),e<0&&(e=0),i&&e<1&&(e=1),e<o.childNodes.length?o.insertBefore(s,o.childNodes[e]):o.appendChild(s)}},dhtmlXMenuObject.prototype.getParentId=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:(null!=this.itemPull[t].parent?this.itemPull[t].parent:this.topId).replace(this.idPrefix,"")},dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()},dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0),this._isInited=!1,this.idPrefix=this._genStr(12)+"_",this.itemPull={}},void 0===dhtmlXMenuObject.prototype.liveInst&&(dhtmlXMenuObject.prototype.liveInst={}),dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(t,e){var i=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var s=0;s<i.length;s++)i[s]!=t&&this._hidePolygon(i[s]),null!=this.idPull[i[s]]&&i[s]!=t&&(this.idPull[i[s]].className=this.idPull[i[s]].className.replace(/Selected/g,"Normal"));"enabled"==this.itemPull[this.idPrefix+t].state&&(this.idPull[this.idPrefix+t].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+t,"parent"),this.conf.selected="win"==this.conf.mode?-1!=this.conf.selected?t:this.conf.selected:t,this.itemPull[this.idPrefix+t].complex&&-1!=this.conf.selected&&this._showPolygon(this.idPrefix+t,this.conf.dir_toplv))},dhtmlXMenuObject.prototype._initTopLevelMenu=function(){if(this.conf.dir_toplv="bottom",this.conf.dir_sublv=this.conf.rtl?"left":"right",this.conf.context)this.idPull[this.idPrefix+this.topId]=new Array(0,0),this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var t=this._getMenuNodes(this.idPrefix+this.topId),e=0;e<t.length;e++)"item"==this.itemPull[t[e]].type&&this._renderToplevelItem(t[e],null),"separator"==this.itemPull[t[e]].type&&this._renderSeparator(t[e],null)},dhtmlXMenuObject.prototype._renderToplevelItem=function(t,e){var i=this,s=document.createElement("DIV");if(s.id=t,"enabled"==this.itemPull[t].state&&null!=this.itemPull[t].cssNormal?s.className=this.itemPull[t].cssNormal:s.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[t].state?"Normal":"Disabled"),""!=this.itemPull[t].title){var n=document.createElement("DIV");n.className="top_level_text",n.innerHTML=this.itemPull[t].title,s.appendChild(n)}if(this.itemPull[t].tip.length>0&&(s.title=this.itemPull[t].tip),""!=this.itemPull[t].imgen||""!=this.itemPull[t].imgdis){var l=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(l){var o=document.createElement("IMG");o.border="0",o.id="image_"+t,o.src=this.conf.icons_path+l,o.className="dhtmlxMenu_TopLevel_Item_Icon",s.childNodes.length>0&&!this.conf.rtl?s.insertBefore(o,s.childNodes[0]):s.appendChild(o)}}s.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},s.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.cont||(this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className="right"==this.conf.align?"align_right":"align_left",this.base.appendChild(this.cont)),null!=e&&(++e<0&&(e=0),e>this.cont.childNodes.length-1&&(e=null)),null!=e?this.cont.insertBefore(s,this.cont.childNodes[e]):this.cont.appendChild(s),this.idPull[s.id]=s,this.itemPull[t].complex&&!this.conf.dload&&this._addSubMenuPolygon(this.itemPull[t].id,this.itemPull[t].id),s.onmouseover=function(){"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler);var t=i._getSubItemToDeselectByPolygon("parent");i._removeSubItemFromSelected(-1,-1);for(var e=0;e<t.length;e++)t[e]!=this.id&&i._hidePolygon(t[e]),null!=i.idPull[t[e]]&&t[e]!=this.id&&(null!=i.itemPull[t[e]].cssNormal?i.idPull[t[e]].className=i.itemPull[t[e]].cssNormal:("sub_item_selected"==i.idPull[t[e]].className&&(i.idPull[t[e]].className="sub_item"),i.idPull[t[e]].className=i.idPull[t[e]].className.replace(/Selected/g,"Normal")));if("enabled"==i.itemPull[this.id].state){if(this.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected",i._addSubItemToSelected(this.id,"parent"),i.conf.selected="win"==i.conf.mode?-1!=i.conf.selected?this.id:i.conf.selected:this.id,i.conf.dload){if("no"==i.itemPull[this.id].loaded){this._dynLoadTM=(new Date).getTime(),i.itemPull[this.id].loaded="get";var s=this.id.replace(i.idPrefix,"");i._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in t.params[this.conf.dload_pid]=s,this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},i.loadStruct(i.conf.dload_url)}i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!0)}if((!i.conf.dload||i.conf.dload&&(!i.itemPull[this.id].loaded||"yes"==i.itemPull[this.id].loaded))&&i.itemPull[this.id].complex&&-1!=i.conf.selected)if(i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context){this._mouseOver=!0;var n=this.id;this._menuOpenTM=window.setTimeout(function(){i._showPolygon(n,i.conf.dir_toplv)},i.conf.top_tmtime)}else i._showPolygon(this.id,i.conf.dir_toplv)}i._doOnTouchMenu(this.id.replace(i.idPrefix,""))},s.onmouseout=function(){i.itemPull[this.id].complex&&-1!=i.conf.selected||"enabled"!=i.itemPull[this.id].state||(null!=i.itemPull[this.id].cssNormal?s.className=i.itemPull[this.id].cssNormal:s.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal"),"web"==i.conf.mode&&(window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i._clearAndHide()},i.conf.tm_sec,"JavaScript")),i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!1,window.clearTimeout(this._menuOpenTM))},s.onclick=function(t){if("web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),"web"==i.conf.mode||"disabled"!=i.itemPull[this.id].state){if((t=t||event).cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,"win"==i.conf.mode&&i.itemPull[this.id].complex){if(i.conf.selected==this.id){i.conf.selected=-1;var e=!1}else{i.conf.selected=this.id;e=!0}e?i._showPolygon(this.id,i.conf.dir_toplv):i._hidePolygon(this.id)}var s=i.itemPull[this.id].complex?"c":"-",n="enabled"!=i.itemPull[this.id].state?"d":"-",l={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};return i._doOnClick(this.id.replace(i.idPrefix,""),s+n+"t",l),!1}},"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addSubMenuPolygon=function(t,e){this._renderSublevelPolygon(t,e);var i=this._getMenuNodes(e);for(s=0;s<i.length;s++)"separator"==this.itemPull[i[s]].type?this._renderSeparator(i[s],null):this._renderSublevelItem(i[s],null);if(t==e);else;for(var s=0;s<i.length;s++)this.itemPull[i[s]].complex&&this._addSubMenuPolygon(t,this.itemPull[i[s]].id)},dhtmlXMenuObject.prototype._renderSublevelPolygon=function(t,e){var i=document.createElement("DIV");i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":""),i.dir="ltr",i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},i.id="polygon_"+e,i.onclick=function(t){(t=t||event).cancelBubble=!0},i.style.display="none",document.body.insertBefore(i,document.body.firstChild),i.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var s=document.createElement("TABLE");s.className="dhtmlxMebu_SubLevelArea_Tbl",s.cellSpacing=0,s.cellPadding=0,s.border=0;var n=document.createElement("TBODY");return s.appendChild(n),i.childNodes[1].appendChild(s),i.tbl=s,i.tbd=n,this.idPull[i.id]=i,null!=this.sxDacProc&&(this.idPull["sxDac_"+e]=new this.sxDacProc(i,i.className),window.dhx4.isIE?(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCycles))),i},dhtmlXMenuObject.prototype._renderSublevelItem=function(t,e){var i=this,s=document.createElement("TR");s.className="enabled"==this.itemPull[t].state?"sub_item":"sub_item_dis";var n=document.createElement("TD");n.className="sub_item_icon";var l=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(""!=l){var o,r=this.itemPull[t].type;if("checkbox"==r||"radio"==r)(o=document.createElement("DIV")).id="image_"+this.itemPull[t].id,o.className="sub_icon "+l,n.appendChild(o);if("checkbox"!=r&&"radio"!=r)(o=document.createElement("IMG")).id="image_"+this.itemPull[t].id,o.className="sub_icon",o.src=this.conf.icons_path+l,n.appendChild(o)}else n.innerHTML="&nbsp;";var a=document.createElement("TD");if(a.className="sub_item_text",""!=this.itemPull[t].title){var h=document.createElement("DIV");h.className="sub_item_text",h.innerHTML=this.itemPull[t].title,a.appendChild(h)}else a.innerHTML="&nbsp;";var d=document.createElement("TD");if(d.className="sub_item_hk",this.itemPull[t].complex){var c=document.createElement("DIV");c.className="complex_arrow",c.id="arrow_"+this.itemPull[t].id,d.appendChild(c)}else if(this.itemPull[t].hotkey.length>0&&!this.itemPull[t].complex){var _=document.createElement("DIV");_.className="sub_item_hk",_.innerHTML=this.itemPull[t].hotkey,d.appendChild(_)}else d.innerHTML="&nbsp;";s.appendChild(this.conf.rtl?d:n),s.appendChild(a),s.appendChild(this.conf.rtl?n:d),s.id=this.itemPull[t].id,s.parent=this.itemPull[t].parent,this.itemPull[t].tip.length>0&&(s.title=this.itemPull[t].tip),s.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},s.onmouseover=function(t){i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),this._visible||i._redistribSubLevelSelection(this.id,this.parent),this._visible=!0},s.onmouseout=function(){"web"==i.conf.mode&&(i.conf.tm_handler&&window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i&&i._clearAndHide&&i._clearAndHide()},i.conf.tm_sec,"JavaScript"));var t=this;i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),i.conf.hide_tm[this.id]=window.setTimeout(function(){t._visible=!1},50)},s.onclick=function(t){if(i.checkEvent("onClick")||!i.itemPull[this.id].complex){(t=t||event).cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,tc=i.itemPull[this.id].complex?"c":"-",td="enabled"==i.itemPull[this.id].state?"-":"d";var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};switch(i.itemPull[this.id].type){case"checkbox":i._checkboxOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"radio":i._radioOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"item":i._doOnClick(this.id.replace(i.idPrefix,""),tc+td+"n",e)}return!1}};var u=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(++e<0&&(e=0),e>u.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=u.tbd.childNodes[e]?u.tbd.insertBefore(s,u.tbd.childNodes[e]):u.tbd.appendChild(s),this.idPull[s.id]=s},dhtmlXMenuObject.prototype._renderSeparator=function(t,e){var i=this.conf.context?"SubLevelArea":this.itemPull[t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";if("TopLevel"!=i||!this.conf.context){var s=this;if("TopLevel"!=i){var n=document.createElement("TR");n.className="sub_sep";var l=document.createElement("TD");l.colSpan="3",n.appendChild(l)}var o=document.createElement("DIV");if(o.id="separator_"+t,o.className="TopLevel"==i?"top_sep":"sub_sep",o.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},o.onclick=function(t){(t=t||event).cancelBubble=!0;var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};s._doOnClick(this.id.replace("separator_"+s.idPrefix,""),"--s",e)},"TopLevel"==i){if(null!=e)++e<0&&(e=0),null!=this.cont.childNodes[e]?this.cont.insertBefore(o,this.cont.childNodes[e]):this.cont.appendChild(o);else{var r=this.cont.childNodes[this.cont.childNodes.length-1];-1==String(r).search("TopLevel_Text")?this.cont.appendChild(o):this.cont.insertBefore(o,r)}this.idPull[o.id]=o}else{var a=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(++e<0&&(e=0),e>a.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=a.tbd.childNodes[e]?a.tbd.insertBefore(n,a.tbd.childNodes[e]):a.tbd.appendChild(n),l.appendChild(o),this.idPull[o.id]=n}}},dhtmlXMenuObject.prototype.addNewSeparator=function(t,e){e=this.idPrefix+(null!=e?e:this._genStr(24));var i=this.idPrefix+this.getParentId(t);this._addItemIntoGlobalStrorage(e,i,"","separator",!1,"",""),this._renderSeparator(e,this.getItemPosition(t))},dhtmlXMenuObject.prototype._initObj=function(t,e,i){t instanceof Array||(null!=(i=t.parentId)&&0!==String(i).indexOf(this.idPrefix)&&(i=this.idPrefix+String(i)),t=t.items);for(var s=0;s<t.length;s++){void 0!==t[s].id&&null!=t[s].id||(t[s].id=this._genStr(24)),null==t[s].text&&(t[s].text=""),0!==String(t[s].id).indexOf(this.idPrefix)&&(t[s].id=this.idPrefix+String(t[s].id));var n={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(var l in n)void 0===t[s][l]&&(t[s][l]=n[l]);if(""==t[s].imgen&&null!=t[s].img&&(t[s].imgen=t[s].img),""==t[s].imgdis&&null!=t[s].img_disabled&&(t[s].imgdis=t[s].img_disabled),null==t[s].title&&null!=t[s].text&&(t[s].title=t[s].text),null!=t[s].href&&(null!=t[s].href.link&&(t[s].href_link=t[s].href.link),null!=t[s].href.target&&(t[s].href_target=t[s].href.target)),null!=t[s].userdata)for(var l in t[s].userdata)this.userData[t[s].id+"_"+l]=t[s].userdata[l];void 0!==t[s].enabled&&0==window.dhx4.s2b(t[s].enabled)?t[s].state="disabled":void 0!==t[s].disabled&&1==window.dhx4.s2b(t[s].disabled)&&(t[s].state="disabled"),void 0===t[s].parent&&(t[s].parent=null!=i?i:this.idPrefix+this.topId),"checkbox"==t[s].type&&(t[s].checked=window.dhx4.s2b(t[s].checked),t[s].imgen=t[s].imgdis="chbx_"+(t[s].checked?"1":"0")),"radio"==t[s].type&&(t[s].checked=window.dhx4.s2b(t[s].checked),t[s].imgen=t[s].imgdis="rdbt_"+(t[s].checked?"1":"0"),void 0!==t[s].group&&null!=t[s].group||(t[s].group=this._genStr(24)),null==this.radio[t[s].group]&&(this.radio[t[s].group]=[]),this.radio[t[s].group].push(t[s].id)),this.itemPull[t[s].id]=t[s],null!=t[s].items&&t[s].items.length>0?(this.itemPull[t[s].id].complex=!0,this._initObj(t[s].items,!0,t[s].id)):this.conf.dload&&1==t[s].complex&&(this.itemPull[t[s].id].loaded="no"),this.itemPull[t[s].id].items=null}if(!0!==e)if(1==this.conf.dload)if(null==i)this._initTopLevelMenu();else{if(this._addSubMenuPolygon(i,i),this.conf.selected==i){var o=this.itemPull[i].parent==this.idPrefix+this.topId,r=o&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv,a=!1;if(o&&this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context){var h=this.idPull[i];if(1==h._mouseOver){var d=this.conf.top_tmtime-((new Date).getTime()-h._dynLoadTM);if(d>1){var c=i,_=this;h._menuOpenTM=window.setTimeout(function(){_._showPolygon(c,r),_=c=null},d),a=!0}}}a||this._showPolygon(i,r)}this.itemPull[i].loaded="yes",1==this.conf.dload_icon&&this._updateLoaderIcon(i,!1)}else this._init()},dhtmlXMenuObject.prototype._xmlToJson=function(t,e){var i=[];if(null==e){var s=t.getElementsByTagName(this.conf.tags.root);if(null==s||null!=s&&0==s.length)return{items:[]};s=s[0]}else s=t;null!=s.getAttribute("parentId")&&(e=this.idPrefix+s.getAttribute("parentId"));for(var n=0;n<s.childNodes.length;n++)if(void 0!==s.childNodes[n].tagName&&String(s.childNodes[n].tagName).toLowerCase()==this.conf.tags.item){var l=s.childNodes[n],o={id:this.idPrefix+(l.getAttribute("id")||this._genStr(24)),title:l.getAttribute("text")||"",imgen:l.getAttribute("img")||"",imgdis:l.getAttribute("imgdis")||"",tip:"",hotkey:"",type:l.getAttribute("type")||"item"};if(null!=l.getAttribute("cssNormal")&&(o.cssNormal=l.getAttribute("cssNormal")),"checkbox"==o.type&&(o.checked=l.getAttribute("checked")),"radio"==o.type&&(o.checked=l.getAttribute("checked"),o.group=l.getAttribute("group")),o.state="enabled",null!=l.getAttribute("enabled")&&0==window.dhx4.s2b(l.getAttribute("enabled"))?o.state="disabled":null!=l.getAttribute("disabled")&&1==window.dhx4.s2b(l.getAttribute("disabled"))&&(o.state="disabled"),o.parent=null!=e?e:this.idPrefix+this.topId,this.conf.dload)o.complex=null!=l.getAttribute("complex"),o.complex&&(o.loaded="no");else{var r=this._xmlToJson(l,o.id);o.items=r.items,o.complex=o.items.length>0}for(var a=0;a<l.childNodes.length;a++)if(void 0!==l.childNodes[a].tagName){var h=String(l.childNodes[a].tagName||"").toLowerCase();if(h==this.conf.tags.userdata){var d=l.childNodes[a];null!=d.getAttribute("name")&&(this.userData[o.id+"_"+d.getAttribute("name")]=null!=d.firstChild&&null!=d.firstChild.nodeValue?d.firstChild.nodeValue:"")}h==this.conf.tags.text_ext&&(o.title=l.childNodes[a].firstChild.nodeValue),h==this.conf.tags.tooltip&&(o.tip=l.childNodes[a].firstChild.nodeValue),h==this.conf.tags.hotkey&&(o.hotkey=l.childNodes[a].firstChild.nodeValue),h==this.conf.tags.href&&"item"==o.type&&(o.href_link=l.childNodes[a].firstChild.nodeValue,null!=l.childNodes[a].getAttribute("target")&&(o.href_target=l.childNodes[a].getAttribute("target")))}i.push(o)}return l={parentId:e,items:i}},dhtmlXMenuObject.prototype.enableDynamicLoading=function(t,e){this.conf.dload=!0,this.conf.dload_url=t,this.conf.dload_sign=-1==String(this.conf.dload_url).search(/\?/)?"?":"&",this.conf.dload_icon=e,this._init()},dhtmlXMenuObject.prototype._updateLoaderIcon=function(t,e){if(null!=this.idPull[t]&&!(String(this.idPull[t].className).search("TopLevel_Item")>=0)){var i=this.conf.rtl?0:2;if(this.idPull[t].childNodes[i]&&this.idPull[t].childNodes[i].childNodes[0]){var s=this.idPull[t].childNodes[i].childNodes[0];0===String(s.className).search("complex_arrow")&&(s.className="complex_arrow"+(e?"_loading":""))}}},dhtmlXMenuObject.prototype.addNewSibling=function(t,e,i,s,n,l){var o=this.idPrefix+(null!=e?e:this._genStr(24)),r=this.idPrefix+(null!=t?this.getParentId(t):this.topId);this._addItemIntoGlobalStrorage(o,r,i,"item",s,n,l),r!=this.idPrefix+this.topId||this.conf.context?this._renderSublevelItem(o,this.getItemPosition(t)):this._renderToplevelItem(o,this.getItemPosition(t))},dhtmlXMenuObject.prototype.addNewChild=function(t,e,i,s,n,l,o){if(null==t){if(!this.conf.context)return this.addNewSibling(t,i,s,n,l,o),void(null!=e&&this.setItemPosition(i,e));t=this.topId}i=this.idPrefix+(null!=i?i:this._genStr(24)),this.setHotKey&&this.setHotKey(t,""),t=this.idPrefix+t,this._addItemIntoGlobalStrorage(i,t,s,"item",n,l,o),null==this.idPull["polygon_"+t]&&this._renderSublevelPolygon(t,t),this._renderSublevelItem(i,e-1),this._redefineComplexState(t)},dhtmlXMenuObject.prototype.removeItem=function(t,e,i){e||(t=this.idPrefix+t);var s=null;if(t!=this.idPrefix+this.topId){if(null==this.itemPull[t])return;this.idPull["polygon_"+t]&&this.idPull["polygon_"+t]._tmShow&&window.clearTimeout(this.idPull["polygon_"+t]._tmShow);var n=this.itemPull[t].type;if("separator"==n){var l=this.idPull["separator_"+t];this.itemPull[t].parent==this.idPrefix+this.topId?(l.onclick=null,l.onselectstart=null,l.id=null,l.parentNode.removeChild(l)):(l.childNodes[0].childNodes[0].onclick=null,l.childNodes[0].childNodes[0].onselectstart=null,l.childNodes[0].childNodes[0].id=null,l.childNodes[0].removeChild(l.childNodes[0].childNodes[0]),l.removeChild(l.childNodes[0]),l.parentNode.removeChild(l)),this.idPull["separator_"+t]=null,this.itemPull[t]=null,delete this.idPull["separator_"+t],delete this.itemPull[t],l=null}else{for(s=this.itemPull[t].parent,(l=this.idPull[t]).onclick=null,l.oncontextmenu=null,l.onmouseover=null,l.onmouseout=null,l.onselectstart=null,l.id=null;l.childNodes.length>0;)l.removeChild(l.childNodes[0]);l.parentNode.removeChild(l),this.idPull[t]=null,this.itemPull[t]=null,delete this.idPull[t],delete this.itemPull[t],l=null}n=null}for(var o in this.itemPull)this.itemPull[o].parent==t&&this.removeItem(o,!0,!0);var r=new Array(t);null==s||i||null!=this.idPull["polygon_"+s]&&0==this.idPull["polygon_"+s].tbd.childNodes.length&&(r.push(s),this._updateItemComplexState(s,!1,!1));for(var a=0;a<r.length;a++)if(this.idPull["polygon_"+r[a]]){var h=this.idPull["polygon_"+r[a]];if(h.onclick=null,h.oncontextmenu=null,h.tbl.removeChild(h.tbd),h.tbd=null,h.childNodes[1].removeChild(h.tbl),h.tbl=null,h.id=null,h.parentNode.removeChild(h),h=null,window.dhx4.isIE6){var d="polygon_"+r[a]+"_ie6cover";null!=this.idPull[d]&&(document.body.removeChild(this.idPull[d]),delete this.idPull[d])}null!=this.idPull["arrowup_"+t]&&this._removeArrow&&this._removeArrow("arrowup_"+t),null!=this.idPull["arrowdown_"+t]&&this._removeArrow&&this._removeArrow("arrowdown_"+t),this.idPull["polygon_"+r[a]]=null,delete this.idPull["polygon_"+r[a]]}r=null,"dhx_terrace"==this.conf.skin&&1==arguments.length&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(t,e,i,s,n,l,o){var r={id:t,title:i,imgen:null!=l?l:"",imgdis:null!=o?o:"",type:s,state:1==n?"disabled":"enabled",parent:e,complex:!1,hotkey:"",tip:""};this.itemPull[r.id]=r},dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=!0,1==this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle",""),this.base._autoSkinUpdate=!1),null!=this.conf.ctx_baseid&&this.addContextZone(this.conf.ctx_baseid)},dhtmlXMenuObject.prototype.addContextZone=function(t){if(t==document.body){t="document.body."+this.idPrefix;var e=document.body}else if("string"==typeof t)e=document.getElementById(t);else e=t;var i=!1;for(var s in this.conf.ctx_zones)i=i||s==t||this.conf.ctx_zones[s]==e;if(1==i)return!1;this.conf.ctx_zones[t]=e;var n=this;window.dhx4.isOpera?(this.operaContext=function(t){n._doOnContextMenuOpera(t,n)},e.addEventListener("mouseup",this.operaContext,!1)):(null==e.oncontextmenu||e._oldContextMenuHandler||(e._oldContextMenuHandler=e.oncontextmenu),e.oncontextmenu=function(t){for(var e in dhtmlXMenuObject.prototype.liveInst)e!=n.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[e].context&&dhtmlXMenuObject.prototype.liveInst[e]._hideContextMenu();return(t=t||event).cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,n._doOnContextBeforeCall(t,this),!1})},dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(t,e){for(var i in dhtmlXMenuObject.prototype.liveInst)i!=e.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[i].context&&dhtmlXMenuObject.prototype.liveInst[i]._hideContextMenu();return t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,0==t.button&&1==t.ctrlKey&&e._doOnContextBeforeCall(t,this),!1},dhtmlXMenuObject.prototype.removeContextZone=function(t){if(!this.isContextZone(t))return!1;t==document.body&&(t="document.body."+this.idPrefix);var e=this.conf.ctx_zones[t];window.dhx4.isOpera?e.removeEventListener("mouseup",this.operaContext,!1):(e.oncontextmenu=null!=e._oldContextMenuHandler?e._oldContextMenuHandler:null,e._oldContextMenuHandler=null);try{this.conf.ctx_zones[t]=null,delete this.conf.ctx_zones[t]}catch(t){}return!0},dhtmlXMenuObject.prototype.isContextZone=function(t){if(t==document.body&&null!=this.conf.ctx_zones["document.body."+this.idPrefix])return!0;var e=!1;return null!=this.conf.ctx_zones[t]&&this.conf.ctx_zones[t]==document.getElementById(t)&&(e=!0),e},dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&""==this.idPull["polygon_"+this.idPrefix+this.topId].style.display},dhtmlXMenuObject.prototype._showContextMenu=function(t,e,i){if(this._clearAndHide(),null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;window.clearTimeout(this.conf.tm_handler),this.idPull[this.idPrefix+this.topId]=new Array(t,e),this._showPolygon(this.idPrefix+this.topId,"bottom"),this.callEvent("onContextMenu",[i])},dhtmlXMenuObject.prototype._hideContextMenu=function(){if(null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;this._clearAndHide(),this._hidePolygon(this.idPrefix+this.topId)},dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(t,e){this.conf.ctx_zoneid=e.id,this._clearAndHide(),this._hideContextMenu();var i=t.srcElement||t.target,s=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetX:t.layerX,n=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?t.offsetY:t.layerY,l=window.dhx4.absLeft(i)+s,o=window.dhx4.absTop(i)+n;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[e.id,t])&&this.conf.ctx_autoshow&&(this._showContextMenu(l,o,e.id),this.callEvent("onAfterContextMenu",[e.id,t])):this.conf.ctx_autoshow&&(this._showContextMenu(l,o,e.id),this.callEvent("onAfterContextMenu",[e.id]))},dhtmlXMenuObject.prototype.showContextMenu=function(t,e){this._showContextMenu(t,e,!1)},dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()},dhtmlXMenuObject.prototype.setAutoShowMode=function(t){this.conf.ctx_autoshow=1==t},dhtmlXMenuObject.prototype.setAutoHideMode=function(t){this.conf.ctx_autohide=1==t},dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(t){this.conf.ctx_hideall=1==t},dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall},dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var t in this.itemPull)if(this.itemPull[t].parent==this.idPrefix+this.topId&&null!=this.idPull[t]){var e=!1,i=!1;for(var s in this.idPull[t].parentNode.firstChild==this.idPull[t]&&(e=!0),this.idPull[t].parentNode.lastChild==this.idPull[t]&&(i=!0),this.itemPull)"separator"==this.itemPull[s].type&&this.itemPull[s].parent==this.idPrefix+this.topId&&(this.idPull[t].nextSibling==this.idPull["separator_"+s]&&(i=!0),this.idPull[t].previousSibling==this.idPull["separator_"+s]&&(e=!0));this.idPull[t].style.borderLeftWidth=e?"1px":"0px",this.idPull[t].style.borderTopLeftRadius=this.idPull[t].style.borderBottomLeftRadius=e?"3px":"0px",this.idPull[t].style.borderTopRightRadius=this.idPull[t].style.borderBottomRightRadius=i?"3px":"0px",this.idPull[t]._bl=e,this.idPull[t]._br=i}},dhtmlXMenuObject.prototype._improveTerraceButton=function(t,e){e?(this.idPull[t].style.borderBottomLeftRadius=this.idPull[t]._bl?"3px":"0px",this.idPull[t].style.borderBottomRightRadius=this.idPull[t]._br?"3px":"0px"):(this.idPull[t].style.borderBottomLeftRadius="0px",this.idPull[t].style.borderBottomRightRadius="0px")},void 0!==window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_menu=function(t,e,i,s,n){return void 0!==n?t=n:((t=document.createElement("DIV")).className="dhx_cell_menu_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV"))),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont]),this.conf.ofs_nodes.t.menu=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachMenu=function(t){if(!this.dataNodes.menu)return this.callEvent("_onBeforeContentAttach",["menu"]),void 0===t&&(t={}),void 0===t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("menu").firstChild,this.dataNodes.menu=new dhtmlXMenuObject(t),this._adjustCont(this._idd),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.menu},dhtmlXCellObject.prototype.detachMenu=function(){this.dataNodes.menu&&(this.dataNodes.menu.unload(),this.dataNodes.menu=null,delete this.dataNodes.menu,this._detachObject("menu"))},dhtmlXCellObject.prototype.showMenu=function(){this._mtbShowHide("menu","")},dhtmlXCellObject.prototype.hideMenu=function(){this._mtbShowHide("menu","none")},dhtmlXCellObject.prototype.getAttachedMenu=function(){return this.dataNodes.menu}),dhtmlXMenuObject.prototype.setItemEnabled=function(t){this._changeItemState(t,"enabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.setItemDisabled=function(t){this._changeItemState(t,"disabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.isItemEnabled=function(t){return null!=this.itemPull[this.idPrefix+t]&&"enabled"==this.itemPull[this.idPrefix+t].state},dhtmlXMenuObject.prototype._changeItemState=function(t,e,i){var s=this.idPrefix+t;return null!=this.itemPull[s]&&null!=this.idPull[s]&&this.itemPull[s].state!=e&&(this.itemPull[s].state=e,this.itemPull[s].parent!=this.idPrefix+this.topId||this.conf.context?this.idPull[s].className="sub_item"+("enabled"==this.itemPull[s].state?"":"_dis"):this.idPull[s].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[s].state?"Normal":"Disabled"),this._updateItemComplexState(this.idPrefix+t,this.itemPull[this.idPrefix+t].complex,!1),this._updateItemImage(t,i),this.idPrefix+this.conf.last_click==s&&"TopLevel"!=i&&this._redistribSubLevelSelection(s,this.itemPull[s].parent),"TopLevel"==i&&this.conf.context),!1},dhtmlXMenuObject.prototype.getItemText=function(t){return null!=this.itemPull[this.idPrefix+t]?this.itemPull[this.idPrefix+t].title:""},dhtmlXMenuObject.prototype.setItemText=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t])if(this._clearAndHide(),this.itemPull[t].title=e,this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context){for(i=null,s=0;s<this.idPull[t].childNodes[1].childNodes.length;s++)"sub_item_text"==String(this.idPull[t].childNodes[1].childNodes[s].className||"")&&(i=this.idPull[t].childNodes[1].childNodes[s]);""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?i&&(i.parentNode.removeChild(i),i=null,this.idPull[t].childNodes[1].innerHTML="&nbsp;"):(i||((i=document.createElement("DIV")).className="sub_item_text",this.idPull[t].childNodes[1].innerHTML="",this.idPull[t].childNodes[1].appendChild(i)),i.innerHTML=this.itemPull[t].title)}else{for(var i=null,s=0;s<this.idPull[t].childNodes.length;s++)try{"top_level_text"==this.idPull[t].childNodes[s].className&&(i=this.idPull[t].childNodes[s])}catch(t){}""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?null!=i&&i.parentNode.removeChild(i):(i||((i=document.createElement("DIV")).className="top_level_text",this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(i,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(i)),i.innerHTML=this.itemPull[t].title)}},dhtmlXMenuObject.prototype.loadFromHTML=function(t,e,i){var s=this.conf.tags.item;this.conf.tags.item="div";var n="string"==typeof t?document.getElementById(t):t,l=this._xmlToJson(n,this.idPrefix+this.topId);this._initObj(l),this.conf.tags.item=s,e&&n.parentNode.removeChild(n),n=objOd=null,null!=onload&&("function"==typeof i?i():"function"==typeof window[i]&&window[i]())},dhtmlXMenuObject.prototype.hideItem=function(t){this._changeItemVisible(t,!1)},dhtmlXMenuObject.prototype.showItem=function(t){this._changeItemVisible(t,!0)},dhtmlXMenuObject.prototype.isItemHidden=function(t){var e=null;return null!=this.idPull[this.idPrefix+t]&&(e="none"==this.idPull[this.idPrefix+t].style.display),e},dhtmlXMenuObject.prototype._changeItemVisible=function(t,e){var i=this.idPrefix+t;null!=this.itemPull[i]&&("separator"==this.itemPull[i].type&&(i="separator_"+i),null!=this.idPull[i]&&(this.idPull[i].style.display=e?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+t].parent)))},dhtmlXMenuObject.prototype.setUserData=function(t,e,i){this.userData[this.idPrefix+t+"_"+e]=i},dhtmlXMenuObject.prototype.getUserData=function(t,e){return null!=this.userData[this.idPrefix+t+"_"+e]?this.userData[this.idPrefix+t+"_"+e]:null},dhtmlXMenuObject.prototype.setOpenMode=function(t){this.conf.mode="win"==t?"win":"web"},dhtmlXMenuObject.prototype.setWebModeTimeout=function(t){this.conf.tm_sec=isNaN(t)?400:t},dhtmlXMenuObject.prototype.getItemImage=function(t){var e=new Array(null,null);return t=this.idPrefix+t,"item"==this.itemPull[t].type&&(e[0]=this.itemPull[t].imgen,e[1]=this.itemPull[t].imgdis),e},dhtmlXMenuObject.prototype.setItemImage=function(t,e,i){"item"==this.itemPull[this.idPrefix+t].type&&(this.itemPull[this.idPrefix+t].imgen=e,this.itemPull[this.idPrefix+t].imgdis=i,this._updateItemImage(t,this._getItemLevelType(t)))},dhtmlXMenuObject.prototype.clearItemImage=function(t){this.setItemImage(t,"","")},dhtmlXMenuObject.prototype.setVisibleArea=function(t,e,i,s){this.conf.v_enabled=!0,this.conf.v.x1=t,this.conf.v.x2=e,this.conf.v.y1=i,this.conf.v.y2=s},dhtmlXMenuObject.prototype.setTooltip=function(t,e){t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.idPull[t].title=e.length>0?e:null,this.itemPull[t].tip=e)},dhtmlXMenuObject.prototype.getTooltip=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].tip},dhtmlXMenuObject.prototype.setTopText=function(t){this.conf.context||(null==this._topText&&(this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.rtl?"left":"left"==this.conf.align?"right":"left"),this.base.appendChild(this._topText)),this._topText.innerHTML=t)},dhtmlXMenuObject.prototype.setAlign=function(t){this.conf.align!=t&&("left"!=t&&"right"!=t||(this.conf.align=t,this.cont&&(this.cont.className="right"==this.conf.align?"align_right":"align_left"),null!=this._topText&&(this._topText.className="dhtmlxMenu_TopLevel_Text_"+("left"==this.conf.align?"right":"left"))))},dhtmlXMenuObject.prototype.setHref=function(t,e,i){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].href_link=e,null!=i&&(this.itemPull[this.idPrefix+t].href_target=i))},dhtmlXMenuObject.prototype.clearHref=function(t){null!=this.itemPull[this.idPrefix+t]&&(delete this.itemPull[this.idPrefix+t].href_link,delete this.itemPull[this.idPrefix+t].href_target)},dhtmlXMenuObject.prototype.getCircuit=function(t){for(var e=new Array(t);this.getParentId(t)!=this.topId;)t=this.getParentId(t),e[e.length]=t;return e.reverse()},dhtmlXMenuObject.prototype._getCheckboxState=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].checked},dhtmlXMenuObject.prototype._setCheckboxState=function(t,e){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].checked=e)},dhtmlXMenuObject.prototype._updateCheckboxImage=function(t){if(null!=this.idPull[this.idPrefix+t]){this.itemPull[this.idPrefix+t].imgen="chbx_"+(this._getCheckboxState(t)?"1":"0"),this.itemPull[this.idPrefix+t].imgdis=this.itemPull[this.idPrefix+t].imgen;try{this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+t].imgen}catch(t){}}},dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t]){var s=this._getCheckboxState(t);this.checkEvent("onCheckboxClick")?this.callEvent("onCheckboxClick",[t,s,this.conf.ctx_zoneid,i])&&this.setCheckboxState(t,!s):this.setCheckboxState(t,!s),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.setCheckboxState=function(t,e){this._setCheckboxState(t,e),this._updateCheckboxImage(t)},dhtmlXMenuObject.prototype.getCheckboxState=function(t){return this._getCheckboxState(t)},dhtmlXMenuObject.prototype.addCheckbox=function(t,e,i,s,n,l,o){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var r="chbx_"+(l?"1":"0"),a=r;if("sibling"==t){var h=this.idPrefix+(null!=s?s:this._genStr(24)),d=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(h,d,n,"checkbox",o,r,a),this.itemPull[h].checked=l,this._renderSublevelItem(h,this.getItemPosition(e))}else{h=this.idPrefix+(null!=s?s:this._genStr(24)),d=this.idPrefix+e;this._addItemIntoGlobalStrorage(h,d,n,"checkbox",o,r,a),this.itemPull[h].checked=l,null==this.idPull["polygon_"+d]&&this._renderSublevelPolygon(d,d),this._renderSublevelItem(h,i-1),this._redefineComplexState(d)}},dhtmlXMenuObject.prototype.setHotKey=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context)&&!this.itemPull[t].complex){var i=this.itemPull[t].type;if("item"==i||"checkbox"==i||"radio"==i){var s=null;try{"sub_item_hk"==this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0].className&&(s=this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0])}catch(t){}if(0==e.length)this.itemPull[t].hotkey_backup=this.itemPull[t].hotkey,this.itemPull[t].hotkey="",null!=s&&s.parentNode.removeChild(s);else{if(this.itemPull[t].hotkey=e,this.itemPull[t].hotkey_backup=null,null==s){(s=document.createElement("DIV")).className="sub_item_hk";for(var n=this.idPull[t].childNodes[this.conf.rtl?0:2];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.appendChild(s)}s.innerHTML=e}}}},dhtmlXMenuObject.prototype.getHotKey=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].hotkey},dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(t){for(var e=this._getSubItemToDeselectByPolygon(t),i=0;i<this.conf.opened_poly.length;i++)this.conf.opened_poly[i]!=t&&this._hidePolygon(this.conf.opened_poly[i]);for(i=0;i<e.length;i++)null!=this.idPull[e[i]]&&"enabled"==this.itemPull[e[i]].state&&(this.idPull[e[i]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal")},dhtmlXMenuObject.prototype._checkArrowsState=function(t){var e=this.idPull["polygon_"+t].childNodes[1],i=this.idPull["arrowup_"+t],s=this.idPull["arrowdown_"+t];0==e.scrollTop?i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled":i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(i.over?"_Over":""),e.scrollTop+e.offsetHeight<e.scrollHeight?s.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(s.over?"_Over":""):s.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled",e=i=s=null},dhtmlXMenuObject.prototype._addUpArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowup_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp",i.over=!1,i.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,e._canScrollUp=!0,e._doScrollUp(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollUp=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(e.conf.of_utm))},i.onclick=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var s=this.idPull["polygon_"+this.idPrefix+t];s.childNodes[0].appendChild(i),this.idPull[i.id]=i,s=i=null},dhtmlXMenuObject.prototype._addDownArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowdown_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown",i.over=!1,i.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,e._canScrollDown=!0,e._doScrollDown(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollDown=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(e.conf.of_dtm))},i.onclick=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var s=this.idPull["polygon_"+this.idPrefix+t];s.childNodes[2].appendChild(i),this.idPull[i.id]=i,s=i=null},dhtmlXMenuObject.prototype._removeUpArrow=function(t){var e="arrowup_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeDownArrow=function(t){var e="arrowdown_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeArrow=function(t){var e=this.idPull[t];e.onselectstart=null,e.oncontextmenu=null,e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.parentNode&&e.parentNode.removeChild(e),e=null,this.idPull[t]=null;try{delete this.idPull[t]}catch(t){}},dhtmlXMenuObject.prototype._isArrowExists=function(t){return null!=this.idPull["arrowup_"+t]&&null!=this.idPull["arrowdown_"+t]},dhtmlXMenuObject.prototype._doScrollUp=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollUp&&i.scrollTop>0){var s=!1,n=i.scrollTop-this.conf.of_ustep;if(n<0&&(s=!0,n=0),i.scrollTop=n,s)e=!0;else{var l=this;this.conf.of_utm=window.setTimeout(function(){l._doScrollUp(t,!1),l=null},this.conf.of_utime)}}else this._canScrollUp=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._doScrollDown=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollDown&&i.scrollTop+i.offsetHeight<=i.scrollHeight){var s=!1,n=i.scrollTop+this.conf.of_dstep;if(n+i.offsetHeight>=i.scrollHeight&&(s=!0,n=i.scrollHeight-i.offsetHeight),i.scrollTop=n,s)e=!0;else{var l=this;this.conf.of_dtm=window.setTimeout(function(){l._doScrollDown(t,!1),l=null},this.conf.of_dtime)}}else this._canScrollDown=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._countPolygonItems=function(t){var e=0;for(var i in this.itemPull){var s=this.itemPull[i].parent,n=this.itemPull[i].type;s!=this.idPrefix+t||"item"!=n&&"radio"!=n&&"checkbox"!=n||e++}return e},dhtmlXMenuObject.prototype.setOverflowHeight=function(t){if("auto"===t)return this.conf.overflow_limit=0,void(this.conf.auto_overflow=!0);if(!(0==this.conf.overflow_limit&&t<=0))if(this._clearAndHide(),this.conf.overflow_limit>=0&&t>0)this.conf.overflow_limit=t;else if(this.conf.overflow_limit>0&&t<=0){for(var e in this.itemPull)if(this._isArrowExists(e)){var i=String(e).replace(this.idPrefix,"");this._removeUpArrow(i),this._removeDownArrow(i),this.idPull["polygon_"+e].childNodes[1].style.height=""}this.conf.overflow_limit=0}else;},dhtmlXMenuObject.prototype._getRadioImgObj=function(t){try{var e=this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){e=null}return e},dhtmlXMenuObject.prototype._setRadioState=function(t,e){var i=this._getRadioImgObj(t);if(null!=i){var s=this.itemPull[this.idPrefix+t];s.checked=e,s.imgen="rdbt_"+(s.checked?"1":"0"),s.imgdis=s.imgen,i.className="sub_icon "+s.imgen}},dhtmlXMenuObject.prototype._radioOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t].group){var s=this.itemPull[this.idPrefix+t].group;this.checkEvent("onRadioClick")?this.callEvent("onRadioClick",[s,this.getRadioChecked(s),t,this.conf.ctx_zoneid,i])&&this.setRadioChecked(s,t):this.setRadioChecked(s,t),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.getRadioChecked=function(t){for(var e=null,i=0;i<this.radio[t].length;i++){var s=this.radio[t][i].replace(this.idPrefix,""),n=this._getRadioImgObj(s);if(null!=n)null!=n.className.match(/rdbt_1$/gi)&&(e=s)}return e},dhtmlXMenuObject.prototype.setRadioChecked=function(t,e){if(null!=this.radio[t])for(var i=0;i<this.radio[t].length;i++){var s=this.radio[t][i].replace(this.idPrefix,"");this._setRadioState(s,s==e)}},dhtmlXMenuObject.prototype.addRadioButton=function(t,e,i,s,n,l,o,r){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var a=this.idPrefix+(null!=s?s:this._genStr(24)),h="rdbt_"+(o?"1":"0"),d=h;if("sibling"==t){var c=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(a,c,n,"radio",r,h,d),this._renderSublevelItem(a,this.getItemPosition(e))}else{c=this.idPrefix+e;this._addItemIntoGlobalStrorage(a,c,n,"radio",r,h,d),null==this.idPull["polygon_"+c]&&this._renderSublevelPolygon(c,c),this._renderSublevelItem(a,i-1),this._redefineComplexState(c)}var _=null!=l?l:this._genStr(24);this.itemPull[a].group=_,null==this.radio[_]&&(this.radio[_]=new Array),this.radio[_][this.radio[_].length]=a,1==o&&this.setRadioChecked(_,String(a).replace(this.idPrefix,""))},dhtmlXMenuObject.prototype.serialize=function(){return"<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>"},dhtmlXMenuObject.prototype._readLevel=function(t){var e="";for(var i in this.itemPull)if(this.itemPull[i].parent==t){var s="",n="",l="",o=String(this.itemPull[i].id).replace(this.idPrefix,""),r="",a=""!=this.itemPull[i].title?' text="'+this.itemPull[i].title+'"':"",h="";"item"==this.itemPull[i].type&&(""!=this.itemPull[i].imgen&&(s=' img="'+this.itemPull[i].imgen+'"'),""!=this.itemPull[i].imgdis&&(n=' imgdis="'+this.itemPull[i].imgdis+'"'),""!=this.itemPull[i].hotkey&&(l="<hotkey>"+this.itemPull[i].hotkey+"</hotkey>")),"separator"==this.itemPull[i].type?r=' type="separator"':"disabled"==this.itemPull[i].state&&(h=' enabled="false"'),"checkbox"==this.itemPull[i].type&&(r=' type="checkbox"'+(this.itemPull[i].checked?' checked="true"':"")),"radio"==this.itemPull[i].type&&(r=' type="radio" group="'+this.itemPull[i].group+'" '+(this.itemPull[i].checked?' checked="true"':"")),e+="<item id='"+o+"'"+a+r+s+n+h+">",e+=l,this.itemPull[i].complex&&(e+=this._readLevel(i)),e+="</item>"}return e},dhtmlXMenuObject.prototype.enableEffect=function(t,e,i){for(var s in this._menuEffect=("opacity"==t||"slide"==t||"slide+"==t)&&t,this._pOpStyleIE=navigator.userAgent.search(/MSIE\s[678]\.0/gi)>=0,this.idPull)0===s.search(/polygon/)&&(this._pOpacityApply(s,this._pOpStyleIE?100:1),this.idPull[s].style.height="");this._pOpMax=(void 0===e?100:e)/(this._pOpStyleIE?1:100),this._pOpStyleName=this._pOpStyleIE?"filter":"opacity",this._pOpStyleValue=this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#",this._pSlSteps=this._pOpStyleIE?10:20,this._pSlTMTimeMax=i||50},dhtmlXMenuObject.prototype._showPolygonEffect=function(t){this._pShowHide(t,!0)},dhtmlXMenuObject.prototype._hidePolygonEffect=function(t){this._pShowHide(t,!1)},dhtmlXMenuObject.prototype._pOpacityApply=function(t,e){this.idPull[t].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",e||this.idPull[t]._op)},dhtmlXMenuObject.prototype._pShowHide=function(t,e){if(this.idPull){if(null!=this.idPull[t]._tmShow){if(this.idPull[t]._step_h>0&&1==e||this.idPull[t]._step_h<0&&0==e)return;window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._tmShow=null,this.idPull[t]._max_h=null}if(0!=e||"hidden"!=this.idPull[t].style.visibility&&"none"!=this.idPull[t].style.display){if(1==e&&"none"==this.idPull[t].style.display&&(this.idPull[t].style.visibility="hidden",this.idPull[t].style.display=""),null==this.idPull[t]._max_h){if(this.idPull[t]._max_h=parseInt(this.idPull[t].offsetHeight),this.idPull[t]._h=1==e?0:this.idPull[t]._max_h,this.idPull[t]._step_h=Math.round(this.idPull[t]._max_h/this._pSlSteps)*(1==e?1:-1),0==this.idPull[t]._step_h)return;this.idPull[t]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps),"slide+"==this._menuEffect||"opacity"==this._menuEffect?(this.idPull[t].op_tm=this.idPull[t]._step_tm,this.idPull[t].op_step=this._pOpMax/this._pSlSteps*(1==e?1:-1),this._pOpStyleIE&&(this.idPull[t].op_step=Math.round(this.idPull[t].op_step)),this.idPull[t]._op=1==e?0:this._pOpMax,this._pOpacityApply(t)):(this.idPull[t]._op=this._pOpStyleIE?100:1,this._pOpacityApply(t)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height="0px"),this.idPull[t].style.visibility="visible"}this._pEffectSet(t,this.idPull[t]._h+this.idPull[t]._step_h)}}},dhtmlXMenuObject.prototype._pEffectSet=function(t,e){if(this.idPull)if(this.idPull[t]._tmShow&&window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._h=Math.max(0,Math.min(e,this.idPull[t]._max_h)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=this.idPull[t]._h+"px"),e+=this.idPull[t]._step_h,"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[t]._op+this.idPull[t].op_step)),this._pOpacityApply(t)),this.idPull[t]._step_h>0&&e<=this.idPull[t]._max_h||this.idPull[t]._step_h<0&&e>=0){var i=this;this.idPull[t]._tmShow=window.setTimeout(function(){i._pEffectSet(t,e)},this.idPull[t]._step_tm)}else 0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=""),this.idPull[t]._step_h<0&&(this.idPull[t].style.visibility="hidden"),"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=this.idPull[t]._step_h<0?this._pOpStyleIE?100:1:this._pOpMax,this._pOpacityApply(t)),this.idPull[t]._tmShow=null,this.idPull[t]._h=null,this.idPull[t]._max_h=null,this.idPull[t]._step_tm=null},dhtmlXToolbarObject.prototype.addSpacer=function(t){var e=this.idPrefix+t;if(null!=this._spacer){if(this._spacer.idd==t)return;if(this._spacer==this.objPull[e].obj.parentNode){for(var i=!0;i;){var s=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]),s!=t&&0!=this._spacer.childNodes.length||(null!=this.objPull[e].arw&&this.base.appendChild(this.objPull[e].arw),i=!1)}return this._spacer.idd=t,void this._fixSpacer()}if(this.base==this.objPull[e].obj.parentNode){i=!0;for(var n=null!=this.objPull[e].arw;i;){var l=this.base.childNodes.length-1;1==n&&this.base.childNodes[l]==this.objPull[e].arw&&(i=!1),this.base.childNodes[l].idd==t&&(i=!1),i&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[l],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[l]))}return this._spacer.idd=t,void this._fixSpacer()}}else{var o=null;for(l=0;l<this.base.childNodes.length;l++)this.base.childNodes[l]==this.objPull[this.idPrefix+t].obj&&(o=l,null!=this.objPull[this.idPrefix+t].arw&&(o=l+1));if(null!=o){for(this._spacer=document.createElement("DIV"),this._spacer.className="right"==this.conf.align?" dhxtoolbar_float_left":" dhxtoolbar_float_right",this._spacer.dir="ltr",this._spacer.idd=t;this.base.childNodes.length>o+1;)this._spacer.appendChild(this.base.childNodes[o+1]);this.cont.appendChild(this._spacer),this._fixSpacer()}}"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer),this._spacer=null,"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()}},dhtmlXToolbarObject.prototype._fixSpacer=function(){if(void 0===window.addEventListener&&null!=this._spacer){this._spacer.style.borderLeft="1px solid #a4bed4";var t=this._spacer;window.setTimeout(function(){t.style.borderLeft="0px solid #a4bed4",t=null},1)}},dhtmlXToolbarObject.prototype.getType=function(t){var e=this.getParentId(t);if(null!=e){var i=null,s=this.objPull[this.idPrefix+e]._listOptions[t];return null!=s&&(i=null!=s.sep?"buttonSelectSeparator":"buttonSelectButton"),i}return null==this.objPull[this.idPrefix+t]?null:this.objPull[this.idPrefix+t].type},dhtmlXToolbarObject.prototype.getTypeExt=function(t){var e=this.getType(t);return"buttonSelectButton"==e||"buttonSelectSeparator"==e?e="buttonSelectButton"==e?"button":"separator":null},dhtmlXToolbarObject.prototype.inArray=function(t,e){for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},dhtmlXToolbarObject.prototype.getParentId=function(t){var e=null;for(var i in this.objPull)if(this.objPull[i]._listOptions)for(var s in this.objPull[i]._listOptions)s==t&&(e=String(i).replace(this.idPrefix,""));return e},dhtmlXToolbarObject.prototype._addItem=function(t,e){"string"==typeof t.text&&(t.text=window.dhx4.trim(t.text),0==t.text.length&&(t.text=null)),this._addItemToStorage(t,e),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.addButton=function(t,e,i,s,n){this._addItem({id:t,type:"button",text:i,img:s,imgdis:n},e)},dhtmlXToolbarObject.prototype.addText=function(t,e,i){this._addItem({id:t,type:"text",text:i},e)},dhtmlXToolbarObject.prototype.addButtonSelect=function(t,e,i,s,n,l,o,r,a,h){for(var d=[],c=0;c<s.length;c++){var _={};s[c]instanceof Array?(_.id=s[c][0],_.type="obj"==s[c][1]?"button":"separator",_.text=s[c][2]||null,_.img=s[c][3]||null):s[c]instanceof Object&&null!=s[c]&&void 0!==s[c].id&&void 0!==s[c].type&&(_.id=s[c].id,_.type="obj"==s[c].type?"button":"separator",_.text=s[c].text,_.img=s[c].img),d.push(_)}this._addItem({id:t,type:"buttonSelect",text:i,img:n,imgdis:l,renderSelect:o,openAll:r,options:d,maxOpen:a,mode:h},e)},dhtmlXToolbarObject.prototype.addButtonTwoState=function(t,e,i,s,n){this._addItem({id:t,type:"buttonTwoState",img:s,imgdis:n,text:i},e)},dhtmlXToolbarObject.prototype.addSeparator=function(t,e){this._addItem({id:t,type:"separator"},e)},dhtmlXToolbarObject.prototype.addSlider=function(t,e,i,s,n,l,o,r,a){this._addItem({id:t,type:"slider",length:i,valueMin:s,valueMax:n,valueNow:l,textMin:o,textMax:r,toolTip:a},e)},dhtmlXToolbarObject.prototype.addInput=function(t,e,i,s){this._addItem({id:t,type:"buttonInput",value:i,width:s},e)},dhtmlXToolbarObject.prototype.forEachItem=function(t){for(var e in this.objPull)this.inArray(this.rootTypes,this.objPull[e].type)&&t(this.objPull[e].id.replace(this.idPrefix,""))},function(){for(var t="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),e=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],i=function(t,e){return function(i,s,n){return i=this.idPrefix+i,null!=this.objPull[i][t]?this.objPull[i][t].call(this.objPull[i],s,n):e}},s=0;s<t.length;s++){var n=t[s],l=e[s];dhtmlXToolbarObject.prototype[n]=i(n,l)}}(),dhtmlXToolbarObject.prototype.showItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].showItem&&(this.objPull[t].showItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.hideItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].hideItem&&(this.objPull[t].hideItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.getPosition=function(t){return this._getPosition(t)},dhtmlXToolbarObject.prototype._getPosition=function(t,e){if(null==this.objPull[this.idPrefix+t])return null;for(var i=null,s=0,n=0;n<this.base.childNodes.length;n++)null!=this.base.childNodes[n].idd&&(this.base.childNodes[n].idd==t&&(i=s),s++);if(!i&&null!=this._spacer)for(n=0;n<this._spacer.childNodes.length;n++)null!=this._spacer.childNodes[n].idd&&(this._spacer.childNodes[n].idd==t&&(i=s),s++);return i},dhtmlXToolbarObject.prototype.setPosition=function(t,e){this._setPosition(t,e)},dhtmlXToolbarObject.prototype._setPosition=function(t,e){if(null!=this.objPull[this.idPrefix+t]){isNaN(e)&&(e=this.base.childNodes.length),e<0&&(e=0);var i=null;this._spacer&&(i=this._spacer.idd,this.removeSpacer());var s=this.objPull[this.idPrefix+t];this.base.removeChild(s.obj),s.arw&&this.base.removeChild(s.arw);var n=this._getIdByPosition(e,!0);null==n[0]?(this.base.appendChild(s.obj),s.arw&&this.base.appendChild(s.arw)):(this.base.insertBefore(s.obj,this.base.childNodes[n[1]]),s.arw&&this.base.insertBefore(s.arw,this.base.childNodes[n[1]+1])),null!=i&&this.addSpacer(i)}},dhtmlXToolbarObject.prototype._getIdByPosition=function(t,e){for(var i=null,s=0,n=0,l=0;l<this.base.childNodes.length;l++)null!=this.base.childNodes[l].idd&&null==i&&s++==t&&(i=this.base.childNodes[l].idd),null==i&&n++;return n=null==i?null:n,1==e?new Array(i,n):i},dhtmlXToolbarObject.prototype.removeItem=function(t){this._removeItem(t),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._removeItem=function(t){var e=this.getType(t);t=this.idPrefix+t;var i=this.objPull[t];if("button"==e&&(i.obj._doOnMouseOver=null,i.obj._doOnMouseOut=null,i.obj._doOnMouseUp=null,i.obj._doOnMouseUpOnceAnywhere=null,i.obj.onclick=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmouseup=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.renderAs=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.state=null,i.img=null,i.imgEn=null,i.imgDis=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null),"buttonTwoState"==e&&(i.obj._doOnMouseOver=null,i.obj._doOnMouseOut=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.renderAs=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.state=null,i.img=null,i.imgEn=null,i.imgDis=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null,i.setItemState=null,i.getItemState=null),"buttonSelect"==e){for(var s in i._listOptions)this.removeListOption(t,s);i._listOptions=null,i.polygon._ie6cover&&(document.body.removeChild(i.polygon._ie6cover),i.polygon._ie6cover=null),i.p_tbl.removeChild(i.p_tbody),i.polygon.removeChild(i.p_tbl),i.polygon.onselectstart=null,document.body.removeChild(i.polygon),i.p_tbody=null,i.p_tbl=null,i.polygon=null,i.obj.onclick=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmouseup=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.idd=null,i.obj.iddPrefix=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.arw.onclick=null,i.arw.onmouseover=null,i.arw.onmouseout=null,i.arw.onmouseup=null,i.arw.onmousedown=null,i.arw.onselectstart=null,i.arw.parentNode.removeChild(i.arw),i.arw=null,i.renderSelect=null,i.state=null,i.type=null,i.id=null,i.img=null,i.imgEn=null,i.imgDis=null,i.openAll=null,i._isListButton=null,i._separatorButtonSelectObject=null,i._buttonButtonSelectObject=null,i.setWidth=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null,i.addListOption=null,i.removeListOption=null,i.showListOption=null,i.hideListOption=null,i.isListOptionVisible=null,i.enableListOption=null,i.disableListOption=null,i.isListOptionEnabled=null,i.setListOptionPosition=null,i.getListOptionPosition=null,i.setListOptionImage=null,i.getListOptionImage=null,i.clearListOptionImage=null,i.setListOptionText=null,i.getListOptionText=null,i.setListOptionToolTip=null,i.getListOptionToolTip=null,i.forEachListOption=null,i.getAllListOptions=null,i.setListOptionSelected=null,i.getListOptionSelected=null}if("buttonInput"==e&&(i.obj.childNodes[0].onkeydown=null,i.obj.removeChild(i.obj.childNodes[0]),i.obj.w=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemToolTip=null,i.getItemToolTip=null,i.setWidth=null,i.getWidth=null,i.setValue=null,i.getValue=null,i.setItemText=null,i.getItemText=null),"slider"==e){for(window.dhx4.isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",i.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",i.pen._doOnMouseMoveEnd,!1)):(document.body.detachEvent("onmousemove",i.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",i.pen._doOnMouseMoveEnd)),i.pen.allowMove=null,i.pen.initXY=null,i.pen.maxX=null,i.pen.minX=null,i.pen.nowX=null,i.pen.newNowX=null,i.pen.valueMax=null,i.pen.valueMin=null,i.pen.valueNow=null,i.pen._definePos=null,i.pen._detectLimits=null,i.pen._doOnMouseMoveStart=null,i.pen._doOnMouseMoveEnd=null,i.pen.onmousedown=null,i.obj.removeChild(i.pen),i.pen=null,i.label.tip=null,document.body.removeChild(i.label),i.label=null,i.obj.onselectstart=null,i.obj.idd=null;i.obj.childNodes.length>0;)i.obj.removeChild(i.obj.childNodes[0]);i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.state=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.setItemToolTipTemplate=null,i.getItemToolTipTemplate=null,i.setMaxValue=null,i.setMinValue=null,i.getMaxValue=null,i.getMinValue=null,i.setValue=null,i.getValue=null,i.showItem=null,i.hideItem=null,i.isVisible=null}"separator"==e&&(i.obj.onselectstart=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.showItem=null,i.hideItem=null,i.isVisible=null),"text"==e&&(i.obj.onselectstart=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setWidth=null,i.setItemText=null,i.getItemText=null),e=null,i=null,this.objPull[this.idPrefix+t]=null,delete this.objPull[this.idPrefix+t]},function(){for(var t="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),e=function(t){return function(e,i,s,n,l,o){if(e=this.idPrefix+e,null!=this.objPull[e]&&"buttonSelect"==this.objPull[e].type)return this.objPull[e][t].call(this.objPull[e],i,s,n,l,o)}},i=0;i<t.length;i++){var s=t[i];dhtmlXToolbarObject.prototype[s]=e(s)}}(),dhtmlXToolbarObject.prototype._rtlParseBtn=function(t,e){return t+e},dhtmlXToolbarObject.prototype._separatorObject=function(t,e,i){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_sep",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this},dhtmlXToolbarObject.prototype._textObject=function(t,e,i){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_text",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},window.dhx4.isIPad&&(this.obj.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.obj.innerHTML=i.text||"",t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(t){this.obj.innerHTML=t},this.getItemText=function(){return this.obj.innerHTML},this.setWidth=function(t){this.obj.style.width=t+"px"},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled,this.imgEn=i.img||"",this.imgDis=i.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.allowClick=!1,this.obj.extAction=i.action||null,this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":"");var s=this;return this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){this.allowClick=!0,0!=s.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className)},this.obj._doOnMouseOut=function(){this.allowClick=!1,0!=s.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.renderAs)},this.obj.onclick=function(e){if(0!=s.state&&0!=this.allowClick){e=e||event;var i=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](i)}catch(e){}t&&t.callEvent&&t.callEvent("onClick",[i])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){return 0==s.state?((e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,e.cancelBubble=!0,!1):"none"==t.anyUsed?(t.anyUsed=this.idd,this.className="dhx_toolbar_btn dhxtoolbar_btn_pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){t.anyUsed="none",this._doOnMouseOut()},!1):void 0},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(0!=s.state&&("none"==t.anyUsed||t.anyUsed==this.idd)){var i=t.anyUsed;this._doOnMouseUp(),window.dhx4.isIPad&&"none"!=i&&t.callEvent("onClick",[this.idd.replace(t.idPrefix,"")])}},window.dhx4.isIPad&&(this.obj.ontouchmove=function(t){this._doOnMouseUp()}),this.obj._doOnMouseUp=function(){t.anyUsed="none",this.className=this.renderAs,this.pressed=!1},this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp(),this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){this._doOnMouseOut()}},t.base.appendChild(this.obj),this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonSelectObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled||"true"==i.enabled,this.imgEn=i.img||"",this.imgDis=i.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.mode=i.mode||"button","select"==this.mode?(this.openAll=!0,this.renderSelect=!1,i.text&&0!=i.text.length||(i.text="&nbsp;")):(this.openAll=1==window.dhx4.s2b(i.openAll),this.renderSelect=null==i.renderSelect||window.dhx4.s2b(i.renderSelect)),this.maxOpen=isNaN(i.maxOpen?i.maxOpen:"")?null:i.maxOpen,this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!t._sbw){var e=document.createElement("DIV");e.className="dhxtoolbar_maxopen_test",document.body.appendChild(e);var i=document.createElement("DIV");i.className="dhxtoolbar_maxopen_test2",e.appendChild(i),t._sbw=e.offsetWidth-i.offsetWidth,e.removeChild(i),i=null,document.body.removeChild(e),e=null}},this._maxOpenTest(),this.obj=document.createElement("DIV"),this.obj.allowClick=!1,this.obj.extAction=i.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed=!1,this.callEvent=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""),t.base.appendChild(this.obj),this.arw=document.createElement("DIV"),this.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(this.state?"def":"dis"),this.arw.style.display=this.obj.style.display,this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>",this.arw.title=this.obj.title,this.arw.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},t.base.appendChild(this.arw);var s=this;if(this.obj.onmouseover=function(e){e=e||event,"none"==t.anyUsed&&s.state&&(s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"))},this.obj.onmouseout=function(){s.obj.allowClick=!1,"none"==t.anyUsed&&s.state&&(s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),s.callEvent=!1)},this.arw.onmouseover=this.obj.onmouseover,this.arw.onmouseout=this.obj.onmouseout,1==this.openAll||(this.obj.onclick=function(e){if(e=e||event,s.obj.allowClick&&s.state&&"none"==t.anyUsed){var i=s.obj.idd.replace(t.idPrefix,"");if(s.obj.extAction)try{window[s.obj.extAction](i)}catch(e){}t.callEvent("onClick",[i])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event,"none"==t.anyUsed&&s.state&&(s.obj.allowClick=!0,s.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",s.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",s.callEvent=!0)},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if((e=e||event).cancelBubble=!0,"none"==t.anyUsed&&s.state&&(s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),window.dhx4.isIPad&&s.callEvent)){var i=s.obj.idd.replace(t.idPrefix,"");t.callEvent("onClick",[i])}}),window.dhx4.isIPad&&(this.obj.ontouchmove=this.obj.onmouseout),this.arw[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event;var i=0===this.className.indexOf("dhx_toolbar_arw")?this:this.nextSibling;if(i._skip?(e=e||event).cancelBubble=!0:i._skip=!0,i=null,s.state){if(t.anyUsed==s.obj.idd)s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),t.anyUsed="none",window.dhx4.zim.clear(s.polygon._idd),s.polygon.style.display="none",s.polygon._ie6cover&&(s.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!0);else{if("none"!=t.anyUsed&&"buttonSelect"==t.objPull[t.idPrefix+t.anyUsed].type){var n=t.objPull[t.idPrefix+t.anyUsed];"none"!=n.polygon.style.display&&(n.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",n.obj.className=n.obj.renderAs,n.arw.className=String(s.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(n.polygon._idd),n.polygon.style.display="none",n.polygon._ie6cover&&(n.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(n.id,!0))}s.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over",s.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",t.anyUsed=s.obj.idd,s.polygon.style.top="0px",s.polygon.style.visibility="hidden",s.polygon.style.zIndex=window.dhx4.zim.reserve(s.polygon._idd),s.polygon.style.display="","dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!1),s._fixMaxOpenHeight(s.maxOpen||null),t._autoDetectVisibleArea();var l=window.dhx4.absTop(s.obj)+s.obj.offsetHeight+t.conf.sel_ofs_y,o=s.polygon.offsetHeight;if(l+o>t.tY2){var r=null!=s.maxOpen?Math.floor((t.tY2-l)/22):0;r>=1?s._fixMaxOpenHeight(r):(l=window.dhx4.absTop(s.obj)-o-t.conf.sel_ofs_y)<0&&(l=0)}if(s.polygon.style.top=l+"px",t.rtl)s.polygon.style.left=window.dhx4.absLeft(s.obj)+s.obj.offsetWidth-s.polygon.offsetWidth+t.conf.sel_ofs_x+"px";else{var a=document.body.scrollLeft+(window.innerWidth||document.body.clientWidth),h=window.dhx4.absLeft(s.obj)+t.conf.sel_ofs_x;h+s.polygon.offsetWidth>a&&(h=window.dhx4.absLeft(s.arw)+s.arw.offsetWidth-s.polygon.offsetWidth),s.polygon.style.left=Math.max(h,5)+"px"}s.polygon.style.visibility="visible",s.polygon._ie6cover&&(s.polygon._ie6cover.style.left=s.polygon.style.left,s.polygon._ie6cover.style.top=s.polygon.style.top,s.polygon._ie6cover.style.width=s.polygon.offsetWidth+"px",s.polygon._ie6cover.style.height=s.polygon.offsetHeight+"px",s.polygon._ie6cover.style.display="")}return!1}},this.arw.onclick=function(t){(t=t||event).cancelBubble=!0},this.arw[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(t){(t=t||event).cancelBubble=!0},!0===this.openAll&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,window.dhx4.isIPad&&(this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend)),this.obj.iddPrefix=t.idPrefix,this._listOptions={},this._fixMaxOpenHeight=function(e){var i="auto",n=!1;if(null!==e){var l=0;for(var o in this._listOptions)l++;l>e?(this._ph=22*e,i=this._ph+"px"):n=!0}this.polygon.style.width="auto",this.polygon.style.height="auto",n||null==s.maxOpen||(this.polygon.style.width=this.p_tbl.offsetWidth+t._sbw+"px",this.polygon.style.height=i)},this._separatorButtonSelectObject=function(t,e,i){return this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.className="tr_sep",this.obj.tr.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td=document.createElement("TD"),this.obj.td.colSpan="2",this.obj.td.className="td_btn_sep",this.obj.td.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},isNaN(i)?i=s.p_tbody.childNodes.length+1:i<1&&(i=1),i>s.p_tbody.childNodes.length?s.p_tbody.appendChild(this.obj.tr):s.p_tbody.insertBefore(this.obj.tr,s.p_tbody.childNodes[i-1]),this.obj.tr.appendChild(this.obj.td),this.obj.sep=document.createElement("DIV"),this.obj.sep.className="btn_sep",this.obj.sep.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td.appendChild(this.obj.sep),s._listOptions[t]=this.obj,this},this._buttonButtonSelectObject=function(e,i,n){var l=!0;void 0!==i.enabled?l=window.dhx4.s2b(i.enabled):void 0!==i.disabled&&(l=window.dhx4.s2b(i.disabled)),this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.en=l,this.obj.tr.extAction=i.action||null,this.obj.tr._selected=null!=i.selected,this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&s.renderSelect?" tr_btn_selected":"":" tr_btn_disabled"),this.obj.tr.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.tr.idd=String(e),isNaN(n)?n=s.p_tbody.childNodes.length+1:n<1&&(n=1),n>s.p_tbody.childNodes.length?s.p_tbody.appendChild(this.obj.tr):s.p_tbody.insertBefore(this.obj.tr,s.p_tbody.childNodes[n-1]),this.obj.td_a=document.createElement("TD"),this.obj.td_a.className="td_btn_img",this.obj.td_a.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td_b=document.createElement("TD"),this.obj.td_b.className="td_btn_txt",this.obj.td_b.onselectstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,!1},t.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b)),null!=i.img?(this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+t.conf.icons_path+i.img+"' border='0'>",this.obj.tr._img=i.img):this.obj.td_a.innerHTML="&nbsp;";var o=null!=i.text?i.text:i.itemText||"";return this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+o+"</div>",this.obj.tr[window.dhx4.isIPad?"ontouchstart":"onmouseover"]=function(){!this.en||this._selected&&s.renderSelect||(this.className="tr_btn tr_btn_over")},this.obj.tr.onmouseout=function(){this.en&&(this._selected&&s.renderSelect?-1==String(this.className).search("tr_btn_selected")&&(this.className="tr_btn tr_btn_selected"):this.className="tr_btn")},this.obj.tr[window.dhx4.isIPad?"ontouchend":"onclick"]=function(e){if((e=e||event).cancelBubble=!0,this.en){s.setListOptionSelected(this.idd.replace(t.idPrefix,"")),s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(s.polygon._idd),s.polygon.style.display="none",s.polygon._ie6cover&&(s.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!0),t.anyUsed="none";var i=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](i)}catch(e){}t.callEvent("onClick",[i])}},s._listOptions[e]=this.obj,this},this.polygon=document.createElement("DIV"),this.polygon.dir="ltr",this.polygon.style.display="none",this.polygon.className="dhx_toolbar_poly_"+t.conf.skin+" dhxtoolbar_icons_"+t.conf.iconSize,this.polygon.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.polygon.onmousedown=function(t){(t=t||event).cancelBubble=!0},this.polygon.style.overflowY="auto",this.polygon._idd=window.dhx4.newId(),window.dhx4.isIPad&&(this.polygon.ontouchstart=function(t){return(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1}),this.p_tbl=document.createElement("TABLE"),this.p_tbl.className="buttons_cont",this.p_tbl.cellSpacing="0",this.p_tbl.cellPadding="0",this.p_tbl.border="0",this.polygon.appendChild(this.p_tbl),this.p_tbody=document.createElement("TBODY"),this.p_tbl.appendChild(this.p_tbody),null!=i.options)for(var n=0;n<i.options.length;n++){var l="_"+(i.options[n].type||"")+"ButtonSelectObject";null==i.options[n].id&&(i.options[n].id=t._genStr(24)),"function"==typeof this[l]&&new this[l](i.options[n].id,i.options[n])}return document.body.appendChild(this.polygon),window.dhx4.isIE6&&(this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)),this.setWidth=function(t){this.obj.style.width=t-this.arw.offsetWidth+"px",this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px",this.p_tbl.style.width=this.polygon.style.width},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display="",this.arw.style.display=""},this.hideItem=function(){this.obj.style.display="none",this.arw.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t,this.arw.title=t},this.getItemToolTip=function(){return this.obj.title},this.addListOption=function(t,e,i,s,n){if("button"==i||"separator"==i){var l={id:t,type:i,text:s,img:n};new this["_"+i+"ButtonSelectObject"](t,l,e)}},this.removeListOption=function(t){if(this._isListButton(t,!0)){var e=this._listOptions[t];if(null!=e.td_a&&null!=e.td_b){for(e.td_a.onselectstart=null,e.td_b.onselectstart=null;e.td_a.childNodes.length>0;)e.td_a.removeChild(e.td_a.childNodes[0]);for(;e.td_b.childNodes.length>0;)e.td_b.removeChild(e.td_b.childNodes[0]);for(e.tr.onselectstart=null,e.tr.onmouseover=null,e.tr.onmouseout=null,e.tr.onclick=null;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.td_a=null,e.td_b=null,e.tr=null}else{for(e.sep.onselectstart=null,e.td.onselectstart=null,e.tr.onselectstart=null;e.td.childNodes.length>0;)e.td.removeChild(e.td.childNodes[0]);for(;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.sep=null,e.td=null,e.tr=null}e=null,this._listOptions[t]=null;try{delete this._listOptions[t]}catch(t){}}},this.showListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="")},this.hideListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="none")},this.isListOptionVisible=function(t){if(this._isListButton(t,!0))return"none"!=this._listOptions[t].tr.style.display},this.enableListOption=function(e){this._isListButton(e)&&(this._listOptions[e].tr.en=!0,this._listOptions[e].tr.className="tr_btn"+(this._listOptions[e].tr._selected&&t.renderSelect?" tr_btn_selected":""))},this.disableListOption=function(t){this._isListButton(t)&&(this._listOptions[t].tr.en=!1,this._listOptions[t].tr.className="tr_btn tr_btn_disabled")},this.isListOptionEnabled=function(t){if(this._isListButton(t))return this._listOptions[t].tr.en},this.setListOptionPosition=function(t,e){if(this._listOptions[t]&&this.getListOptionPosition(t)!=e&&!isNaN(e)){e<1&&(e=1);var i=this._listOptions[t].tr;this.p_tbody.removeChild(i),e>this.p_tbody.childNodes.length?this.p_tbody.appendChild(i):this.p_tbody.insertBefore(i,this.p_tbody.childNodes[e-1]),i=null}},this.getListOptionPosition=function(t){var e=-1;if(!this._listOptions[t])return e;for(var i=0;i<this.p_tbody.childNodes.length;i++)this.p_tbody.childNodes[i]==this._listOptions[t].tr&&(e=i+1);return e},this.setListOptionImage=function(e,i){if(this._isListButton(e)){var s=this._listOptions[e].tr.childNodes[t.rtl?1:0];if(s.childNodes.length>0)s.childNodes[0].src=t.conf.icons_path+i;else{var n=document.createElement("IMG");n.className="btn_sel_img",n.src=t.conf.icons_path+i,s.appendChild(n)}s=null}},this.getListOptionImage=function(e){if(this._isListButton(e)){var i=this._listOptions[e].tr.childNodes[t.rtl?1:0],s=null;return i.childNodes.length>0&&(s=i.childNodes[0].src),i=null,s}},this.clearListOptionImage=function(e){if(this._isListButton(e)){for(var i=this._listOptions[e].tr.childNodes[t.rtl?1:0];i.childNodes.length>0;)i.removeChild(i.childNodes[0]);i.innerHTML="&nbsp;",i=null}},this.setListOptionText=function(e,i){this._isListButton(e)&&(this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML=i)},this.getListOptionText=function(e){if(this._isListButton(e))return this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML},this.setListOptionToolTip=function(t,e){this._isListButton(t)&&(this._listOptions[t].tr.title=e)},this.getListOptionToolTip=function(t){if(this._isListButton(t))return this._listOptions[t].tr.title},this.forEachListOption=function(t){for(var e in this._listOptions)t(e)},this.getAllListOptions=function(){var t=new Array;for(var e in this._listOptions)t[t.length]=e;return t},this.setListOptionSelected=function(t){for(var e in this._listOptions){var i=this._listOptions[e];null!=i.td_a&&null!=i.td_b&&i.tr.en&&(e==t?(i.tr._selected=!0,i.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),"select"==this.mode&&(i.tr._img?this.setItemImage(i.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(t)))):(i.tr._selected=!1,i.tr.className="tr_btn")),i=null}},this.getListOptionSelected=function(){var t=null;for(var e in this._listOptions)1==this._listOptions[e].tr._selected&&(t=e);return t},this._isListButton=function(t,e){return null!=this._listOptions[t]&&!(!e&&"tr_sep"==this._listOptions[t].tr.className)},this.setMaxOpen=function(t){if(this._ph=null,"number"==typeof t)return this.maxOpen=t,void this._maxOpenTest();this.maxOpen=null},i.width&&this.setWidth(i.width),"select"==this.mode&&void 0!==i.selected&&this.setListOptionSelected(i.selected),this},dhtmlXToolbarObject.prototype._buttonInputObject=function(t,e,i){this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.w=null!=i.width?i.width:100,this.obj.title=null!=i.title?i.title:"",this.obj.innerHTML="<input class='dhxtoolbar_input' type='text' style='width:"+this.obj.w+"px;'"+(null!=i.value?" value='"+i.value+"'":"")+">";var s=t,n=this;return this.obj.childNodes[0].onkeydown=function(t){13==(t=t||event).keyCode&&s.callEvent("onEnter",[n.obj.idd,this.value])},t.base.appendChild(this.obj),this.enableItem=function(){this.obj.childNodes[0].disabled=!1},this.disableItem=function(){this.obj.childNodes[0].disabled=!0},this.isEnabled=function(){return!this.obj.childNodes[0].disabled},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return"none"!=this.obj.style.display},this.setValue=function(t){this.obj.childNodes[0].value=t},this.getValue=function(){return this.obj.childNodes[0].value},this.setWidth=function(t){this.obj.w=t,this.obj.childNodes[0].style.width=this.obj.w+"px"},this.getWidth=function(){return this.obj.w},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this.getInput=function(){return this.obj.firstChild},void 0!==i.enabled&&0==window.dhx4.s2b(i.enabled)&&this.disableItem(),this},dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled,this.imgEn=null!=i.img?i.img:"",this.imgDis=null!=i.imgdis?i.imgdis:"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.pressed=null!=i.selected,this.obj.extAction=i.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed&&(this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"),this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""),t.base.appendChild(this.obj);var s=this;return this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){0!=s.state&&"none"==t.anyUsed&&(this.pressed?this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over":(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className))},this.obj._doOnMouseOut=function(){0!=s.state&&"none"==t.anyUsed&&(this.pressed?this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def":(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.className))},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if((!t.checkEvent("onBeforeStateChange")||t.callEvent("onBeforeStateChange",[this.idd.replace(t.idPrefix,""),this.pressed]))&&0!=s.state&&"none"==t.anyUsed){this.pressed=!this.pressed,this.className=this.pressed?"dhx_toolbar_btn dhxtoolbar_btn_pres":this.renderAs;var i=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](i,this.pressed)}catch(e){}return t.callEvent("onStateChange",[i,this.pressed]),!1}},this.setItemState=function(e,i){if(this.obj.pressed!=e&&(1==e?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(this.obj.pressed=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),1==i)){var s=this.obj.idd.replace(t.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](s,this.obj.pressed)}catch(t){}t.callEvent("onStateChange",[s,this.obj.pressed])}},this.getItemState=function(){return this.obj.pressed},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._sliderObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled||"true"==i.enabled,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.onselectstart=function(t){(t=t||event).preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.len=null!=i.length?Number(i.length):50,this.obj.innerHTML="<div class='dhxtoolbar_text'>"+(i.textMin||"")+"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>"+(i.textMax||"")+"</div>",t.base.appendChild(this.obj);var s=this;this.pen=document.createElement("DIV"),this.pen.className="dhxtoolbar_sl_pen",this.obj.appendChild(this.pen);var n=this.pen;this.label=document.createElement("DIV"),this.label.dir="ltr",this.label.className="dhx_toolbar_slider_label_"+t.conf.skin+(t.rtl?"_rtl":""),this.label.style.display="none",this.label.tip=i.toolTip||"%v",this.label._zi=window.dhx4.newId(),document.body.appendChild(this.label);var l=this.label;return this.pen.valueMin=null!=i.valueMin?Number(i.valueMin):0,this.pen.valueMax=null!=i.valueMax?Number(i.valueMax):100,this.pen.valueMin>this.pen.valueMax&&(this.pen.valueMin=this.pen.valueMax),this.pen.valueNow=null!=i.valueNow?Number(i.valueNow):this.pen.valueMax,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits=function(){this.minX=s.obj.childNodes[1].offsetLeft+2,this.maxX=s.obj.childNodes[3].offsetLeft-this.offsetWidth+1},this.pen._detectLimits(),this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX),this.style.left=this.nowX+"px",this.newNowX=this.nowX},this.pen._definePos(),this.pen.initXY=0,this.pen.allowMove=!1,this.pen[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(t){0!=s.state&&(t=t||event,this.initXY=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className="dhxtoolbar_sl_pen dhxtoolbar_over",""!=l.tip&&(l.style.visibility="hidden",l.style.display="",l.innerHTML=l.tip.replace("%v",this.valueNow),l.style.left=Math.round(window.dhx4.absLeft(this)+this.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(this)-l.offsetHeight-3+"px",l.style.visibility="",l.style.zIndex=window.dhx4.zim.reserve(l._zi)))},this.pen._doOnMouseMoveStart=function(t){if(t=t||event,n.allowMove){var e=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,i=e-n.initXY;if(!(e<window.dhx4.absLeft(n)+Math.round(n.offsetWidth/2)&&n.nowX==n.minX||e>window.dhx4.absLeft(n)+Math.round(n.offsetWidth/2)&&n.nowX==n.maxX))return n.newNowX=n.nowX+i,n.newNowX<n.minX&&(n.newNowX=n.minX),n.newNowX>n.maxX&&(n.newNowX=n.maxX),n.nowX=n.newNowX,n.style.left=n.nowX+"px",n.initXY=e,n.newValueNow=Math.round((n.valueMax-n.valueMin)*(n.newNowX-n.minX)/(n.maxX-n.minX)+n.valueMin),""!=l.tip&&(l.innerHTML=l.tip.replace(/%v/gi,n.newValueNow),l.style.left=Math.round(window.dhx4.absLeft(n)+n.offsetWidth/2-l.offsetWidth/2)+"px",l.style.top=window.dhx4.absTop(n)-l.offsetHeight-3+"px"),t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}},this.pen._doOnMouseMoveEnd=function(){n.allowMove&&(n.className="dhxtoolbar_sl_pen",n.allowMove=!1,n.nowX=n.newNowX,n.valueNow=n.newValueNow,""!=l.tip&&(l.style.display="none",window.dhx4.zim.clear(l._zi)),t.callEvent("onValueChange",[s.obj.idd.replace(t.idPrefix,""),n.valueNow]))},window.dhx4.isIPad?(document.addEventListener("touchmove",n._doOnMouseMoveStart,!1),document.addEventListener("touchend",n._doOnMouseMoveEnd,!1)):void 0!==window.addEventListener?(window.addEventListener("mousemove",n._doOnMouseMoveStart,!1),window.addEventListener("mouseup",n._doOnMouseMoveEnd,!1)):(document.body.attachEvent("onmousemove",n._doOnMouseMoveStart),document.body.attachEvent("onmouseup",n._doOnMouseMoveEnd)),this.enableItem=function(){this.state||(this.state=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def")},this.disableItem=function(){this.state&&(this.state=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_dis")},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setValue=function(e,i){(e=Number(e))<this.pen.valueMin&&(e=this.pen.valueMin),e>this.pen.valueMax&&(e=this.pen.valueMax),this.pen.valueNow=e,this.pen._definePos(),1==i&&t.callEvent("onValueChange",[this.obj.idd.replace(t.idPrefix,""),this.pen.valueNow])},this.getValue=function(){return this.pen.valueNow},this.setMinValue=function(t,e){(t=Number(t))>this.pen.valueMax||(this.obj.childNodes[0].innerHTML=e,this.obj.childNodes[0].style.display=e.length>0?"":"none",this.pen.valueMin=t,this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits(),this.pen._definePos())},this.setMaxValue=function(t,e){(t=Number(t))<this.pen.valueMin||(this.obj.childNodes[4].innerHTML=e,this.obj.childNodes[4].style.display=e.length>0?"":"none",this.pen.valueMax=t,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen._detectLimits(),this.pen._definePos())},this.getMinValue=function(){var t=this.obj.childNodes[0].innerHTML,e=this.pen.valueMin;return new Array(e,t)},this.getMaxValue=function(){var t=this.obj.childNodes[4].innerHTML,e=this.pen.valueMax;return new Array(e,t)},this.setItemToolTipTemplate=function(t){this.label.tip=t},this.getItemToolTipTemplate=function(){return this.label.tip},this},dhtmlXToolbarObject.prototype.unload=function(){for(this.conf.isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):"function"==typeof window.addEventListener?window.removeEventListener("mousedown",this._doOnClick,!1):document.body.detachEvent("onmousedown",this._doOnClick),this._doOnClick=null,this.clearAll(),this.objPull=null,this._xmlLoader&&(this._xmlLoader.destructor(),this._xmlLoader=null);this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);for(this.cont.removeChild(this.base),this.base=null;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="",this.cont=null,window.dhx4._enableDataLoading(this,null,null,null,"clear"),window.dhx4._eventable(this,"clear"),this.tX1=null,this.tX2=null,this.tY1=null,this.tY2=null,this.anyUsed=null,this.idPrefix=null,this.rootTypes=null,this._rtl=null,this._rtlParseBtn=null,this.setRTL=null,this._sbw=null,this._getObj=null,this._addImgObj=null,this._setItemImage=null,this._clearItemImage=null,this._setItemText=null,this._getItemText=null,this._enableItem=null,this._disableItem=null,this._xmlParser=null,this._addItemToStorage=null,this._genStr=null,this._addItem=null,this._getPosition=null,this._setPosition=null,this._getIdByPosition=null,this._separatorObject=null,this._textObject=null,this._buttonObject=null,this._buttonSelectObject=null,this._buttonInputObject=null,this._buttonTwoStateObject=null,this._sliderObject=null,this._autoDetectVisibleArea=null,this._removeItem=null,this.setAlign=null,this.setSkin=null,this.setIconsPath=null,this.setIconPath=null,this.loadXML=null,this.loadXMLString=null,this.clearAll=null,this.addSpacer=null,this.removeSpacer=null,this.getType=null,this.getTypeExt=null,this.inArray=null,this.getParentId=null,this.addButton=null,this.addText=null,this.addButtonSelect=null,this.addButtonTwoState=null,this.addSeparator=null,this.addSlider=null,this.addInput=null,this.forEachItem=null,this.showItem=null,this.hideItem=null,this.isVisible=null,this.enableItem=null,this.disableItem=null,this.isEnabled=null,this.setItemText=null,this.getItemText=null,this.setItemToolTip=null,this.getItemToolTip=null,this.setItemImage=null,this.setItemImageDis=null,this.clearItemImage=null,this.clearItemImageDis=null,this.setItemState=null,this.getItemState=null,this.setItemToolTipTemplate=null,this.getItemToolTipTemplate=null,this.setValue=null,this.getValue=null,this.setMinValue=null,this.getMinValue=null,this.setMaxValue=null,this.getMaxValue=null,this.setWidth=null,this.getWidth=null,this.getPosition=null,this.setPosition=null,this.removeItem=null,this.addListOption=null,this.removeListOption=null,this.showListOption=null,this.hideListOption=null,this.isListOptionVisible=null,this.enableListOption=null,this.disableListOption=null,this.isListOptionEnabled=null,this.setListOptionPosition=null,this.getListOptionPosition=null,this.setListOptionText=null,this.getListOptionText=null,this.setListOptionToolTip=null,this.getListOptionToolTip=null,this.setListOptionImage=null,this.getListOptionImage=null,this.clearListOptionImage=null,this.forEachListOption=null,this.getAllListOptions=null,this.setListOptionSelected=null,this.getListOptionSelected=null,this.unload=null,this.setUserData=null,this.getUserData=null,this.setMaxOpen=null,this.items=null,this.conf=null},dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){var t=window.dhx4.screenDim();this.tX1=t.left,this.tX2=t.right,this.tY1=t.top,this.tY2=t.bottom},dhtmlXToolbarObject.prototype._initObj=function(t){for(var e=0;e<t.length;e++)this._addItemToStorage(t[e]);"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._xmlToJson=function(t){var e=[],i=t.getElementsByTagName("toolbar");if(null!=i&&null!=i[0]){i=i[0];for(var s=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"],n=["id","type","enabled","disabled","action","selected","img","text"],l=0;l<i.childNodes.length;l++)if("item"==i.childNodes[l].tagName){for(var o={},r=0;r<s.length;r++){null!=(d=i.childNodes[l].getAttribute(s[r]))&&(o[s[r]]=d)}for(var a=0;a<i.childNodes[l].childNodes.length;a++){if("item"==i.childNodes[l].childNodes[a].tagName&&"buttonSelect"==o.type){var h={};for(r=0;r<n.length;r++){var d;null!=(d=i.childNodes[l].childNodes[a].getAttribute(n[r]))&&(h[n[r]]=d)}var c=i.childNodes[l].childNodes[a].getElementsByTagName("itemText");null!=c&&null!=c[0]&&(h.itemText=c[0].firstChild.nodeValue);var _=i.childNodes[l].childNodes[a].getElementsByTagName("userdata");for(r=0;r<_.length;r++){h.userdata||(h.userdata={});var u={};try{u.name=_[r].getAttribute("name")}catch(t){u.name=null}try{u.value=_[r].firstChild.nodeValue}catch(t){u.value=""}null!=u.name&&(h.userdata[u.name]=u.value)}null==o.options&&(o.options=[]),o.options.push(h)}if("userdata"==i.childNodes[l].childNodes[a].tagName){null==o.userdata&&(o.userdata={});h={};try{h.name=i.childNodes[l].childNodes[a].getAttribute("name")}catch(t){h.name=null}try{h.value=i.childNodes[l].childNodes[a].firstChild.nodeValue}catch(t){h.value=""}null!=h.name&&(o.userdata[h.name]=h.value)}}e.push(o)}}return e},dhtmlXToolbarObject.prototype._addItemToStorage=function(t,e){var i=t.id||this._genStr(24),s=t.type||"";if("spacer"==s?this.addSpacer(this._lastId):this._lastId=i,""!=s&&null!=this["_"+s+"Object"]){if("buttonSelect"==s&&null!=t.options)for(var n=0;n<t.options.length;n++)"obj"==t.options[n].type&&(t.options[n].type="button"),"sep"==t.options[n].type&&(t.options[n].type="separator");if("slider"==s){var l={tip_template:"toolTip",value_min:"valueMin",value_max:"valueMax",value_now:"valueNow",text_min:"textMin",text_max:"textMax"};for(var o in l)null==t[l[o]]&&null!=t[o]&&(t[l[o]]=t[o])}"buttonInput"==s&&null==t.value&&null!=t.text&&(t.value=t.text),"buttonTwoState"==s&&void 0===t.selected&&void 0!==t.pressed&&window.dhx4.s2b(t.pressed)&&(t.selected=!0),void 0===t.enabled&&void 0!==t.disabled&&window.dhx4.s2b(t.disabled)&&(t.enabled=!1),null==t.imgDis&&null!=t.img_disabled&&(t.imgdis=t.img_disabled),void 0!==t.openAll&&null!=t.openAll||"dhx_terrace"!=this.conf.skin||(t.openAll=!0),this.objPull[this.idPrefix+i]=new this["_"+s+"Object"](this,i,t),this.objPull[this.idPrefix+i].type=s,this.setPosition(i,e)}if(null!=t.userdata)for(var o in t.userdata)this.setUserData(i,o,t.userdata[o]);if(null!=t.options)for(n=0;n<t.options.length;n++)if(null!=t.options[n].userdata)for(var o in t.options[n].userdata)this.setListOptionUserData(t.id,t.options[n].id,o,t.options[n].userdata[o])},dhtmlXToolbarObject.prototype.setSkin=function(t,e){for(var i in!0===e?this.cont.className=this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/,"dhxtoolbar_icons_"+this.conf.iconSize):(this.conf.skin=t,"dhx_skyblue"==this.conf.skin&&(this.conf.sel_ofs_y=1),"dhx_web"==this.conf.skin&&(this.conf.sel_ofs_y=1,this.conf.sel_ofs_x=1),"dhx_terrace"==this.conf.skin&&(this.conf.sel_ofs_y=-1,this.conf.sel_ofs_x=0),this.cont.className="dhx_toolbar_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize),this.objPull){var s=this.objPull[i];"slider"==s.type&&(s.pen._detectLimits(),s.pen._definePos(),s.label.className="dhx_toolbar_slider_label_"+this.conf.skin),"buttonSelect"==s.type&&(s.polygon.className="dhx_toolbar_poly_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize)}"dhx_terrace"==t&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.setAlign=function(t){this.conf.align="right"==t?"right":"left",this.base.className="right"==t?"dhxtoolbar_float_right":"dhxtoolbar_float_left",this._spacer&&(this._spacer.className="right"==t?" dhxtoolbar_float_left":" dhxtoolbar_float_right")},dhtmlXToolbarObject.prototype.setIconSize=function(t){this.conf.iconSize={18:!0,24:!0,32:!0,48:!0}[t]?t:18,this.setSkin(this.conf.skin,!0),this.callEvent("_onIconSizeChange",[this.conf.iconSize])},dhtmlXToolbarObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXToolbarObject.prototype.setUserData=function(t,e,i){t=this.idPrefix+t,null!=this.objPull[t]&&(null==this.objPull[t].userData&&(this.objPull[t].userData={}),this.objPull[t].userData[e]=i)},dhtmlXToolbarObject.prototype.getUserData=function(t,e){return t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].userData&&this.objPull[t].userData[e]||null},dhtmlXToolbarObject.prototype._isListOptionExists=function(t,e){if(null==this.objPull[this.idPrefix+t])return!1;var i=this.objPull[this.idPrefix+t];return"buttonSelect"==i.type&&null!=i._listOptions[e]},dhtmlXToolbarObject.prototype.setListOptionUserData=function(t,e,i,s){if(this._isListOptionExists(t,e)){var n=this.objPull[this.idPrefix+t]._listOptions[e];null==n.userData&&(n.userData={}),n.userData[i]=s}},dhtmlXToolbarObject.prototype.getListOptionUserData=function(t,e,i){if(!this._isListOptionExists(t,e))return null;var s=this.objPull[this.idPrefix+t]._listOptions[e];return s.userData&&s.userData[i]?s.userData[i]:null},dhtmlXToolbarObject.prototype._improveTerraceSkin=function(){null==this.conf.terrace_radius&&(this.conf.terrace_radius="3px");var t=[],e={separator:!0,text:!0},i=[this.base];null!=this._spacer&&i.push(this._spacer);for(var s=0;s<i.length;s++){t[s]=[];for(var n=0;n<i[s].childNodes.length;n++)if(null!=i[s].childNodes[n].idd&&"none"!=i[s].childNodes[n].style.display){var l=this.idPrefix+i[s].childNodes[n].idd;null!=this.objPull[l]&&this.objPull[l].obj==i[s].childNodes[n]&&t[s].push({a:l,type:this.objPull[l].type,node:this.objPull[l]["buttonSelect"==this.objPull[l].type?"arw":"obj"]})}i[s]=null}for(s=0;s<t.length;s++)for(n=0;n<t[s].length;n++){var o=t[s][n],r=!1,a=!1;e[o.type]||((n==t[s].length-1||null!=t[s][n+1]&&e[t[s][n+1].type])&&(r=!0),(0==n||n-1>=0&&null!=t[s][n-1]&&e[t[s][n-1].type])&&(a=!0)),o.node.style.borderRightWidth=r?"1px":"0px",o.node.style.borderTopRightRadius=o.node.style.borderBottomRightRadius=r?this.conf.terrace_radius:"0px","buttonSelect"==o.type?(o.node.previousSibling.style.borderTopLeftRadius=o.node.previousSibling.style.borderBottomLeftRadius=a?this.conf.terrace_radius:"0px",o.node.previousSibling._br=r,o.node.previousSibling._bl=a):o.node.style.borderTopLeftRadius=o.node.style.borderBottomLeftRadius=a?this.conf.terrace_radius:"0px",o.node._br=r,o.node._bl=a}for(s=0;s<t.length;s++){for(n=0;n<t[s].length;n++){for(var l in t[s][n])t[s][n][l]=null;t[s][n]=null}t[s]=null}t=i=null},dhtmlXToolbarObject.prototype._improveTerraceButtonSelect=function(t,e){var i=this.objPull[t];1==e?(i.obj.style.borderBottomLeftRadius=i.obj._bl?this.conf.terrace_radius:"0px",i.arw.style.borderBottomRightRadius=i.obj._br?this.conf.terrace_radius:"0px"):(i.obj.style.borderBottomLeftRadius="0px",i.arw.style.borderBottomRightRadius="0px"),i=null},void 0!==window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_toolbar=function(t,e,i,s,n){return void 0!==n?t=n:((t=document.createElement("DIV")).className="dhx_cell_toolbar_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV")),t.firstChild.className="dhx_toolbar_base_18_dhx_skyblue"),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.cont]),this.conf.ofs_nodes.t.toolbar=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachToolbar=function(t){if(null==this.dataNodes.ribbon&&null==this.dataNodes.toolbar)return this.callEvent("_onBeforeContentAttach",["toolbar"]),void 0===t?t={}:"string"==typeof t&&(t={skin:t}),void 0===t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("toolbar").firstChild,this.dataNodes.toolbar=new dhtmlXToolbarObject(t),this._adjustCont(this._idd),this.dataNodes.toolbar._masterCell=this,this.dataNodes.toolbar.attachEvent("_onIconSizeChange",function(){this._masterCell._adjustCont()}),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.toolbar},dhtmlXCellObject.prototype.detachToolbar=function(){this.dataNodes.toolbar&&(this.dataNodes.toolbar._masterCell=null,this.dataNodes.toolbar.unload(),this.dataNodes.toolbar=null,delete this.dataNodes.toolbar,this._detachObject("toolbar"))},dhtmlXCellObject.prototype.showToolbar=function(){this._mtbShowHide("toolbar","")},dhtmlXCellObject.prototype.hideToolbar=function(){this._mtbShowHide("toolbar","none")},dhtmlXCellObject.prototype.getAttachedToolbar=function(){return this.dataNodes.toolbar}),String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")},dhtmlxArray._master={_dhx_find:function(t){for(var e=0;e<this.length;e++)if(t==this[e])return e;return-1},_dhx_insertAt:function(t,e){this[this.length]=null;for(var i=this.length-1;i>=t;i--)this[i]=this[i-1];this[t]=e},_dhx_removeAt:function(t){this.splice(t,1)},_dhx_swapItems:function(t,e){var i=this[t];this[t]=this[e],this[e]=i}},dhtmlXGridObject.prototype={getRowAttribute:function(t,e){return this.getRowById(t)._attrs[e]},setRowAttribute:function(t,e,i){this.getRowById(t)._attrs[e]=i},isTreeGrid:function(){return-1!=this.cellType._dhx_find("tree")},setRowHidden:function(t,e){dhx4.s2b(e);var i=this.getRowById(t);if(i){if(""===i.expand&&this.collapseKids(i),e&&"none"!=i.style.display){i.style.display="none";var s=this.selectedRows._dhx_find(i);if(-1!=s){i.className=i.className.replace("rowselected","");for(var n=0;n<i.childNodes.length;n++)i.childNodes[n].className=i.childNodes[n].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(s)}this.callEvent("onGridReconstructed",[])}e||"none"!=i.style.display||(i.style.display="",this.callEvent("onGridReconstructed",[])),this.callEvent("onRowHide",[t,e]),this.setSizes()}},setColumnHidden:function(t,e){if(!this.hdr.rows.length)return this._ivizcol||(this._ivizcol=[]),this._ivizcol[t]=e;if(this.fldSorted&&this.fldSorted.cellIndex==t&&e&&(this.sortImg.style.display="none"),dhx4.s2b(e)){if(this._hrrar){if(this._hrrar[t])return}else this._hrrar=new Array;this._hrrar[t]="display:none;",this._hideShowColumn(t,"none")}else{if(!this._hrrar||!this._hrrar[t])return;this._hrrar[t]="",this._hideShowColumn(t,"")}this.fldSorted&&this.fldSorted.cellIndex==t&&!e&&(this.sortImg.style.display="inline"),this.setSortImgPos(),this.callEvent("onColumnHidden",[t,e])},isColumnHidden:function(t){return!(!this._hrrar||!this._hrrar[t])},setColumnsVisibility:function(t){if(t&&(this._ivizcol=t.split(this.delim)),this.hdr.rows.length&&this._ivizcol)for(var e=0;e<this._ivizcol.length;e++)this.setColumnHidden(e,this._ivizcol[e])},_fixHiddenRowsAll:function(t,e,i,s,n){n=n||"_cellIndex";for(var l=t.rows.length,o=0;o<l;o++){var r=t.rows[o].childNodes;if(r.length!=this._cCount){for(var a=0;a<r.length;a++)if(r[a][n]==e){r[a].style[i]=s;break}}else r[e].style[i]=s}},_hideShowColumn:function(t,e){if(this.hdr.rows[1]&&this.hdr.rows[1]._childIndexes&&this.hdr.rows[1]._childIndexes[t]!=t&&this.hdr.rows[1]._childIndexes[t],"none"==e){this.hdr.rows[0].cells[t]._oldWidth=this.hdr.rows[0].cells[t].style.width||this.initCellWidth[t]+"px",this.hdr.rows[0].cells[t]._oldWidthP=this.cellWidthPC[t],this.obj.rows[0].cells[t].style.width="0px";var i={rows:[this.obj.rows[0]]};this.forEachRow(function(t){"TR"==this.rowsAr[t].tagName&&i.rows.push(this.rowsAr[t])}),this._fixHiddenRowsAll(i,t,"display","none"),this.isTreeGrid()&&this._fixHiddenRowsAllTG(t,"none"),(_isOpera&&_OperaRv<9||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,t,"display","none","_cellIndexS"),this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],t,"display","none"),this._fixHiddenRowsAll(this.hdr,t,"whiteSpace","nowrap","_cellIndexS"),this.cellWidthPX.length||this.cellWidthPC.length||(this.cellWidthPX=[].concat(this.initCellWidth)),this.cellWidthPX[t]&&(this.cellWidthPX[t]=0),this.cellWidthPC[t]&&(this.cellWidthPC[t]=0)}else if(this.hdr.rows[0].cells[t]._oldWidth){var s=this.hdr.rows[0].cells[t];(_isOpera||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,t,"display","","_cellIndexS"),this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],t,"display","");i={rows:[this.obj.rows[0]]};this.forEachRow(function(t){"TR"==this.rowsAr[t].tagName&&i.rows.push(this.rowsAr[t])}),this._fixHiddenRowsAll(i,t,"display",""),this.isTreeGrid()&&this._fixHiddenRowsAllTG(t,""),this._fixHiddenRowsAll(this.hdr,t,"whiteSpace","normal","_cellIndexS"),s._oldWidthP&&(this.cellWidthPC[t]=s._oldWidthP),s._oldWidth&&(this.cellWidthPX[t]=parseInt(s._oldWidth))}this.setSizes(),_isIE||_isFF||(this.obj.border=1,this.obj.border=0)},enableColSpan:function(t){this._ecspn=dhx4.s2b(t)},enableRowsHover:function(t,e){this._unsetRowHover(!1,!0),this._hvrCss=e,dhx4.s2b(t)?this._elmnh||(this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0):this._elmnh&&(this.obj.onmousemove=this.obj._honmousemove,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this._elmnh=!1)},enableEditEvents:function(t,e,i){this._sclE=dhx4.s2b(t),this._dclE=dhx4.s2b(e),this._f2kE=dhx4.s2b(i)},enableLightMouseNavigation:function(t){dhx4.s2b(t)?this._elmn||(this.entBox._onclick=this.entBox.onclick,this.entBox.onclick=function(){return!0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");e&&(this.grid.editStop(),this.grid.doClick(e),this.grid.editCell(),(t||event).cancelBubble=!0)},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0):this._elmn&&(this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=this.obj._onmousemove,this._elmn=!1)},_unsetRowHover:function(t,e){if(that=e?this:this.grid,that._lahRw&&that._lahRw!=e){for(var i=0;i<that._lahRw.childNodes.length;i++)that._lahRw.childNodes[i].className=that._lahRw.childNodes[i].className.replace(that._hvrCss,"");that._lahRw=null}},_setRowHover:function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");if(e&&e.parentNode!=this.grid._lahRw){if(this.grid._unsetRowHover(0,e),!(e=e.parentNode).idd||"__filler__"==e.idd)return;for(var i=0;i<e.childNodes.length;i++)e.childNodes[i].className+=" "+this.grid._hvrCss;this.grid._lahRw=e}this._honmousemove(t)},_autoMoveSelect:function(t){if(!this.grid.editor){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");e.parentNode.idd&&this.grid.doClick(e,!0,0)}this._onmousemove(t)},enableDistributedParsing:function(t,e,i){dhx4.s2b(t)?(this._ads_count=e||10,this._ads_time=i||250):this._ads_count=0},destructor:function(){if(this.editStop(!0),this._sizeTime&&(this._sizeTime=window.clearTimeout(this._sizeTime)),this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,""),this.formInputs)for(var t=0;t<this.formInputs.length;t++)this.parentForm.removeChild(this.formInputs[t]);var e;for(t=0;t<this.rowsCol.length;t++)this.rowsCol[t]&&(this.rowsCol[t].grid=null);for(t in this.rowsAr)this.rowsAr[t]&&(this.rowsAr[t]=null);this.rowsCol=new dhtmlxArray,this.rowsAr={},this.entBox.innerHTML="";var i=function(){};for(e in this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=i,this.setSizes=this._update_srnd_view=this.callEvent=i,this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null,this._fake&&(this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=i,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=i),this)this[e]&&this[e].m_obj&&(this[e].m_obj=null),this[e]=null;return this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null),null},getSortingState:function(){var t=new Array;return this.fldSorted&&(t[0]=this.fldSorted._cellIndex,t[1]="dhxgrid_sort_desc"==this.sortImg.className?"des":"asc"),t},enableAutoHeight:function(t,e,i){this._ahgr=dhx4.s2b(t),this._ahgrF=dhx4.s2b(i),this._ahgrM=e||null,1==arguments.length&&(this.objBox.style.overflowY=t?"hidden":"auto"),"auto"==e&&(this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize())},enableStableSorting:function(t){this._sst=dhx4.s2b(t),this.rowsCol.stablesort=function(t){for(var e=this.length-1,i=0;i<this.length-1;i++){for(var s=0;s<e;s++)if(t(this[s],this[s+1])>0){var n=this[s];this[s]=this[s+1],this[s+1]=n}e--}}},enableKeyboardSupport:function(t){this._htkebl=!dhx4.s2b(t)},enableContextMenu:function(t){this._ctmndx=t},setScrollbarWidthCorrection:function(t){},enableTooltips:function(t){this._enbTts=t.split(",");for(var e=0;e<this._enbTts.length;e++)this._enbTts[e]=dhx4.s2b(this._enbTts[e])},enableResizing:function(t){this._drsclmn=t.split(",");for(var e=0;e<this._drsclmn.length;e++)this._drsclmn[e]=dhx4.s2b(this._drsclmn[e])},setColumnMinWidth:function(t,e){2==arguments.length?(this._drsclmW||(this._drsclmW=new Array),this._drsclmW[e]=t):this._drsclmW=t.split(",")},enableCellIds:function(t){this._enbCid=dhx4.s2b(t)},lockRow:function(t,e){var i=this.getRowById(t);i&&(i._locked=dhx4.s2b(e),this.cell&&this.cell.parentNode.idd==t&&this.editStop())},_getRowArray:function(t){for(var e=new Array,i=0;i<t.childNodes.length;i++){var s=this.cells3(t,i);e[i]=s.getValue()}return e},setDateFormat:function(t,e){this._dtmask=t,this._dtmask_inc=e},setNumberFormat:function(t,e,i,s){var n=t.replace(/[^0\,\.]*/g,""),l=n.indexOf(".");l>-1&&(l=n.length-l-1);var o=n.indexOf(",");o>-1&&(o=n.length-l-2-o),"string"!=typeof i&&(i=this.i18n.decimal_separator),"string"!=typeof s&&(s=this.i18n.group_separator);var r=t.split(n)[0],a=t.split(n)[1];this._maskArr[e]=[l,o,r,a,i,s]},_aplNFb:function(t,e){var i=this._maskArr[e];if(!i)return t;var s=parseFloat(t.toString().replace(/[^0-9]*/g,""));return"-"==t.toString().substr(0,1)&&(s*=-1),i[0]>0&&(s/=Math.pow(10,i[0])),s},_aplNF:function(t,e){var i=this._maskArr[e];if(!i)return t;var s=(parseFloat(t)<0?"-":"")+i[2];if((t=((t=Math.abs(Math.round(parseFloat(t)*Math.pow(10,i[0]>0?i[0]:0))).toString()).length<i[0]?Math.pow(10,i[0]+1-t.length).toString().substr(1,i[0]+1)+t.toString():t).split("").reverse())[i[0]]=(t[i[0]]||"0")+i[4],i[1]>0)for(var n=(i[0]>0?0:1)+i[0]+i[1];n<t.length;n+=i[1])t[n]+=i[5];return s+t.reverse().join("")+i[3]},_launchCommands:function(t){for(var e=0;e<t.length;e++){for(var i=new Array,s=0;s<t[e].childNodes.length;s++)1==t[e].childNodes[s].nodeType&&(i[i.length]=t[e].childNodes[s].firstChild.data);this[t[e].getAttribute("command")].apply(this,i)}},_parseHead:function(t){var e=dhx4.ajax.xpath("./head",t);if(e.length){var i=dhx4.ajax.xpath("./column",e[0]),s=dhx4.ajax.xpath("./settings",e[0]),n="setInitWidths",l=!1;if(s[0])for(var o=0;o<s[0].childNodes.length;o++)switch(s[0].childNodes[o].tagName){case"colwidth":s[0].childNodes[o].firstChild&&"%"==s[0].childNodes[o].firstChild.data&&(n="setInitWidthsP");break;case"splitat":l=!!s[0].childNodes[o].firstChild&&s[0].childNodes[o].firstChild.data}if(this._launchCommands(dhx4.ajax.xpath("./beforeInit/call",e[0])),i.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var r=[[],[],[],[],[],[],[],[],[]],a=["","width","type","align","sort","color","format","hidden","id"],h=["",n,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],d=0;d<i.length;d++){for(var c=1;c<a.length;c++)r[c].push(i[d].getAttribute(a[c]));r[0].push((i[d].firstChild?i[d].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(r[0]);for(d=0;d<h.length;d++)h[d]&&this[h[d]](r[d].join(this.delim));for(d=0;d<i.length;d++)if(0==this.cellType[d].indexOf("co")||"clist"==this.cellType[d]){var _=dhx4.ajax.xpath("./option",i[d]);if(_.length){var u=new Array;if("clist"==this.cellType[d]){for(c=0;c<_.length;c++)u[u.length]=_[c].firstChild?_[c].firstChild.data:"";this.registerCList(d,u)}else{var f=this.getCombo(d);for(c=0;c<_.length;c++)f.put(_[c].getAttribute("value"),_[c].firstChild?_[c].firstChild.data:"")}}}else r[6][d]&&(-1!=this.cellType[d].toLowerCase().indexOf("calendar")||"date"==this.fldSort[d]?this.setDateFormat(r[6][d]):this.setNumberFormat(r[6][d],d));this.init();var p=r[7].join(this.delim);this.setColHidden&&""!=p.replace(/,/g,"")&&this.setColHidden(p),l&&this.splitAt&&this.splitAt(l)}this._launchCommands(dhx4.ajax.xpath("./afterInit/call",e[0]))}var m=dhx4.ajax.xpath("//rows/userdata",t);if(m.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(c=0;c<m.length;c++){for(var g="",v=0;v<m[c].childNodes.length;v++)g+=m[c].childNodes[v].nodeValue;this.UserData.gridglobaluserdata.put(m[c].getAttribute("name"),g)}}},getCheckedRows:function(t){var e=new Array;return this.forEachRowA(function(i){var s=this.cells(i,t);s.changeState&&0!=s.getValue()&&e.push(i)},!0),e.join(",")},checkAll:function(){for(var t=arguments.length?arguments[0]:1,e=0;e<this.getColumnsNum();e++)"ch"==this.getColType(e)&&this.setCheckedRows(e,t)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(t,e){this.forEachRowA(function(i){this.cells(i,t).isCheckbox()&&this.cells(i,t).setValue(e)})},_drawTooltip:function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");if(!e||this.grid.editor&&this.grid.editor.cell==e)return!0;var i=e.parentNode;if(i.idd&&"__filler__"!=i.idd){var s=t?t.target:event.srcElement;if(i.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",[i.idd,e._cellIndex,t||window.event]))return!0;if(this.grid._enbTts&&!this.grid._enbTts[e._cellIndex])return s.title&&(s.title=""),!0;if(!(e._cellIndex>=this.grid._cCount)){var n=this.grid.cells3(i,e._cellIndex);if(n&&n.cell&&n.cell._attrs)return s._title&&(n.cell.title=""),n.cell._attrs.title||(s._title=!0),n&&(s.title=n.cell._attrs.title||(n.getTitle?n.getTitle():(n.getValue()||"").toString().replace(/<[^>]*>/gi,""))),!0}}},enableCellWidthCorrection:function(t){_isFF&&(this._wcorr=parseInt(t))},getAllRowIds:function(t){for(var e=[],i=0;i<this.rowsBuffer.length;i++)this.rowsBuffer[i]&&e.push(this.rowsBuffer[i].idd);return e.join(t||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(t,e,i){if(this._ecspn){var s=this.getRowById(t);if(s._childIndexes&&s.childNodes[s._childIndexes[e]]){var n=s._childIndexes[e],l=s.childNodes[n],o=l.colSpan;if(l.colSpan=1,o&&1!=o)for(var r=1;r<o;r++){var a=document.createElement("TD");l.nextSibling?s.insertBefore(a,l.nextSibling):s.appendChild(a),s._childIndexes[e+r]=n+r,a._cellIndex=e+r,a.style.textAlign=this.cellAlign[r],a.style.verticalAlign=this.cellVAlign[r],l=a,this.cells3(s,e+r).setValue("")}for(var h=1*e+1*o;h<s._childIndexes.length;h++)s._childIndexes[h]+=1*(o-1)}if(i&&i>1){if(s._childIndexes)n=s._childIndexes[e];else{n=e;s._childIndexes=new Array;for(h=0;h<s.childNodes.length;h++)s._childIndexes[h]=h}s.childNodes[n].colSpan=i;for(h=1;h<i;h++)s._childIndexes[s.childNodes[n+1]._cellIndex]=n,s.removeChild(s.childNodes[n+1]);for(h=1*s.childNodes[s._childIndexes[e]]._cellIndex+1*i;h<s._childIndexes.length;h++)s._childIndexes[h]-=i-1}}},preventIECaching:function(t){dhx4.ajax.cache=!t},enableColumnAutoSize:function(t){this._eCAS=dhx4.s2b(t)},_onHeaderDblClick:function(t){var e=this.grid,i=e.getFirstParentOfType(_isIE?event.srcElement:t.target,"TD");if(!e._eCAS)return!1;e.adjustColumnSize(i._cellIndexS)},adjustColumnSize:function(t,e){if(!this._hrrar||!this._hrrar[t]){this._notresize=!0;var i=0;this._setColumnSizeR(t,20);for(var s=1;s<this.hdr.rows.length;s++){var n=this.hdr.rows[s];(n=n.childNodes[n._childIndexes?n._childIndexes[t]:t])&&(!n.colSpan||n.colSpan<2)&&n._cellIndex==t&&(n.childNodes[0]&&"hdrcell"==n.childNodes[0].className&&(n=n.childNodes[0]),i=Math.max(i,n.scrollWidth))}for(var l=this.obj.rows.length,o=0,r=this.cellType._dhx_find("tree"),a=1;a<l;a++){var h=this.obj.rows[a];this.rowsAr[h.idd]&&(h._childIndexes&&h._childIndexes[t]!=t||!h.childNodes[t]||(o=(h.childNodes[t].innerText||h.childNodes[t].textContent||"").length*this.fontWidth,this._h2&&t==r&&(o+=22*this._h2.get[h.idd].level),o>i&&(i=o)))}i+=20+(e||0),this._setColumnSizeR(t,i),this._notresize=!1,this.setSizes()}},detachHeader:function(t,e){var i=(e=e||this.hdr).rows[t+1];i&&i.parentNode.removeChild(i),this.setSizes()},detachFooter:function(t){this.detachHeader(t,this.ftr)},attachHeader:function(t,e,i){if("string"==typeof t&&(t=this._eSplit(t)),"string"==typeof e&&(e=e.split(this.delim)),i=i||"_aHead",this.hdr.rows.length){if(t)this._createHRow([t,e],this["_aHead"==i?"hdr":"ftr"]);else if(this[i])for(var s=0;s<this[i].length;s++)this.attachHeader.apply(this,this[i][s])}else this[i]||(this[i]=new Array),this[i][this[i].length]=[t,e,i]},_createHRow:function(t,e){if(!e){"absolute"!=this.entBox.style.position&&(this.entBox.style.position="relative"),(o=document.createElement("DIV")).className="c_ftr".substr(2),this.entBox.appendChild(o),(c=document.createElement("TABLE")).cellPadding=c.cellSpacing=0,_isIE&&8!=_isIE||(c.width="100%",c.style.paddingRight="20px"),c.style.marginRight="20px",c.style.tableLayout="fixed",o.appendChild(c),c.appendChild(document.createElement("TBODY")),this.ftr=e=c;for(var i=c.insertRow(0),s=this.hdrLabels.length<=1?t[0].length:this.hdrLabels.length,n=0;n<s;n++)i.appendChild(document.createElement("TH")),i.childNodes[n]._cellIndex=n;_isIE&&_isIE<8?i.style.position="absolute":i.style.height="auto"}var l=t[1],o=document.createElement("TR");e.rows[0].parentNode.appendChild(o);for(n=0;n<t[0].length;n++){if("#cspan"!=t[0][n])if("#rspan"==t[0][n]&&e.rows.length>1){for(var r=e.rows.length-2,a=!1,h=null;!a;){h=e.rows[r];for(var d=0;d<h.cells.length;d++)if(h.cells[d]._cellIndex==n){a=d+1;break}r--}(h=h.cells[a-1]).rowSpan=(h.rowSpan||1)+1}else{var c,_=document.createElement("TD");if(_._cellIndex=_._cellIndexS=n,this._hrrar&&this._hrrar[n]&&!_isIE&&(_.style.display="none"),"object"==typeof t[0][n])_.appendChild(t[0][n]);else if(this.forceDivInHeader?_.innerHTML="<div class='hdrcell'>"+(t[0][n]||"&nbsp;")+"</div>":_.innerHTML=t[0][n]||"&nbsp;",-1!=(t[0][n]||"").indexOf("#"))if(c=t[0][n].match(/(^|{)#([^}]+)(}|$)/)){var u="_in_header_"+c[2];this[u]&&this[u](this.forceDivInHeader?_.firstChild:_,n,t[0][n].split(c[0]))}l&&(_.style.cssText=l[n]),o.appendChild(_)}else(h=o.cells[o.cells.length-1]).colSpan=(h.colSpan||1)+1}_isKHTML&&(e._kTimer&&window.clearTimeout(e._kTimer),e._kTimer=window.setTimeout(function(){e.rows[1].style.display="none",window.setTimeout(function(){e.rows[1].style.display=""},1)},500))},attachFooter:function(t,e){this.attachHeader(t,e,"_aFoot")},setCellExcellType:function(t,e,i){this.changeCellType(this.getRowById(t),e,i)},changeCellType:function(t,e,i){i=i||this.cellType[e];var s,n=(s=this.cells3(t,e)).getValue();s.cell._cellType=i,(s=this.cells3(t,e)).setValue(n)},setRowExcellType:function(t,e){for(var i=this.rowsAr[t],s=0;s<i.childNodes.length;s++)this.changeCellType(i,s,e)},setColumnExcellType:function(t,e){for(var i=0;i<this.rowsBuffer.length;i++)this.rowsBuffer[i]&&"TR"==this.rowsBuffer[i].tagName&&this.changeCellType(this.rowsBuffer[i],t,e);"math"==this.cellType[t]?this._strangeParams[i]=e:this.cellType[t]=e},forEachRow:function(t){for(var e in this.rowsAr)this.rowsAr[e]&&this.rowsAr[e].idd&&t.apply(this,[this.rowsAr[e].idd])},forEachRowA:function(t){for(var e=0;e<this.rowsBuffer.length;e++)this.rowsBuffer[e]&&t.call(this,this.render_row(e).idd)},forEachCell:function(t,e){var i=this.getRowById(t);if(i)for(var s=0;s<this._cCount;s++)e(this.cells3(i,s),s)},enableAutoWidth:function(t,e,i){this._awdth=[dhx4.s2b(t),parseInt(e||99999),parseInt(i||0)],1==arguments.length&&(this.objBox.style.overflowX=t?"hidden":"auto")},updateFromXML:function(t,e,i,s){void 0===e&&(e=!0),this._refresh_mode=[!0,e,i],this.load(t,s)},_refreshFromXML:function(t){this._f_rowsBuffer&&this.filterBy(0,""),reset=!1,window.eXcell_tree&&(eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(t){this.grid._h2.get[this.cell.parentNode.idd]&&this.cell.parentNode.valTag?this.setLabel(t):this.setValueX(t)});var e=this.cellType._dhx_find("tree"),i=dhx4.ajax.xmltop("rows",t),s=i.getAttribute("parent")||0,n={};this._refresh_mode[2]&&(-1!=e?this._h2.forEachChild(s,function(t){n[t.id]=!0},this):this.forEachRow(function(t){n[t]=!0}));for(var l=dhx4.ajax.xpath("//row",i),o=0;o<l.length;o++){var r=l[o],a=r.getAttribute("id");n[a]=!1;s=r.parentNode.getAttribute("id")||s;if(this.rowsAr[a]&&"TR"!=this.rowsAr[a].tagName)this._h2?this._h2.get[a].buff.data=r:this.rowsBuffer[this.getRowIndex(a)].data=r,this.rowsAr[a]=r;else if(this.rowsAr[a])this._process_xml_row(this.rowsAr[a],r,-1),this._postRowProcessing(this.rowsAr[a],!0),this._fake&&this._fake.rowsAr[a]&&this._fake._process_xml_row(this._fake.rowsAr[a],r,-1);else if(this._refresh_mode[1]){var h={idd:a,data:r,_parser:this._process_xml_row,_locator:this._get_xml_data},d=this.rowsBuffer.length;"top"==this._refresh_mode[1]?(this.rowsBuffer.unshift(h),d=0):this.rowsBuffer.push(h),this._h2?(reset=!0,this._h2.add(a,r.parentNode.getAttribute("id")||r.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1]):this._srnd&&(reset=!0),this.rowsAr[a]=r,r=this.render_row(d),this._insertRowAt(r,d?-1:0)}}if(this._refresh_mode[2])for(a in n)n[a]&&this.rowsAr[a]&&this.deleteRow(a);this._refresh_mode=null,window.eXcell_tree&&(eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX),reset&&(this._h2?this._renderSort():this.render_dataset()),this._f_rowsBuffer&&(this._f_rowsBuffer=null,this.filterByAll())},getCustomCombo:function(t,e){var i=this.cells(t,e).cell;return i._combo||(i._combo=new dhtmlXGridComboObject),i._combo},setTabOrder:function(t){var e=t.split(this.delim);this._tabOrder=[];for(var i=this._cCount||t.length,s=0;s<i;s++)e[s]={c:parseInt(e[s]),ind:s};e.sort(function(t,e){return t.c>e.c?1:-1});for(s=0;s<i;s++)e[s+1]&&void 0!==e[s].c?this._tabOrder[e[s].ind]=e[s+1].ind:this._tabOrder[e[s].ind]=-1*(e[0].ind+1)},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var t=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[t+1],this.cell._cellIndex,!0)},k13_0_1:function(){var t=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[t-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop(),this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]),this._still_active=!0},k9_0_0:function(){if(this.editStop(),!this.callEvent("onTab",[!0]))return!0;var t=this._getNextCell(null,1);t&&(this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0)},k9_0_1:function(){if(this.editStop(),!this.callEvent("onTab",[!1]))return!1;var t=this._getNextCell(null,-1);t&&(this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0)},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var t=this.cells4(this.cell);if(!t.changeState||!1===t.changeState())return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(this.editor||!this.isTreeGrid())return!1;this.collapseKids(this.row)},k39_0_0:function(){if(this.editor||!this.isTreeGrid())return!1;this.expandKids(this.row)},k40_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var e=Math.max(t._r_select||0,this.getRowIndex(this.row.idd)),i=this._nextRow(e,1);if(i)t._r_select=null,this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&t.showRow(i.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[]),this.pagingOn&&this.rowsCol[e+1]&&this.selectCell(e+1,0,!0)}}this._still_active=!0},k38_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var e=this.getRowIndex(this.row.idd)+1;if(-1==e||this.pagingOn&&1==e)this._key_events.k33_0_0.apply(this,[]);else{var i=this._nextRow(e-1,-1);this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&i&&t.showRow(i.idd)}}this._still_active=!0}},_build_master_row:function(){for(var t=document.createElement("DIV"),e=["<table><tr>"],i=0;i<this._cCount;i++)e.push("<td></td>");e.push("</tr></table>"),t.innerHTML=e.join(""),this._master_row=t.firstChild.rows[0]},_prepareRow:function(t){this._master_row||this._build_master_row();for(var e=this._master_row.cloneNode(!0),i=0;i<e.childNodes.length;i++)e.childNodes[i]._cellIndex=i,this._enbCid&&(e.childNodes[i].id="c_"+t+"_"+i),this.dragAndDropOff&&this.dragger.addDraggableItem(e.childNodes[i],this);return e.idd=t,e.grid=this,e},_process_jsarray_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(e):e),t},_get_jsarray_data:function(t,e){return t[e]},_process_json_row:function(t,e){return e=this._c_order?this._swapColumns(e.data):e.data,this._process_some_row(t,e)},_process_some_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,e),t},_get_json_data:function(t,e){return t.data[e]},_process_js_row:function(t,e){for(var i=[],s=0;s<this.columnIds.length;s++)i[s]=e[this.columnIds[s]],i[s]||0===i[s]||(i[s]="");return this._process_some_row(t,i),t._attrs=e,t},_get_js_data:function(t,e){return t[this.columnIds[e]]},_process_csv_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(e.split(this.csv.cell)):e.split(this.csv.cell)),t},_get_csv_data:function(t,e){return t.split(this.csv.cell)[e]},_process_store_row:function(t,e){for(var i=[],s=0;s<this.columnIds.length;s++)i[s]=e[this.columnIds[s]];for(var n=0;n<t.childNodes.length;n++)t.childNodes[n]._attrs={};t._attrs=e,this._fillRow(t,i)},_process_xml_row:function(t,e){var i=dhx4.ajax.xpath(this.xml.cell,e),s=[];if(t._attrs=this._xml_attrs(e),this._ud_enabled)for(var n=dhx4.ajax.xpath("./userdata",e),l=n.length-1;l>=0;l--){for(var o="",r=0;r<n[l].childNodes.length;r++)o+=n[l].childNodes[r].nodeValue;this.setUserData(t.idd,n[l].getAttribute("name"),o)}for(r=0;r<i.length;r++){var a=i[this._c_order?this._c_order[r]:r];if(a){var h=t._childIndexes?t._childIndexes[r]:r,d=a.getAttribute("type");t.childNodes[h]&&(d&&(t.childNodes[h]._cellType=d),t.childNodes[h]._attrs=this._xml_attrs(a)),a.getAttribute("xmlcontent")||(a=a.firstChild?a.firstChild.data:""),s.push(a)}}for(i.length;r<t.childNodes.length;r++)t.childNodes[r]._attrs={};return t.parentNode&&"row"==t.parentNode.tagName&&(t._attrs.parent=t.parentNode.getAttribute("idd")),this._fillRow(t,s),t},_get_xml_data:function(t,e){for(t=t.firstChild;;){if(!t)return"";if("cell"==t.tagName&&e--,e<0)break;t=t.nextSibling}return t.firstChild?t.firstChild.data:""},_fillRow:function(t,e){this.editor&&this.editor.parentNode&&this.editor.parentNode.idd==t.idd&&this.editStop();for(var i=0;i<t.childNodes.length;i++)if(i<e.length||this.defVal[i]){var s=t.childNodes[i]._cellIndex,n=e[s],l=this.cells4(t.childNodes[i]);!this.defVal[s]||""!=n&&void 0!==n||(n=this.defVal[s]),l&&l.setValue(n)}else t.childNodes[i].innerHTML="&nbsp;",t.childNodes[i]._clearCell=!0;return t},_postRowProcessing:function(t,e){t._attrs.class&&(t._css=t.className=t._attrs.class),t._attrs.locked&&(t._locked=!0),t._attrs.bgColor&&(t.bgColor=t._attrs.bgColor);for(var i=0,s=0;s<t.childNodes.length;s++){var n=t.childNodes[s],l=n._cellIndex,o=n._attrs.style||t._attrs.style;o&&(n.style.cssText+=";"+o),n._attrs.class&&(n.className=n._attrs.class),(o=n._attrs.align||this.cellAlign[l])&&(n.align=o),n.vAlign=n._attrs.valign||this.cellVAlign[l];var r=n._attrs.bgColor||this.columnColor[l];r&&(n.bgColor=r),n._attrs.colspan&&!e&&(this.setColspan(t.idd,s+i,n._attrs.colspan),i+=n._attrs.colspan-1),this._hrrar&&this._hrrar[l]&&!e&&(n.style.display="none")}this.callEvent("onRowCreated",[t.idd,t,null])},load:function(t,e,i){this.callEvent("onXLS",[this]),2==arguments.length&&"function"!=typeof e&&(i=e,e=null),i=i||"xml",this.xmlFileUrl||(this.xmlFileUrl=t),this._data_type=i,this.xmlLoader=this.doLoadDetails;var s=this;return this.xmlLoader=function(t){s.callEvent&&(s["_process_"+i](t.xmlDoc),s._contextCallTimer||s.callEvent("onXLE",[s,0,0,t.xmlDoc]),e&&(e(),e=null))},dhx4.ajax.get(t,this.xmlLoader)},loadXMLString:function(t,e){this.parse({responseXML:dhx4.ajax.parse(t)},e,"xml")},loadXML:function(t,e){this.load(t,e,"xml")},parse:function(t,e,i){2==arguments.length&&"function"!=typeof e&&(i=e,e=null),i=i||"xml",this._data_type=i,"xml"==i&&"string"==typeof t&&(t={responseXML:dhx4.ajax.parse(t)}),this["_process_"+i](t),this._contextCallTimer||this.callEvent("onXLE",[this,0,0,t]),e&&e()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(t){var e={};if(t.attributes.length)for(var i=0;i<t.attributes.length;i++)e[t.attributes[i].name]=t.attributes[i].value;return e},_process_xml:function(t){if(this._refresh_mode)return this._refreshFromXML(t);this._parsing=!0;var e=dhx4.ajax.xmltop(this.xml.top,t);if(e.tagName==this.xml.top){var i=e.getAttribute("dhx_security");i&&(dhtmlx.security_key=i),this._parseHead(e);var s=dhx4.ajax.xpath(this.xml.row,e),n=parseInt(e.getAttribute("pos")||0),l=parseInt(e.getAttribute("total_count")||0);if(!this.pagingOn)l=Math.min(l,32e6/this._srdh);var o=!1;if(l&&l!=this.rowsBuffer.length&&(this.rowsBuffer[l-1]||(this.rowsBuffer.length&&(o=!0),this.rowsBuffer[l-1]=null),l<this.rowsBuffer.length&&(this.rowsBuffer.splice(l,this.rowsBuffer.length-l),o=!0)),this.isTreeGrid())return this._process_tree_xml(e);for(var r=0;r<s.length;r++)if(!this.rowsBuffer[r+n]){var a=s[r].getAttribute("id")||r+n+1;this.rowsBuffer[r+n]={idd:a,data:s[r],_parser:this._process_xml_row,_locator:this._get_xml_data},this.rowsAr[a]=s[r]}if(this.callEvent("onDataReady",[]),o&&this._srnd){var h=this.objBox.scrollTop;this._reset_view(),this.objBox.scrollTop=h}else this.render_dataset();this._parsing=!1}},_process_jsarray:function(data){this._parsing=!0,data=data.responseText||data,"string"==typeof data&&(eval("dhtmlx.temp="+data+";"),data=dhtmlx.temp);for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data}),this.rowsAr[id]=data[i]}this.render_dataset(),this._parsing=!1},_process_csv:function(t){if(this._parsing=!0,t=(t=(t=t.responseText||t).replace(/\r/g,"")).split(this.csv.row),this._csvHdr){this.clearAll();var e=t.splice(0,1)[0].split(this.csv.cell);this._csvAID||e.splice(0,1),this.setHeader(e.join(this.delim)),this.init()}for(var i=0;i<t.length;i++)if(t[i]||i!=t.length-1){if(this._csvAID){var s=i+1;this.rowsBuffer.push({idd:s,data:t[i],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var n=t[i].split(this.csv.cell);s=n.splice(0,1)[0];this.rowsBuffer.push({idd:s,data:n,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[s]=t[i]}this.render_dataset(),this._parsing=!1},_process_js:function(t){return this._process_json(t,"js")},_process_json:function(data,mode){this._parsing=!0;var data=data.responseText||data;if("string"==typeof data&&(eval("dhtmlx.temp="+data+";"),data=dhtmlx.temp),"js"==mode){data.data&&(data=data.data);for(var i=0;i<data.length;i++){var row=data[i],id=row.id||i+1;this.rowsBuffer.push({idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data}),this.rowsAr[id]=data[i]}}else for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data}),this.rowsAr[id]=data.rows[i]}data.dhx_security&&(dhtmlx.security_key=data.dhx_security),this.callEvent("onDataReady",[]),this.render_dataset(),this._parsing=!1},render_dataset:function(t,e){if(this._srnd){if(this._fillers)return this._update_srnd_view();e=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(t=Math.max(t||0,(this.currentPage-1)*this.rowsBufferOutSize),e=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(t=t||0,e=e||this.rowsBuffer.length);for(var i=t;i<e;i++){var s=this.render_row(i);if(-1==s){this.xmlFileUrl&&this.callEvent("onDynXLS",[i,this._dpref?this._dpref:e-i])&&this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+i+"&count="+(this._dpref?this._dpref:e-i),this._data_type),e=i;break}if(s.parentNode&&s.parentNode.tagName||(this._insertRowAt(s,i),(s._attrs.selected||s._attrs.select)&&(this.selectRow(s,!!s._attrs.call,!0),s._attrs.selected=s._attrs.select=null)),this._ads_count&&i-t==this._ads_count){var n=this;return this._context_parsing=this._context_parsing||this._parsing,this._contextCallTimer=window.setTimeout(function(){n._contextCallTimer=null,n.render_dataset(i,e),n._contextCallTimer||(n._context_parsing?n.callEvent("onXLE",[]):n._fixAlterCss(),n.callEvent("onDistributedEnd",[]),n._context_parsing=!1)},this._ads_time)}}if(this._ads_count&&i==e&&this.callEvent("onDistributedEnd",[]),this._srnd&&!this._fillers){var l=this.rowsBuffer.length-e;for(this._fillers=[],this._fake&&!this._realfake&&(this._fake._fillers=[]);l>0;){var o=_isIE||window._FFrv?Math.min(l,5e4):l,r=this._add_filler(e,o);r&&this._fillers.push(r),l-=o,e+=o}}this.setSizes()},render_row:function(t){if(!this.rowsBuffer[t])return-1;if(this.rowsBuffer[t]._parser){var e=this.rowsBuffer[t];if(this.rowsAr[e.idd]&&"TR"==this.rowsAr[e.idd].tagName)return this.rowsBuffer[t]=this.rowsAr[e.idd];var i=this._prepareRow(e.idd);return this.rowsBuffer[t]=i,this.rowsAr[e.idd]=i,e._parser.call(this,i,e.data),this._postRowProcessing(i),i}return this.rowsBuffer[t]},_get_cell_value:function(t,e,i){return t._locator?(this._c_order&&(e=this._c_order[e]),t._locator.call(this,t.data,e)):this.cells3(t,e)[i||"getValue"]()},sortRows:function(t,e,i){if(this.editStop(),i=(i||"asc").toLowerCase(),e=e||this.fldSort[t],t=t||0,this.isTreeGrid())this.sortTreeRows(t,e,i);else{var s={},n=this.cellType[t],l="getValue";"link"==n&&(l="getContent"),"dhxCalendar"!=n&&"dhxCalendarA"!=n||(l="getDate");for(var o=0;o<this.rowsBuffer.length;o++)s[this.rowsBuffer[o].idd]=this._get_cell_value(this.rowsBuffer[o],t,l);this._sortRows(t,e,i,s)}this.callEvent("onAfterSorting",[t,e,i])},_sortCore:function(t,e,i,s,n){var l="sort";if(this._sst&&(n.stablesort=this.rowsCol.stablesort,l="stablesort"),e.length>4&&(e=window[e]),"cus"==e){var o=this._customSorts[t];n[l](function(t,e){return o(s[t.idd],s[e.idd],i,t.idd,e.idd)})}else"function"==typeof e?n[l](function(t,n){return e(s[t.idd],s[n.idd],i,t.idd,n.idd)}):"str"==e?n[l](function(t,e){return"asc"==i?s[t.idd]>s[e.idd]?1:s[t.idd]<s[e.idd]?-1:0:s[t.idd]<s[e.idd]?1:s[t.idd]>s[e.idd]?-1:0}):"int"==e?n[l](function(t,e){var n=parseFloat(s[t.idd]);n=isNaN(n)?-99999999999999:n;var l=parseFloat(s[e.idd]);return l=isNaN(l)?-99999999999999:l,"asc"==i?n-l:l-n}):"date"==e&&n[l](function(t,e){var n=Date.parse(s[t.idd])||Date.parse("01/01/1900"),l=Date.parse(s[e.idd])||Date.parse("01/01/1900");return"asc"==i?n-l:l-n})},_sortRows:function(t,e,i,s){this._sortCore(t,e,i,s,this.rowsBuffer),this._reset_view(),this.callEvent("onGridReconstructed",[])},_reset_view:function(t){if(this.obj.rows[0]){this._lahRw&&this._unsetRowHover(0,!0),this.callEvent("onResetView",[]);var e=this.obj.rows[0].parentNode,i=e.removeChild(e.childNodes[0],!0);if(_isKHTML)for(var s=e.parentNode.childNodes.length-1;s>=0;s--)"TR"==e.parentNode.childNodes[s].tagName&&e.parentNode.removeChild(e.parentNode.childNodes[s],!0);else if(_isIE)for(s=e.childNodes.length-1;s>=0;s--)e.childNodes[s].removeNode(!0);else e.innerHTML="";e.appendChild(i),this.rowsCol=dhtmlxArray(),this._sst&&this.enableStableSorting(!0),this._fillers=this.undefined,t||(_isIE&&this._srnd,this.render_dataset())}},deleteRow:function(t,e){if(e||(e=this.getRowById(t)),e){if(this.editStop(),!this._realfake&&0==this.callEvent("onBeforeRowDeleted",[t]))return!1;var i=0;if(-1==this.cellType._dhx_find("tree")||this._realfake){e.parentNode&&e.parentNode.removeChild(e);var s=this.rowsCol._dhx_find(e);-1!=s&&this.rowsCol._dhx_removeAt(s);for(var n=0;n<this.rowsBuffer.length;n++)if(this.rowsBuffer[n]&&this.rowsBuffer[n].idd==t){this.rowsBuffer._dhx_removeAt(n),s=n;break}}else i=this._h2.get[t].parent.id,this._removeTrGrRow(e);this.rowsAr[t]=null;for(n=0;n<this.selectedRows.length;n++)this.selectedRows[n].idd==t&&this.selectedRows._dhx_removeAt(n);if(this._srnd){for(n=0;n<this._fillers.length;n++){var l=this._fillers[n];l&&(l[0]>=s?this._update_fillers(n,0,-1):l[0]+l[1]>s&&this._update_fillers(n,-1,0))}this._update_srnd_view()}return this.pagingOn&&this.changePage(),this._realfake||this.callEvent("onAfterRowDeleted",[t,i]),this.callEvent("onGridReconstructed",[]),this._ahgr&&this.setSizes(),!0}},_addRow:function(t,e,i){-1!=i&&void 0!==i||(i=this.rowsBuffer.length),"string"==typeof e&&(e=e.split(this.delim));var s=this._prepareRow(t);s._attrs={};for(var n=0;n<s.childNodes.length;n++)s.childNodes[n]._attrs={};if(this.rowsAr[s.idd]=s,this._h2&&(this._h2.get[s.idd].buff=s),this._fillRow(s,e),this._postRowProcessing(s),this._skipInsert)return this._skipInsert=!1,this.rowsAr[s.idd]=s;if(this.pagingOn)return this.rowsBuffer._dhx_insertAt(i,s),this.rowsAr[s.idd]=s,s;if(this._fillers){this.rowsCol._dhx_insertAt(i,null),this.rowsBuffer._dhx_insertAt(i,s),this._fake&&this._fake.rowsCol._dhx_insertAt(i,null),this.rowsAr[s.idd]=s;for(var l=!1,o=0;o<this._fillers.length;o++){var r=this._fillers[o];if(r&&r[0]<=i&&r[0]+r[1]>=i){r[1]=r[1]+1;var a=r[2].firstChild.style.height=parseInt(r[2].firstChild.style.height)+this._srdh+"px";l=!0,this._fake&&(this._fake._fillers[o][1]++,this._fake._fillers[o][2].firstChild.style.height=a)}r&&r[0]>i&&(r[0]=r[0]+1,this._fake&&this._fake._fillers[o][0]++)}return l||this._fillers.push(this._add_filler(i,1,0==i?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[i-1])),s}return this.rowsBuffer._dhx_insertAt(i,s),this._insertRowAt(s,i)},addRow:function(t,e,i){var s=this._addRow(t,e,i);return this.dragContext||this.callEvent("onRowAdded",[t]),this.pagingOn&&this.changePage(this.currentPage),this._srnd&&this._update_srnd_view(),s._added=!0,this._ahgr&&this.setSizes(),this.callEvent("onGridReconstructed",[]),s},_insertRowAt:function(t,e,i){if(this.rowsAr[t.idd]=t,this._skipInsert)return this._skipInsert=!1,t;if(e<0||!e&&0!==parseInt(e)?e=this.rowsCol.length:e>this.rowsCol.length&&(e=this.rowsCol.length),this._cssEven){var s=t.className.replace(this._cssUnEven,"");(this._cssSP?this.getLevel(t.idd):e)%2==1?t.className=s+" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+"_"+this.getLevel(t.idd):""):t.className=s+" "+this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(t.idd):"")}return i||(e!=this.obj.rows.length-1&&this.rowsCol[e]?this.rowsCol[e].parentNode.insertBefore(t,this.rowsCol[e]):_isKHTML?this.obj.appendChild(t):this.obj.firstChild.appendChild(t)),this.rowsCol._dhx_insertAt(e,t),this.callEvent("onRowInserted",[t,e]),t},getRowById:function(t){var e=this.rowsAr[t];if(e){if("TR"!=e.tagName){for(var i=0;i<this.rowsBuffer.length;i++)if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==t)return this.render_row(i);if(this._h2)return this.render_row(null,e.idd)}return e}return null},cellById:function(t,e){return this.cells(t,e)},cells:function(t,e){if(0==arguments.length)return this.cells4(this.cell);var i=this.getRowById(t),s=i._childIndexes?i.childNodes[i._childIndexes[e]]:i.childNodes[e];return!s&&i._childIndexes&&(s=i.firstChild||{}),this.cells4(s)},cellByIndex:function(t,e){return this.cells2(t,e)},cells2:function(t,e){var i=this.render_row(t),s=i._childIndexes?i.childNodes[i._childIndexes[e]]:i.childNodes[e];return!s&&i._childIndexes&&(s=i.firstChild||{}),this.cells4(s)},cells3:function(t,e){var i=t._childIndexes?t.childNodes[t._childIndexes[e]]:t.childNodes[e];return this.cells4(i)},cells4:function(t){var e=window["eXcell_"+(t._cellType||this.cellType[t._cellIndex])];if(e)return new e(t)},cells5:function(t,e){e=e||t._cellType||this.cellType[t._cellIndex];if(!this._ecache[e]){if(window["eXcell_"+e])i=window["eXcell_"+e];else var i=eXcell_ro;this._ecache[e]=new i(t)}return this._ecache[e].cell=t,this._ecache[e]},dma:function(t){this._ecache||(this._ecache={}),t&&!this._dma?(this._dma=this.cells4,this.cells4=this.cells5):!t&&this._dma&&(this.cells4=this._dma,this._dma=null)},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(t){arguments.length>0?this.smartTabOrder=dhx4.s2b(t):this.smartTabOrder=!0},setExternalTabOrder:function(t,e){var i=this;this.tabStart="object"==typeof t?t:document.getElementById(t);var s=this.tabStart.onkeydown;this.tabStart.onkeydown=function(t){s&&s.call(this,t);var e=t||window.event;if(9==e.keyCode&&!e.shiftKey)return e.cancelBubble=!0,i.selectCell(0,0,0,0,1),i.smartTabOrder&&i.cells2(0,0).isDisabled()&&i._key_events.k9_0_0.call(i),this.blur(),!1},_isOpera&&(this.tabStart.onkeypress=this.tabStart.onkeydown),this.tabEnd="object"==typeof e?e:document.getElementById(e);var n=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(t){n&&n.call(this,t);var e=t||window.event;if(9==e.keyCode&&e.shiftKey)return e.cancelBubble=!0,i.selectCell(i.getRowsNum()-1,i.getColumnCount()-1,0,0,1),i.smartTabOrder&&i.cells2(i.getRowsNum()-1,i.getColumnCount()-1).isDisabled()&&i._key_events.k9_0_1.call(i),this.blur(),!1},_isOpera&&(this.tabEnd.onkeypress=this.tabEnd.onkeydown)},uid:function(){return this._ui_seed||(this._ui_seed=(new Date).valueOf()),this._ui_seed++},clearAndLoad:function(){var t=this._pgn_skin;this._pgn_skin=null,this.clearAll(),this._pgn_skin=t,this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var t=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,t,Math.min(t+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}},function(){function t(t,e){this[t]=e}function e(t,e){this[t].call(this,e)}function i(t,e){this[t].call(this,e.join(this.delim))}var s=[{name:"label",def:"&nbsp;",operation:"setHeader",type:function(t,e,i){var s=[];function n(t,e,i){s[e]||(s[e]=[]),"object"==typeof i&&(i.toString=function(){return this.text}),s[e][t]=i}for(var l=0;l<e.length;l++)if("object"==typeof e[l]&&e[l].length)for(var o=0;o<e[l].length;o++)n(l,o,e[l][o]);else n(l,0,e[l]);for(l=0;l<s.length;l++)for(o=0;o<s[0].length;o++){var r=s[l][o];if(s[l][o]=(r||"").toString()||"&nbsp;",r&&r.colspan)for(var a=1;a<r.colspan;a++)n(o+a,l,"#cspan");if(r&&r.rowspan)for(a=1;a<r.rowspan;a++)n(o,l+a,"#rspan")}for(this.setHeader(s[0]),l=1;l<s.length;l++)this.attachHeader(s[l])}},{name:"id",def:"",operation:"columnIds",type:t},{name:"width",def:"*",operation:"setInitWidths",type:i},{name:"align",def:"left",operation:"cellAlign",type:t},{name:"valign",def:"middle",operation:"cellVAlign",type:t},{name:"sort",def:"na",operation:"fldSort",type:t},{name:"type",def:"ro",operation:"setColTypes",type:i},{name:"options",def:"",operation:"",type:function(t,e){for(var i=0;i<e.length;i++)if("object"==typeof e[i]){var s=this.getCombo(i);for(var n in e[i])s.put(n,e[i][n])}}}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(t){return[t.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(t){for(var i=0;i<s.length;i++){for(var n=[],l=0;l<t.length;l++)n[l]=t[l][s[i].name]||s[i].def;(s[i].type||e).call(this,s[i].operation,n,t)}this.init()},rows:function(t){},headers:function(t){for(var e=0;e<t.length;e++)this.attachHeader(t[e])}})}(),dhtmlXGridObject.prototype._dp_init=function(t){t.attachEvent("insertCallback",function(t,e){this.obj._h2?this.obj.addRow(e,i,null,parent):this.obj.addRow(e,[],0);var i=this.obj.getRowById(e);i&&(this.obj._process_xml_row(i,t.firstChild),this.obj._postRowProcessing(i))}),t.attachEvent("updateCallback",function(t,e){var i=this.obj.getRowById(e);i&&(this.obj._process_xml_row(i,t.firstChild),this.obj._postRowProcessing(i))}),t.attachEvent("deleteCallback",function(t,e){this.obj.setUserData(e,this.action_param,"true_deleted"),this.obj.deleteRow(e)}),t._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"],this.attachEvent("onEditCell",function(e,i,s){if(t._columns&&!t._columns[s])return!0;var n=this.cells(i,s);return 1==e?n.isCheckbox()&&t.setUpdated(i,!0):2==e&&n.wasChanged()&&t.setUpdated(i,!0),!0}),this.attachEvent("onRowPaste",function(e){t.setUpdated(e,!0)}),this.attachEvent("onUndo",function(e){t.setUpdated(e,!0)}),this.attachEvent("onRowIdChange",function(e,i){var s=t.findRow(e);s<t.updatedRows.length&&(t.updatedRows[s]=i)}),this.attachEvent("onSelectStateChanged",function(e){return"row"==t.updateMode&&t.sendData(),!0}),this.attachEvent("onEnter",function(e,i){return"row"==t.updateMode&&t.sendData(),!0}),this.attachEvent("onBeforeRowDeleted",function(e){if(!this.rowsAr[e])return!0;if(this.dragContext&&t.dnd)return window.setTimeout(function(){t.setUpdated(e,!0)},1),!0;var i=t.getState(e);return this._h2&&this._h2.forEachChild(e,function(e){t.setUpdated(e.id,!1),t.markRow(e.id,!0,"deleted")},this),"inserted"==i?(t.set_invalid(e,!1),t.setUpdated(e,!1),!0):"deleted"!=i&&("true_deleted"==i?(t.setUpdated(e,!1),!0):(t.setUpdated(e,!0,"deleted"),!1))}),this.attachEvent("onBindUpdate",function(e){"object"==typeof e&&(e=e.id),t.setUpdated(e,!0)}),this.attachEvent("onRowAdded",function(e){return!(!this.dragContext||!t.dnd)||(t.setUpdated(e,!0,"inserted"),!0)}),t._getRowData=function(t,e){var i,s=[];s.gr_id=t,this.obj.isTreeGrid()&&(s.gr_pid=this.obj.getParentId(t));for(var n=this.obj.getRowById(t),l=0;l<this.obj._cCount;l++){if(this.obj._c_order)var o=this.obj._c_order[l];else o=l;var r=this.obj.cells(n.idd,l);this._changed&&!r.wasChanged()||(this._endnm?s[this.obj.getColumnId(l)]=r.getValue():s["c"+o]=r.getValue())}if(i=this.obj.UserData[t])for(var a=0;a<i.keys.length;a++)i.keys[a]&&0!=i.keys[a].indexOf("__")&&(s[i.keys[a]]=i.values[a]);if(i=this.obj.UserData.gridglobaluserdata)for(a=0;a<i.keys.length;a++)s[i.keys[a]]=i.values[a];return s},t._clearUpdateFlag=function(t){if(this.obj.getRowById(t))for(var e=0;e<this.obj._cCount;e++)this.obj.cells(t,e).cell.wasChanged=!1},t.checkBeforeUpdate=function(t){for(var e=!0,i=[],s=0;s<this.obj._cCount;s++)if(this.mandatoryFields[s]){var n=this.mandatoryFields[s].call(this.obj,this.obj.cells(t,s).getValue(),t,s);"string"==typeof n?(this.messages.push(n),e=!1):(e&=n,i[s]=!n)}return e||(this.set_invalid(t,"invalid",i),this.setUpdated(t,!1)),e}},dhx4.attachEvent("onGridCreated",function(t){t._con_f_used=[].concat(t._con_f_used),dhtmlXGridObject.prototype._con_f_used=[];var e=function(t){return function(t){return(t=t.replace(/(\?|\&)connector[^\f]*/g,""))+(-1!=t.indexOf("?")?"&":"?")+"connector=true"+(this.hdr.rows.length>0?"&dhx_no_header=1":"")}.call(this,t)+(this._connector_sorting||"")+(this._connector_filter||"")};t.attachEvent("onCollectValues",function(t){return!this._con_f_used[t]||"object"==typeof this._con_f_used[t]&&this._con_f_used[t]}),t.attachEvent("onDynXLS",function(){return this.xmlFileUrl=e.call(this,this.xmlFileUrl),!0}),t.attachEvent("onBeforeSorting",function(t,i,s){if("connector"==i){var n=this;return this.clearAndLoad(function(t,i,s){return this._connector_sorting="&dhx_sort["+i+"]="+s,e.call(this,t)}.call(this,this.xmlFileUrl,t,s),function(){n.setSortImgState(!0,t,s)}),!1}return!0}),t.attachEvent("onFilterStart",function(t,i){var s=this.getSortingState();if(this._con_f_used.length){return this.clearAndLoad(function(t,i,s){for(var n=[],l=0;l<i.length;l++)n[l]="dhx_filter["+i[l]+"]="+encodeURIComponent(s[l]);return this._connector_filter="&"+n.join("&"),e.call(this,t)}.call(this,this.xmlFileUrl,t,i)),s.length&&this.setSortImgState(!0,s[0],s[1]),!1}return!0})}),dhtmlXGridObject.prototype._con_f_used=[],dhtmlXGridObject.prototype._in_header_connector_text_filter=function(t,e){return this._con_f_used[e]||(this._con_f_used[e]=1),this._in_header_text_filter(t,e)},dhtmlXGridObject.prototype._in_header_connector_select_filter=function(t,e){return this._con_f_used[e]||(this._con_f_used[e]=2),this._in_header_select_filter(t,e)},dhtmlXGridObject.prototype.load_connector=dhtmlXGridObject.prototype.load,dhtmlXGridObject.prototype.load=function(t,e,i){if(!this._colls_loaded&&this.cellType){for(var s=[],n=0;n<this.cellType.length;n++)0!=this.cellType[n].indexOf("co")&&0!=this.cellType[n].indexOf("clist")&&2!=this._con_f_used[n]||s.push(n);s.length&&(arguments[0]+=(-1!=arguments[0].indexOf("?")?"&":"?")+"connector=true&dhx_colls="+s.join(","))}return this.load_connector.apply(this,arguments)},dhtmlXGridObject.prototype._parseHead_connector=dhtmlXGridObject.prototype._parseHead,dhtmlXGridObject.prototype._parseHead=function(t,e,i){if(this._parseHead_connector.apply(this,arguments),!this._colls_loaded){for(var s=dhx4.ajax.xpath("./coll_options",arguments[0]),n=0;n<s.length;n++){var l=s[n].getAttribute("for"),o=[],r=null;"combo"==this.cellType[l]?r=this.getColumnCombo(l):0==this.cellType[l].indexOf("co")&&(r=this.getCombo(l));for(var a=dhx4.ajax.xpath("./item",s[n]),h=[],d=0;d<a.length;d++){var c=a[d].getAttribute("value");if(r){var _=a[d].getAttribute("label")||c;r.addOption?h.push([c,_]):r.put(c,_),o[o.length]=_}else o[o.length]=c}h.length?r&&r.addOption(h):o.length&&!r&&this.registerCList&&this.registerCList(1*l,o),this._con_f_used[1*l]&&(this._con_f_used[1*l]=o)}this._colls_loaded=!0}},dhtmlXGridCellObject.prototype={getAttribute:function(t){return this.cell._attrs[t]},setAttribute:function(t,e){this.cell._attrs[t]=e},getInput:function(){if(this.obj&&("INPUT"==this.obj.tagName||"TEXTAREA"==this.obj.tagName))return this.obj;var t=(this.obj||this.cell).getElementsByTagName("TEXTAREA");return t.length||(t=(this.obj||this.cell).getElementsByTagName("INPUT")),t[0]}},dhtmlXGridCellObject.prototype.setValue=function(t){"number"==typeof t||t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t="&nbsp;",this.cell._clearCell=!0),this.setCValue(t)},dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent},dhtmlXGridCellObject.prototype.setCValue=function(t,e){this.cell.innerHTML=t,this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,arguments.length>1?e:t])},dhtmlXGridCellObject.prototype.setCTxtValue=function(t){this.cell.innerHTML="",this.cell.appendChild(document.createTextNode(t)),this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,t])},dhtmlXGridCellObject.prototype.setLabel=function(t){this.cell.innerHTML=t},dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()},eXcell.prototype=new dhtmlXGridCellObject,eXcell_ed.prototype=new eXcell,eXcell_edtxt.prototype=new eXcell_ed,eXcell_edn.prototype=new eXcell_ed,eXcell_edn.prototype.setValue=function(t){if(!t||""==t.toString()._dhx_trim())return this.cell._clearCell=!0,this.setCValue("&nbsp;",0);this.cell._clearCell=!1,this.cell._orig_value=t,this.setCValue(this.grid._aplNF(t,this.cell._cellIndex),t)},eXcell_ch.prototype=new eXcell,eXcell_ch.prototype.setValue=function(t){this.cell.style.verticalAlign="middle",t&&("false"!=(t=t.toString()._dhx_trim())&&"0"!=t||(t="")),t?(t="1",this.cell.chstate="1"):(t="0",this.cell.chstate="0");this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+t+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)},eXcell_ra.prototype=new eXcell_ch,eXcell_ra.prototype.setValue=function(t){if(this.cell.style.verticalAlign="middle",t&&("false"!=(t=t.toString()._dhx_trim())&&"0"!=t||(t="")),t){if(this.grid._RaSeCol||(this.grid._RaSeCol=[]),this.grid._RaSeCol[this.cell._cellIndex]){var e=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);e.setValue("0"),this.grid.rowsAr[e.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,e.cell.parentNode.idd,e.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell,t="1",this.cell.chstate="1"}else t="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+t+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)},eXcell_txt.prototype=new eXcell,eXcell_txttxt.prototype=new eXcell_txt,eXcell_txt.prototype.setValue=function(t){this.cell._brval=t,t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t="&nbsp;",this.cell._clearCell=!0),!this.grid.multiLine||this.cell._clearCell?this.setCValue(t,this.cell._brval):this.setCValue(t.replace(/\n/g,"<br/>"),t)},eXcell_co.prototype=new eXcell,eXcell_co.prototype.getText=function(){return this.cell.innerHTML},eXcell_co.prototype.setValue=function(t){if("object"==typeof t){var e=dhx4.ajax.xpath("./option",t);e.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var i=0;i<e.length;i++)this.cell._combo.put(e[i].getAttribute("value"),e[i].firstChild?e[i].firstChild.data:"");t=t.firstChild.data}if(""==(t||"").toString()._dhx_trim()&&(t=null),this.cell.combo_value=t,null!==t){var s=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(t);this.setCValue(null===s?t:s,t)}else this.setCValue("&nbsp;",t)},eXcell_coro.prototype=new eXcell_co,eXcell_cotxt.prototype=new eXcell_co,eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent},eXcell_cotxt.prototype.setValue=function(t){if("object"==typeof t){var e=dhx4.ajax.xpath("./option",t);e.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var i=0;i<e.length;i++)this.cell._combo.put(e[i].getAttribute("value"),e[i].firstChild?e[i].firstChild.data:"");t=t.firstChild.data}""==(t||"").toString()._dhx_trim()&&(t=null),null!==t?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(t)||t,t):this.setCTxtValue(" ",t),this.cell.combo_value=t},eXcell_corotxt.prototype=new eXcell_cotxt,eXcell_cp.prototype=new eXcell,eXcell_cp.prototype.setValue=function(t){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?"100%":23)+";background-color:"+(t||"")+";border:0px;'>&nbsp;</div>",t),this.cell.firstChild._bg=t},eXcell_img.prototype=new eXcell,eXcell_img.prototype.getTitle=function(){return this.cell._brval},eXcell_img.prototype.setValue=function(t){var e=t;if(-1!=(t||"").indexOf("^")){var i=t.split("^");t=i[0],e=this.cell._attrs.title||i[1],i.length>2&&(this.cell.lnk=i[2],i[3]&&(this.cell.trg=i[3])),this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(t||"")._dhx_trim()+"' border='0'>",t),this.cell.lnk&&(this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"),this.cell._brval=e},eXcell_price.prototype=new eXcell_ed,eXcell_price.prototype.setValue=function(t){isNaN(parseFloat(t))&&(t=this.val||0);var e="green";t<0&&(e="red"),this.setCValue("<span>$</span><span style='padding-right:2px;color:"+e+";'>"+t+"</span>",t)},eXcell_dyn.prototype=new eXcell_ed,eXcell_dyn.prototype.setValue=function(t){if(t&&!isNaN(Number(t))||""!==t&&(t=0),t>0)var e="green",i="dyn_up.gif";else if(0==t)e="black",i="dyn_.gif";else e="red",i="dyn_down.gif";this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+i+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+e+";'>"+t+"</span></div>",t)},eXcell_ro.prototype=new eXcell,window.eXcell_hidden=function(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell.val}},eXcell_hidden.prototype=new eXcell,eXcell_hidden.prototype.setValue=function(t){this.cell.val=t},eXcell_ron.prototype=new eXcell,eXcell_ron.prototype.setValue=function(t){if(0===t);else if(!t||""==t.toString()._dhx_trim())return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._clearCell=!1,this.setCValue(t?this.grid._aplNF(t,this.cell._cellIndex):"0")},eXcell_rotxt.prototype=new eXcell,Hashtable.prototype=new dhtmlXGridComboObject,void 0!==window.dhtmlXCellObject&&(dhtmlXCellObject.prototype.attachGrid=function(){this.callEvent("_onBeforeContentAttach",["grid"]);var t=document.createElement("DIV");return t.style.width="100%",t.style.height="100%",t.style.position="relative",t.style.overflow="hidden",this._attachObject(t),this.dataType="grid",this.dataObj=new dhtmlXGridObject(t),this.dataObj.setSkin(this.conf.skin),"dhx_skyblue"==this.conf.skin&&void 0!==window.dhtmlXWindowsCell&&this instanceof window.dhtmlXWindowsCell?(this.dataObj.entBox.style.border="1px solid #a4bed4",this.dataObj._sizeFix=0):(this.dataObj.entBox.style.border="0px solid white",this.dataObj._sizeFix=2),t=null,this.callEvent("_onContentAttach",[]),this.dataObj}),dhtmlXGridObject.prototype.enableDragAndDrop=function(t){"temporary_disabled"==t?(this.dADTempOff=!1,t=!0):this.dADTempOff=!0,this.dragAndDropOff=dhx4.s2b(t),this._drag_validate=!0,t&&(this.objBox.ondragstart=function(t){return(t||event).cancelBubble=!0,!1})},dhtmlXGridObject.prototype.setDragBehavior=function(t){switch(this.dadmodec=this.dadmodefix=0,t){case"child":this.dadmode=0,this._sbmod=!1;break;case"sibling":this.dadmode=1,this._sbmod=!1;break;case"sibling-next":this.dadmode=1,this._sbmod=!0;break;case"complex":this.dadmode=2,this._sbmod=!1;break;case"complex-next":this.dadmode=2,this._sbmod=!0}},dhtmlXGridObject.prototype.enableDragOrder=function(t){this._dndorder=dhx4.s2b(t)},dhtmlXGridObject.prototype._checkParent=function(t,e){var i=this._h2.get[t.idd].parent;if(i.parent){for(var s=0;s<e.length;s++)if(e[s]==i.id)return!0;return this._checkParent(this.rowsAr[i.id],e)}},dhtmlXGridObject.prototype._createDragNode=function(t,e){if(this.editStop(),window.dhtmlDragAndDrop.dragNode)return null;if(!this.dADTempOff)return null;t.parentObject=new Object,t.parentObject.treeNod=this;var i=this.callEvent("onBeforeDrag",[t.parentNode.idd,t._cellIndex,e]);if(!i)return null;var s=new Array;s=(s=this.getSelectedId())&&""!=s?s.split(this.delim):[];for(var n=!1,l=0;l<s.length;l++)s[l]==t.parentNode.idd&&(n=!0);if(n||(this.selectRow(this.rowsAr[t.parentNode.idd],!1,e.ctrlKey,!1),e.ctrlKey||(s=[]),s[this.selMultiRows?s.length:0]=t.parentNode.idd),this.isTreeGrid())for(l=s.length-1;l>=0;l--)this._checkParent(this.rowsAr[s[l]],s)&&s.splice(l,1);var o=this;s.length&&this._dndorder&&s.sort(function(t,e){return o.rowsAr[t].rowIndex>o.rowsAr[e].rowIndex?1:-1});var r=this.getFirstParentOfType(_isIE?e.srcElement:e.target,"TD");r&&(this._dndExtra=r._cellIndex),this._dragged=new Array;for(l=0;l<s.length;l++)this.rowsAr[s[l]]&&(this._dragged[this._dragged.length]=this.rowsAr[s[l]],this.rowsAr[s[l]].treeNod=this);t.parentObject.parentNode=t.parentNode;var a=document.createElement("div");return a.innerHTML=!0!==i?i:this.rowToDragElement(t.parentNode.idd),a.style.position="absolute",a.className="dragSpanDiv",a},dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV"),this._sdrgc.innerHTML="&nbsp;",this._sdrgc.className="gridDragLine",this.objBox.appendChild(this._sdrgc)},dragContext.prototype.valid=function(){if(this.sobj!=this.tobj)return!0;if(this.sid==this.tid)return!1;if("treeGrid"==this.target)for(var t=this.tid;t=this.tobj.getParentId(t);)if(this.sid==t)return!1;return!0},dragContext.prototype.close=function(){this.sobj=null,this.tobj=null},dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)},dragContext.prototype.set=function(t,e){return this[t]=e,this},dragContext.prototype.uid=function(t,e){for(this.nid=this.sid;this.tobj.rowsAr[this.nid];)this.nid=this.nid+(new Date).valueOf();return this},dragContext.prototype.data=function(){return this.sobj==this.tobj?this.sobj._getRowArray(this.sobj.rowsAr[this.sid]):"tree"==this.source?this.tobj.treeToGridElement(this.sobj,this.sid,this.tid):this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)},dragContext.prototype.attrs=function(){return"tree"==this.source?{}:this.sobj.rowsAr[this.sid]._attrs},dragContext.prototype.childs=function(){return"treeGrid"==this.source&&this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null},dragContext.prototype.pid=function(){if(!this.tid)return 0;if(!this.tobj._h2)return 0;if("treeGrid"==this.target){if("child"==this.dropmode)return this.tid;var t=this.tobj.rowsAr[this.tid],e=this.tobj._h2.get[t.idd].parent.id;if(this.alfa&&this.tobj._sbmod&&t.nextSibling){var i=this.tobj._h2.get[t.nextSibling.idd].parent.id;if(i==this.tid)return this.tid;if(i!=e)return i}return e}},dragContext.prototype.ind=function(){if(this.tid==window.unknown)return this.tobj.rowsBuffer.length;"treeGrid"==this.target&&("child"==this.dropmode?this.tobj.openItem(this.tid):this.tobj.openItem(this.tobj.getParentId(this.tid)));var t=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if(this.alfa&&this.tobj._sbmod&&"sibling"==this.dropmode){var e=this.tobj.rowsAr[this.tid];if(e.nextSibling&&this._h2.get[e.nextSibling.idd].parent.id==this.tid)return t+1}return t+1+("treeGrid"==this.target&&t>=0&&"minus"==this.tobj._h2.get[this.tobj.rowsBuffer[t].idd].state?this.tobj._getOpenLenght(this.tobj.rowsBuffer[t].idd,0):0)},dragContext.prototype.img=function(){return"grid"!=this.target&&this.sobj._h2?this.sobj.getItemImage(this.sid):null},dragContext.prototype.slist=function(){for(var t=new Array,e=0;e<this.sid.length;e++)t[t.length]=this.sid[e]["tree"==this.source?"id":"idd"];return t.join(",")},dhtmlXGridObject.prototype._drag=function(t,e,i,s){if(this._realfake)return this._fake._drag();this.lastLanding;this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);var n=i.parentNode,l=t.parentObject;n.idd||(n.grid=this,this.dadmodefix=0);var o=new dragContext(0,0,0,1==n.grid.dadmode||n.grid.dadmodec?"sibling":"child");if(l&&l.childNodes)o.set("source","tree").set("sobj",l.treeNod).set("sid",o.sobj._dragged);else{if(!l)return!0;l.treeNod.isTreeGrid&&l.treeNod.isTreeGrid()&&o.set("source","treeGrid"),o.set("sobj",l.treeNod).set("sid",o.sobj._dragged)}n.grid.isTreeGrid()?o.set("target","treeGrid"):o.set("dropmode","sibling"),o.set("tobj",n.grid).set("tid",n.idd),2==o.tobj.dadmode&&1==o.tobj.dadmodec&&o.tobj.dadmodefix<0&&(o.tobj.obj.rows[1].idd!=o.tid?o.tid=n.previousSibling.idd:o.tid=0);var r=this.getFirstParentOfType(s,"TD");if(r&&o.set("tExtra",r._cellIndex),r&&o.set("sExtra",o.sobj._dndExtra),o.sobj.dpcpy&&o.set("mode","copy"),o.tobj._realfake&&(o.tobj=o.tobj._fake),o.sobj._realfake&&(o.sobj=o.sobj._fake),o.tobj._clearMove(),l&&l.treeNod&&l.treeNod._nonTrivialRow)l.treeNod._nonTrivialRow(this,o.tid,o.dropmode,l);else{if(o.tobj.dragContext=o,!o.tobj.callEvent("onDrag",[o.slist(),o.tid,o.sobj,o.tobj,o.sExtra,o.tExtra]))return o.tobj.dragContext=null;var a=new Array;if("object"==typeof o.sid){for(var h=o.copy(),d=0;d<o.sid.length;d++)h.set("alfa",!d).set("sid",o.sid[d]["tree"==o.source?"id":"idd"]).valid()&&(h.tobj._dragRoutine(h),"treeGrid"==h.target&&"child"==h.dropmode&&h.tobj.openItem(h.tid),a[a.length]=h.nid,h.set("dropmode","sibling").set("tid",h.nid));h.close()}else o.tobj._dragRoutine(o);o.tobj.laterLink&&o.tobj.laterLink(),o.tobj.callEvent("onDrop",[o.slist(),o.tid,a.join(","),o.sobj,o.tobj,o.sExtra,o.tExtra])}o.tobj.dragContext=null,o.close()},dhtmlXGridObject.prototype._dragRoutine=function(t){if(t.sobj==t.tobj&&"grid"==t.source&&"move"==t.mode&&!this._fake){if(t.sobj._dndProblematic)return;var e=t.sobj.rowsAr[t.sid],i=t.sobj.rowsCol._dhx_find(e);if(t.sobj.rowsCol._dhx_removeAt(t.sobj.rowsCol._dhx_find(e)),t.sobj.rowsBuffer._dhx_removeAt(t.sobj.rowsBuffer._dhx_find(e)),t.sobj.rowsBuffer._dhx_insertAt(t.ind(),e),t.tobj._fake){t.tobj._fake.rowsCol._dhx_removeAt(i);var s=t.tobj._fake.rowsAr[t.sid];s.parentNode.removeChild(s)}return t.sobj._insertRowAt(e,t.ind()),t.nid=t.sid,void t.sobj.callEvent("onGridReconstructed",[])}var n;if(this._h2&&void 0!==t.tid&&"sibling"==t.dropmode&&(this._sbmod||t.tid)?t.alfa&&this._sbmod&&this._h2.get[t.tid].childs.length?(this.openItem(t.tid),n=t.uid().tobj.addRowBefore(t.nid,t.data(),this._h2.get[t.tid].childs[0].id,t.img(),t.childs())):n=t.uid().tobj.addRowAfter(t.nid,t.data(),t.tid,t.img(),t.childs()):n=t.uid().tobj.addRow(t.nid,t.data(),t.ind(),t.pid(),t.img(),t.childs()),n._attrs=t.attrs(),"tree"==t.source){this.callEvent("onRowAdded",[t.nid]);var l=t.sobj._globalIdStorageFind(t.sid);if(l.childsCount){for(var o=t.copy().set("tid",t.nid).set("dropmode","grid"==t.target?"sibling":"child"),r=0;r<l.childsCount;r++)t.tobj._dragRoutine(o.set("sid",l.childNodes[r].id)),"move"==t.mode&&r--;o.close()}}else if(t.tobj._copyUserData(t),this.callEvent("onRowAdded",[t.nid]),"treeGrid"==t.source){t.sobj==t.tobj&&(n._xml=t.sobj.rowsAr[t.sid]._xml);var a=t.sobj._h2.get[t.sid];if(a&&a.childs.length){o=t.copy().set("tid",t.nid);"grid"==t.target?o.set("dropmode","sibling"):(o.tobj.kidsXmlFile||o.tobj.openItem(t.tid),o.set("dropmode","child"));var h=a.childs.length;if(!o.tobj.kidsXmlFile)for(r=0;r<h;r++)t.sobj.render_row_tree(null,a.childs[r].id),t.tobj._dragRoutine(o.set("sid",a.childs[r].id)),h!=a.childs.length&&(r--,h=a.childs.length);o.close()}}"move"==t.mode&&(t.sobj["tree"==t.source?"deleteItem":"deleteRow"](t.sid),t.sobj!=t.tobj||t.tobj.rowsAr[t.sid]||(t.tobj.changeRowId(t.nid,t.sid),t.nid=t.sid))},dhtmlXGridObject.prototype.gridToGrid=function(t,e,i){for(var s=new Array,n=0;n<e.hdr.rows[0].cells.length;n++)s[n]=e.cells(t,n).getValue();return s},dhtmlXGridObject.prototype.checkParentLine=function(t,e){return!!(this._h2&&e&&t)&&(t.id==e||this.checkParentLine(t.parent,e))},dhtmlXGridObject.prototype._dragIn=function(t,e,i,s){if(!this.dADTempOff)return 0;var n=this.isTreeGrid(),l=e.parentNode.idd?e.parentNode:e.parentObject;if(this._drag_validate){if(t.parentNode==e.parentNode)return 0;if(n&&this==l.grid&&this.checkParentLine(this._h2.get[t.parentNode.idd],e.parentNode.idd))return 0}if(!this.callEvent("onDragIn",[l.idd||l.id,t.parentNode.idd,l.grid||l.treeNod,t.grid||t.parentNode.grid]))return this._setMove(t,i,s,!0);if(this._setMove(t,i,s),n&&""!=t.parentNode.expand){var o=this;this._autoOpenTimer=window.setTimeout(function(){o._autoOpenItem(null,o),o=null},1e3),this._autoOpenId=t.parentNode.idd}else this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);return t},dhtmlXGridObject.prototype._autoOpenItem=function(t,e){e.openItem(e._autoOpenId)},dhtmlXGridObject.prototype._dragOut=function(t){this._clearMove();var e=t.parentNode.parentObject?t.parentObject.id:t.parentNode.idd;this.callEvent("onDragOut",[e]),this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer)},dhtmlXGridObject.prototype._setMove=function(t,e,i,s){if(t.parentNode.idd){var n=dhx4.absTop(t),l=dhx4.absTop(this.objBox);if(n-l>parseInt(this.objBox.offsetHeight)-50&&(this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20),n-l+parseInt(this.objBox.scrollTop)<parseInt(this.objBox.scrollTop)+30&&(this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20),s)return 0;if(2==this.dadmode){var o=i-n+(document.body.scrollTop||document.documentElement.scrollTop)-2-t.offsetHeight/2;Math.abs(o)-t.offsetHeight/6>0?(this.dadmodec=1,this.dadmodefix=o<0?-1:1):this.dadmodec=0}else this.dadmodec=this.dadmode;if(this.dadmodec)this._sdrgc||this._createSdrgc(),this._sdrgc.style.display="block",this._sdrgc.style.top=n-l+parseInt(this.objBox.scrollTop)+(this.dadmodefix>=0?t.offsetHeight:0)+"px";else if(this._llSelD=t,"TR"==t.parentNode.tagName)for(var r=0;r<t.parentNode.childNodes.length;r++){(o=t.parentNode.childNodes[r])._bgCol=o.style.backgroundColor,o.style.backgroundColor="#FFCCCC"}}},dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc&&(this._sdrgc.style.display="none"),this._llSelD&&"TR"==this._llSelD.parentNode.tagName)for(var t=this._llSelD.parentNode.childNodes,e=0;e<t.length;e++)t[e].style.backgroundColor=t[e]._bgCol;this._llSelD=null},dhtmlXGridObject.prototype.rowToDragElement=function(t){return this.cells(t,0).getValue()},dhtmlXGridObject.prototype._copyUserData=function(t){if(!t.tobj.UserData[t.nid]||t.tobj!=t.sobj){t.tobj.UserData[t.nid]=new Hashtable;var e=t.sobj.UserData[t.sid],i=t.tobj.UserData[t.nid];e&&(i.keys=i.keys.concat(e.keys),i.values=i.values.concat(e.values))}},dhtmlXGridObject.prototype.moveRow=function(t,e,i,s){switch(e){case"row_sibling":this.moveRowTo(t,i,"move","sibling",this,s);break;case"up":this.moveRowUp(t);break;case"down":this.moveRowDown(t)}},dhtmlXGridObject.prototype._nonTrivialNode=function(t,e,i,s,n){if(t.callEvent&&!n&&!t.callEvent("onDrag",[s.idd,e.id,i?i.id:null,this,t]))return!1;for(var l=s.idd,o=l;t._idpull[o];)o+=(new Date).getMilliseconds().toString();var r=this.isTreeGrid()?this.getItemImage(l):"";if(i){for(d=0;d<e.childsCount&&e.childNodes[d]!=i;d++);0!=d?i=e.childNodes[d-1]:(st="TOP",i="")}var a=t._attachChildNode(e,o,this.gridToTreeElement(t,o,l),"",r,r,r,"","",i);if(this._h2){var h=this._h2.get[l];if(h.childs.length)for(var d=0;d<h.childs.length;d++)this._nonTrivialNode(t,a,0,this.rowsAr[h.childs[d].id],1),this.dpcpy||d--}this.dpcpy||this.deleteRow(l),t.callEvent&&!n&&t.callEvent("onDrop",[o,e.id,i?i.id:null,this,t])},dhtmlXGridObject.prototype.gridToTreeElement=function(t,e,i){return this.cells(i,0).getValue()},dhtmlXGridObject.prototype.treeToGridElement=function(t,e,i){var s=new Array,n=this.cellType._dhx_find("tree");-1==n&&(n=0);for(var l=0;l<this.getColumnCount();l++)s[s.length]=l!=n?t.getUserData(e,this.getColumnId(l))||"":t.getItemText(e);return s},dhtmlXGridObject.prototype.moveRowTo=function(t,e,i,s,n,l){var o=new dragContext((n||this).isTreeGrid()?"treeGrid":"grid",(l||this).isTreeGrid()?"treeGrid":"grid",i,s||"sibling",t,e,n||this,l||this);return o.tobj._dragRoutine(o),o.close(),o.nid},dhtmlXGridObject.prototype.enableMercyDrag=function(t){this.dpcpy=dhx4.s2b(t)},dhtmlXGridObject.prototype.toPDF=function(t,e,i,s,n,l){var o={row:this.getSelectedRowId(),col:this.getSelectedCellIndex()};if(null===o.row||-1===o.col)o=!1;else if(o.row&&-1!==o.row.indexOf(this.delim)){var r=this.cells(o.row,o.col).cell;r.parentNode.className=r.parentNode.className.replace(" rowselected",""),r.className=r.className.replace(" cellselected",""),o.el=r}else o=!1;var a="full_color"==(e=e||"color"),h=this;function d(t,e){return(window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.currentStyle?t.currentStyle[e]:null)||""}function c(t){if(!h.rowsBuffer[t])return"";var e=h.render_row(t);if("none"==e.style.display)return"";for(var i="<row"+(h.isTreeGrid()?' level="'+h.getLevel(e.idd)+'"':"")+">",s=0;s<h._cCount;s++)if((!h._srClmn||h._srClmn[s])&&(!h._hrrar[s]||h._fake&&s<h._fake.hdrLabels.length)){var n=h.cells(e.idd,s);if(a){var l=d(n.cell,"color"),o=d(n.cell,"backgroundColor"),r=d(n.cell,"font-weight")||d(n.cell,"fontWeight"),c=d(n.cell,"font-style")||d(n.cell,"fontStyle"),_=d(n.cell,"text-align")||d(n.cell,"textAlign"),u=d(n.cell,"font-family")||d(n.cell,"fontFamily");"transparent"!=o&&"rgba(0, 0, 0, 0)"!=o||(o="rgb(255,255,255)"),i+="<cell bgColor='"+o+"' textColor='"+l+"' bold='"+r+"' italic='"+c+"' align='"+_+"' font='"+u+"'>"}else i+="<cell>";i+="<![CDATA["+(n.getContent?n.getContent():n.getTitle())+"]]></cell>"}return i+"</row>"}h._asCDATA=!0,this.target=void 0===l?' target="_blank"':l,eXcell_ch.prototype.getContent=function(){return this.getValue()},eXcell_ra.prototype.getContent=function(){return this.getValue()};var _=document.createElement("div");_.style.display="none",document.body.appendChild(_);var u="form_"+h.uid();_.innerHTML='<form id="'+u+'" method="post" action="'+t+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"'+this.target+'><input type="hidden" name="grid_xml" id="grid_xml"/> </form>',document.getElementById(u).firstChild.value=encodeURIComponent(function(t){for(var e=[],n=1;n<h.hdr.rows.length;n++){e[n]=[];for(var l=0;l<h._cCount;l++){var o=h.hdr.rows[n].childNodes[l];e[n][l]||(e[n][l]=[0,0]),o&&(e[n][o._cellIndexS]=[o.colSpan,o.rowSpan])}}var r="<rows profile='"+t+"'";for(i&&(r+=" header='"+i+"'"),s&&(r+=" footer='"+s+"'"),r+="><head>"+h._serialiseExportConfig(e).replace(/^<head/,"<columns").replace(/head>$/,"columns>"),n=2;n<h.hdr.rows.length;n++){var a=0,d=h.hdr.rows[n],c="";for(l=0;l<h._cCount;l++)if(h._srClmn&&!h._srClmn[l]||h._hrrar[l]&&(!h._fake||l>=h._fake.hdrLabels.length))a++;else{var _=e[n][l],u=_[0]&&_[0]>1?' colspan="'+_[0]+'" ':"";_[1]&&_[1]>1&&(u+=' rowspan="'+_[1]+'" ',a=-1);var f="",p=d;h._fake&&l<h._fake._cCount&&(p=h._fake.hdr.rows[n]);for(var m=0;m<p.cells.length;m++)if(p.cells[m]._cellIndexS==l){f=(f=p.cells[m].getElementsByTagName("SELECT").length?"":_isIE?p.cells[m].innerText:p.cells[m].textContent).replace(/[ \n\r\t\xA0]+/," ");break}f&&" "!=f||a++,c+="<column"+u+"><![CDATA["+f+"]]></column>"}a!=h._cCount&&(r+="\n<columns>"+c+"</columns>")}return r+="</head>\n",r+=function(){var t=["<foot>"];if(!h.ftr)return"";for(var e=1;e<h.ftr.rows.length;e++){t.push("<columns>");for(var i=h.ftr.rows[e],s=0;s<h._cCount;s++)if((!h._srClmn||h._srClmn[s])&&(!h._hrrar[s]||h._fake&&!(s>=h._fake.hdrLabels.length))){for(var n=0;n<i.cells.length;n++){var l="",o="";if(i.cells[n]._cellIndexS==s){l=(l=_isIE?i.cells[n].innerText:i.cells[n].textContent).replace(/[ \n\r\t\xA0]+/," "),i.cells[n].colSpan&&1!=i.cells[n].colSpan&&(o=" colspan='"+i.cells[n].colSpan+"' "),i.cells[n].rowSpan&&1!=i.cells[n].rowSpan&&(o=" rowspan='"+i.cells[n].rowSpan+"' ");break}}t.push("<column"+o+"><![CDATA["+l+"]]></column>")}t.push("</columns>")}return t.push("</foot>"),t.join("\n")}()}(e).replace("–","-")+function(){var t=[];if(n)for(var e=0;e<n.length;e++)t.push(c(h.getRowIndex(n[e])));else for(e=0;e<h.getRowsNum();e++)t.push(c(e));return t.join("\n")}()+"</rows>"),document.getElementById(u).submit(),_.parentNode.removeChild(_),h=null,o&&(o.el.parentNode.className+=" rowselected",o.el.className+=" cellselected"),o=null},dhtmlXGridObject.prototype._serialiseExportConfig=function(t){for(var e,i="<head>",s=0;s<this.hdr.rows[0].cells.length;s++)if((!this._srClmn||this._srClmn[s])&&(!this._hrrar[s]||this._fake&&!(s>=this._fake.hdrLabels.length))){var n=this.fldSort[s];"cus"==n&&(n=(n=this._customSorts[s].toString()).replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));var l=t[1][s];i+="<column "+((l[1]&&l[1]>1?' rowspan="'+l[1]+'" ':"")+(l[0]&&l[0]>1?' colspan="'+l[0]+'" ':""))+" width='"+this.getColWidth(s)+"' align='"+this.cellAlign[s]+"' type='"+this.cellType[s]+"' hidden='"+(this.isColumnHidden&&this.isColumnHidden(s)?"true":"false")+"' sort='"+(n||"na")+"' color='"+(this.columnColor[s]||"")+"'"+(this.columnIds[s]?" id='"+this.columnIds[s]+"'":"")+">",this._asCDATA?i+="<![CDATA["+this.getColumnLabel(s)+"]]>":i+=this.getColumnLabel(s);var o=this.combos[s]?this.getCombo(s):null;if(o)for(var r=0;r<o.keys.length;r++)i+="<option value='"+("string"!=typeof(e=o.keys[r])?e:e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/"/g,"&quot;")).replace(/'/g,"&apos;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"))+"'><![CDATA["+o.values[r]+"]]></option>";i+="</column>"}return i+"</head>"},window.eXcell_sub_row_grid&&(window.eXcell_sub_row_grid.prototype.getContent=function(){return""}),dhtmlXGridObject.prototype.toExcel=function(t,e,i,s,n){if(!document.getElementById("ifr")){var l=document.createElement("iframe");l.style.display="none",l.setAttribute("name","dhx_export_iframe"),l.setAttribute("src",""),l.setAttribute("id","dhx_export_iframe"),document.body.appendChild(l)}this.toPDF(t,e,i,s,n,' target="dhx_export_iframe"')},dhtmlXGridObject.prototype.filterBy=function(t,e,i){if(this.isTreeGrid())return this.filterTreeBy(t,e,i);if(this._f_rowsBuffer?i||(this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer)),this._fake&&(this._fake.rowsBuffer=this.rowsBuffer)):this._f_rowsBuffer=[].concat(this.rowsBuffer),this.rowsBuffer.length){if(this.dma(!0),"object"==typeof t)for(var s=0;s<e.length;s++)this._filterA(t[s],e[s]);else this._filterA(t,e);this.dma(!1),this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<this.currentPage-1&&this.changePage(0),this._reset_view(),this.callEvent("onGridReconstructed",[])}},dhtmlXGridObject.prototype._filterA=function(t,e){if(""!=e){var i=!0;if("function"==typeof e?i=!1:e=(e||"").toString().toLowerCase(),this.rowsBuffer.length)for(var s=this.rowsBuffer.length-1;s>=0;s--)(i?-1!=this._get_cell_value(this.rowsBuffer[s],t).toString().toLowerCase().indexOf(e):e.call(this,this._get_cell_value(this.rowsBuffer[s],t),this.rowsBuffer[s].idd))||this.rowsBuffer.splice(s,1)}},dhtmlXGridObject.prototype.getFilterElement=function(t){if(this.filters){for(var e=0;e<this.filters.length;e++)if(this.filters[e][1]==t)return this.filters[e][0].combo||this.filters[e][0];return null}},dhtmlXGridObject.prototype.collectValues=function(t){var e=this.dhxevs.data.oncollectvalues;if(e){var i=!0;for(var s in e){var n=e[s].call(this,t);!0!==n&&(i=n||i)}if(!0!==i)return i}if(this.isTreeGrid())return this.collectTreeValues(t);this.dma(!0),this._build_m_order(),t=this._m_order?this._m_order[t]:t;for(var l={},o=[],r=this._f_rowsBuffer||this.rowsBuffer,a=0;a<r.length;a++){var h=this._get_cell_value(r[a],t);!h||r[a]._childIndexes&&r[a]._childIndexes[t]==r[a]._childIndexes[t-1]||(l[h]=!0)}this.dma(!1);var d=this.combos[t]||!!this._col_combos&&this._col_combos[t];for(var c in l)!0===l[c]&&(d&&(d.get&&d.get(c)?c=d.get(c):d.getOption&&d.getOption(c)&&(c=d.getOption(c).text)),o.push(c));return o.sort()},dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var t=0;t<this._c_order.length;t++)this._m_order[this._c_order[t]]=t}},dhtmlXGridObject.prototype.filterByAll=function(){var t=[],e=[];this._build_m_order();for(var i=0;i<this.filters.length;i++){var s=this._m_order?this._m_order[this.filters[i][1]]:this.filters[i][1];if(!(s>=this._cCount)){e.push(s);var n,l=this.filters[i][0].old_value=this.filters[i][0].value;this.filters[i][0]._filter&&(l=this.filters[i][0]._filter()),"function"!=typeof l&&(n=this.combos[s]||!!this._col_combos&&this._col_combos[s])&&(n.values?l=-1==(s=n.values._dhx_find(l))?l:n.keys[s]:n.getOptionByLabel&&(l=n.getOptionByLabel(l)?n.getOptionByLabel(l).value:l)),t.push(l)}}this.callEvent("onFilterStart",[e,t])&&(this.filterBy(e,t),this._cssEven&&this._fixAlterCss(),this.callEvent("onFilterEnd",[this.filters]),this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length&&(this._f_rowsBuffer=null))},dhtmlXGridObject.prototype.makeFilter=function(t,e,i){if(this.filters||(this.filters=[]),"object"!=typeof t&&(t=document.getElementById(t)),t){var s=this;if(t.style.width||(t.style.width="90%"),"SELECT"==t.tagName)this.filters.push([t,e]),this._loadSelectOptins(t,e),t.onchange=function(){s.filterByAll()},_isIE&&(t.style.marginTop="1px"),this.attachEvent("onEditCell",function(i,s,n){return this._build_m_order(),2==i&&this.filters&&(this._m_order?n==this._m_order[e]:n==e)&&this._loadSelectOptins(t,e),!0});else if("INPUT"==t.tagName)this.filters.push([t,e]),t.old_value=t.value="",t.onkeydown=function(){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(function(){t.value!=t.old_value&&(s.filterByAll(),t.old_value=t.value)},500)};else if("DIV"==t.tagName&&"combo"==t.className){this.filters.push([t,e]),t.style.padding="0px",t.style.margin="0px",window.dhx_globalImgPath||(window.dhx_globalImgPath=this.imgURL);var n=new dhtmlXCombo(t,"_filter","90%");n.filterSelfA=n.filterSelf,n.filterSelf=function(){0==this.getSelectedIndex()&&this.setComboText(""),this.filterSelfA.apply(this,arguments),this.optionsArr[0].hide(!1)},n.enableFilteringMode(!0),t.combo=n,t.value="",this._loadComboOptins(t,e),n.attachEvent("onChange",function(){t.value=n.getSelectedValue(),null===t.value&&(t.value=""),s.filterByAll()})}t.parentNode&&(t.parentNode.className+=" filter"),this._filters_ready()}},dhtmlXGridObject.prototype.findCell=function(t,e,i,s){!0===(s=s||function(t,e){return-1!=e.toString().toLowerCase().indexOf(t)})&&(s=function(t,e){return e.toString().toLowerCase()==t});var n=new Array;if(t=t.toString().toLowerCase(),"number"!=typeof i&&(i=i?1:0),!this.rowsBuffer.length)return n;for(var l=e||0;l<this._cCount;l++){if(this._h2)this._h2.forEachChild(0,function(e){if(i&&n.length==i)return n;s(t,this._get_cell_value(e.buff,l))&&n.push([e.id,l])},this);else for(var o=0;o<this.rowsBuffer.length;o++)if(s(t,this._get_cell_value(this.rowsBuffer[o],l))&&(n.push([this.rowsBuffer[o].idd,l]),i&&n.length==i))return n;if(void 0!==e)return n}return n},dhtmlXGridObject.prototype.makeSearch=function(t,e,i){if("object"!=typeof t&&(t=document.getElementById(t)),t){var s=this;"INPUT"==t.tagName&&(t.onkeypress=function(){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(function(){if(""!=t.value){var n=s.findCell(t.value,e,!0,i);n.length&&(s._h2&&s.openItem(n[0][0]),s.selectCell(s.getRowIndex(n[0][0]),e||0))}},500)}),t.parentNode&&(t.parentNode.className+=" filter")}},dhtmlXGridObject.prototype._loadSelectOptins=function(t,e){var i=this.collectValues(e),s=t.value;t.innerHTML="",t.options[0]=new Option("","");for(var n=this._filter_tr?this._filter_tr[e]:null,l=0;l<i.length;l++)t.options[t.options.length]=new Option(n?n(i[l]):i[l],i[l]);t.value=s},dhtmlXGridObject.prototype.setSelectFilterLabel=function(t,e){this._filter_tr||(this._filter_tr=[]),this._filter_tr[t]=e},dhtmlXGridObject.prototype._loadComboOptins=function(t,e){if(t.combo){var i=this.collectValues(e);t.combo.clearAll();for(var s=[["",""]],n=0;n<i.length;n++)s.push([i[n],i[n]]);t.combo.addOption(s)}},dhtmlXGridObject.prototype.refreshFilters=function(){if(this.filters)for(var t=0;t<this.filters.length;t++)switch(this.filters[t][0].tagName.toLowerCase()){case"input":break;case"select":this._loadSelectOptins.apply(this,this.filters[t]);break;case"div":this._loadComboOptins.apply(this,this.filters[t])}},dhtmlXGridObject.prototype._filters_ready=function(t,e){this.attachEvent("onXLE",this.refreshFilters),this.attachEvent("onRowCreated",function(t,e){if(this._f_rowsBuffer)for(var i=0;i<this._f_rowsBuffer.length;i++)if(this._f_rowsBuffer[i].idd==t)return this._f_rowsBuffer[i]=e}),this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null,this.hdr.rows.length||(this.filters=[])}),this.attachEvent("onSetSizes",this._filters_resize_combo),this.attachEvent("onResize",this._filters_resize_combo),this._filters_ready=function(){}},dhtmlXGridObject.prototype._filters_resize_combo=function(){if(this.filters){for(var t=0;t<this.filters.length;t++)null!=this.filters[t][0].combo&&this.filters[t][0].combo.setSize(Math.round(90*this.filters[t][0].offsetWidth/100));return!0}},dhtmlXGridObject.prototype._in_header_text_filter=function(t,e){t.innerHTML="<input type='text'>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_text_filter_inc=function(t,e){t.innerHTML="<input type='text'>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0},this.makeFilter(t.firstChild,e),t.firstChild._filter=function(){return""==t.firstChild.value?"":function(e){return 0==e.toString().toLowerCase().indexOf(t.firstChild.value.toLowerCase())}},this._filters_ready()},dhtmlXGridObject.prototype._in_header_select_filter=function(t,e){t.innerHTML="<select></select>",t.onclick=function(t){return(t||event).cancelBubble=!0,!1},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_select_filter_strict=function(t,e){t.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>",t.onclick=function(t){return(t||event).cancelBubble=!0,!1},this.makeFilter(t.firstChild,e);var i=this.combos;t.firstChild._filter=function(){var s=t.firstChild.value;return s?(i[e]&&(s=i[e].keys[i[e].values._dhx_find(s)]),s=s.toLowerCase(),function(t){return t.toString().toLowerCase()==s}):""},this._filters_ready()},dhtmlXGridObject.prototype._in_header_combo_filter=function(t,e){t.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>",t.onselectstart=function(){return event.cancelBubble=!0},t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._search_common=function(t,e){t.innerHTML="<input type='text' style='width:90%; '>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0}},dhtmlXGridObject.prototype._in_header_text_search=function(t,e,i){this._search_common(t,e),this.makeSearch(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_text_search_strict=function(t,e){this._search_common(t,e),this.makeSearch(t.firstChild,e,!0)},dhtmlXGridObject.prototype._in_header_numeric_filter=function(t,e){this._in_header_text_filter.call(this,t,e),t.firstChild._filter=function(){var t,e=this.value,i="==",s=parseFloat(e.replace("=","")),n=null;return e?-1!=e.indexOf("..")?(e=e.split(".."),s=parseFloat(e[0]),n=parseFloat(e[1]),function(t){return t>=s&&t<=n}):((t=e.match(/>=|<=|>|</))&&(i=t[0],s=parseFloat(e.replace(i,""))),Function("v"," if (v "+i+" "+s+" ) return true; return false;")):""}},dhtmlXGridObject.prototype._in_header_master_checkbox=function(t,e,i){t.innerHTML=i[0]+"<input type='checkbox' />"+i[1];var s=this;t.getElementsByTagName("input")[0].onclick=function(t){s._build_m_order();var i=s._m_order?s._m_order[e]:e,n=this.checked?1:0;s.forEachRowA(function(t){var e=this.cells(t,i);e.isCheckbox()&&(e.setValue(n),e.cell.wasChanged=!0),this.callEvent("onEditCell",[1,t,i,n]),this.callEvent("onCheckbox",[t,i,n])}),(t||event).cancelBubble=!0}},dhtmlXGridObject.prototype._in_header_stat_total=function(t,e,i){this._stat_in_header(t,function(){var t=0;this._build_m_order();for(var i=this._m_order?this._m_order[e]:e,s=0;s<this.rowsBuffer.length;s++){var n=parseFloat(this._get_cell_value(this.rowsBuffer[s],i));t+=isNaN(n)?0:n}return this._maskArr[i]?this._aplNF(t,i):Math.round(100*t)/100},e,i,i)},dhtmlXGridObject.prototype._in_header_stat_multi_total=function(t,e,i){var s=i[1].split(":");i[1]="";for(var n=0;n<s.length;n++)s[n]=parseInt(s[n]);for(var l=[],o=0;o<s.length;o++)l[s[o]]=!0;this._stat_in_header(t,function(){for(var t=0,i=0;i<this.rowsBuffer.length;i++){for(var n=1,l=0;l<s.length;l++)n*=parseFloat(this._get_cell_value(this.rowsBuffer[i],s[l]));t+=isNaN(n)?0:n}return this._maskArr[e]?this._aplNF(t,e):Math.round(100*t)/100},l,i,i)},dhtmlXGridObject.prototype._in_header_stat_max=function(t,e,i){this._stat_in_header(t,function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=-999999999;if(0==this.getRowsNum())return"&nbsp;";for(var s=0;s<this.rowsBuffer.length;s++)i=Math.max(i,parseFloat(this._get_cell_value(this.rowsBuffer[s],t)));return this._maskArr[e]?this._aplNF(i,e):i},e,i)},dhtmlXGridObject.prototype._in_header_stat_min=function(t,e,i){this._stat_in_header(t,function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=999999999;if(0==this.getRowsNum())return"&nbsp;";for(var s=0;s<this.rowsBuffer.length;s++)i=Math.min(i,parseFloat(this._get_cell_value(this.rowsBuffer[s],t)));return this._maskArr[e]?this._aplNF(i,e):i},e,i)},dhtmlXGridObject.prototype._in_header_stat_average=function(t,e,i){this._stat_in_header(t,function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=0,s=0;if(0==this.getRowsNum())return"&nbsp;";for(var n=0;n<this.rowsBuffer.length;n++){var l=parseFloat(this._get_cell_value(this.rowsBuffer[n],t));isNaN(l)||(i+=l,s++)}return this._maskArr[e]?this._aplNF(i/s,e):Math.round(i/s*100)/100},e,i)},dhtmlXGridObject.prototype._in_header_stat_count=function(t,e,i){this._stat_in_header(t,function(){return this.getRowsNum()},e,i)},dhtmlXGridObject.prototype._stat_in_header=function(t,e,i,s){var n=function(){this.dma(!0),t.innerHTML=(s[0]?s[0]:"")+e.call(this)+(s[1]?s[1]:""),this.dma(!1),this.callEvent("onStatReady",[])};this._stat_events||(this._stat_events=[],this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var t=0;t<this._stat_events.length;t++)for(var e=0;e<4;e++)this.detachEvent(this._stat_events[t][e]);this._stat_events=[]}})),this._stat_events.push([this.attachEvent("onGridReconstructed",n),this.attachEvent("onXLE",n),this.attachEvent("onFilterEnd",n),this.attachEvent("onEditCell",function(t,e,s){return 2==t&&(s==i||i&&i[s])&&n.call(this),!0})]),t.innerHTML=""},dhtmlXGridObject.prototype.loadCSVFile=function(t,e){this.load(t,e,"csv")},dhtmlXGridObject.prototype.enableCSVAutoID=function(t){this._csvAID=dhx4.s2b(t)},dhtmlXGridObject.prototype.enableCSVHeader=function(t){this._csvHdr=dhx4.s2b(t)},dhtmlXGridObject.prototype.setCSVDelimiter=function(t){this.csv.cell=t},dhtmlXGridObject.prototype._csvAID=!0,dhtmlXGridObject.prototype.loadCSVString=function(t){this.parse(t,"csv")},dhtmlXGridObject.prototype.serializeToCSV=function(t){this.editStop(),this._mathSerialization?this._agetm="getMathValue":this._strictText||t?this._agetm="getTitle":this._agetm="getValue";var e=[];if(this._csvHdr)for(var i=1;i<this.hdr.rows.length;i++){for(var s=[],n=0;n<this._cCount;n++)this._srClmn&&!this._srClmn[n]||s.push(this.getColumnLabel(n,i-1));e.push(this.csvParser.str(s,this.csv.cell,this.csv.row))}n=0;for(var l=this.rowsBuffer.length;n<l;n++){var o=this._serializeRowToCVS(null,n);""!=o&&e.push(o)}return this.csvParser.block(e,this.csv.row)},dhtmlXGridObject.prototype._serializeRowToCVS=function(t,e,i,s){var n=new Array;t||(t=this.render_row(e),this._fake&&!this._fake.rowsAr[t.idd]&&this._fake.render_row(e)),this._csvAID||(n[n.length]=t.idd),i=i||0,s=s||this._cCount;for(var l=!1,o=i;t.childNodes[i]._cellIndex>o&&i;)i--;for(var r=i;o<s&&t.childNodes[r];r++){var a=t.childNodes[r]._cellIndex;if(this._srClmn&&!this._srClmn[a]||this._serialize_visible&&this._hrrar[a])o++;else{for(var h=t.childNodes[r],d=this.cells(t.idd,a);o!=a&&(o++,n.push(""),!(o>=s)););if(o>=s)break;if(o++,d.cell?zxVal=d[this._agetm]():zxVal="",this._chAttr&&d.wasChanged()&&(l=!0),n[n.length]=null===zxVal?"":zxVal,this._ecspn&&h.colSpan&&h.colSpan>1){h=h.colSpan-1;for(var c=0;c<h;c++)n[n.length]="",o++}}}return this._onlChAttr&&!l?"":this.csvParser.str(n,this.csv.cell,this.csv.row)},dhtmlXGridObject.prototype.toClipBoard=function(t){window.clipboardData?window.clipboardData.setData("Text",t):(new Clipboard).copy(t)},dhtmlXGridObject.prototype.fromClipBoard=function(){return window.clipboardData?window.clipboardData.getData("Text"):(new Clipboard).paste()},dhtmlXGridObject.prototype.cellToClipboard=function(t,e){if(!t||!e&&0!==e){if(!this.selectedRows[0])return;t=this.selectedRows[0].idd,e=this.cell._cellIndex}var i=this.cells(t,e);this.toClipBoard(((i.getLabel?i.getLabel():i.getValue())||"").toString())},dhtmlXGridObject.prototype.updateCellFromClipboard=function(t,e){if(!t||!e){if(!this.selectedRows[0])return;t=this.selectedRows[0].idd,e=this.cell._cellIndex}var i=this.cells(t,e);i[i.setImage?"setLabel":"setValue"](this.fromClipBoard())},dhtmlXGridObject.prototype.rowToClipboard=function(t){var e="";if(this._mathSerialization?this._agetm="getMathValue":this._strictText?this._agetm="getTitle":this._agetm="getValue",this._serialize_visible=!this._fake,t)e=this._serializeRowToCVS(this.getRowById(t));else for(var i=[],s=0;s<this.selectedRows.length;s++)i[i.length]=this._serializeRowToCVS(this.selectedRows[s]),e=this.csvParser.block(i,this.csv.row);this._serialize_visible=!1,this.toClipBoard(e)},dhtmlXGridObject.prototype.updateRowFromClipboard=function(t){var e=this.fromClipBoard();if(e){if(t)var i=this.getRowById(t);else i=this.selectedRows[0];if(i){e=this.csvParser.unblock(e,this.csv.cell,this.csv.row)[0],this._csvAID||e.splice(0,1);for(var s=0;s<e.length;s++){var n=this.cells3(i,s);n[n.setImage?"setLabel":"setValue"](e[s])}}}},dhtmlXGridObject.prototype.csvParser={block:function(t,e){return t.join(e)},unblock:function(t,e,i){for(var s=(t||"").split(i),n=0;n<s.length;n++)s[n]=(s[n]||"").split(e);var l=s.length-1;return 1==s[l].length&&""==s[l][0]&&s.splice(l,1),s},str:function(t,e,i){return t.join(e)}},dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(t,e){return t.join(e)},unblock:function(t,e,i){var s=[[]],n=0;if(!t)return s;for(var l=/^[ ]*"/,o=/"[ ]*$/,r=new RegExp(".*"+i+".*$"),a=t.split(e),h=0;h<a.length;h++)if(a[h].match(l)){for(var d=a[h].replace(l,"");!a[h].match(o);)d+=a[++h];s[n].push(d.replace(o,"").replace(this._quote_esc,'"'))}else if(a[h].match(r)){var c=a[h].indexOf(i);s[n].push(a[h].substr(0,c)),s[++n]=[],a[h]=a[h].substr(c+1),h--}else(a[h]||h!=a.length-1)&&s[n].push(a[h]);var _=s.length-1;return _>0&&!s[_].length&&s.splice(_,1),s},str:function(t,e,i){for(var s=0;s<t.length;s++)t[s]='"'+t[s].replace(this._quote,'\\"')+'"';return t.join(e)}},dhtmlXGridObject.prototype.addRowFromClipboard=function(){var t=this.fromClipBoard();if(t)for(var e=this.csvParser.unblock(t,this.csv.cell,this.csv.row),i=0;i<e.length;i++)if(e[i]){if(!(t=e[i]).length)continue;this._csvAID?this.addRow(this.getRowsNum()+2,t):(this.rowsAr[t[0]]&&(t[0]=this.uid()),this.addRow(t[0],t.slice(1)))}},dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())},dhtmlXGridObject.prototype.gridFromClipboard=function(){var t=this.fromClipBoard();t&&this.loadCSVString(t)},dhtmlXGridObject.prototype.getXLS=function(t){if(!this.xslform){this.xslform=document.createElement("FORM"),this.xslform.action=(t||"")+"xls.php",this.xslform.method="post",this.xslform.target=_isIE?"_blank":"",document.body.appendChild(this.xslform);var e=document.createElement("INPUT");e.type="hidden",e.name="csv",this.xslform.appendChild(e);var i=document.createElement("INPUT");i.type="hidden",i.name="csv_header",this.xslform.appendChild(i)}var s=this.serializeToCSV();this.xslform.childNodes[0].value=s;for(var n=[],l=this._cCount,o=0;o<l;o++)n.push(this.getHeaderCol(o));n=n.join(","),this.xslform.childNodes[1].value=n,this.xslform.submit()},dhtmlXGridObject.prototype.printView=function(t,e){var i="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }\t\n  </style>",s=null;if(this._fake){s=[].concat(this._hrrar);for(var n=0;n<this._fake._cCount;n++)this._hrrar[n]=null}i+="<base  href='"+document.location.href+"'></base>",this.parentGrid||(i+=t||""),i+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var l=Math.max(this.rowsBuffer.length,this.rowsCol.length),o=this._cCount,r=this._printWidth();i+='<tr class="header_row_1">';for(n=0;n<o;n++)if(!this._hrrar||!this._hrrar[n]){for(var a=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(n)]:n],h=a.colSpan||1,d=a.rowSpan||1,c=1;c<h;c++)r[n]+=r[c];i+='<td rowspan="'+d+'" width="'+r[n]+'%" style="background-color:lightgrey;" colspan="'+h+'">'+this.getHeaderCol(n)+"</td>",n+=h-1}i+="</tr>";for(n=2;n<this.hdr.rows.length;n++)if(_isIE){i+="<tr style='background-color:lightgrey' class='header_row_"+n+"'>";var _=this.hdr.rows[n].childNodes;for(c=0;c<_.length;c++)this._hrrar&&this._hrrar[_[c]._cellIndex]||(i+=_[c].outerHTML);i+="</tr>"}else i+="<tr class='header_row_"+n+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[n].innerHTML:"")+this.hdr.rows[n].innerHTML+"</tr>";for(n=0;n<l;n++)if(i+="<tr>",this.rowsCol[n]&&this.rowsCol[n]._cntr)i+=this.rowsCol[n].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";else if(!this.rowsCol[n]||"none"!=this.rowsCol[n].style.display){var u;if(this.rowsCol[n])u=this.rowsCol[n].idd;else{if(!this.rowsBuffer[n])continue;u=this.rowsBuffer[n].idd}for(c=0;c<o;c++)if(!this._hrrar||!this._hrrar[c]){if(this.rowsAr[u]&&"TR"==this.rowsAr[u].tagName){var f=this.cells(u,c);if(f._setState)var p="";else if(f.getContent)p=f.getContent();else if(f.getImage||f.combo)p=f.cell.innerHTML;else p=f.getValue()}else p=this._get_cell_value(this.rowsBuffer[n],c);var m=this.columnColor[c]?"background-color:"+this.columnColor[c]+";":"",g=this.cellAlign[c]?"text-align:"+this.cellAlign[c]+";":"",v=f.getAttribute("colspan");i+='<td style="'+m+g+'" '+(v?'colSpan="'+v+'"':"")+">"+(""===p?"&nbsp;":p)+"</td>",v&&(c+=v-1)}if(i+="</tr>",this.rowsCol[n]&&this.rowsCol[n]._expanded){var b=this.cells4(this.rowsCol[n]._expanded.ctrl);b.getSubGrid?i+='<tr><td colspan="'+o+'">'+b.getSubGrid().printView()+"</td></tr>":i+='<tr><td colspan="'+o+'">'+this.rowsCol[n]._expanded.innerHTML+"</td></tr>"}}if(this.ftr)for(n=1;n<this.ftr.childNodes[0].rows.length;n++)i+="<tr style='background-color:lightgrey'>"+(this._fake?this._fake.ftr.childNodes[0].rows[n].innerHTML:"")+this.ftr.childNodes[0].rows[n].innerHTML+"</tr>";if(i+="</table>",this.parentGrid)return i;i+=e||"";var x=window.open("","_blank");x.document.write(i),x.document.write("<script>window.onerror=function(){return true;}<\/script>"),x.document.close(),this._fake&&(this._hrrar=s)},dhtmlXGridObject.prototype._printWidth=function(){for(var t=[],e=0,i=0;i<this._cCount;i++){var s=this.getColWidth(i);t.push(s),e+=s}var n=[],l=0;for(i=0;i<t.length;i++){var o=Math.floor(t[i]/e*100);l+=o,n.push(o)}return n[n.length-1]+=100-l,n},window.clipboardData||(window.clipboardData={_make:function(){var t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return null;var e=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!e)return null;e.addDataFlavor("text/unicode");var i=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);return this._p=[t,e,i],!0},setData:function(t,e){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(i){return dhx4.callEvent("onClipboardError",["Access to clipboard denied",t,e]),""}if(!this._make())return!1;this._p[2].data=e,this._p[1].setTransferData("text/unicode",this._p[2],2*e.length);var i=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,i.kGlobalClipboard)},getData:function(t){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){return dhx4.callEvent("onClipboardError",["Access to clipboard denied",t]),""}if(!this._make())return!1;this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var e=new Object,i=new Object;try{this._p[1].getTransferData("text/unicode",i,e)}catch(t){return""}return i&&(i=i.value.QueryInterface(Components.interfaces.nsISupportsString)),i?i.data.substring(0,e.value/2):""}}),dhtmlXGridObject.prototype.enableBlockSelection=function(t){if(void 0===this._bs_mode){var e=this;this.obj.onmousedown=function(t){return e._bs_mode&&e._OnSelectionStart(t||event,this),!0},this._CSVRowDelimiter=this.csv.row,this.attachEvent("onResize",function(){return e._HideSelection(),!0}),this.attachEvent("onGridReconstructed",function(){return e._HideSelection(),!0}),this.attachEvent("onFilterEnd",this._HideSelection)}if(!1===t)return this._bs_mode=!1,this._HideSelection();if(this._bs_mode=!0,!window.dhx4.isIPad){var i=this._clip_area=document.createElement("textarea");i.style.cssText="position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;",i.onkeydown=function(t){86==(t=t||event).keyCode&&(t.ctrlKey||t.metaKey)&&e.pasteBlockFromClipboard()},document.body.insertBefore(this._clip_area,document.body.firstChild),dhtmlxEvent(this.entBox,"click",function(){e.editor||e._clip_area.select()})}},dhtmlXGridObject.prototype.forceLabelSelection=function(t){this._strictText=dhx4.s2b(t)},dhtmlXGridObject.prototype._OnSelectionStart=function(t,e){var i=this;if(2!=t.button){var s=t.srcElement||t.target;if(this.editor){if(s.tagName&&("INPUT"==s.tagName||"TEXTAREA"==s.tagName))return;this.editStop()}i.setActive(!0);var n=this.getPosition(this.obj),l=t.clientX-n[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),o=t.clientY-n[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if(this._CreateSelection(l-4,o-4),s==this._selectionObj)this._HideSelection(),this._startSelectionCell=null;else{for(;s&&(!s.tagName||"td"!=s.tagName.toLowerCase());)s=s.parentNode;this._startSelectionCell=s}if(this._startSelectionCell&&!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex]))return this._startSelectionCell=null;this.obj.onmousedown=null,this.obj[_isIE?"onmouseleave":"onmouseout"]=function(t){i._blsTimer&&window.clearTimeout(i._blsTimer)},this.obj.onmmold=this.obj.onmousemove,this._init_pos=[l,o],this._selectionObj.onmousemove=this.obj.onmousemove=function(e){(e=e||t).preventDefault?e.preventDefault():e.returnValue=!1,i._OnSelectionMove(e)},this._oldDMP=document.body.onmouseup,document.body.onmouseup=function(e){return e=e||t,i._OnSelectionStop(e,this),!0},this.callEvent("onBeforeBlockSelection",[]),document.body.onselectstart=function(){return!1}}},dhtmlXGridObject.prototype._getCellByPos=function(t,e){t=t,this._fake&&(t+=this._fake.objBox.scrollWidth),e=e;for(var i=0,s=0;s<this.obj.rows.length;s++)if((e-=this.obj.rows[s].offsetHeight)<=0){i=this.obj.rows[s];break}if(!i||!i.idd)return null;for(s=0;s<this._cCount;s++)if((t-=this.getColWidth(s))<=0)for(;;){if(!i._childIndexes||i._childIndexes[s+1]!=i._childIndexes[s])return this.cells(i.idd,s).cell;i=i.previousSibling}return null},dhtmlXGridObject.prototype._OnSelectionMove=function(t){var e=this;this._ShowSelection();var i=this.getPosition(this.obj),s=t.clientX-i[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),n=t.clientY-i[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if(Math.abs(this._init_pos[0]-s)<5&&Math.abs(this._init_pos[1]-n)<5)return this._HideSelection();var l=this._endSelectionCell;if(null==this._startSelectionCell)this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(t.srcElement||t.target,"TD");else if(t.srcElement||t.target)if("dhtmlxGrid_selection"==(t.srcElement||t.target).className)this._endSelectionCell=this._getCellByPos(s,n)||this._endSelectionCell;else{var o=this.getFirstParentOfType(t.srcElement||t.target,"TD");o.parentNode.idd&&(this._endSelectionCell=o)}this._endSelectionCell&&(this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex])||(this._endSelectionCell=l));var r=this.objBox.scrollLeft+this.objBox.clientWidth,a=this.objBox.scrollTop+this.objBox.clientHeight,h=this.objBox.scrollLeft,d=this.objBox.scrollTop,c=!1;if(this._blsTimer&&window.clearTimeout(this._blsTimer),s+20>=r?(this.objBox.scrollLeft=this.objBox.scrollLeft+20,c=!0):s-20<h&&(this.objBox.scrollLeft=this.objBox.scrollLeft-20,c=!0),n+20>=a&&!this._realfake?(this.objBox.scrollTop=this.objBox.scrollTop+20,c=!0):n-20<d&&!this._realfake&&(this.objBox.scrollTop=this.objBox.scrollTop-20,c=!0),this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell),c){var _=t.clientX,u=t.clientY;this._blsTimer=window.setTimeout(function(){e._OnSelectionMove({clientX:_,clientY:u})},100)}},dhtmlXGridObject.prototype._OnSelectionStop=function(t){var e=this;if(this._blsTimer&&window.clearTimeout(this._blsTimer),this.obj.onmousedown=function(i){return e._bs_mode&&e._OnSelectionStart(i||t,this),!0},this.obj.onmousemove=this.obj.onmmold||null,this._selectionObj.onmousemove=null,document.body.onmouseup=this._oldDMP||null,parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2)this._HideSelection();else{var i=this.getFirstParentOfType(t.srcElement||t.target,"TD");for(i&&i.parentNode.idd||(i=this._endSelectionCell);i&&(!i.tagName||"td"!=i.tagName.toLowerCase());)i=i.parentNode;if(!i)return this._HideSelection();this._stopSelectionCell=i,this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell),this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}},dhtmlXGridObject.prototype._RedrawSelectionPos=function(t,e){if(t.parentNode.grid!=e.parentNode.grid)return this._selectionArea;var i={};i.LeftTopCol=t._cellIndex,i.LeftTopRow=this.getRowIndex(t.parentNode.idd),i.RightBottomCol=e._cellIndex,i.RightBottomRow=this.getRowIndex(e.parentNode.idd);var s=t.offsetWidth,n=t.offsetHeight;t=this.getPosition(t,this.obj);var l=e.offsetWidth,o=e.offsetHeight;if(e=this.getPosition(e,this.obj),t[0]<e[0])var r=t[0],a=e[0]+l;else{var h=i.RightBottomCol;i.RightBottomCol=i.LeftTopCol,i.LeftTopCol=h;r=e[0],a=t[0]+s}if(t[1]<e[1])var d=t[1],c=e[1]+o;else{h=i.RightBottomRow;i.RightBottomRow=i.LeftTopRow,i.LeftTopRow=h;d=e[1],c=t[1]+n}var _=a-r,u=c-d;return this._selectionObj.style.left=r+"px",this._selectionObj.style.top=d+"px",this._selectionObj.style.width=_+"px",this._selectionObj.style.height=u+"px",i},dhtmlXGridObject.prototype._CreateSelection=function(t,e){if(null==this._selectionObj){var i=document.createElement("div");i.style.position="absolute",i.style.display="none",i.className="dhtmlxGrid_selection",this._selectionObj=i,this._selectionObj.onmousedown=function(t){if(2==(t=t||event).button||_isMacOS&&t.ctrlKey)return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",t])},this._selectionObj.oncontextmenu=function(t){return(t||event).cancelBubble=!0,!1},this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px",this._selectionObj.style.height="0px",this._selectionObj.style.left=t+"px",this._selectionObj.style.top=e+"px",this._selectionObj.startX=t,this._selectionObj.startY=e},dhtmlXGridObject.prototype._ShowSelection=function(){this._selectionObj&&(this._selectionObj.style.display="")},dhtmlXGridObject.prototype._HideSelection=function(){this._selectionObj&&(this._selectionObj.style.display="none"),this._selectionArea=null,this._clip_area&&(this._clip_area.value="",this._clip_area.blur())},dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._clip_area&&null!=this._selectionArea){var t=new Array;this._mathSerialization?this._agetm="getMathValue":this._strictText?this._agetm="getTitle":this._agetm="getValue",this._serialize_visible=!0;for(var e=this._selectionArea.LeftTopRow;e<=this._selectionArea.RightBottomRow;e++){var i=this._serializeRowToCVS(this.rowsBuffer[e],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);this._csvAID?t[t.length]=i:t[t.length]=i.substr(i.indexOf(this.csv.cell)+1)}t=t.join(this._CSVRowDelimiter),this._clip_area.value=t,this._clip_area.select(),this._serialize_visible=!1}},dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){if(this._clip_area){this._clip_area.select();var t=this;window.setTimeout(function(){t._pasteBlockFromClipboard(),t=null},1)}},dhtmlXGridObject.prototype._pasteBlockFromClipboard=function(){var t=this._clip_area.value;if(t){if(null!=this._selectionArea)var e=this._selectionArea.LeftTopRow,i=this._selectionArea.LeftTopCol;else{if(null==this.cell||this.editor)return!1;e=this.getRowIndex(this.cell.parentNode.idd),i=this.cell._cellIndex}var s=e+(t=this.csvParser.unblock(t,this.csv.cell,this.csv.row)).length,n=i+t[0].length;n>this._cCount&&(n=this._cCount);for(var l=0,o=e;o<s;o++){var r=this.render_row(o);if(-1!=r){for(var a=0,h=i;h<n;h++)if(!this._hrrar[h]||this._fake){var d=this.cells3(r,h);if(d.isDisabled())a++;else{if(this._onEditUndoRedo&&this._onEditUndoRedo(2,r.idd,h,t[l][a],d.getValue()),d.combo){for(var c=d.combo.values,_=0;_<c.length;_++)if(t[l][a]==c[_]){d.setValue(d.combo.keys[_]),c=null;break}null!=c&&d.editable?d.setValue(t[l][a++]):a++}else d[d.setImage?"setLabel":"setValue"](t[l][a++]);d.cell.wasChanged=!0}}else n=Math.max(n+1,this._cCount);this.callEvent("onRowPaste",[r.idd]),l++}}}},dhtmlXGridObject.prototype.getSelectedBlock=function(){return this._selectionArea?this._selectionArea:null!==this.getSelectedRowId()?{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}:null},dhtmlXGridObject.prototype.enableSmartRendering=function(t,e,i){arguments.length>2&&(e&&!this.rowsBuffer[e-1]&&(this.rowsBuffer[e-1]=0),e=i),this._srnd=dhx4.s2b(t),this._srdh=this._srdh||20,this._dpref=e||0},dhtmlXGridObject.prototype.enablePreRendering=function(t){this._srnd_pr=parseInt(t||50)},dhtmlXGridObject.prototype.forceFullLoading=function(t,e){for(var i=0;i<this.rowsBuffer.length;i++)if(!this.rowsBuffer[i]){var s=t||this.rowsBuffer.length-i;if(this.callEvent("onDynXLS",[i,s])){var n=this;this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+i+"&count="+s,function(){window.setTimeout(function(){n.forceFullLoading(t,e)},100)},this._data_type)}return}e&&e.call(this)},dhtmlXGridObject.prototype.setAwaitedRowHeight=function(t){this._srdh=parseInt(t)},dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2},dhtmlXGridObject.prototype._add_filler=function(t,e,i,s){if(!e)return null;var n=this._prepareRow("__filler__");n.firstChild.style.width="1px",n.firstChild.style.padding=n.firstChild.style.margin="0px";for(var l=1;l<n.childNodes.length;l++)n.childNodes[l].style.display="none";return n.firstChild.style.height=e*this._srdh+"px",(i=i||this.rowsCol[t])&&i.nextSibling?i.parentNode.insertBefore(n,i.nextSibling):_isKHTML?this.obj.appendChild(n):this.obj.rows[0].parentNode.appendChild(n),this.callEvent("onAddFiller",[t,e,n,i,s]),[t,e,n]},dhtmlXGridObject.prototype._update_srnd_view=function(){var t=Math.floor(this.objBox.scrollTop/this._srdh),e=t+this._get_view_size();if(this.multiLine){var i=this.objBox.scrollTop;for(t=0;i>0;)i-=this.rowsCol[t]?this.rowsCol[t].offsetHeight:this._srdh,t++;e=t+this._get_view_size(),t>0&&t--}(e+=this._srnd_pr||0)>this.rowsBuffer.length&&(e=this.rowsBuffer.length);for(var s=t;s<e;s++)if(!this.rowsCol[s]){if(-1==this._add_from_buffer(s)){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[e-1]){this._dpref&&this._dpref;var n=Math.max(0,Math.min(s,e-this._dpref));this._current_load=[n,e-n]}else this._current_load=[s,this._dpref?this._dpref:e-s];this.callEvent("onDynXLS",this._current_load)&&this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}return}this._tgle&&(this._updateLine(this._h2.get[this.rowsBuffer[s].idd],this.rowsBuffer[s]),this._updateParentLine(this._h2.get[this.rowsBuffer[s].idd],this.rowsBuffer[s])),s&&s==(this._realfake?this._fake:this)._r_select&&this.selectCell(s,this.cell?this.cell._cellIndex:0,!0)}this._fake&&!this._realfake&&this.multiLine&&(this._fake.objBox.scrollTop=this.objBox.scrollTop)},dhtmlXGridObject.prototype._add_from_buffer=function(t){var e=this.render_row(t);if(-1==e)return-1;if((e._attrs.selected||e._attrs.select)&&(this.selectRow(e,!1,!0),e._attrs.selected=e._attrs.select=null),this._cssSP){if(this._h2){var i=this._h2.get[e.idd];e.className+=" "+(i.level%2?this._cssUnEven+" "+this._cssUnEven:this._cssEven+" "+this._cssEven)+"_"+i.level+(this.rowsAr[i.id]._css||"")}}else this._cssEven&&t%2==0?e.className=this._cssEven+(-1!=e.className.indexOf("rowselected")?" rowselected ":" ")+(e._css||""):this._cssUnEven&&t%2==1&&(e.className=this._cssUnEven+(-1!=e.className.indexOf("rowselected")?" rowselected ":" ")+(e._css||""));for(var s=0;s<this._fillers.length;s++){var n=this._fillers[s];if(n&&n[0]<=t&&n[0]+n[1]>t){var l=t-n[0];return void(0==l?(this._insert_before(t,e,n[2]),this._update_fillers(s,-1,1)):l==n[1]-1?(this._insert_after(t,e,n[2]),this._update_fillers(s,-1,0)):(this._fillers.push(this._add_filler(t+1,n[1]-l-1,n[2],1)),this._insert_after(t,e,n[2]),this._update_fillers(s,-n[1]+l,0)))}}},dhtmlXGridObject.prototype._update_fillers=function(t,e,i){var s=this._fillers[t];s[1]=s[1]+e,s[0]=s[0]+i,s[1]?(s[2].firstChild.style.height=parseFloat(s[2].firstChild.style.height)+e*this._srdh+"px",this.callEvent("onUpdateFiller",[s[2]])):(this.callEvent("onRemoveFiller",[s[2]]),s[2].parentNode.removeChild(s[2]),this._fillers.splice(t,1))},dhtmlXGridObject.prototype._insert_before=function(t,e,i){i.parentNode.insertBefore(e,i),this.rowsCol[t]=e,this.callEvent("onRowInserted",[e,null,i,"before"])},dhtmlXGridObject.prototype._insert_after=function(t,e,i){i.nextSibling?i.parentNode.insertBefore(e,i.nextSibling):i.parentNode.appendChild(e),this.rowsCol[t]=e,this.callEvent("onRowInserted",[e,null,i,"after"])},void 0!==window.dhtmlxValidation&&(dhtmlxValidation.trackInput=function(t,e,i,s){dhtmlxEvent(t,"keyup",function(n){dhtmlxValidation._timer&&(window.clearTimeout(dhtmlxValidation._timer),dhtmlxValidation._timer=null),dhtmlxValidation._timer=window.setTimeout(function(){dhtmlxValidation.checkInput(t,e)?(t.className=t.className.replace(/[ ]*dhtmlx_live_validation_error/g,""),s&&s(t,t.value,e)):i&&!i(t,t.value,e)||(t.className+=" dhtmlx_live_validation_error")},250)})},dhtmlxValidation.checkInput=function(t,e){return dhtmlxValidation.checkValue(t.value,e)},dhtmlxValidation.checkValue=function(t,e){"string"==typeof e&&(e=e.split(","));for(var i=!0,s=0;s<e.length;s++)this["is"+e[s]]?i=i&&this["is"+e[s]](t):alert("Incorrect validation rule: "+e[s]);return i}),dhtmlXGridObject.prototype.enableValidation=function(t,e){t=dhx4.s2b(t),this._validators=!!t&&{data:[]},arguments.length>1&&(this._validators._live=e),this._validators._event||(this._validators._event=this.attachEvent("onEditCell",this.validationEvent))},dhtmlXGridObject.prototype.setColValidators=function(t){this._validators||this.enableValidation(!0),"string"==typeof t&&(t=t.split(this.delim)),this._validators.data=t},dhtmlXGridObject.prototype.validationEvent=function(t,e,i,s,n){var l=this._validators;if(!l)return!0;var o=l.data[i]||this.cells(e,i).getAttribute("validate")||"";if(1==t&&o){var r=this.editor||(this._fake||{}).editor;if(!r)return!0;if(r.cell.className=r.cell.className.replace(/[ ]*dhtmlx_validation_error/g,""),l._live){var a=this;dhtmlxValidation.trackInput(r.getInput(),o,function(t,s,n){return a.callEvent("onLiveValidationError",[e,i,s,t,n])},function(t,s,n){return a.callEvent("onLiveValidationCorrect",[e,i,s,t,n])})}}return 2==t&&this.validateCell(e,i,o,s),!0},dhtmlXGridObject.prototype.validateCell=function(t,e,i,s){if(i=i||this._validators.data[e]||this.cells(t,e).getAttribute("validate"),s=s||this.cells(t,e).getValue(),i){var n=this.cells(t,e).cell,l=!0;"string"==typeof i&&(i=i.split(this.delim));for(var o=0;o<i.length;o++)dhtmlxValidation.checkValue(s,i[o])||(this.callEvent("onValidationError",[t,e,s,i[o]])&&(n.className+=" dhtmlx_validation_error"),l=!1);return l&&(this.callEvent("onValidationCorrect",[t,e,s,i]),n.className=n.className.replace(/[ ]*dhtmlx_validation_error/g,"")),l}},eXcell_stree.prototype=new eXcell,dhtmlXGridObject.prototype.setSubTree=function(t,e){this._sub_trees||(this._sub_trees=[]),this._sub_trees[e]=[t],t.parentObject.style.display="none";var i=this;t.parentObject.onclick=function(t){return(t||window.event).cancelBubble=!0,!1},t.ev_onDblClick=null,t.attachEvent("onDblClick",function(t){return i._sub_id=t,i.editStop(),!0}),t._chRRS=!0},eXcell_link.prototype=new eXcell,eXcell_link.prototype.getTitle=function(){var t=this.cell.firstChild;return t&&t.tagName?t.getAttribute("href"):""},eXcell_link.prototype.getContent=function(){var t=this.cell.firstChild;return t&&t.tagName?t.innerHTML:""},eXcell_grid.prototype=new eXcell,dhtmlXGridObject.prototype.setSubGrid=function(t,e,i){this._sub_grids||(this._sub_grids=[]),this._sub_grids[e]=[t,i],t.entBox.style.display="none";var s=this;t.entBox.onclick=function(t){return(t||window.event).cancelBubble=!0,!1},t.attachEvent("onRowSelect",function(t){return s.editStop(),!0}),t._chRRS=!1},eXcell_dhxCalendar.prototype=new eXcell,eXcell_dhxCalendar.prototype.edit=function(){var t=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1),this.grid._grid_calendarA.setPosition(t[0],t[1]+this.cell.offsetHeight),this.grid._grid_calendarA._last_operation_calendar=!1,this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]),this.cell._cediton=!0,this.val=this.cell.val,this._val=this.cell.innerHTML;var e=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){},this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y"),this.grid._grid_calendarA.setDate(this.val||new Date),this.grid._grid_calendarA.draw=e},eXcell_dhxCalendar.prototype.getDate=function(){return this.cell.val?this.cell.val:null},eXcell_dhxCalendar.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()},eXcell_dhxCalendar.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){if(this.cell._cediton=!1,this.grid._grid_calendarA._last_operation_calendar){var t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),e=this.grid._grid_calendarA.getDate();this.cell.val=new Date(e),this.setCValue(t,e),this.cell._clearCell=!t;var i=this.val;return this.val=this._val,this.cell.val.valueOf()!=i}return!1}},eXcell_dhxCalendar.prototype.setValue=function(t){if(t&&"object"==typeof t)return this.cell.val=t,this.cell._clearCell=!1,void this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",t).toString(),this.cell.val);t&&""!=t.toString()._dhx_trim()?(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",t.toString(),null,!0)),this.grid._dtmask_inc&&(t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))):(t="&nbsp",this.cell._clearCell=!0,this.cell.val=""),"NaN"==this.cell.val||"Invalid Date"==this.cell.val?(this.cell._clearCell=!0,this.cell.val=new Date,this.setCValue("&nbsp;",0)):this.setCValue((t||"").toString(),this.cell.val)},eXcell_dhxCalendarA.prototype=new eXcell,eXcell_dhxCalendarA.prototype.edit=function(){var t=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1),this.grid._grid_calendarA.setPosition(1*t[0]+this.cell.offsetWidth,1*t[1]),this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid._grid_calendarA._last_operation_calendar=!1,this.cell._cediton=!0,this.val=this.cell.val,this._val=this.cell.innerHTML;var e=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){},this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y"),this.grid._grid_calendarA.setDate(this.val),this.grid._grid_calendarA.draw=e,this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA",this.obj=document.createElement(this.cell.atag),this.obj.style.height=this.cell.offsetHeight-4+"px",this.obj.className="dhx_combo_edit",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.align,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.getValue(),this.cell.innerHTML="",this.cell.appendChild(this.obj),window.dhx4.isIE&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40&&(this.obj.style.height="36px",this.obj.style.overflow="scroll")),this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0},this.obj.focus(),this.obj.focus()},eXcell_dhxCalendarA.prototype.getDate=function(){return this.cell.val?this.cell.val:null},eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()},eXcell_dhxCalendarA.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){if(this.cell._cediton=!1,this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=!1;var t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),e=this.grid._grid_calendarA.getDate();this.cell.val=new Date(e),this.setCValue(t,e),this.cell._clearCell=!t;var i=this.val;return this.val=this._val,this.cell.val.valueOf()!=(""|i).valueOf()}this.setValue(this.obj.value);i=this.val;return this.val=this._val,this.cell.val.valueOf()!=(i||"").valueOf()}},eXcell_dhxCalendarA.prototype.setValue=function(t){if(t&&"object"==typeof t)return this.cell.val=t,this.cell._clearCell=!1,void this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",t).toString(),this.cell.val);t&&""!=t.toString()._dhx_trim()?(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",t.toString(),null,!0)),this.grid._dtmask_inc&&(t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))):(t="&nbsp",this.cell._clearCell=!0,this.cell.val=""),"NaN"==this.cell.val||"Invalid Date"==this.cell.val?(this.cell.val=new Date,this.cell._clearCell=!0,this.setCValue("&nbsp;",0)):this.setCValue((t||"").toString(),this.cell.val)},dhtmlXGridObject.prototype.resetCounter=function(t){this._fake&&!this._realfake&&t<this._fake._cCount&&this._fake.resetCounter(t,this.currentPage);var e=arguments[0]||0;for(this.currentPage&&(e=(this.currentPage-1)*this.rowsBufferOutSize),e=0;e<this.rowsBuffer.length;e++)this.rowsBuffer[e]&&"TR"==this.rowsBuffer[e].tagName&&this.rowsAr[this.rowsBuffer[e].idd]&&(this.rowsAr[this.rowsBuffer[e].idd].childNodes[t].innerHTML=e+1)},eXcell_cntr.prototype=new eXcell,eXcell_acheck.prototype=new eXcell,eXcell_acheck.prototype.setValue=function(t){-1!=(t=(t||"").toString()).indexOf("1")||-1!=t.indexOf("true")?(t="1",this.cell.chstate="1"):(t="0",this.cell.chstate="0");this.setCValue(this.drawCurrentState(),this.cell.chstate)},eXcell_context.prototype=new eXcell,dhtmlXGridObject.prototype.setSubContext=function(t,e,i){var s=this;t.attachEvent("onClick",function(e,i){return s._sub_id=e,s.editStop(),t.hideContextMenu(),!0}),this._sub_context||(this._sub_context=[]),this._sub_context[e]=[t,i],t.hideContextMenu()},dhtmlXGridObject.prototype._process_html=function(t){if(t.tagName&&"TABLE"==t.tagName)return this._process_inner_html(t,0);var e=document.createElement("DIV");e.innerHTML=t.xmlDoc.responseText;var i=e.getElementsByTagName("TABLE")[0];this._process_inner_html(i,0)},dhtmlXGridObject.prototype._process_inner_html=function(t,e){for(var i=t.rows.length,s=e;s<i;s++){var n=t.rows[s].getAttribute("id")||s;this.rowsBuffer.push({idd:n,data:t.rows[s],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset(),this.setSizes()},dhtmlXGridObject.prototype._process_html_row=function(t,e){var i=e.getElementsByTagName("TD"),s=[];t._attrs=this._xml_attrs(e);for(var n=0;n<i.length;n++){var l=i[n],o=l.getAttribute("type");if(t.childNodes[n]&&(o&&(t.childNodes[n]._cellType=o),t.childNodes[n]._attrs=this._xml_attrs(i[n])),l.firstChild?s.push(l.innerHTML):s.push(""),l.colSpan>1){t.childNodes[n]._attrs.colspan=l.colSpan;for(var r=1;r<l.colSpan;r++)s.push("")}}for(i.length;n<t.childNodes.length;n++)t.childNodes[n]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(s):s),t},dhtmlXGridObject.prototype._get_html_data=function(t,e){for(t=t.firstChild;;){if(!t)return"";if("TD"==t.tagName&&e--,e<0)break;t=t.nextSibling}return t.firstChild?t.firstChild.data:""},dhtmlxEvent(window,"load",function(){for(var t=document.getElementsByTagName("table"),e=0;e<t.length;e++)"dhtmlxGrid"==t[e].className&&dhtmlXGridFromTable(t[e])}),dhtmlXGridObject.prototype._process_xmlA=function(t){this._parsing=!0;var e=dhx4.ajax.xmltop(this.xml.top,t);this._parseHead(e);var i=dhx4.ajax.xpath(this.xml.row,e),s=parseInt(e.getAttribute("pos")||0),n=parseInt(e.getAttribute("total_count")||0);if(n&&!this.rowsBuffer[n-1]&&(this.rowsBuffer[n-1]=null),this.isTreeGrid())return this._get_xml_data=this._get_xml_dataA,this._process_xml_row=this._process_xml_rowA,this._process_tree_xml(t);for(var l=0;l<i.length;l++)if(!this.rowsBuffer[l+s]){var o=i[l].getAttribute("id")||this.uid();this.rowsBuffer[l+s]={idd:o,data:i[l],_parser:this._process_xml_rowA,_locator:this._get_xml_dataA},this.rowsAr[o]=i[l]}this.render_dataset(),this._parsing=!1},dhtmlXGridObject.prototype._process_xmlB=function(t){this._parsing=!0;var e=dhx4.ajax.xmltop(this.xml.top,t);this._parseHead(e);var i=dhx4.ajax.xpath(this.xml.row,e),s=parseInt(e.getAttribute("pos")||0),n=parseInt(e.getAttribute("total_count")||0);if(n&&!this.rowsBuffer[n-1]&&(this.rowsBuffer[n-1]=null),this.isTreeGrid())return this._get_xml_data=this._get_xml_dataB,this._process_xml_row=this._process_xml_rowB,this._process_tree_xml(t);for(var l=0;l<i.length;l++)if(!this.rowsBuffer[l+s]){var o=i[l].getAttribute("id")||this.uid();this.rowsBuffer[l+s]={idd:o,data:i[l],_parser:this._process_xml_rowB,_locator:this._get_xml_dataB},this.rowsAr[o]=i[l]}this.render_dataset(),this._parsing=!1},dhtmlXGridObject.prototype._process_xml_rowA=function(t,e){var i=[];t._attrs=this._xml_attrs(e);for(var s=0;s<this.columnIds.length;s++){var n=this.columnIds[s],l=t._attrs[n]||"";t.childNodes[s]&&(t.childNodes[s]._attrs={}),i.push(l)}return this._fillRow(t,this._c_order?this._swapColumns(i):i),t},dhtmlXGridObject.prototype._get_xml_dataA=function(t,e){return t.getAttribute(this.getColumnId(e))},dhtmlXGridObject.prototype._process_xml_rowB=function(t,e){var i=[];if(t._attrs=this._xml_attrs(e),this._ud_enabled)for(var s=dhx4.ajax.xpath("./userdata",e),n=s.length-1;n>=0;n--)this.setUserData(s[n].getAttribute("name"),s[n].firstChild?s[n].firstChild.data:"");for(var l=0;l<e.childNodes.length;l++){var o=e.childNodes[l];if(o.tagName){var r=this.getColIndexById(o.tagName);if(!isNaN(r)){var a=o.getAttribute("type");a&&(t.childNodes[r]._cellType=a),t.childNodes[r]._attrs=this._xml_attrs(o),o.getAttribute("xmlcontent")||(o=o.firstChild?o.firstChild.data:""),i[r]=o}}}for(n=0;n<t.childNodes.length;n++)t.childNodes[n]._attrs||(t.childNodes[n]._attrs={});return this._fillRow(t,i),t},dhtmlXGridObject.prototype._get_xml_dataB=function(t,e){var i=this.getColumnId(e);for(t=t.firstChild;;){if(!t)return"";if(t.tagName==i)return t.firstChild?t.firstChild.data:"";t=t.nextSibling}return""},dhtmlXGridObject.prototype.startFastOperations=function(){this._disF=["setSizes","callEvent","_fixAlterCss","cells4","forEachRow","_correctMonolite"],this._disA=[];for(var t=this._disF.length-1;t>=0;t--)this._disA[t]=this[this._disF[t]],this[this._disF[t]]=function(){return!0};this._cellCache=[],this.cells4=function(t){var e=this._cellCache[t._cellIndex];return e||((e=this._cellCache[t._cellIndex]=this._disA[3].apply(this,[t])).destructor=function(){return!0},e.setCValue=function(t){e.cell.innerHTML=t}),e.cell=t,e.combo=t._combo||this.combos[t._cellIndex],e}},dhtmlXGridObject.prototype.stopFastOperations=function(){if(this._disF){for(var t=this._disF.length-1;t>=0;t--)this[this._disF[t]]=this._disA[t];this._correctMonolite&&this._correctMonolite(),this.setSizes(),this.callEvent("onGridReconstructed",[])}},dhtmlXGridObject.prototype._in_header_number_filter=function(t,e){this._in_header_text_filter.call(this,t,e);var i=this;t.firstChild._filter=function(){var t=i._get_filters(this.value,"num");return function(e){for(var i=!(t.length>0),s=0;s<t.length;s++)i=i||t[s](e);return i}}},dhtmlXGridObject.prototype._in_header_string_filter=function(t,e){this._in_header_text_filter.call(this,t,e);var i=this;t.firstChild._filter=function(){var t=i._get_filters(this.value,"str");return function(e){for(var i=!(t.length>0),s=0;s<t.length;s++)i=i||t[s](e);return i}}},dhtmlXGridObject.prototype._get_filters=function(t,e){for(var i=t.split(","),s=[],n=0;n<i.length;n++)if(""!=i[n]){var l=this["_get_"+e+"_filter"](i[n]);s.push(l)}return s},dhtmlXGridObject.prototype._get_str_filter=function(t){if("null"==t||"empty"==t)return new Function("value",'if (value == null || value == "") return true; return false;');if("!null"==t||"!empty"==t)return new Function("value",'if (value == null || value == "") return false; return true;');if("!"===t.substr(0,1)){var e=t.substr(1);return new Function("value",'if (value !== "'+e+'") return true; return false;')}if("~"===t.substr(0,1)){e=t.substr(1);return new Function("value",'if (value.indexOf("'+e+'") !== -1) return true; return false;')}if("^"===t.substr(0,1)&&"&"===t.substr(t.length-1,1)&&(t="="+t.substr(1,t.length-2)),"^"===t.substr(0,1)){e=t.substr(1);return new Function("value","if (value.substr(0, "+e.length+') === "'+e+'") return true; return false;')}if("&"===t.substr(t.length-1,1)){e=t.substr(0,t.length-1);return new Function("value","if (value.substr(value.length - "+e.length+') === "'+e+'") return true; return false;')}if("="===t.substr(0,1))e=t.substr(1);else e=t;return new Function("value",'if (value === "'+e+'") return true; return false;')},dhtmlXGridObject.prototype._get_num_filter=function(t){if("null"==t||"empty"==t)return new Function("value",'if (value == null || value == "") return true; return false;');if("!null"==t||"!empty"==t)return new Function("value",'if (value == null || value == "") return false; return true;');var e=t.split("..");if(2==e.length){var i=parseFloat(e[0]),s=parseFloat(e[1]);return new Function("value","if (value >= "+i+" && value <= "+s+") return true; return false;")}var n=t.match(/<>|>=|<=|>|<|=/);if(n)var l=n[0],o=parseFloat(t.replace(l,""));else{l="==";o=parseFloat(t)}return"<>"==l&&(l="!="),"="==l&&(l="=="),new Function("value"," if (value "+l+" "+o+" ) return true; return false;")},dhtmlXGridObject.prototype.attachHeaderA=dhtmlXGridObject.prototype.attachHeader,dhtmlXGridObject.prototype.attachHeader=function(){if(this.attachHeaderA.apply(this,arguments),this._realfake)return!0;this.formAutoSubmit(),void 0===this.FormSubmitOnlyChanged&&this.submitOnlyChanged(!0),void 0===this._submitAR&&this.submitAddedRows(!0);var t=this;this._added_rows=[],this._deleted_rows=[],this.attachEvent("onRowAdded",function(e){return t._added_rows.push(e),t.forEachCell(e,function(t){t.cell.wasChanged=!0}),!0}),this.attachEvent("onBeforeRowDeleted",function(e){return t._deleted_rows.push(e),!0}),this.attachHeader=this.attachHeaderA},dhtmlXGridObject.prototype.formAutoSubmit=function(){if(this.parentForm=this.detectParentFormPresent(),!1===this.parentForm)return!1;if(!this.formEventAttached){this.formInputs=new Array;var t=this;dhtmlxEvent(this.parentForm,"submit",function(){t.entBox&&t.parentFormOnSubmit()}),this.formEventAttached=!0}},dhtmlXGridObject.prototype.parentFormOnSubmit=function(){if(this.formCreateInputCollection(),!this.callEvent("onBeforeFormSubmit",[]))return!1},dhtmlXGridObject.prototype.submitOnlyChanged=function(t){this.FormSubmitOnlyChanged=dhx4.s2b(t)},dhtmlXGridObject.prototype.submitColumns=function(t){"string"==typeof t&&(t=t.split(this.delim)),this._submit_cols=t},dhtmlXGridObject.prototype.setFieldName=function(t){t=(t=(t=(t=(t=t.replace(/\{GRID_ID\}/g,"'+a1+'")).replace(/\{ROW_ID\}/g,"'+a2+'")).replace(/\{ROW_INDEX\}/g,"'+this.getRowIndex(a2)+'")).replace(/\{COLUMN_INDEX\}/g,"'+a3+'")).replace(/\{COLUMN_ID\}/g,"'+this.getColumnId(a3)+'"),this._input_mask=Function("a1","a2","a3","return '"+t+"';")},dhtmlXGridObject.prototype.submitSerialization=function(t){this.FormSubmitSerialization=dhx4.s2b(t)},dhtmlXGridObject.prototype.submitAddedRows=function(t){this._submitAR=dhx4.s2b(t)},dhtmlXGridObject.prototype.submitOnlySelected=function(t){this.FormSubmitOnlySelected=dhx4.s2b(t)},dhtmlXGridObject.prototype.submitOnlyRowID=function(t){this.FormSubmitOnlyRowID=dhx4.s2b(t)},dhtmlXGridObject.prototype.createFormInput=function(t,e){var i=document.createElement("input");i.type="hidden",this._input_mask&&"string"!=typeof t?i.name=this._input_mask.apply(this,t):i.name=((this.globalBox||this.entBox).id||"dhtmlXGrid")+"_"+t,i.value=e,this.parentForm.appendChild(i),this.formInputs.push(i)},dhtmlXGridObject.prototype.createFormInputRow=function(t){for(var e=(this.globalBox||this.entBox).id,i=0;i<this._cCount;i++){var s=this.cells3(t,i);this.FormSubmitOnlyChanged&&!s.wasChanged()||this._submit_cols&&!this._submit_cols[i]||this.createFormInput(this._input_mask?[e,t.idd,i]:t.idd+"_"+i,s.getValue())}},dhtmlXGridObject.prototype.formCreateInputCollection=function(){if(0==this.parentForm)return!1;for(var t=0;t<this.formInputs.length;t++)this.parentForm.removeChild(this.formInputs[t]);if(this.formInputs=new Array,this.FormSubmitSerialization)this.createFormInput("serialized",this.serialize());else if(this.FormSubmitOnlySelected)if(this.FormSubmitOnlyRowID)this.createFormInput("selected",this.getSelectedId());else for(t=0;t<this.selectedRows.length;t++)this.createFormInputRow(this.selectedRows[t]);else this._submitAR&&(this._added_rows.length&&this.createFormInput("rowsadded",this._added_rows.join(",")),this._deleted_rows.length&&this.createFormInput("rowsdeleted",this._deleted_rows.join(","))),this.forEachRow(function(t){-1!==this.getRowById(t)&&this.createFormInputRow(this.rowsAr[t])})},dhtmlXGridObject.prototype.detectParentFormPresent=function(){for(var t=!1,e=this.entBox;e&&e.tagName&&e!=document.body;){if("form"==e.tagName.toLowerCase()){t=e;break}e=e.parentNode}return t},dhtmlXGridObject.prototype.unGroup=function(){this._groups&&(this._dndProblematic=!1,delete this._groups,delete this._gIndex,this._fake&&this._mirror_rowsCol(),this.forEachRow(function(t){this.rowsAr[t].style.display=""}),this._reset_view(),this.callEvent("onGridReconstructed",[]),this.callEvent("onUnGroup",[]))},dhtmlXGridObject.prototype._mirror_rowsCol=function(){this._fake._groups=this._groups,this._fake._gIndex=this._gIndex,this.rowsBuffer=dhtmlxArray();for(var t=0;t<this.rowsCol.length;t++)this.rowsCol[t]._cntr||this.rowsBuffer.push(this.rowsCol[t]);this._fake.rowsBuffer=dhtmlxArray();for(t=0;t<this._fake.rowsCol.length;t++)this._fake.rowsCol[t]._cntr||this._fake.rowsBuffer.push(this._fake.rowsCol[t])},dhtmlXGridObject.prototype.groupBy=function(t,e){if(this._groups&&this.unGroup(),this._dndProblematic=!0,this._groups={},!e){e=["#title"];for(var i=1;i<this._cCount;i++)e.push("#cspan")}this._gmask=document.createElement("TR"),this._gmask.origin=e;var s,n=0;for(i=0;i<e.length;i++)"#cspan"==e[i]?s.colSpan=(parseInt(s.colSpan)||1)+1:((s=document.createElement("TD"))._cellIndex=i,this._hrrar[i]&&(s.style.display="none"),s.className="group_row",s.innerHTML="&nbsp;","#title"==e[i]?this._gmask._title=n:s.align=this.cellAlign[i]||"left",this._gmask.appendChild(s),0==e[i].indexOf("#stat")&&(this._gmask._math=!0,s._counter=[this["_g_"+e[i].replace("#","")],i,n]),n++);for(var l in this._groups)this._groups[l]=this.undefined;if(this._gIndex=t,this._fake&&!this._realfake&&(this._fake._groups=[],this._fake._gIndex=this._gIndex),this._nextRow=function(t,e){var i=this.rowsCol[t+e];return i&&("none"==i.style.display||i._cntr)?this._nextRow(t+e,e):i},this.__sortRowsBG||(this._key_events=dhtmlx.extend({},this._key_events),this._key_events.k38_0_0=function(){if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{var t=this.row.rowIndex;if(!t)return;var e=this._nextRow(t-1,-1);e&&this.selectCell(e,this.cell._cellIndex,!0)}},this._key_events.k13_1_0=this._key_events.k13_0_1=function(){},this._key_events.k40_0_0=function(){if(this.editor&&this.editor.combo)this.editor.shiftNext();else{var t=this.row.rowIndex;if(!t)return;var e=this._nextRow(t-1,1);e&&this.selectCell(e,this.cell._cellIndex,!0)}},this.attachEvent("onFilterStart",function(){return this._groups&&(this._groups=this.undefined),!0}),this.attachEvent("onFilterEnd",function(){void 0!==this._gIndex&&this.groupBy(this._gIndex,this._gmask.origin)}),this.sortRows_bg=this.sortRows,this.sortRows=function(t,e,i){if(void 0===this._groups)return this.sortRows_bg.apply(this,arguments);if(e=e||"str",i=i||"asc",this.callEvent("onBeforeSorting",[t,e,i])){if(void 0===this._groups)return!0;t==this._gIndex?this._sortByGroup(t,e,i):this._sortInGroup(t,e,i),this.setSortImgState(!0,t,i),this._fake&&(this._mirror_rowsCol(),this._fake._groups=[],this._fake._reset_view()),this.setSortImgState(!0,t,i),this.callEvent("onAfterSorting",[t,e,i])}return!1},this.attachEvent("onClearAll",function(){this.unGroup()}),this.attachEvent("onBeforeRowDeleted",function(t){if(!this._groups)return!0;if(!this.rowsAr[t])return!0;var e=this.cells(t,this._gIndex).getValue();""===e&&(e=" ");var i=this._groups[e];return this._dec_group(i),!0}),this.attachEvent("onAfterRowDeleted",function(t){this.updateGroups()}),this.attachEvent("onCheckbox",function(t,e,i){this.callEvent("onEditCell",[2,t,e,i?1:0,i?0:1])}),this.attachEvent("onXLE",this.updateGroups),this.attachEvent("onColumnHidden",this.hideGroupColumn),this.attachEvent("onEditCell",function(t,e,i,s,n){if(!this._groups)return!0;if(2==t&&s!=n&&i==this._gIndex){""===n&&(n=" "),this._dec_group(this._groups[n]);var l=this.rowsAr[e],o=this.rowsCol._dhx_find(l),r=this._inc_group(s),a=this.rowsCol[r];l==a&&(a=a.nextSibling);var h=l.parentNode;l.rowIndex;h.removeChild(l),a?h.insertBefore(l,a):h.appendChild(l),this.rowsCol._dhx_insertAt(r,l),r<o&&o++,this.rowsCol._dhx_removeAt(o,l),this._fixAlterCss()}else 2==t&&s!=n&&(this.updateGroups(),this._updateGroupView(this._groups[this.cells(e,this._gIndex).getValue()||" "]));return!0}),this.__sortRowsBG=!0),this._groupExisting(),this._hrrar)for(i=0;i<this._hrrar.length;i++)this._hrrar[i]&&this.hideGroupColumn(i,!0);this.callEvent("onGroup",[]),(this._ahgr||this._awdth)&&this.setSizes()},dhtmlXGridObject.prototype._sortInGroup=function(t,e,i){var s=this._groups_get();s.reverse();for(var n=0;n<s.length;n++){for(var l=s[n]._cntr._childs,o={},r=0;r<l.length;r++){var a=this.cells3(l[r],t);o[l[r].idd]=a.getDate?a.getDate():a.getValue()}this._sortCore(t,e,i,o,l)}this._groups_put(s),this.setSizes(),this.callEvent("onGridReconstructed",[])},dhtmlXGridObject.prototype._sortByGroup=function(t,e,i){for(var s=this._groups_get(),n=[],l=0;l<s.length;l++)s[l].idd="_sort_"+l,n["_sort_"+l]=s[l]._cntr.text;this._sortCore(t,e,i,n,s),this._groups_put(s),this.callEvent("onGridReconstructed",[]),this.setSizes()},dhtmlXGridObject.prototype._inc_group=function(t,e,i){""===t&&(t=" "),this._groups[t]||(this._groups[t]={text:t,row:this._addPseudoRow(),count:0,state:e?"plus":"minus"});var s=this._groups[t];s.row._cntr=s;var n=this.rowsCol._dhx_find(s.row)+s.count+1;return s.count++,i||(this._updateGroupView(s),this.updateGroups()),n},dhtmlXGridObject.prototype._dec_group=function(t){if(t)return t.count--,0==t.count?(t.row.parentNode.removeChild(t.row),this.rowsCol._dhx_removeAt(this.rowsCol._dhx_find(t.row)),delete this._groups[t.text]):this._updateGroupView(t),this._fake&&!this._realfake&&this._fake._dec_group(this._fake._groups[t.text]),this.updateGroups(),!0},dhtmlXGridObject.prototype._insertRowAt_gA=dhtmlXGridObject.prototype._insertRowAt,dhtmlXGridObject.prototype._insertRowAt=function(t,e,i){if(void 0!==this._groups){if(this._realfake)var s=this._fake._bfs_cells(t.idd,this._gIndex).getValue();else if(this._bfs_cells3)s=this._bfs_cells3(t,this._gIndex).getValue();else s=this.cells3(t,this._gIndex).getValue();s||(s=" "),e=this._inc_group(s,"none"==t.style.display)}var n=this._insertRowAt_gA(t,e,i);return void 0!==this._groups&&(this.expandGroup(s),this._updateGroupView(this._groups[s]),this.updateGroups()),n},dhtmlXGridObject.prototype._updateGroupView=function(t){if(this._fake&&!this._realfake)return t.row.firstChild.innerHTML="&nbsp;";var e=this._gmask||this._fake._gmask,i="<img style='margin-bottom:-4px' src='"+this.imgURL+t.state+".gif'> ";this.customGroupFormat?i+=this.customGroupFormat(t.text,t.count):i+=t.text+" ( "+t.count+" ) ",t.row.childNodes[e._title].innerHTML=i},dhtmlXGridObject.prototype._addPseudoRow=function(t){for(var e=this._gmask||this._fake._gmask,i=e.cloneNode(!0),s=0;s<i.childNodes.length;s++)i.childNodes[s]._cellIndex=e.childNodes[s]._cellIndex,this._realfake&&(i.childNodes[s].style.display="");var n=this;return i.onclick=function(t){n.callEvent("onGroupClick",[this._cntr.text])&&(n._fake&&n._realfake?n._fake._switchGroupState(n._fake._groups[this._cntr.text].row):n._switchGroupState(this),(t||event).cancelBubble="true")},i.ondblclick=function(t){(t||event).cancelBubble="true"},t||(_isKHTML?this.obj.appendChild(i):this.obj.firstChild.appendChild(i),this.rowsCol.push(i)),i},dhtmlXGridObject.prototype._groups_get=function(){var t=[];this._temp_par=this.obj.parentNode,this._temp_par.removeChild(this.obj);for(var e=[],i=this.rowsCol.length-1;i>=0;i--)this.rowsCol[i]._cntr?(this.rowsCol[i]._cntr._childs=e,e=[],t.push(this.rowsCol[i])):e.push(this.rowsCol[i]),this.rowsCol[i].parentNode.removeChild(this.rowsCol[i]);return t},dhtmlXGridObject.prototype._groups_put=function(t){var e=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray(0),this.rowsCol.stablesort=e;for(var i=0;i<t.length;i++){var s=t[i]._cntr;this.obj.firstChild.appendChild(s.row),this.rowsCol.push(s.row),s.row.idd=null;for(var n=0;n<s._childs.length;n++)this.obj.firstChild.appendChild(s._childs[n]),this.rowsCol.push(s._childs[n]);delete s._childs}this._temp_par.appendChild(this.obj)},dhtmlXGridObject.prototype._groupExisting=function(t){if(this.getRowsNum()){t=[];this._temp_par=this.obj.parentNode,this._temp_par.removeChild(this.obj);for(var e=this.rowsCol.length,i=0;i<e;i++){var s=this.cells4(this.rowsCol[i].childNodes[this._gIndex]).getValue();if(this.rowsCol[i].style.display="",s||(s=" "),!this._groups[s]){this._groups[s]={text:s,row:this._addPseudoRow(!0),count:0,state:"minus"};var n=this._groups[s];n.row._cntr=n,this._groups[s]._childs=[],t.push(n.row)}this._groups[s].count++,this._groups[s]._childs.push(this.rowsCol[i]),this.rowsCol[i].parentNode.removeChild(this.rowsCol[i])}for(i=0;i<t.length;i++)this._updateGroupView(t[i]._cntr);this._groups_put(t),this._fake&&!this._realfake&&(this._mirror_rowsCol(),this._fake._groups=[],this._fake._reset_view()),this.callEvent("onGridReconstructed",[]),this.updateGroups()}},dhtmlXGridObject.prototype._switchGroupState=function(t){var e=t._cntr;this._fake&&!this._realfake&&(e.state=this._fake._groups[t._cntr.text].row._cntr.state,this._fake._switchGroupState(this._fake._groups[t._cntr.text].row));var i=this.rowsCol._dhx_find(e.row)+1;e.state="minus"==e.state?"plus":"minus";for(var s="plus"==e.state?"none":"";this.rowsCol[i]&&!this.rowsCol[i]._cntr;)this.rowsCol[i].style.display=s,i++;this._updateGroupView(e),this.callEvent("onGroupStateChanged",[e.text,"minus"==e.state]),this.setSizes()},dhtmlXGridObject.prototype.expandGroup=function(t){"plus"==this._groups[t].state&&this._switchGroupState(this._groups[t].row)},dhtmlXGridObject.prototype.collapseGroup=function(t){"minus"==this._groups[t].state&&this._switchGroupState(this._groups[t].row)},dhtmlXGridObject.prototype.expandAllGroups=function(){for(var t in this._groups)this._groups[t]&&"plus"==this._groups[t].state&&this._switchGroupState(this._groups[t].row)},dhtmlXGridObject.prototype.collapseAllGroups=function(){for(var t in this._groups)this._groups[t]&&"minus"==this._groups[t].state&&this._switchGroupState(this._groups[t].row)},dhtmlXGridObject.prototype.hideGroupColumn=function(t,e){if(!this._fake){for(var i=-1,s=this._gmask.childNodes,n=0;n<s.length;n++)if(s[n]._cellIndex==t){i=n;break}if(-1!=i)for(var l in this._groups)this._groups[l].row.childNodes[i].style.display=e?"none":""}},dhtmlXGridObject.prototype.groupStat=function(t,e,i){i=this["_g_"+(i||"stat_total")];var s=0,n=0;return this.forEachRowInGroup(t,function(t){s=i(s,1*this.cells(t,e).getValue(),n),n++}),s},dhtmlXGridObject.prototype.forEachRowInGroup=function(t,e){var i=this._groups[t].row.nextSibling;if(i)for(;i&&!i._cntr;)e.call(this,i.idd),i=i.nextSibling;else{var s=this._groups[t]._childs;if(s)for(var n=0;n<s.length;n++)e.call(this,s[n].idd)}},dhtmlXGridObject.prototype.updateGroups=function(){if(this._gmask&&this._gmask._math&&!this._parsing)for(var t=this._gmask.childNodes,e=0;e<t.length;e++)t[e]._counter&&this._b_processing.apply(this,t[e]._counter)},dhtmlXGridObject.prototype._b_processing=function(t,e,i){var s=0,n=0;this._ecache[this.cellType[e]]||this.cells5({parentNode:{grid:this}},this.cellType[e]);for(var l=this.rowsCol.length-1;l>=0;l--)this.rowsCol[l]._cntr?(this.cells5(this.rowsCol[l].childNodes[i],this.cellType[e]).setValue(s),n=s=0):(s=t(s,1*this.cells3(this.rowsCol[l],e).getValue(),n),n++)},dhtmlXGridObject.prototype._g_stat_total=function(t,e,i){return t+e},dhtmlXGridObject.prototype._g_stat_min=function(t,e,i){return i||(t=1/0),Math.min(t,e)},dhtmlXGridObject.prototype._g_stat_max=function(t,e,i){return i||(t=-1/0),Math.max(t,e)},dhtmlXGridObject.prototype._g_stat_average=function(t,e,i){return(t*i+e)/(i+1)},dhtmlXGridObject.prototype._g_stat_count=function(t,e,i){return t++},dhtmlXGridObject.prototype._in_header_collapse=function(t,e,i){var s="TD"==t.tagName?t:t.parentNode;e=s._cellIndexS,this._column_groups||(this._column_groups=[]);var n=i[1].split(":");n=[(n=i[1].split(":")).shift(),n.join(":")];var l=parseInt(n[0]);t.innerHTML=i[0]+"<img src='"+this.imgURL+"minus.gif' style='padding-right:10px;height:16px'/><span style='position:relative; top:-6px;'>"+(n[1]||"")+"<span>",t.style.paddingBottom="0px";var o=this;this._column_groups[e]=t.getElementsByTagName("IMG")[0],this._column_groups[e].onclick=function(t){(t||event).cancelBubble=!0,this._cstate=!this._cstate;for(var i=e+1;i<e+l;i++)o.setColumnHidden(i,this._cstate);if(this._cstate){if(s.colSpan&&s.colSpan>0){s._exp_colspan=s.colSpan;var n=Math.max(1,s.colSpan-l);if(!_isFF)for(var r=0;r<s.colSpan-n;r++){var a=document.createElement("TD");s.nextSibling?s.parentNode.insertBefore(a,s.nextSibling):s.parentNode.appendChild(a)}s.colSpan=n}o.callEvent("onColumnCollapse",[e,this._cstate])}else if(s._exp_colspan){if(s.colSpan=s._exp_colspan,!_isFF)for(r=1;r<s._exp_colspan;r++)s.parentNode.removeChild(s.nextSibling);o.callEvent("onColumnCollapse",[e,this._cstate])}this.src=o.imgURL+(this._cstate?"plus.gif":"minus.gif"),"none"!=o.sortImg.style.display&&o.setSortImgPos()}},dhtmlXGridObject.prototype.collapseColumns=function(t){this._column_groups[t]&&!this._column_groups[t]._cstate&&this._column_groups[t].onclick({})},dhtmlXGridObject.prototype.expandColumns=function(t){this._column_groups[t]&&this._column_groups[t]._cstate&&this._column_groups[t].onclick({})},dhtmlXGridObject.prototype.enableHeaderMenu=function(t){if(!window.dhtmlXMenuObject)return dhtmlx.message("You need to include DHTMLX Menu");if(!this._header_menu){var e=this._header_menu=new dhtmlXMenuObject;e.renderAsContextMenu();var i=this;e.attachEvent("onBeforeContextMenu",function(){return i._showHContext(t),!0}),e.attachEvent("onClick",function(t){for(var e=this.getCheckboxState(t),s=i.hdr.rows[1],n=0;n<s.cells.length;n++){var l=s.cells[n];if(l._cellIndexS==t)for(var o=l.colSpan||1,r=0;r<o;r++)i.setColumnHidden(1*t+r,!e)}}),this.attachEvent("onInit",function(){e.addContextZone(this.hdr)}),this.hdr.rows.length&&this.callEvent("onInit",[])}},dhtmlXGridObject.prototype.getHeaderMenu=function(t){return this._header_menu},dhtmlXGridObject.prototype._hideHContext=function(){this._header_menu&&this._header_menu.hide()},dhtmlXGridObject.prototype._showHContext=function(t){"string"==typeof t&&(t=t.split(this.delim));var e=0,i=0;this._header_menu.clearAll();for(var s=0;s<this.hdr.rows[1].cells.length;s++){var n=this.hdr.rows[1].cells[s];if(!t||t[e]&&"false"!=t[e]){if(n.firstChild&&"DIV"==n.firstChild.tagName)var l=n.firstChild.innerHTML;else l=n.innerHTML;l=l.replace(/<[^>]*>/gi,"");var o=!(this.isColumnHidden(e)||0==this.getColWidth(e));this._header_menu.addCheckbox("child",this._header_menu.topId,i,e,l,o),i++}e+=n.colSpan||1}},dhtmlXGridObject.prototype._process_json_row=function(t,e){t._attrs=e;for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};if(e.userdata)for(var s in e.userdata)this.setUserData(t.idd,s,e.userdata[s]);e=this._c_order?this._swapColumns(e.data):e.data;for(var n=0;n<e.length;n++)"object"==typeof e[n]&&null!=e[n]&&(t.childNodes[n]._attrs=e[n],e[n].type&&(t.childNodes[n]._cellType=e[n].type),e[n]=e[n].value);return this._fillRow(t,e),t},dhtmlXGridObject.prototype._process_js_row=function(t,e){t._attrs=e;for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};if(e.userdata)for(var s in e.userdata)this.setUserData(t.idd,s,e.userdata[s]);for(var n=[],l=0;l<this.columnIds.length;l++)n[l]=e[this.columnIds[l]],"object"==typeof n[l]&&null!=n[l]&&(t.childNodes[l]._attrs=n[l],n[l].type&&(t.childNodes[l]._cellType=n[l].type),n[l]=n[l].value),n[l]||0===n[l]||(n[l]="");return this._fillRow(t,n),t},dhtmlXGridObject.prototype.updateFromJSON=function(t,e,i,s){void 0===e&&(e=!0),this._refresh_mode=[!0,e,i],this.load(t,s,"json")},dhtmlXGridObject.prototype._refreshFromJSON=function(t){this._f_rowsBuffer&&this.filterBy(0,""),reset=!1,window.eXcell_tree&&(eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(t){this.grid._h2.get[this.cell.parentNode.idd]&&this.cell.parentNode.valTag?this.setLabel(t):this.setValueX(t)});var e=this.cellType._dhx_find("tree"),i=t.parent||0,s={};this._refresh_mode[2]&&(-1!=e?this._h2.forEachChild(i,function(t){s[t.id]=!0},this):this.forEachRow(function(t){s[t]=!0}));for(var n=t.rows,l=0;l<n.length;l++){var o=n[l],r=o.id;if(s[r]=!1,this.rowsAr[r]&&"TR"!=this.rowsAr[r].tagName)this._h2?this._h2.get[r].buff.data=o:this.rowsBuffer[this.getRowIndex(r)].data=o,this.rowsAr[r]=o;else if(this.rowsAr[r])this._process_json_row(this.rowsAr[r],o,-1),this._postRowProcessing(this.rowsAr[r],!0);else if(this._refresh_mode[1]){var a={idd:r,data:o,_parser:this._process_json_row,_locator:this._get_json_data},h=this.rowsBuffer.length;"top"==this._refresh_mode[1]?(this.rowsBuffer.unshift(a),h=0):this.rowsBuffer.push(a),this._h2&&(reset=!0,this._h2.add(r,i).buff=this.rowsBuffer[this.rowsBuffer.length-1]),this.rowsAr[r]=o,o=this.render_row(h),this._insertRowAt(o,h?-1:0)}}if(this._refresh_mode[2])for(r in s)s[r]&&this.rowsAr[r]&&this.deleteRow(r);this._refresh_mode=null,window.eXcell_tree&&(eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX),reset&&this._renderSort(),this._f_rowsBuffer&&(this._f_rowsBuffer=null,this.filterByAll())},dhtmlXGridObject.prototype._process_js=function(t){return this._process_json(t,"js")},dhtmlXGridObject.prototype._parseHeadJson=function(t){if(t.head&&t.head.length){var e=t.head,i=t.settings,s="setInitWidths",n=!1;i&&"%"==i.colwidth&&(s="setInitWidthsP"),i&&"%"==i.splitat&&(n=i.splitat),this.hdr.rows.length>0&&this.clearAll(!0);for(var l=[[],[],[],[],[],[],[]],o=["value","width","type","align","sort","hidden","id"],r=["",s,"setColTypes","setColAlign","setColSorting","","setColumnIds"],a=0;a<e.length;a++)for(var h=0;h<o.length;h++)l[h].push(e[a][o[h]]);this.setHeader(l[0]);for(a=0;a<r.length;a++)r[a]&&this[r[a]](l[a].join(this.delim));for(a=0;a<e.length;a++){var d=e[a].options;if(e[a].options)if("clist"==this.cellType[a])this.registerCList(a,d);else{var c=this.getCombo(a);for(h=0;h<d.length;h++)c.put(d[h].id,d[h].value)}}this.init();var _=l[5].join(this.delim);this.setColHidden&&""!=_.replace(/,/g,"")&&this.setColHidden(_),n&&this.splitAt&&this.splitAt(n)}},dhtmlXGridObject.prototype._process_json=function(data,mode){this._parsing=!0;try{var data=data.responseText||data;"string"==typeof data&&(eval("dhtmlx.temp="+data+";"),data=dhtmlx.temp)}catch(t){dhx4.callEvent("onLoadXMLError",["Incorrect JSON",data.xmlDoc||data,this]),data={rows:[]}}if(this._refresh_mode)return this._refreshFromJSON(data);data.head&&this._parseHeadJson(data);var cr=parseInt(data.pos||0),total=parseInt(data.total_count||0),reset=!1;total&&(this.rowsBuffer[total-1]||(this.rowsBuffer.length&&(reset=!0),this.rowsBuffer[total-1]=null),total<this.rowsBuffer.length&&(this.rowsBuffer.splice(total,this.rowsBuffer.length-total),reset=!0));var userdata="js"===mode?data.userdata:data;for(var key in userdata)"js"!==mode&&"rows"==key||this.setUserData("",key,userdata[key]);if("js"==mode&&data.collections)for(var colkey in data.collections){var index=this.getColIndexById(colkey),colrecs=data.collections[colkey];if(index!==window.undefined)if("clist"==this.cellType[index]){colplaindata=[];for(var j=0;j<colrecs.length;j++)colplaindata.push(colrecs[j].label);this.registerCList(index,colplaindata)}else for(var combo=this.getCombo(index),j=0;j<colrecs.length;j++)combo.put(colrecs[j].value,colrecs[j].label)}if(this.isTreeGrid())return this._process_tree_json(data,null,null,mode);if("js"==mode){data.data&&(data=data.data);for(var i=0;i<data.length;i++)if(!this.rowsBuffer[i+cr]){var row=data[i],id=row.id||i+1;this.rowsBuffer[i+cr]={idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data},this.rowsAr[id]=data[i]}}else for(var i=0;i<data.rows.length;i++)if(!this.rowsBuffer[i+cr]){var id=data.rows[i].id;this.rowsBuffer[i+cr]={idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data},this.rowsAr[id]=data.rows[i]}if(this.callEvent("onDataReady",[]),reset&&this._srnd){var h=this.objBox.scrollTop;this._reset_view(),this.objBox.scrollTop=h}else this.render_dataset();this._parsing=!1},dhtmlXGridObject.prototype._get_json_data=function(t,e){return"object"==typeof t.data[e]?t.data[e].value:t.data[e]},dhtmlXGridObject.prototype._process_tree_json=function(t,e,i,s){this._parsing=!0;var n=!1;if(e||(this.render_row=this.render_row_tree,n=!0,"0"==(i=(e=t).parent||0)&&(i=0),this._h2||(this._h2=this._createHierarchy()),this._fake&&(this._fake._h2=this._h2)),"js"==s){e.data&&!i&&(t=e.data),e.rows&&(e=e.rows);for(var l=0;l<e.length;l++){var o=e[l].id;(r=this._h2.add(o,i)).buff={idd:o,data:e[l],_parser:this._process_js_row,_locator:this._get_js_data},e[l].open&&(r.state="minus"),this.rowsAr[o]=r.buff,this._process_tree_json(e[l],e[l],o,s)}}else if(e.rows)for(l=0;l<e.rows.length;l++){var r;o=e.rows[l].id;(r=this._h2.add(o,i)).buff={idd:o,data:e.rows[l],_parser:this._process_json_row,_locator:this._get_json_data},e.rows[l].open&&(r.state="minus"),this.rowsAr[o]=r.buff,this._process_tree_json(e.rows[l],e.rows[l],o,s)}n&&(0!=i&&this._h2.change(i,"state","minus"),this._updateTGRState(this._h2.get[i]),this._h2_to_buff(),this.callEvent("onDataReady",[]),0!=i&&(this._srnd||this.pagingOn)?this._renderSort():this.render_dataset(),!1===this._slowParse&&this.forEachRow(function(t){this.render_row_tree(0,t)}),this._parsing=!1,0==i||this._srnd||this.callEvent("onOpenEnd",[i,1]))},dhtmlXGridObject.prototype.enableMarkedCells=function(t){this.markedRowsArr=new dhtmlxArray(0),this.markedCellsArr=new Array(0),this.lastMarkedRow=null,this.lastMarkedColumn=null,this.markedCells=!0,this.lastMarkMethod=0,arguments.length>0&&(dhx4.s2b(t)||(this.markedCells=!1))},dhtmlXGridObject.prototype.doMark=function(t,e){var i=t.parentNode.idd;if(this.setActive(!0),i){this.editStop(),this.cell=t,this.row=t.parentNode;var s=t._cellIndex;if(e||(e=0),0==e)this.unmarkAll();else if(1==e){if(this.lastMarkedRow)for(var n=Math.min(this.getRowIndex(i),this.getRowIndex(this.lastMarkedRow)),l=Math.max(this.getRowIndex(i),this.getRowIndex(this.lastMarkedRow)),o=Math.min(s,this.lastMarkedColumn),r=Math.max(s,this.lastMarkedColumn),a=n;a<l+1;a++)for(var h=o;h<r+1;h++)this.mark(this.getRowId(a),h,!0)}else if(2==e&&-1!=this.markedRowsArr._dhx_find(i))for(var d=0;d<this.markedCellsArr[i].length;d++)if(this.markedCellsArr[i][d]==s)return this.mark(i,s,!1),!0;this.markedCellsArr[i]||(this.markedCellsArr[i]=new dhtmlxArray(0)),1!=e&&this.mark(i,s),this.moveToVisible(this.cells(i,s).cell),this.lastMarkedRow=i,this.lastMarkedColumn=s,this.lastMarkMethod=e}},dhtmlXGridObject.prototype.mark=function(t,e,i){if(arguments.length>2&&!dhx4.s2b(i)){if(this.cells(t,e).cell.className=this.cells(t,e).cell.className.replace(/cellselected/g,""),-1!=this.markedRowsArr._dhx_find(t)){var s=this.markedCellsArr[t]._dhx_find(e);-1!=s&&(this.markedCellsArr[t]._dhx_removeAt(s),0==this.markedCellsArr[t].length&&this.markedRowsArr._dhx_removeAt(this.markedRowsArr._dhx_find(t)),this.callEvent("onCellUnMarked",[t,e]))}return!0}this.cells(t,e).cell.className+=" cellselected",-1==this.markedRowsArr._dhx_find(t)&&(this.markedRowsArr[this.markedRowsArr.length]=t),this.markedCellsArr[t]||(this.markedCellsArr[t]=new dhtmlxArray(0)),-1==this.markedCellsArr[t]._dhx_find(e)&&(this.markedCellsArr[t][this.markedCellsArr[t].length]=e,this.callEvent("onCellMarked",[t,e]))},dhtmlXGridObject.prototype.unmarkAll=function(){if(this.markedRowsArr){for(var t=0;t<this.markedRowsArr.length;t++){var e=this.markedRowsArr[t];if(this.rowsAr[e])for(var i=0;i<this.markedCellsArr[e].length;i++)this.callEvent("onCellUnMarked",[e,this.markedCellsArr[e][i]]),this.cells(e,this.markedCellsArr[e][i]).cell.className=this.cells(e,this.markedCellsArr[e][i]).cell.className.replace(/cellselected/g,"")}this.markedRowsArr=new dhtmlxArray(0),this.markedCellsArr=new Array(0)}return!0},dhtmlXGridObject.prototype.getMarked=function(){var t=new Array;if(this.markedRowsArr)for(var e=0;e<this.markedRowsArr.length;e++)for(var i=this.markedRowsArr[e],s=0;s<this.markedCellsArr[i].length;s++)t[t.length]=[i,this.markedCellsArr[i][s]];return t},eXcell_math.prototype=new eXcell,dhx4.attachEvent("onGridCreated",function(t){t._mat_links={},t._aggregators=[],t.attachEvent("onClearAll",function(){this._mat_links={},this._aggregators=[]}),t.attachEvent("onCellChanged",function(t,e){if(this._mat_links[t]){var i=this._mat_links[t][e];if(i)for(var s=0;s<i.length;s++)i[s].parentNode&&this.cells5(i[s]).setValue(this._calcSCL(i[s]))}if(!this._parsing&&this._aggregators[e]){var n=this._h2.get[t].parent.id;if(0!=n){var l=this.cells(n,e);l.setValue(this._calcSCL(l.cell))}}}),t.attachEvent("onAfterRowDeleted",function(t,e){if(0!=e&&!this._parsing&&this._aggregators.length)for(var i=0;i<this._aggregators.length;i++)if(this._aggregators[i]){var s=this.cells(e,i);s.setValue(this._calcSCL(s.cell))}return!0}),t.attachEvent("onXLE",function(){for(var t=0;t<this._aggregators.length;t++)this._aggregators[t]&&this._h2.forEachChild(0,function(e){if(0!=e.childs.length){var i=this.cells(e.id,t);i.setValue(this._calcSCL(i.cell))}},this)})}),dhtmlXGridObject.prototype.enableMathSerialization=function(t){this._mathSerialization=dhx4.s2b(t)},dhtmlXGridObject.prototype.setMathRound=function(t){this._roundDl=t,this._roundD=Math.pow(10,t)},dhtmlXGridObject.prototype.enableMathEditing=function(t){this._mathEdit=dhx4.s2b(t)},dhtmlXGridObject.prototype._calcSCL=function(cell){if(!cell._code)return this.cells5(cell).getValue();try{dhtmlx.agrid=this;var z=eval(cell._code)}catch(t){return"#SCL"}if(this._roundD){var pre=Math.abs(z)<1?"0":"";if(z<0&&(pre="-"+pre),z=Math.round(Math.abs(z)*this._roundD).toString(),0==z)return 0;if(this._roundDl>0){var n=z.length-this._roundDl;return n<0&&(z=("000000000"+z).substring(9+n),n=0),pre+z.substring(0,n)+"."+z.substring(n,z.length)}return pre+z}return z},dhtmlXGridObject.prototype._countTotal=function(t,e){for(var i=0,s=this._h2.get[t],n=0;n<s.childs.length;n++){if(!s.childs[n].buff)return i;if(s.childs[n].buff._parser)return this._h2.forEachChild(t,function(t){if(0==t.childs.length){var s=parseFloat(this._get_cell_value(t.buff,e),10);s&&(i+=s)}},this),i;var l=parseFloat(this._get_cell_value(s.childs[n].buff,e),10);l&&(i+=l)}return i},dhtmlXGridObject.prototype._compileSCL=function(t,e,i){if(null===t||t===window.undefined)return t;if(0!=(t=t.toString()).indexOf("=")||!e.parentNode)return this._reLink([],e),i&&(e._code=e.original=null),t;e.original=t;var s=null;if(-1!=(t=t.replace("=","")).indexOf("sum"))return t=t.replace("sum","(dhtmlx.agrid._countTotal('"+e.parentNode.idd+"',"+e._cellIndex+"))"),this._aggregators||(this._aggregators=[]),this._aggregators[e._cellIndex]="sum",e._code=t,this._parsing?"":this._calcSCL(e);if(-1!=t.indexOf("[[")){var n=/(\[\[([^\,]*)\,([^\]]*)]\])/g;dhtmlx.agrid=this,s=s||new Array,t=t.replace(n,function(t,i,n,l){return"-"==n&&(n=e.parentNode.idd),0==n.indexOf("#")&&(n=dhtmlx.agrid.getRowId(n.replace("#",""))),s[s.length]=[n,l],'(parseFloat(dhtmlx.agrid.cells("'+n+'",'+l+").getValue(),10))"})}if(-1!=t.indexOf(":")){n=/:(\w+)/g;dhtmlx.agrid=this;var l=e.parentNode.idd;s=s||new Array,t=t.replace(n,function(t,e,i,n){return s[s.length]=[l,dhtmlx.agrid.getColIndexById(e)],'(parseFloat(dhtmlx.agrid.cells("'+l+'",dhtmlx.agrid.getColIndexById("'+e+'")).getValue(),10))'})}else{n=/c([0-9]+)/g;dhtmlx.agrid=this;l=e.parentNode.idd;s=s||new Array,t=t.replace(n,function(t,e,i,n){return s[s.length]=[l,e],'(parseFloat(dhtmlx.agrid.cells("'+l+'",'+e+").getValue(),10))"})}return this._reLink(s,e),e._code=t,this._calcSCL(e)},dhtmlXGridObject.prototype._reLink=function(t,e){if(t.length)for(var i=0;i<t.length;i++){this._mat_links[t[i][0]]||(this._mat_links[t[i][0]]={});var s=this._mat_links[t[i][0]];s[t[i][1]]||(s[t[i][1]]=[]),s[t[i][1]].push(e)}},_isKHTML&&function(){var t=String.prototype.replace;String.prototype.replace=function(e,i){if("function"!=typeof i)return t.apply(this,arguments);var s=""+this,n=i;if(!(e instanceof RegExp))return-1==(h=s.indexOf(e))?s:t.apply(s,[e,n(e,h,s)]);for(var l,o=e,r=[],a=o.lastIndex;null!=(l=o.exec(s));){var h=l.index,d=l.concat(h,s);if(r.push(s.slice(a,h),n.apply(null,d).toString()),!o.global){a+=RegExp.lastMatch.length;break}a=o.lastIndex}return r.push(s.slice(a)),r.join("")}}(),dhtmlXGridObject.prototype.insertColumn=function(t,e,i,s,n,l,o,r,a){if((t=parseInt(t))>this._cCount&&(t=this._cCount),this._cMod||(this._cMod=this._cCount),this._processAllArrays(this._cCount,t-1,[e||"&nbsp;",s||100,i||"ed",l||"left",o||"",n||"na",a||"","",this._cMod,s||100]),this._processAllRows("_addColInRow",t),"object"==typeof e)for(var h=1;h<this.hdr.rows.length;h++)if("#rspan"==e[h-1]){for(var d=h-1,c=!1,_=null;!c;){_=this.hdr.rows[d];for(var u=0;u<_.cells.length;u++)if(_.cells[u]._cellIndex==t){c=u;break}d--}this.hdr.rows[d+1].cells[u].rowSpan=(this.hdr.rows[d].cells[u].rowSpan||1)+1}else this.setHeaderCol(t,e[h-1]||"&nbsp;",h);else this.setHeaderCol(t,e||"&nbsp;");this.hdr.rows[0].cells[t],this._cCount++,this._cMod++,this._master_row=null,this.setSizes()},dhtmlXGridObject.prototype.deleteColumn=function(t){t=parseInt(t),0!=this._cCount&&(this._cMod||(this._cMod=this._cCount),t>=this._cCount||(this._processAllArrays(t,this._cCount-1,[null,null,null,null,null,null,null,null,null,null,null]),this._processAllRows("_deleteColInRow",t),this._cCount--,this._master_row=null,this.setSizes()))},dhtmlXGridObject.prototype._processAllRows=function(t,e,i){this[t](this.obj.rows[0],e,i,0);for(var s=this.hdr.rows.length,n=0;n<s;n++)this[t](this.hdr.rows[n],e,i,n);if(this.ftr)for(s=this.ftr.firstChild.rows.length,n=0;n<s;n++)this[t](this.ftr.firstChild.rows[n],e,i,n);this.forEachRow(function(s){this.rowsAr[s]&&"TR"==this.rowsAr[s].tagName&&this[t](this.rowsAr[s],e,i,-1)})},dhtmlXGridObject.prototype._processAllArrays=function(t,e,i){var s=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor","_hrrar","_c_order"];this.cellWidthPX.length&&s.push("cellWidthPX"),this.cellWidthPC.length&&s.push("cellWidthPC"),this._col_combos&&s.push("_col_combos"),this._mCols&&(s[s.length]="_mCols"),this.columnIds&&(s[s.length]="columnIds"),this._maskArr&&s.push("_maskArr"),this._drsclmW&&s.push("_drsclmW"),this._RaSeCol&&s.push("_RaSeCol"),this._hm_config&&s.push("_hm_config"),this._drsclmn&&s.push("_drsclmn"),this.clists&&s.push("clists"),this._validators&&this._validators.data&&s.push(this._validators.data),s.push("combos"),this._customSorts&&s.push("_customSorts"),this._aggregators&&s.push("_aggregators");var n=t<=e;if(!this._c_order){this._c_order=new Array;for(var l=this._cCount,o=0;o<l;o++)this._c_order[o]=o}for(o=0;o<s.length;o++){var r=this[s[o]]||s[o];if(r){if(n){for(var a=r[t],h=t;h<e;h++)r[h]=r[h+1];r[e]=a}else{for(a=r[t],h=t;h>e+1;h--)r[h]=r[h-1];r[e+1]=a}i&&(r[e+(n?0:1)]=i[o])}}},dhtmlXGridObject.prototype.moveColumn=function(t,e){if(e--,t=parseInt(t),(e=parseInt(e))<t)var i=e+1;else i=e;if(!this.callEvent("onBeforeCMove",[t,i]))return!1;t!=i&&(this.editStop(),this._processAllRows("_moveColInRow",t,e),this._processAllArrays(t,e),this.fldSorted&&this.setSortImgPos(this.fldSorted._cellIndex),this.callEvent("onAfterCMove",[t,i]))},dhtmlXGridObject.prototype._swapColumns=function(t){for(var e=new Array,i=0;i<this._cCount;i++){var s=t[this._c_order[i]];void 0===s&&(s=""),e[i]=s}return e},dhtmlXGridObject.prototype._moveColInRow=function(t,e,i){var s=t.childNodes[e],n=t.childNodes[i+1];if(s){n?t.insertBefore(s,n):t.appendChild(s);for(var l=0;l<t.childNodes.length;l++)t.childNodes[l]._cellIndex=t.childNodes[l]._cellIndexS=l}},dhtmlXGridObject.prototype._addColInRow=function(t,e,i,s){var n=e;if(t._childIndexes){if(t._childIndexes[e-1]!=t._childIndexes[e]&&t.childNodes[t._childIndexes[e-1]])for(l=t._childIndexes.length;l>=e;l--)t._childIndexes[l]=l?t._childIndexes[l-1]+1:0;else{for(var l=t._childIndexes.length;l>=e;l--)t._childIndexes[l]=l?t._childIndexes[l-1]+1:0;t._childIndexes[e]--}n=t._childIndexes[e]}var o=t.childNodes[n],r=document.createElement(s?"TD":"TH");s?r._attrs={}:r.style.width=(parseInt(this.cellWidthPX[e])||"100")+"px",o?t.insertBefore(r,o):t.appendChild(r),this.dragAndDropOff&&t.idd&&this.dragger.addDraggableItem(t.childNodes[n],this);for(l=n+1;l<t.childNodes.length;l++)t.childNodes[l]._cellIndex=t.childNodes[l]._cellIndexS=t.childNodes[l]._cellIndex+1;t.childNodes[n]&&(t.childNodes[n]._cellIndex=t.childNodes[n]._cellIndexS=e),t.idd||void 0!==t.idd?(this.cells3(t,e).setValue(""),r.align=this.cellAlign[e],r.style.verticalAlign=this.cellVAlign[e],r.bgColor=this.columnColor[e]):"TD"==r.tagName&&(!t.idd&&this.forceDivInHeader?r.innerHTML="<div class='hdrcell'>&nbsp;</div>":r.innerHTML="&nbsp;")},dhtmlXGridObject.prototype._deleteColInRow=function(t,e){var i=e;t._childIndexes&&(e=t._childIndexes[e]);var s=t.childNodes[e];if(s){if(s.colSpan&&s.colSpan>1&&s.parentNode.idd){var n=s.colSpan-1,l=this.cells4(s).getValue();if(this.setColspan(s.parentNode.idd,s._cellIndex,1),n>1){var o=1*s._cellIndex;this.setColspan(s.parentNode.idd,o+1,n),this.cells(s.parentNode.idd,1*s._cellIndex+1).setValue(l),t._childIndexes.splice(o,1);for(var r=o;r<t._childIndexes.length;r++)t._childIndexes[r]-=1}}else if(t._childIndexes){t._childIndexes.splice(i,1);for(r=i;r<t._childIndexes.length;r++)t._childIndexes[r]--}s&&t.removeChild(s);for(r=e;r<t.childNodes.length;r++)t.childNodes[r]._cellIndex=t.childNodes[r]._cellIndexS=t.childNodes[r]._cellIndex-1}},dhtmlXGridObject.prototype.enableColumnMove=function(t,e){this._mCol=dhx4.s2b(t),void 0!==e&&(this._mCols=e.split(",")),this._mmevTrue||(dhtmlxEvent(this.hdr,"mousedown",this._startColumnMove),dhtmlxEvent(document.body,"mousemove",this._onColumnMove),dhtmlxEvent(document.body,"mouseup",this._stopColumnMove),this._mmevTrue=!0)},dhtmlXGridObject.prototype._startColumnMove=function(t){for(var e=(t=t||event).target||t.srcElement,i=e;"TABLE"!=i.tagName;)i=i.parentNode;var s=i.grid;if(s&&(s.setActive(),s._mCol&&2!=t.button))return"default"!=(e=s.getFirstParentOfType(e,"TD")).style.cursor||(s&&!s._colInMove&&(s.resized=null,s._mCols&&"true"!=s._mCols[e._cellIndex]||(s._colInMove=e._cellIndex+1)),!0)},dhtmlXGridObject.prototype._onColumnMove=function(t){t=t||event;var e=window.globalActiveDHTMLGridObject;if(e&&e._colInMove){if(e._hideHContext&&e._hideHContext(),"object"!=typeof e._colInMove)(l=document.createElement("DIV"))._aIndex=e._colInMove-1,l._bIndex=null,l.innerHTML=e.getHeaderCol(l._aIndex),l.className="dhx_dragColDiv",l.style.position="absolute",document.body.appendChild(l),e._colInMove=l;var i=[];i[0]=document.body.scrollLeft||document.documentElement.scrollLeft,i[1]=document.body.scrollTop||document.documentElement.scrollTop,e._colInMove.style.left=t.clientX+i[0]+8+"px",e._colInMove.style.top=t.clientY+i[1]+8+"px";for(var s=t.target||t.srcElement;s&&void 0===s._cellIndexS;)s=s.parentNode;if(e._colInMove._oldHe&&(e._colInMove._oldHe.className=e._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,""),e._colInMove._oldHe=null,e._colInMove._bIndex=null),s){if(e.hdr.rows[1]._childIndexes)var n=e.hdr.rows[1].cells[e.hdr.rows[1]._childIndexes[s._cellIndexS]];else n=e.hdr.rows[1].cells[s._cellIndexS];var l;(l=t.clientX-(dhx4.absLeft(n)-e.hdrBox.scrollLeft))/n.offsetWidth>.5?(n.className+=" columnTargetR",e._colInMove._bIndex=s._cellIndexS):(n.className+=" columnTargetL",e._colInMove._bIndex=s._cellIndexS-1),n.offsetLeft<e.objBox.scrollLeft+20&&(e.objBox.scrollLeft=Math.max(0,n.offsetLeft-20)),n.offsetLeft+n.offsetWidth-e.objBox.scrollLeft>e.objBox.offsetWidth-20&&(e.objBox.scrollLeft=Math.min(e.objBox.scrollLeft+n.offsetWidth+20,e.objBox.scrollWidth-e.objBox.offsetWidth)),e._colInMove._oldHe=n}return t.cancelBubble=!0,!1}return!0},dhtmlXGridObject.prototype._stopColumnMove=function(t){t=t||event;var e=window.globalActiveDHTMLGridObject;return e&&e._colInMove&&("object"==typeof e._colInMove&&(e._colInMove.parentNode.removeChild(e._colInMove),null!=e._colInMove._bIndex&&e.moveColumn(e._colInMove._aIndex,e._colInMove._bIndex+1),e._colInMove._oldHe&&(e._colInMove._oldHe.className=e._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,"")),e._colInMove._oldHe=null,e._colInMove.grid=null,e.resized=!0),e._colInMove=0),!0},dhtmlXGridObject.prototype.mouseOverHeader=function(t){var e=this;dhtmlxEvent(this.hdr,"mousemove",function(i){var s=(i=i||window.event).target||i.srcElement;"TD"!=s.tagName&&(s=e.getFirstParentOfType(s,"TD")),s&&void 0!==s._cellIndex&&t(s.parentNode.rowIndex,s._cellIndex)})},dhtmlXGridObject.prototype.mouseOver=function(t){var e=this;dhtmlxEvent(this.obj,"mousemove",function(i){var s=(i=i||window.event).target||i.srcElement;"TD"!=s.tagName&&(s=e.getFirstParentOfType(s,"TD")),s&&void 0!==s._cellIndex&&t(s.parentNode.rowIndex,s._cellIndex)})},dhtmlXGridObject.prototype.enablePaging=function(t,e,i,s,n,l){this._pgn_parentObj="string"==typeof s?document.getElementById(s):s,this._pgn_recInfoParentObj="string"==typeof l?document.getElementById(l):l,this.pagingOn=t,this.showRecInfo=n,this.rowsBufferOutSize=parseInt(e),this.currentPage=1,this.pagesInGroup=parseInt(i),this._init_pgn_events(),this.setPagingSkin("default")},dhtmlXGridObject.prototype.setXMLAutoLoading=function(t,e){this.xmlFileUrl=t,this._dpref=e},dhtmlXGridObject.prototype.changePageRelative=function(t){this.changePage(this.currentPage+t)},dhtmlXGridObject.prototype.changePage=function(t){0==arguments.length&&(t=this.currentPage||0),t=parseInt(t),t=Math.max(1,Math.min(t,Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize))),this.callEvent("onBeforePageChanged",[this.currentPage,t])&&(this.currentPage=parseInt(t),this._reset_view(),this._fixAlterCss(),this.callEvent("onPageChanged",this.getStateOfView()))},dhtmlXGridObject.prototype.setPagingSkin=function(t){this._pgn_skin=this["_pgn_"+t],"toolbar"==t&&(this._pgn_skin_tlb=arguments[1])},dhtmlXGridObject.prototype.setPagingTemplates=function(t,e){this._pgn_templateA=this._pgn_template_compile(t),this._pgn_templateB=this._pgn_template_compile(e),this._page_skin_update()},dhtmlXGridObject.prototype._page_skin_update=function(t){this.pagesInGroup||(this.pagesInGroup=Math.ceil(Math.min(5,this.rowsBuffer.length/this.rowsBufferOutSize)));var e=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(e&&e<this.currentPage)return this.changePage(e);this.pagingOn&&this._pgn_skin&&this._pgn_skin.apply(this,this.getStateOfView())},dhtmlXGridObject.prototype._init_pgn_events=function(t){this.attachEvent("onXLE",this._page_skin_update),this.attachEvent("onClearAll",this._page_skin_update),this.attachEvent("onPageChanged",this._page_skin_update),this.attachEvent("onGridReconstructed",this._page_skin_update),this._init_pgn_events=function(){}},dhtmlXGridObject.prototype._pgn_default=function(t,e,i){if(!this.pagingBlock){if(this.pagingBlock=document.createElement("DIV"),this.pagingBlock.className="pagingBlock",this.recordInfoBlock=document.createElement("SPAN"),this.recordInfoBlock.className="recordsInfoBlock",!this._pgn_parentObj)return;this._pgn_parentObj.appendChild(this.pagingBlock),this._pgn_recInfoParentObj&&this.showRecInfo&&this._pgn_recInfoParentObj.appendChild(this.recordInfoBlock),this._pgn_templateA||(this._pgn_templateA=this._pgn_template_compile("[prevpages:&lt;:&nbsp;] [currentpages:,&nbsp;] [nextpages:&gt;:&nbsp;]"),this._pgn_templateB=this._pgn_template_compile("Results <b>[from]-[to]</b> of <b>[total]</b>"))}var s=this.getStateOfView();this.pagingBlock.innerHTML=this._pgn_templateA.apply(this,s),this.recordInfoBlock.innerHTML=this._pgn_templateB.apply(this,s),this._pgn_template_active(this.pagingBlock),this._pgn_template_active(this.recordInfoBlock),this.callEvent("onPaging",[])},dhtmlXGridObject.prototype._pgn_block=function(t){for(var e=Math.floor((this.currentPage-1)/this.pagesInGroup)*this.pagesInGroup,i=Math.min(Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize),e+this.pagesInGroup),s=[],n=e+1;n<=i;n++)n==this.currentPage?s.push("<a class='dhx_not_active'><b>"+n+"</b></a>"):s.push("<a onclick='this.grid.changePage("+n+"); return false;'>"+n+"</a>");return s.join(t)},dhtmlXGridObject.prototype._pgn_link=function(t,e,i){if("prevpages"==t||"prev"==t)return 1==this.currentPage?i:"<a onclick='this.grid.changePageRelative(-1*"+("prev"==t?"1":"this.grid.pagesInGroup")+"); return false;'>"+e+"</a>";if("nextpages"==t||"next"==t)return this.rowsBuffer.length/this.rowsBufferOutSize<=this.currentPage?i:this.rowsBuffer.length/(this.rowsBufferOutSize*("next"==t?"1":this.pagesInGroup))<=1?i:"<a onclick='this.grid.changePageRelative("+("next"==t?"1":"this.grid.pagesInGroup")+"); return false;'>"+e+"</a>";if("current"==t){var s=this.currentPage+(e?parseInt(e):0);return s<1||Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)<s?i:"<a "+(s==this.currentPage?"class='dhx_active_page_link' ":"")+"onclick='this.grid.changePage("+s+"); return false;'>"+s+"</a>"}return e},dhtmlXGridObject.prototype._pgn_template_active=function(t){var e=t.getElementsByTagName("A");if(e)for(var i=0;i<e.length;i++)e[i].grid=this},dhtmlXGridObject.prototype._pgn_template_compile=function(t){return t=t.replace(/\[([^\]]*)\]/g,function(t,e){switch((e=e.split(":"))[0]){case"from":return'"+(arguments[1]*1+(arguments[2]*1?1:0))+"';case"total":return'"+arguments[3]+"';case"to":return'"+arguments[2]+"';case"current":case"prev":case"next":case"prevpages":case"nextpages":return"\"+this._pgn_link('"+e[0]+"','"+e[1]+"','"+e[2]+"')+\"";case"currentpages":return"\"+this._pgn_block('"+e[1]+"')+\""}}),new Function('return "'+t+'";')},dhtmlXGridObject.prototype.i18n.paging={results:"Results",records:"Records from ",to:" to ",page:"Page ",perpage:"rows per page",first:"To first Page",previous:"Previous Page",found:"Found records",next:"Next Page",last:"To last Page",of:" of ",notfound:"No Records Found"},dhtmlXGridObject.prototype.setPagingWTMode=function(t,e,i,s){this._WTDef=[t,e,i,s]},dhtmlXGridObject.prototype._pgn_bricks=function(t,e,i){var s=(this.skin_name||"").split("_")[1],n="";"light"!=s&&"modern"!=s&&"skyblue"!=s||(n="_"+s),this.pagerElAr=new Array,this.pagerElAr.pagerCont=document.createElement("DIV"),this.pagerElAr.pagerBord=document.createElement("DIV"),this.pagerElAr.pagerLine=document.createElement("DIV"),this.pagerElAr.pagerBox=document.createElement("DIV"),this.pagerElAr.pagerInfo=document.createElement("DIV"),this.pagerElAr.pagerInfoBox=document.createElement("DIV");var l=this.globalBox||this.objBox;if(this.pagerElAr.pagerCont.style.width=l.clientWidth+"px",this.pagerElAr.pagerCont.style.overflow="hidden",this.pagerElAr.pagerCont.style.clear="both",this.pagerElAr.pagerBord.className="dhx_pbox"+n,this.pagerElAr.pagerLine.className="dhx_pline"+n,this.pagerElAr.pagerBox.style.clear="both",this.pagerElAr.pagerInfo.className="dhx_pager_info"+n,this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerBord),this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerLine),this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerInfo),this.pagerElAr.pagerLine.appendChild(this.pagerElAr.pagerBox),this.pagerElAr.pagerInfo.appendChild(this.pagerElAr.pagerInfoBox),this._pgn_parentObj.innerHTML="",this._pgn_parentObj.appendChild(this.pagerElAr.pagerCont),this.rowsBuffer.length>0){var o=20;if(t>this.pagesInGroup){var r=document.createElement("DIV"),a=document.createElement("DIV");r.className="dhx_page"+n,a.innerHTML="&larr;",r.appendChild(a),this.pagerElAr.pagerBox.appendChild(r);var h=this;r.pgnum=(Math.ceil(t/this.pagesInGroup)-1)*this.pagesInGroup,r.onclick=function(){h.changePage(this.pgnum)},o+=22}for(var d=1;d<=this.pagesInGroup;d++){r=document.createElement("DIV"),a=document.createElement("DIV");if(r.className="dhx_page"+n,pageNumber=(Math.ceil(t/this.pagesInGroup)-1)*this.pagesInGroup+d,pageNumber>Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize))break;if(a.innerHTML=pageNumber,r.appendChild(a),t==pageNumber)r.className+=" dhx_page_active"+n,a.className="dhx_page_active"+n;else{h=this;r.pgnum=pageNumber,r.onclick=function(){h.changePage(this.pgnum)}}o+=parseInt(22/3)*pageNumber.toString().length+15,a.style.width=parseInt(22/3)*pageNumber.toString().length+8+"px",this.pagerElAr.pagerBox.appendChild(r)}if(Math.ceil(t/this.pagesInGroup)*this.pagesInGroup<Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)){r=document.createElement("DIV"),a=document.createElement("DIV");r.className="dhx_page"+n,a.innerHTML="&rarr;",r.appendChild(a),this.pagerElAr.pagerBox.appendChild(r);h=this;r.pgnum=Math.ceil(t/this.pagesInGroup)*this.pagesInGroup+1,r.onclick=function(){h.changePage(this.pgnum)},o+=22}this.pagerElAr.pagerLine.style.width=o+"px"}this.rowsBuffer.length>0&&this.showRecInfo?this.pagerElAr.pagerInfoBox.innerHTML=this.i18n.paging.records+(e+1)+this.i18n.paging.to+i+this.i18n.paging.of+this.rowsBuffer.length:0==this.rowsBuffer.length&&(this.pagerElAr.pagerLine.parentNode.removeChild(this.pagerElAr.pagerLine),this.pagerElAr.pagerInfoBox.innerHTML=this.i18n.paging.notfound),this.pagerElAr.pagerBox.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;",this.pagerElAr.pagerBord.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;",this.pagerElAr.pagerCont.appendChild(document.createElement("SPAN")).innerHTML="&nbsp;",this.callEvent("onPaging",[])},dhtmlXGridObject.prototype._pgn_toolbar=function(t,e,i){this.aToolBar||(this.aToolBar=this._pgn_createToolBar());var s=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(this._WTDef[0]&&(this.aToolBar.enableItem("right"),this.aToolBar.enableItem("rightabs"),this.aToolBar.enableItem("left"),this.aToolBar.enableItem("leftabs"),this.currentPage>=s&&(this.aToolBar.disableItem("right"),this.aToolBar.disableItem("rightabs")),1==this.currentPage&&(this.aToolBar.disableItem("left"),this.aToolBar.disableItem("leftabs"))),this._WTDef[2]){var n=this;this.aToolBar.forEachListOption("pages",function(t){n.aToolBar.removeListOption("pages",t)});for(var l={dhx_skyblue:4,dhx_web:0,dhx_terrace:14}[this.aToolBar.conf.skin],o=0;o<s;o++)this.aToolBar.addListOption("pages","pages_"+(o+1),NaN,"button","<span style='padding: 0px "+l+"px 0px 0px;'>"+this.i18n.paging.page+(o+1)+"</span>","paging_page.gif");this.aToolBar.setItemText("pages",this.i18n.paging.page+t)}this._WTDef[1]&&(this.getRowsNum()?this.aToolBar.setItemText("results","<div style='width:100%; text-align:center'>"+this.i18n.paging.records+(e+1)+this.i18n.paging.to+i+"</div>"):this.aToolBar.setItemText("results",this.i18n.paging.notfound)),this._WTDef[3]&&this.aToolBar.setItemText("perpagenum",this.rowsBufferOutSize.toString()+" "+this.i18n.paging.perpage),this.callEvent("onPaging",[])},dhtmlXGridObject.prototype._pgn_createToolBar=function(){this.aToolBar=new dhtmlXToolbarObject({parent:this._pgn_parentObj,skin:this._pgn_skin_tlb||this.skin_name,icons_path:this.imgURL}),this._WTDef||this.setPagingWTMode(!0,!0,!0,!0);var t,e=this;if(this.aToolBar.attachEvent("onClick",function(t){switch((t=t.split("_"))[0]){case"leftabs":e.changePage(1);break;case"left":e.changePage(e.currentPage-1);break;case"rightabs":e.changePage(99999);break;case"right":e.changePage(e.currentPage+1);break;case"perpagenum":if(t[1]===this.undefined)return;e.rowsBufferOutSize=parseInt(t[1]),e.changePage(),e.aToolBar.setItemText("perpagenum",t[1]+" "+e.i18n.paging.perpage);break;case"pages":if(t[1]===this.undefined)return;e.changePage(t[1]),e.aToolBar.setItemText("pages",e.i18n.paging.page+t[1])}}),this._WTDef[0]&&(this.aToolBar.addButton("leftabs",NaN,null,"ar_left_abs.gif","ar_left_abs_dis.gif"),this.aToolBar.addButton("left",NaN,null,"ar_left.gif","ar_left_dis.gif")),this._WTDef[1]&&(this.aToolBar.addText("results",NaN,this.i18n.paging.results),this.aToolBar.setWidth("results","150"),this.aToolBar.disableItem("results")),this._WTDef[0]&&(this.aToolBar.addButton("right",NaN,null,"ar_right.gif","ar_right_dis.gif"),this.aToolBar.addButton("rightabs",NaN,null,"ar_right_abs.gif","ar_right_abs_dis.gif")),this._WTDef[2]&&("dhx_terrace"==this.aToolBar.conf.skin&&this.aToolBar.addSeparator(),this.aToolBar.addButtonSelect("pages",NaN,"select page",[],"paging_pages.gif",null,!1,!0)),t=this._WTDef[3]){"dhx_terrace"==this.aToolBar.conf.skin&&this.aToolBar.addSeparator(),this.aToolBar.addButtonSelect("perpagenum",NaN,"select size",[],"paging_rows.gif",null,!1,!0),"object"!=typeof t&&(t=[5,10,15,20,25,30]);for(var i={dhx_skyblue:4,dhx_web:0,dhx_terrace:18}[this.aToolBar.conf.skin],s=0;s<t.length;s++)this.aToolBar.addListOption("perpagenum","perpagenum_"+t[s],NaN,"button","<span style='padding: 0px "+i+"px 0px 0px;'>"+t[s]+" "+this.i18n.paging.perpage+"</span>","paging_page.gif")}return this.aToolBar},dhtmlXGridObject.prototype.post=function(t,e,i,s){this.callEvent("onXLS",[this]),2==arguments.length&&"function"!=typeof i&&(s=i,i=null),s=s||"xml",this.xmlFileUrl||(this.xmlFileUrl=t),this._data_type=s,this.xmlLoader=this.doLoadDetails;var n=this;this.xmlLoader=function(t){n.callEvent&&(n["_process_"+s](t.xmlDoc),n._contextCallTimer||n.callEvent("onXLE",[n,0,0,t.xmlDoc]),i&&(i(),i=null))},dhx4.ajax.post(t,e||"",this.xmlLoader)},dhtmlXGridObject.prototype.setRowspan=function(t,e,i){var s=this[this._bfs_cells?"_bfs_cells":"cells"](t,e).cell,n=this.rowsAr[t];if(s.rowSpan&&1!=s.rowSpan)for(var l=n.nextSibling,o=1;o<s.rowSpan;o++){var r=l.childNodes[l._childIndexes[s._cellIndex+1]],a=document.createElement("TD");a.innerHTML="&nbsp;",a._cellIndex=s._cellIndex,a._clearCell=!0,r?r.parentNode.insertBefore(a,r):l.parentNode.appendChild(a),this._shiftIndexes(l,s._cellIndex,-1),l=l.nextSibling}s.rowSpan=i,n=this._h2?this.rowsAr[this._h2.get[n.idd].parent.childs[this._h2.get[n.idd].index+1].id]:n.nextSibling||this.rowsCol[this.rowsCol._dhx_find(n)+1];var h=[];for(o=1;o<i;o++){var d=null;if(d=this._fake&&!this._realfake?this._bfs_cells3(n,e).cell:this.cells3(n,e).cell,this._shiftIndexes(n,s._cellIndex,1),d&&d.parentNode.removeChild(d),h.push(n),this._h2)(n=this._h2.get[n.idd].parent.childs[this._h2.get[n.idd].index+1])&&(n=this.rowsAr[n.id]);else n=n.nextSibling||this.rowsCol[this.rowsCol._dhx_find(n)+1]}this.rowsAr[t]._rowSpan=this.rowsAr[t]._rowSpan||{},this.rowsAr[t]._rowSpan[e]=h,this._fake&&!this._realfake&&e<this._fake._cCount&&this._fake.setRowspan(t,e,i)},dhtmlXGridObject.prototype._shiftIndexes=function(t,e,i){if(!t._childIndexes){t._childIndexes=new Array;for(var s=0;s<t.childNodes.length;s++)t._childIndexes[s]=s}for(s=0;s<t._childIndexes.length;s++)s>e&&(t._childIndexes[s]=t._childIndexes[s]-i)},dhtmlXGridObject.prototype.enableRowspan=function(){this._erspan=!0,this.enableRowspan=function(){},this.attachEvent("onAfterSorting",function(){if(!this._dload){for(var t=1;t<this.obj.rows.length;t++)if(this.obj.rows[t]._rowSpan){var e=this.obj.rows[t];for(var i in e._rowSpan)for(var s=e,n=s._rowSpan[i],l=0;l<n.length;l++){if(s.nextSibling?s.parentNode.insertBefore(n[l],s.nextSibling):s.parentNode.appendChild(n[l]),this._fake){var o=this._fake.rowsAr[s.idd],r=this._fake.rowsAr[n[l].idd];o.nextSibling?o.parentNode.insertBefore(r,o.nextSibling):o.parentNode.appendChild(r),this._correctRowHeight(s.idd)}s=s.nextSibling}}var a=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray,this.rowsCol.stablesort=a;for(t=1;t<this.obj.rows.length;t++)this.rowsCol.push(this.obj.rows[t])}}),this.attachEvent("onXLE",function(t,e,i,s){for(var n=0;n<this.rowsBuffer.length;n++)for(var l=this.render_row(n),o=l.childNodes,r=0;r<o.length;r++)o[r]._attrs.rowspan&&this.setRowspan(l.idd,o[r]._cellIndex,o[r]._attrs.rowspan)})},dhx4.attachEvent("onGridCreated",function(t){t._split_later&&t.splitAt(t._split_later)}),dhtmlXGridObject.prototype.splitAt=function(t){if(!this.obj.rows[0])return this._split_later=t;t=parseInt(t);var e=document.createElement("DIV");this.entBox.appendChild(e);var i=document.createElement("DIV");this.entBox.appendChild(i);for(var s=this.entBox.childNodes.length-3;s>=0;s--)i.insertBefore(this.entBox.childNodes[s],i.firstChild);if(this.entBox.style.position="relative",this.globalBox=this.entBox,this.entBox=i,i.grid=this,e.style.cssText+="border:0px solid red !important;",i.style.cssText+="border:0px solid red !important;",i.style.top="0px",i.style.position="absolute",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=11,i.style.height=e.style.height=this.globalBox.clientHeight,this._fake=new dhtmlXGridObject(e),this.globalBox=this._fake.globalBox=this.globalBox,this._fake._fake=this,this._fake._realfake=!0,this._treeC=this.cellType._dhx_find("tree"),this._fake.delim=this.delim,this._fake.customGroupFormat=this.customGroupFormat,this._fake.setImagesPath(this._imgURL),this._fake.iconURL=this.iconURL,this._fake._customSorts=this._customSorts,this._fake.noHeader=this.noHeader,this._fake._enbTts=this._enbTts,this._fake._drsclmW=this._drsclmW,this._fake._htkebl=this._htkebl,this._fake.clists=this.clists,this._fake.fldSort=new Array,this._fake.selMultiRows=this.selMultiRows,this._fake.multiLine=this.multiLine,this._fake.smartTabOrder=this.smartTabOrder,this.multiLine||this._erspan){this.attachEvent("onCellChanged",this._correctRowHeight),this.attachEvent("onRowAdded",this._correctRowHeight);var n=function(){this.forEachRow(function(t){this._correctRowHeight(t)})};this.attachEvent("onPageChanged",n),this.attachEvent("onXLE",n),this.attachEvent("onResizeEnd",n),this._ads_count||this.attachEvent("onAfterSorting",n),this._srnd&&this.attachEvent("onFilterEnd",n),this.attachEvent("onDistributedEnd",n)}this.attachEvent("onGridReconstructed",function(){this._fake.objBox.scrollTop=this.objBox.scrollTop}),this._fake.loadedKidsHash=this.loadedKidsHash,this._h2&&(this._fake._h2=this._h2),this._fake._dInc=this._dInc;var l=[[],[],[],[],[],[],[]],o=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor"],r=["setHeader","setInitWidths","setColTypes","setColAlign","setColVAlign","setColSorting","setColumnColor"];this._fake.callEvent=function(){var t=!0;this._fake._split_event=!0;var e="onScroll"==arguments[0];return("onGridReconstructed"==arguments[0]||e)&&this._fake.callEvent.apply(this,arguments),e||(t=this._fake.callEvent.apply(this._fake,arguments)),this._fake._split_event=!1,t},this._elmn&&this._fake.enableLightMouseNavigation(!0),(this.__cssEven||this._cssUnEven)&&this._fake.attachEvent("onGridReconstructed",function(){this._fixAlterCss()}),this._fake._cssEven=this._cssEven,this._fake._cssUnEven=this._cssUnEven,this._fake._cssSP=this._cssSP,this._fake.isEditable=this.isEditable,this._fake._edtc=this._edtc,this._sst&&this._fake.enableStableSorting(!0),this._fake._sclE=this._sclE,this._fake._dclE=this._dclE,this._fake._f2kE=this._f2kE,this._fake._maskArr=this._maskArr,this._fake._dtmask=this._dtmask,this._fake.combos=this.combos;var a=0,h=this.globalBox.offsetWidth;for(s=0;s<t;s++){for(var d=0;d<o.length;d++)this[o[d]]&&(l[d][s]=this[o[d]][s]),"string"==typeof l[d][s]&&(l[d][s]=l[d][s].replace(new RegExp("\\"+this.delim,"g"),"\\"+this.delim));_isFF&&(l[1][s]=1*l[1][s]),"%"==this.cellWidthType?(l[1][s]=Math.round(parseInt(this[o[1]][s])*h/100),a+=l[1][s]):a+=parseInt(this[o[1]][s]),this.setColumnHidden(s,!0)}for(d=0;d<o.length;d++){var c=l[d].join(this.delim);"setHeader"!=r[d]?""!=c&&this._fake[r[d]](c):this._fake[r[d]](c,null,this._hstyles)}this._fake._strangeParams=this._strangeParams,this._fake._drsclmn=this._drsclmn,a=Math.min(this.globalBox.offsetWidth,a),i.style.left=a+"px",e.style.width=a+"px",i.style.width=Math.max(this.globalBox.offsetWidth-a,0),this._ecspn&&(this._fake._ecspn=!0),this._fake.init(),this.dragAndDropOff&&this.dragger.addDragLanding(this._fake.entBox,this),this._fake.objBox.style.overflow="hidden",dhtmlx.$customScroll?this._fake.objBox._custom_scroll_mode="":this._fake.objBox.style.overflowX="scroll",this._fake._srdh=this._srdh||20,this._fake._srnd=this._srnd;var _=this;function u(t){var e=t.wheelDelta/-40;t.wheelDelta===window.undefined&&(e=t.detail),_.objBox.scrollTop+=40*e,t.preventDefault&&t.preventDefault()}function f(t,e){e.style.whiteSpace="";var i=e.nextSibling,s=e.parentNode;t.parentNode.insertBefore(e,t),i?s.insertBefore(t,i):s.appendChild(t);var n=t.style.display;t.style.display=e.style.display,e.style.display=n}function p(e,i,s,n){var l=new Array(t).join(this.delim),o=[];if(2==e)for(var r=0;r<t;r++){var a=i[e-1].cells[i[e-1]._childIndexes?i[e-1]._childIndexes[r]:r];a.rowSpan&&a.rowSpan>1&&(o[a._cellIndex]=a.rowSpan-1,n[e-1].cells[n[e-1]._childIndexes?n[e-1]._childIndexes[r]:r].rowSpan=a.rowSpan,a.rowSpan=1)}for(;e<i.length;e++){this._fake.attachHeader(l,null,s),n=n||this._fake.ftr.childNodes[0].rows;for(var h=t,d=0,c=0;c<h;c++)if(o[c]){if(o[c]=o[c]-1,_isIE||_isOpera){var _=document.createElement("TD");_isFF&&(_.style.display="none"),i[e].insertBefore(_,i[e].cells[0])}d++}else{var u=n[e].cells[c-d],p=i[e].cells[c-(_isIE?0:d)],m=p.rowSpan;if(c+=p.colSpan-1||0,f(u,p),m>1&&(o[c]=m-1,p.rowSpan=m),n[e].cells[c].colSpan>1){i[e].cells[c].colSpan=n[e].cells[c].colSpan,h-=n[e].cells[c].colSpan-1;for(r=1;r<n[e].cells[c].colSpan;r++)n[e].removeChild(n[e].cells[c+1])}}}}dhtmlxEvent(this._fake.objBox,"mousewheel",u),dhtmlxEvent(this._fake.objBox,"DOMMouseScroll",u),this.hdr.rows.length>2&&p.call(this,2,this.hdr.rows,"_aHead",this._fake.hdr.rows),this.ftr&&(p.call(this,1,this.ftr.childNodes[0].rows,"_aFoot"),this._fake.ftr.parentNode.style.bottom=(_isFF?2:1)+"px"),this.saveSizeToCookie&&(this.saveSizeToCookie=function(e,i){if(this._realfake)return this._fake.saveSizeToCookie.apply(this._fake,arguments);e||(e=this.entBox.id);for(var s=new Array,n="cellWidthPX",l=0;l<this[n].length;l++)s[l]=l<t?this._fake[n][l]:this[n][l];s=s.join(","),this.setCookie(e,i,0,s);s=(this.initCellWidth||new Array).join(",");return this.setCookie(e,i,1,s),!0},this.loadSizeFromCookie=function(e){if(e||(e=this.entBox.id),i=this._getCookie(e,1)){this.initCellWidth=i.split(",");var i=this._getCookie(e,0),s="cellWidthPX";this.cellWidthType="px";var n=0;if(i&&i.length){i=i.split(",");for(var l=0;l<i.length;l++)l<t?(this._fake[s][l]=i[l],n+=1*i[l]):this[s][l]=i[l]}this._fake.entBox.style.width=n+"px",this._fake.objBox.style.width=n+"px";var o=this.globalBox.childNodes[1];return o.style.left=n-(_isFF,0)+"px",this.ftr&&(this.ftr.style.left=n-(_isFF,0)+"px"),o.style.width=this.globalBox.offsetWidth-n+"px",this.setSizes(),!0}},this._fake.onRSE=this.onRSE),this.setCellTextStyleA=this.setCellTextStyle,this.setCellTextStyle=function(e,i,s){i<t&&this._fake.setCellTextStyle(e,i,s),this.setCellTextStyleA(e,i,s)},this.setRowTextBoldA=this.setRowTextBold,this.setRowTextBold=function(t){this.setRowTextBoldA(t),this._fake.setRowTextBold(t)},this.setRowColorA=this.setRowColor,this.setRowColor=function(t,e){this.setRowColorA(t,e),this._fake.setRowColor(t,e)},this.setRowHiddenA=this.setRowHidden,this.setRowHidden=function(t,e){this.setRowHiddenA(t,e),this._fake.setRowHidden(t,e)},this.setRowTextNormalA=this.setRowTextNormal,this.setRowTextNormal=function(t){this.setRowTextNormalA(t),this._fake.setRowTextNormal(t)},this.getChangedRows=function(t){var e=new Array;function i(t){for(var i=0;i<t.childNodes.length;i++)if(t.childNodes[i].wasChanged)return e[e.length]=t.idd}return this.forEachRow(function(s){var n=this.rowsAr[s],l=this._fake.rowsAr[s];"TR"==n.tagName&&l&&"TR"==l.tagName&&(t&&n._added?e[e.length]=n.idd:i(n)||i(l))}),e.join(this.delim)},this.setRowTextStyleA=this.setRowTextStyle,this.setRowTextStyle=function(t,e){this.setRowTextStyleA(t,e),this._fake.rowsAr[t]&&this._fake.setRowTextStyle(t,e)},this.lockRowA=this.lockRow,this.lockRow=function(t,e){this.lockRowA(t,e),this._fake.lockRow(t,e)},this.getColWidth=function(e){return e<t?parseInt(this._fake.cellWidthPX[e]):parseInt(this.cellWidthPX[e])},this.getColumnLabel=function(e){return this._fake.getColumnLabel.apply(e<t?this._fake:this,arguments)},this.setColWidthA=this._fake.setColWidthA=this.setColWidth,this.setColWidth=function(e,i){(e*=1)<t?this._fake.setColWidthA(e,i):this.setColWidthA(e,i),e+1<=t&&this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth,this._fake.obj.offsetWidth))},this.adjustColumnSizeA=this.adjustColumnSize,this.setColumnLabelA=this.setColumnLabel,this.setColumnLabel=function(e,i,s,n){var l=this;return e<t&&(l=this._fake),this.setColumnLabelA.apply(l,[e,i,s,n])},this.adjustColumnSize=function(e,i){if(!(e<t))return this.adjustColumnSizeA(e,i);_isIE&&(this._fake.obj.style.tableLayout=""),this._fake.adjustColumnSize(e,i),_isIE&&(this._fake.obj.style.tableLayout="fixed"),this._fake._correctSplit()};var m="cells";this._bfs_cells=this[m],this[m]=function(){return arguments[1]<t?this._fake.cells.apply(this._fake,arguments):this._bfs_cells.apply(this,arguments)},this._bfs_isColumnHidden=this.isColumnHidden,this.isColumnHidden=function(){return parseInt(arguments[0])<t?this._fake.isColumnHidden.apply(this._fake,arguments):this._bfs_isColumnHidden.apply(this,arguments)},this._bfs_setColumnHidden=this.setColumnHidden,this.setColumnHidden=function(){return parseInt(arguments[0])<t?(this._fake.setColumnHidden.apply(this._fake,arguments),this._fake._correctSplit()):this._bfs_setColumnHidden.apply(this,arguments)};m="cells2";this._bfs_cells2=this[m],this[m]=function(){return arguments[1]<t?this._fake.cells2.apply(this._fake,arguments):this._bfs_cells2.apply(this,arguments)};m="cells3";this._bfs_cells3=this[m],this[m]=function(e,i){return arguments[1]<t&&this._fake.rowsAr[arguments[0].idd]?this._fake.rowsAr[e.idd]&&0==this._fake.rowsAr[e.idd].childNodes.length?this._bfs_cells3.apply(this,arguments):(arguments[0]=arguments[0].idd,this._fake.cells.apply(this._fake,arguments)):this._bfs_cells3.apply(this,arguments)};m="changeRowId";this._bfs_changeRowId=this[m],this[m]=function(){this._bfs_changeRowId.apply(this,arguments),this._fake.rowsAr[arguments[0]]&&this._fake.changeRowId.apply(this._fake,arguments)},this._fake.getRowById=function(t){var e=this.rowsAr[t];if(!e&&this._fake.rowsAr[t]&&(e=this._fake.getRowById(t)),e){if("TR"!=e.tagName){for(var i=0;i<this.rowsBuffer.length;i++)if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==t)return this.render_row(i);if(this._h2)return this.render_row(null,e.idd)}return e}return null},this.collapseKids&&(this._fake._bfs_collapseKids=this.collapseKids,this._fake.collapseKids=function(){return this._fake.collapseKids.apply(this._fake,[this._fake.rowsAr[arguments[0].idd]])},this._bfs_collapseKids=this.collapseKids,this.collapseKids=function(){this._bfs_collapseKids.apply(this,arguments);this._fake._h2syncModel(),this._cssSP||this._fake._fixAlterCss()},this._fake._bfs_expandKids=this.expandKids,this._fake.expandKids=function(){this._fake.expandKids.apply(this._fake,[this._fake.rowsAr[arguments[0].idd]]),this._cssSP||this._fake._fixAlterCss()},this._bfs_expandAll=this.expandAll,this.expandAll=function(){this._bfs_expandAll(),this._fake._h2syncModel(),this._cssSP||this._fake._fixAlterCss()},this._bfs_collapseAll=this.collapseAll,this.collapseAll=function(){this._bfs_collapseAll(),this._fake._h2syncModel(),this._cssSP||this._fake._fixAlterCss()},this._bfs_expandKids=this.expandKids,this.expandKids=function(){this._bfs_expandKids.apply(this,arguments);this._fake._h2syncModel(),this._cssSP||this._fake._fixAlterCss()},this._fake._h2syncModel=function(){this._fake.pagingOn?this._fake._renderSort():this._renderSort()},this._updateTGRState=function(t){return this._fake._updateTGRState(t)}),this._elmnh&&(this._setRowHoverA=this._fake._setRowHoverA=this._setRowHover,this._unsetRowHoverA=this._fake._unsetRowHoverA=this._unsetRowHover,this._setRowHover=this._fake._setRowHover=function(){var t=this.grid;t._setRowHoverA.apply(this,arguments);var e=_isIE?event.srcElement:arguments[0].target;(e=t._fake.rowsAr[t.getFirstParentOfType(e,"TD").parentNode.idd])&&t._fake._setRowHoverA.apply(t._fake.obj,[{target:e.childNodes[0]},arguments[1]])},this._unsetRowHover=this._fake._unsetRowHover=function(){if(arguments[1])var t=this;else t=this.grid;t._unsetRowHoverA.apply(this,arguments),t._fake._unsetRowHoverA.apply(t._fake.obj,arguments)},this._fake.enableRowsHover(!0,this._hvrCss),this.enableRowsHover(!1),this.enableRowsHover(!0,this._fake._hvrCss)),this._updateTGRState=function(t){t.update&&0!=t.id&&(this.rowsAr[t.id].imgTag&&(this.rowsAr[t.id].imgTag.src=this.iconTree+t.state+".gif"),this._fake.rowsAr[t.id]&&this._fake.rowsAr[t.id].imgTag&&(this._fake.rowsAr[t.id].imgTag.src=this.iconTree+t.state+".gif"),t.update=!1)},this.copy_row=function(e){var i=e.cloneNode(!0);i._skipInsert=e._skipInsert;var s=t;if(i._attrs={},i._css=e._css,this._ecspn){s=0;for(var n=0;s<i.childNodes.length&&n<t;n+=i.childNodes[s].colSpan||1)s++}for(;i.childNodes.length>s;)i.removeChild(i.childNodes[i.childNodes.length-1]);var l=s;for(n=0;n<l;n++)this.dragAndDropOff&&this.dragger.addDraggableItem(i.childNodes[n],this),i.childNodes[n].style.display=this._fake._hrrar&&this._fake._hrrar[n]?"none":"",i.childNodes[n]._cellIndex=n,i.childNodes[n].combo_value=arguments[0].childNodes[n].combo_value,i.childNodes[n]._clearCell=arguments[0].childNodes[n]._clearCell,i.childNodes[n]._cellType=arguments[0].childNodes[n]._cellType,i.childNodes[n]._brval=arguments[0].childNodes[n]._brval,i.childNodes[n].val=arguments[0].childNodes[n].val,i.childNodes[n]._combo=arguments[0].childNodes[n]._combo,i.childNodes[n]._attrs=arguments[0].childNodes[n]._attrs,i.childNodes[n].chstate=arguments[0].childNodes[n].chstate,e._attrs.style&&(i.childNodes[n].style.cssText+=";"+e._attrs.style),i.childNodes[n].colSpan>1&&(this._childIndexes=this._fake._childIndexes);if(this._h2&&this._treeC<t){var o=this._h2.get[arguments[0].idd];i.imgTag=i.childNodes[this._treeC].childNodes[0].childNodes[o.level],i.valTag=i.childNodes[this._treeC].childNodes[0].childNodes[o.level+2]}return i.idd=e.idd,i.grid=this._fake,i};m="_insertRowAt";this._bfs_insertRowAt=this[m],this[m]=function(){var t=this._bfs_insertRowAt.apply(this,arguments);arguments[0]=this.copy_row(arguments[0]);var e=this._fake._insertRowAt.apply(this._fake,arguments);return t._fhd&&(e.parentNode.removeChild(e),this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(e)),t._fhd=!1),t},this._bfs_setSizes=this.setSizes,this.setSizes=function(){if(!this._notresize){this._bfs_setSizes(this,arguments),this.sync_headers(),this.sync_scroll()&&this._ahgr&&this.setSizes();var t=this.dontSetSizes?this.entBox.offsetHeight+"px":this.entBox.style.height;this._fake.entBox.style.height=t,this._fake.objBox.style.height=this.objBox.style.height,this._fake.hdrBox.style.height=this.hdrBox.style.height,this._fake.objBox.scrollTop=this.objBox.scrollTop,this._fake.setColumnSizes(this._fake.entBox.clientWidth),this.globalBox.style.width=parseInt(this.entBox.style.width)+parseInt(this._fake.entBox.style.width),this.dontSetSizes||(this.globalBox.style.height=t)}},this.sync_scroll=this._fake.sync_scroll=function(t){var e=this.objBox.style.overflowX;if(this.obj.offsetWidth<=this.objBox.offsetWidth){if(!t)return this._fake.sync_scroll(!0);this.objBox.style.overflowX="hidden",this._fake.objBox.style.overflowX="hidden"}else dhtmlx.$customScroll||(this.objBox.style.overflowX="scroll",this._fake.objBox.style.overflowX="scroll");return e!=this.objBox.style.overflowX},this.sync_headers=this._fake.sync_headers=function(){if(!this.noHeader&&this._fake.hdr.scrollHeight!=this.hdr.offsetHeight){for(var e=1;e<this.hdr.rows.length;e++){for(var i=t;!this.hdr.rows[e].childNodes[i];)i--;var s=Math.min(this.hdr.rows[e].childNodes[i].scrollHeight+2,this.hdr.rows[e].scrollHeight),n=this._fake.hdr.rows[e].scrollHeight;if(s!=n&&(this._fake.hdr.rows[e].style.height=this.hdr.rows[e].style.height=Math.max(s,n)+"px"),window._KHTMLrv){for(var l=0;this._fake._hrrar[l];)l++;this._fake.hdr.rows[e].childNodes[l].style.height=this.hdr.rows[e].childNodes[i].style.height=Math.max(s,n)+"px"}}this._fake.sync_headers}},this._fake._bfs_setSizes=this._fake.setSizes,this._fake.setSizes=function(){this._fake._notresize||this._fake.setSizes()};m="_doOnScroll";this._bfs__doOnScroll=this[m],this[m]=function(){this._bfs__doOnScroll.apply(this,arguments),this._fake.objBox.scrollTop=this.objBox.scrollTop=this.objBox.scrollTop+.1,this._fake._doOnScroll.apply(this._fake,arguments)};m="selectAll";this._bfs__selectAll=this[m],this[m]=function(){this._bfs__selectAll.apply(this,arguments),this._bfs__selectAll.apply(this._fake,arguments)};m="doClick";function g(t,e,i,s){for(var n=s.shiftKey?-1:1,l=s.shiftKey?-1:i._cCount,o=!1,r=t+n;r!=l;r+=n)if(!1!==(o=i.smartTabOrder?!i.cells2(e,r).isDisabled()&&r:r))return i.selectCell(e,o,!1,!1,!0,!0),s.cancelBubble=!0,s.preventDefault&&s.preventDefault(),!0}this._bfs_doClick=this[m],this[m]=function(){if(this._bfs_doClick.apply(this,arguments),"TD"==arguments[0].tagName){var e=arguments[0]._cellIndex>=t;if(!arguments[0].parentNode.idd)return;e||(arguments[0].className=arguments[0].className.replace(/cellselected/g,"")),this._fake.rowsAr[arguments[0].parentNode.idd]||this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd)),arguments[0]=this._fake.cells(arguments[0].parentNode.idd,e?0:arguments[0]._cellIndex).cell,e&&(this._fake.cell=null),this._fake._bfs_doClick.apply(this._fake,arguments),e?this._fake.cell=this.cell:this.cell=this._fake.cell,this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime),e?(arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell):this.objBox.scrollTop=this._fake.objBox.scrollTop}},this._fake._bfs_doClick=this._fake[m],this._fake[m]=function(){if(this._bfs_doClick.apply(this,arguments),"TD"==arguments[0].tagName){var e=arguments[0]._cellIndex<t;if(!arguments[0].parentNode.idd)return;arguments[0]=this._fake._bfs_cells(arguments[0].parentNode.idd,e?t:arguments[0]._cellIndex).cell,this._fake.cell=null,this._fake._bfs_doClick.apply(this._fake,arguments),this._fake.cell=this.cell,this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime),e&&(arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell,this._fake.objBox.scrollTop=this.objBox.scrollTop)}},this.clearSelectionA=this.clearSelection,this.clearSelection=function(t){t&&this._fake.clearSelection(),this.clearSelectionA()},this.moveRowUpA=this.moveRowUp,this.moveRowUp=function(t){this._h2||this._fake.moveRowUp(t),this.moveRowUpA(t),this._h2&&this._fake._h2syncModel()},this.moveRowDownA=this.moveRowDown,this.moveRowDown=function(t){this._h2||this._fake.moveRowDown(t),this.moveRowDownA(t),this._h2&&this._fake._h2syncModel()},this._fake.getUserData=function(){return this._fake.getUserData.apply(this._fake,arguments)},this._fake.setUserData=function(){return this._fake.setUserData.apply(this._fake,arguments)},this.getSortingStateA=this.getSortingState,this.getSortingState=function(){var t=this.getSortingStateA();return 0!=t.length?t:this._fake.getSortingState()},this.setSortImgStateA=this._fake.setSortImgStateA=this.setSortImgState,this.setSortImgState=function(e,i,s,n){this.setSortImgStateA(e,i,s,n),1*i<t?(this._fake.setSortImgStateA(e,i,s,n),this.setSortImgStateA(!1)):this._fake.setSortImgStateA(!1)},this._fake.doColResizeA=this._fake.doColResize,this._fake.doColResize=function(e,i,s,n,l){var o=-1,r=0;return arguments[1]._cellIndex==t-1?(o=this._initalSplR+(e.clientX-n),this._initalSplF||(this._initalSplF=arguments[3]+this.objBox.scrollWidth-this.objBox.offsetWidth),this.objBox.scrollWidth==this.objBox.offsetWidth&&(this._fake.alter_split_resize||e.clientX-n>0)?(arguments[3]=this._initalSplF||arguments[3],r=this.doColResizeA.apply(this,arguments)):r=this.doColResizeA.apply(this,arguments)):(this.obj.offsetWidth<this.entBox.offsetWidth&&(o=this.obj.offsetWidth),r=this.doColResizeA.apply(this,arguments)),!1!==r&&(this._correctSplit(o),this.resized=this._fake.resized=1),r},this._fake.changeCursorState=function(t){var e=t.target||t.srcElement;if("TD"!=e.tagName&&(e=this.getFirstParentOfType(e,"TD")),"TD"!=e.tagName||!this._drsclmn||this._drsclmn[e._cellIndex]){var i=(t.layerX||0)+(_isIE||"DIV"!=t.target.tagName?0:e.offsetLeft),s=parseInt(this.getPosition(e,this.hdrBox));e.offsetWidth-(t.offsetX||-1*(s-i))<(_isOpera?20:10)||this.entBox.offsetWidth-(t.offsetX?t.offsetX+e.offsetLeft:i)+this.objBox.scrollLeft-0<(_isOpera?20:10)?e.style.cursor="E-resize":e.style.cursor="default",_isOpera&&(this.hdrBox.scrollLeft=this.objBox.scrollLeft)}},this._fake.startColResizeA=this._fake.startColResize,this._fake.startColResize=function(t){var e=this.startColResizeA(t);if(this._initalSplR=this.entBox.offsetWidth,this._initalSplF=null,this.entBox.onmousemove){var i=this.entBox.parentNode;if(i._aggrid)return e;i._aggrid=i.grid,i.grid=this,this.entBox.parentNode.onmousemove=this.entBox.onmousemove,this.entBox.onmousemove=null}return e},this._fake.stopColResizeA=this._fake.stopColResize,this._fake.stopColResize=function(t){if(this.entBox.parentNode.onmousemove){var e=this.entBox.parentNode;e.grid=e._aggrid,e._aggrid=null,this.entBox.onmousemove=this.entBox.parentNode.onmousemove,this.entBox.parentNode.onmousemove=null,this.obj.offsetWidth<this.entBox.offsetWidth&&this._correctSplit(this.obj.offsetWidth)}return this.stopColResizeA(t)},this.doKeyA=this.doKey,this._fake.doKeyA=this._fake.doKey,this._fake.doKey=this.doKey=function(t){if(!t)return!0;if(this._htkebl)return!0;if((t.target||t.srcElement).value!==window.undefined){var e=t.target||t.srcElement;if(!e.parentNode||-1==e.parentNode.className.indexOf("editable"))return!0}switch(t.keyCode){case 9:var i=this._realfake?this._fake:this;if(!i.callEvent("onTab",[!0]))return!0;if(this.cell){for(var s=this.cell._cellIndex,n=i.getRowIndex(this.cell.parentNode.idd);!g(s,n,i,t);){if((n+=t.shiftKey?-1:1)<0||n>=i.rowsBuffer.length)return;s=t.shiftKey?i._cCount:-1}return}}return this.doKeyA(t)},this.editCellA=this.editCell,this.editCell=function(){return this.cell&&this.cell.parentNode.grid!=this?this._fake.editCell():this.editCellA()},this.deleteRowA=this.deleteRow,this.deleteRow=function(t,e){if(!1===this.deleteRowA(t,e))return!1;this._fake.rowsAr[t]&&this._fake.deleteRow(t)},this.clearAllA=this.clearAll,this.clearAll=function(){this.clearAllA(),this._fake.clearAll()},this.editStopA=this.editStop,this.editStop=function(t){this._fake.editor?this._fake.editStop(t):this.editStopA(t)},this.attachEvent("onAfterSorting",function(e,i,s){e>=t&&this._fake.setSortImgState(!1)}),this._fake.sortField=function(t,e,i){if(this._fake.sortField.call(this._fake,t,e,this._fake.hdr.rows[0].cells[t]),"na"!=this.fldSort[t]&&this._fake.fldSorted){var s=this._fake.getSortingState()[1];this._fake.setSortImgState(!1),this.setSortImgState(!0,arguments[0],s)}},this.sortTreeRowsA=this.sortTreeRows,this._fake.sortTreeRowsA=this._fake.sortTreeRows,this.sortTreeRows=this._fake.sortTreeRows=function(t,e,i,s){if(this._realfake)return this._fake.sortTreeRows(t,e,i,s);this.sortTreeRowsA(t,e,i,s),this._fake._h2syncModel(),this._fake.setSortImgStateA(!1),this._fake.fldSorted=null},this._fake._fillers=[],this._fake.rowsBuffer=this.rowsBuffer,this.attachEvent("onClearAll",function(){this._fake.rowsBuffer=this.rowsBuffer}),this._add_filler_s=this._add_filler,this._add_filler=function(t,e,i,s){var n;(this._fake._fillers||(this._fake._fillers=[]),this._realfake||!s)&&(i&&i.idd?n=this._fake.rowsAr[i.idd]:i&&i.nextSibling?((n={}).nextSibling=this._fake.rowsAr[i.nextSibling.idd],n.parentNode=n.nextSibling.parentNode):this._fake._fillers.length&&(n=this._fake._fillers[this._fake._fillers.length-1][2]),this._fake._fillers.push(this._fake._add_filler(t,e,n)));return this._add_filler_s.apply(this,arguments)},this._add_from_buffer_s=this._add_from_buffer,this._add_from_buffer=function(){var t=this._add_from_buffer_s.apply(this,arguments);return-1!=t&&(this._fake._add_from_buffer.apply(this._fake,arguments),this.multiLine&&this._correctRowHeight(this.rowsBuffer[arguments[0]].idd)),t},this._fake.render_row=function(t){var e=this._fake.render_row(t);return-1==e?-1:e?this.rowsAr[e.idd]=this.rowsAr[e.idd]||this._fake.copy_row(e):null},this._reset_view_s=this._reset_view,this._reset_view=function(){this._fake._reset_view(!0),this._fake._fillers=[],this._reset_view_s()},this.moveColumn_s=this.moveColumn,this.moveColumn=function(e,i){if(i>=t)return this.moveColumn_s(e,i)},this.attachEvent("onCellChanged",function(e,i,s){if(this._split_event&&i<t&&this.rowsAr[e]){var n=this._fake.rowsAr[e];if(!n)return;n=n._childIndexes?n.childNodes[n._childIndexes[i]]:n.childNodes[i];var l=this.rowsAr[e].childNodes[i];l._treeCell&&l.firstChild.lastChild?l.firstChild.lastChild.innerHTML=s:l.innerHTML=n.innerHTML,l._clearCell=!1,l.combo_value=n.combo_value,l.chstate=n.chstate}}),this._fake.combos=this.combos,this.setSizes(),this.rowsBuffer[0]&&this._reset_view(),this.attachEvent("onXLE",function(){this._fake._correctSplit()}),this._fake._correctSplit()},dhtmlXGridObject.prototype._correctSplit=function(t){if(t=t||this.obj.scrollWidth-this.objBox.scrollLeft,(t=Math.min(this.globalBox.offsetWidth,t))>-1){this.entBox.style.width=t+"px",this.objBox.style.width=t+"px";var e=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._fake.entBox.style.left=t+"px",this._fake.entBox.style.width=Math.max(0,this.globalBox.offsetWidth-t-(this.quirks?0:2)*e)+"px",this._fake.ftr&&(this._fake.ftr.parentNode.style.width=this._fake.entBox.style.width),_isIE){var i=_isIE&&!window.xmlHttpRequest;e=this.globalBox.offsetWidth-this.globalBox.clientWidth;this._fake.hdrBox.style.width=this._fake.objBox.style.width=Math.max(0,this.globalBox.offsetWidth-(i?e:0)-t)+"px"}}},dhtmlXGridObject.prototype._correctRowHeight=function(t,e){if(this.rowsAr[t]&&this._fake.rowsAr[t]){var i=this.rowsAr[t].offsetHeight,s=this._fake.rowsAr[t].offsetHeight,n=Math.max(i,s)-(this.rowsAr[t].delta_fix||0);if(n&&(this.rowsAr[t].style.height=this._fake.rowsAr[t].style.height=Math.round(n+1)+"px",this.rowsAr[t].delta_fix=1,window._KHTMLrv)){for(var l,o=this._fake._cCount;!l&&o>=0;)l=this.rowsAr[t].childNodes[o],o-=1;var r=this._fake.rowsAr[t].firstChild;l&&r&&(l.style.height=r.style.height=n+"px",l.style.boxSizing=r.style.boxSizing="border-box")}}},dhtmlXGridObject.prototype.enableAutoSizeSaving=function(t,e){this.attachEvent("onResizeEnd",function(){this.saveSizeToCookie(t,e)})},dhtmlXGridObject.prototype.saveOpenStates=function(t,e){t||(t=this.entBox.id);var i=[];this._h2.forEachChild(0,function(t){"minus"==t.state&&i.push(t.id)});var s="gridOpen"+(t||"")+"="+i.join("|")+(e?"; "+e:"");document.cookie=s},dhtmlXGridObject.prototype.loadOpenStates=function(t,e){var i=this.getCookie(t,"gridOpen");if(i){i=i.split("|");for(var s=0;s<i.length;s++){var n=this.getParentId(i[s]);this.getOpenState(n)&&this.openItem(i[s])}}},dhtmlXGridObject.prototype.enableAutoHiddenColumnsSaving=function(t,e){this.attachEvent("onColumnHidden",function(){this.saveHiddenColumnsToCookie(t,e)})},dhtmlXGridObject.prototype.enableSortingSaving=function(t,e){this.attachEvent("onBeforeSorting",function(){var i=this;return window.setTimeout(function(){i.saveSortingToCookie(t,e)},1),!0})},dhtmlXGridObject.prototype.enableOrderSaving=function(t,e){this.attachEvent("onAfterCMove",function(){this.saveOrderToCookie(t,e),this.saveSizeToCookie(t,e)})},dhtmlXGridObject.prototype.enableAutoSaving=function(t,e){this.enableOrderSaving(t,e),this.enableAutoSizeSaving(t,e),this.enableSortingSaving(t,e)},dhtmlXGridObject.prototype.saveSizeToCookie=function(t,e){if("px"==this.cellWidthType)var i=this.cellWidthPX.join(",");else i=this.cellWidthPC.join(",");var s=(this.initCellWidth||new Array).join(",");this.setCookie(t,e,0,i),this.setCookie(t,e,1,s)},dhtmlXGridObject.prototype.saveHiddenColumnsToCookie=function(t,e){var i=[].concat(this._hrrar||[]);if(this._fake&&this._fake._hrrar)for(var s=0;s<this._fake._cCount;s++)i[s]=this._fake._hrrar[s]?"1":"";this.setCookie(t,e,4,i.join(",").replace(/display:none;/g,"1"))},dhtmlXGridObject.prototype.loadHiddenColumnsFromCookie=function(t){for(var e=(this._getCookie(t,4)||"").split(","),i=0;i<this._cCount;i++)this.setColumnHidden(i,!!e[i])},dhtmlXGridObject.prototype.saveSortingToCookie=function(t,e){this.setCookie(t,e,2,(this.getSortingState()||[]).join(","))},dhtmlXGridObject.prototype.loadSortingFromCookie=function(t){var e=this._getCookie(t,2);(e=(e||"").split(",")).length>1&&e[0]<this._cCount&&(this.sortRows(e[0],null,e[1]),this.setSortImgState(!0,e[0],e[1]))},dhtmlXGridObject.prototype.saveOrderToCookie=function(t,e){if(!this._c_order){this._c_order=[];for(var i=this._cCount,s=0;s<i;s++)this._c_order[s]=s}this.setCookie(t,e,3,(this._c_order||[]).slice(0,this._cCount).join(",")),this.saveSortingToCookie()},dhtmlXGridObject.prototype.loadOrderFromCookie=function(t){var e=this._getCookie(t,3);if((e=(e||"").split(",")).length>1&&e.length<=this._cCount)for(var i=0;i<e.length;i++)if(!this._c_order&&e[i]!=i||this._c_order&&e[i]!=this._c_order[i]){var s=e[i];if(this._c_order)for(var n=0;n<this._c_order.length;n++)if(this._c_order[n]==e[i]){s=n;break}this.moveColumn(1*s,i)}},dhtmlXGridObject.prototype.loadSizeFromCookie=function(t){var e;if((e=this._getCookie(t,1))&&(this.initCellWidth=e.split(",")),(e=this._getCookie(t,0))&&e.length){if(!this._fake&&this._hrrar)for(var i=0;i<e.length;i++)this._hrrar[i]&&(e[i]=0);"px"==this.cellWidthType?this.cellWidthPX=e.split(","):this.cellWidthPC=e.split(",")}return this.setSizes(),!0},dhtmlXGridObject.prototype.clearConfigCookie=function(t){t||(t=this.entBox.id);var e="gridSettings"+t+"=||||";document.cookie=e},dhtmlXGridObject.prototype.clearSizeCookie=dhtmlXGridObject.prototype.clearConfigCookie,dhtmlXGridObject.prototype.setCookie=function(t,e,i,s){t||(t=this.entBox.id);var n=this.getCookie(t);(n=(n||"||||").split("|"))[i]=s;var l="gridSettings"+t+"="+n.join("|").replace(/,/g,"-")+(e?"; "+e:"");document.cookie=l},dhtmlXGridObject.prototype.getCookie=function(t,e){t||(t=this.entBox.id);var i=(t=(e||"gridSettings")+t)+"=";if(document.cookie.length>0){var s=document.cookie.indexOf(i);if(-1!=s){s+=i.length;var n=document.cookie.indexOf(";",s);return-1==n&&(n=document.cookie.length),document.cookie.substring(s,n)}}},dhtmlXGridObject.prototype._getCookie=function(t,e){return(this.getCookie(t)||"||||").replace(/-/g,",").split("|")[e]},dhtmlXGridObject.prototype.enableUndoRedo=function(){var t=this;this.attachEvent("onEditCell",function(){return t._onEditUndoRedo.apply(t,arguments)});this.attachEvent("onCheckbox",function(e,i,s){return t._onEditUndoRedo.apply(t,[2,e,i,s?1:0,s?0:1])}),this._IsUndoRedoEnabled=!0,this._UndoRedoData=[],this._UndoRedoPos=-1},dhtmlXGridObject.prototype.disableUndoRedo=function(){this._IsUndoRedoEnabled=!1,this._UndoRedoData=[],this._UndoRedoPos=-1},dhtmlXGridObject.prototype._onEditUndoRedo=function(t,e,i,s,n){if(this._IsUndoRedoEnabled&&2==t&&n!=s){-1!==this._UndoRedoPos&&this._UndoRedoPos!=this._UndoRedoData.length-1?this._UndoRedoData=this._UndoRedoData.slice(0,this._UndoRedoPos+1):-1===this._UndoRedoPos&&this._UndoRedoData.length>0&&(this._UndoRedoData=[]);var l={old_value:n,new_value:s,row_id:e,cell_index:i};this._UndoRedoData.push(l),this._UndoRedoPos++}return!0},dhtmlXGridObject.prototype.doUndo=function(){if(-1===this._UndoRedoPos)return!1;var t=this._UndoRedoData[this._UndoRedoPos--],e=this.cells(t.row_id,t.cell_index);"tree"==this.getColType(t.cell_index)?e.setLabel(t.old_value):e.setValue(t.old_value),this.callEvent("onUndo",[t.row_id])},dhtmlXGridObject.prototype.doRedo=function(){if(this._UndoRedoPos==this._UndoRedoData.length-1)return!1;var t=this._UndoRedoData[++this._UndoRedoPos];this.cells(t.row_id,t.cell_index).setValue(t.new_value),this.callEvent("onUndo",[t.row_id])},dhtmlXGridObject.prototype.getRedo=function(){return this._UndoRedoPos==this._UndoRedoData.length-1?[]:this._UndoRedoData.slice(this._UndoRedoPos+1)},dhtmlXGridObject.prototype.getUndo=function(){return-1==this._UndoRedoPos?[]:this._UndoRedoData.slice(0,this._UndoRedoPos+1)},dhtmlXGridObject.prototype.enableAccessKeyMap=function(){this._select_ifpossible=function(){this.editor&&this.editor.obj&&this.editor.obj.select&&this.editor.obj.select()},this._key_events={k13_1_0:function(){this.editStop()},k13_0_1:function(){this._key_events.k9_0_1.call(this)},k13_0_0:function(){this._key_events.k9_0_0.call(this)},k9_0_0:function(){if(this.editStop(),!this.callEvent("onTab",[!0]))return!0;var t=this._getNextCell(null,1);t&&(this.pagingOn&&this.showRow(t.parentNode.idd),this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0),this._select_ifpossible()},k9_0_1:function(){if(this.editStop(),!this.callEvent("onTab",[!1]))return!0;var t=this._getNextCell(null,-1);t&&(this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0),this._select_ifpossible()},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var t=this.cells4(this.cell);if(!t.changeState||!1===t.changeState())return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(this.editor)return!1;this.isTreeGrid()?this.collapseKids(this.row):this._key_events.k9_0_1.call(this)},k39_0_0:function(){if(this.editor)return!1;!this.editor&&this.isTreeGrid()?this.expandKids(this.row):this._key_events.k9_0_0.call(this)},k37_1_0:function(){if(this.editor)return!1;this.selectCell(this.row,0,!1,!1,!0),this._select_ifpossible()},k39_1_0:function(){if(this.editor)return!1;this.selectCell(this.row,this._cCount-1,!1,!1,!0),this._select_ifpossible()},k38_1_0:function(){this.selectCell(this.rowsCol[0],this.cell._cellIndex,!0,!1,!0),this._select_ifpossible()},k40_1_0:function(){this.selectCell(this.rowsCol[this.rowsCol.length-1],this.cell._cellIndex,!0,!1,!0),this._select_ifpossible()},k38_0_1:function(){var t=this.getRowIndex(this.row.idd),e=this._nextRow(t,-1);if(!e||e._sRow||e._rLoad)return!1;this.selectCell(e,this.cell._cellIndex,!0,!1,!0),this._select_ifpossible()},k40_0_1:function(){var t=this.getRowIndex(this.row.idd),e=this._nextRow(t,1);if(!e||e._sRow||e._rLoad)return!1;this.selectCell(e,this.cell._cellIndex,!0,!1,!0),this._select_ifpossible()},k38_1_1:function(){for(var t=this.getRowIndex(this.row.idd);t>=0;t--)this.selectCell(this.rowsCol[t],this.cell._cellIndex,!0,!1,!0)},k40_1_1:function(){for(var t=this.getRowIndex(this.row.idd)+1;t<this.rowsCol.length;t++)this.selectCell(this.rowsCol[t],this.cell._cellIndex,!0,!1,!0)},k40_0_0:function(){if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var t=t=this.getRowIndex(this.row.idd)+1;if(this.rowsBuffer[t]){var e=this._nextRow(t-1,1);this.pagingOn&&e&&this.showRow(e.idd),this._Opera_stop=0,this.selectCell(e,this.cell._cellIndex,!0,!1,!0)}else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[])}}this._still_active=!0},k36_0_0:function(){return this._key_events.k37_1_0.call(this)},k35_0_0:function(){return this._key_events.k39_1_0.call(this)},k36_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[0],0,!0,!1,!0),this._select_ifpossible()},k35_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[this.rowsCol.length-1],this._cCount-1,!0,!1,!0),this._select_ifpossible()},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k38_0_0:function(){if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var t=t=this.getRowIndex(this.row.idd)+1;if(-1!=t){var e=this._nextRow(t-1,-1);this._Opera_stop=0,this.pagingOn&&e&&this.showRow(e.idd),this.selectCell(e,this.cell._cellIndex,!0,!1,!0)}else this._key_events.k33_0_0.apply(this,[])}this._still_active=!0}}},dhtmlXGridObject.prototype.enableExcelKeyMap=function(){dhtmlXGridObject.prototype._key_events={k13_1_0:function(){this.editStop()},k13_0_1:function(){this.editStop(),this._key_events.k38_0_0.call(this)},k13_0_0:function(){this.editStop(),this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]),this._still_active=!0,this._key_events.k40_0_0.call(this)},k9_0_0:function(){if(this.editStop(),!this.callEvent("onTab",[!0]))return!0;if(!(this.cell&&this.cell._cellIndex+1>=this._cCount)){var t=this._getNextCell(null,1);t&&this.row==t.parentNode&&(this.selectCell(t.parentNode,t._cellIndex,!0),this._still_active=!0)}},k9_0_1:function(){if(this.editStop(),!this.callEvent("onTab",[!1]))return!0;if(!this.cell||0!=this.cell._cellIndex){var t=this._getNextCell(null,-1);t&&this.row==t.parentNode&&(this.selectCell(t.parentNode,t._cellIndex,!0),this._still_active=!0)}},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var t=this.cells4(this.cell);if(!t.changeState||!1===t.changeState())return!1},k27_0_0:function(){this.editStop(!0),this._still_active=!0},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(this.editor)return!1;this.isTreeGrid()?this.collapseKids(this.row):this._key_events.k9_0_1.call(this)},k39_0_0:function(){if(this.editor)return!1;!this.editor&&this.isTreeGrid()?this.expandKids(this.row):this._key_events.k9_0_0.call(this)},k37_1_0:function(){if(this.editor)return!1;this.selectCell(this.row,0,!0)},k39_1_0:function(){if(this.editor)return!1;this.selectCell(this.row,this._cCount-1,!0)},k38_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[0],this.cell._cellIndex,!0)},k40_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[this.rowsCol.length-1],this.cell._cellIndex,!0)},k38_0_1:function(){if(this.editor||!this.rowsCol.length)return!1;var t=this.row.rowIndex,e=this._nextRow(t-1,-1);if(!e||e._sRow||e._rLoad)return!1;this.selectCell(e,this.cell._cellIndex,!0,!0)},k40_0_1:function(){if(this.editor||!this.rowsCol.length)return!1;var t=this.row.rowIndex,e=this._nextRow(t-1,1);if(!e||e._sRow||e._rLoad)return!1;this.selectCell(e,this.cell._cellIndex,!0,!0)},k38_1_1:function(){if(this.editor||!this.rowsCol.length)return!1;for(var t=this.row.rowIndex-1;t>=0;t--)this.selectCell(this.rowsCol[t],this.cell._cellIndex,!0,!0)},k40_1_1:function(){if(this.editor||!this.rowsCol.length)return!1;for(var t=this.row.rowIndex;t<this.rowsCol.length;t++)this.selectCell(this.rowsCol[t],this.cell._cellIndex,!0,!0)},k40_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(this.editor)return!1;var e=Math.max(t._r_select||0,this.getRowIndex(this.row.idd)),i=this._nextRow(e,1);if(i)t._r_select=null,this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&t.showRow(i.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[])}}},k36_0_0:function(){return this._key_events.k37_1_0.call(this)},k35_0_0:function(){return this._key_events.k39_1_0.call(this)},k36_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[0],0,!0)},k35_1_0:function(){if(this.editor||!this.rowsCol.length)return!1;this.selectCell(this.rowsCol[this.rowsCol.length-1],this._cCount-1,!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k38_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(this.editor)return!1;if(!this.row.idd)return;var e=this.getRowIndex(this.row.idd)+1;if(-1==e||this.pagingOn&&1==e)this._key_events.k33_0_0.apply(this,[]);else{var i=this._nextRow(e-1,-1);this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&i&&t.showRow(i.idd)}}},k_other:function(t){if(this.editor)return!1;if(!t.ctrlKey&&t.keyCode>=40&&(t.keyCode<91||t.keyCode>95&&t.keyCode<111||t.keyCode>187)&&this.cell){var e=this.cells4(this.cell);if(e.isDisabled())return!1;var i=e.getValue();!1!==e.editable&&e.setValue(""),this.editCell(),this.editor?(this.editor.val=i,this.editor.obj&&this.editor.obj.select&&this.editor.obj.select()):e.setValue(i)}}}},eXcell_time.prototype=new eXcell_ed,eXcell_sub_row.prototype=new eXcell,eXcell_sub_row_ajax.prototype=new eXcell_sub_row,eXcell_sub_row_grid.prototype=new eXcell_sub_row,dhtmlXGridObject.prototype._expandMonolite=function(t,e,i){var s=this.parentNode,n=s.parentNode,l=n.grid;(t||window.event)&&(i||n._expanded||l.editStop(),(t||event).cancelBubble=!0);var o=l.getUserData(n.idd,"__sub_row");if(l._sub_row_editor||(l._sub_row_editor=new eXcell_sub_row(s)),o){if(n._expanded&&!e){l._sub_row_editor._setState("plus.gif",s),s._previous_content=n._expanded,l.objBox.removeChild(n._expanded),n._expanded=!1,n.style.height=(n.oldHeight||20)+"px",s.style.height=(n.oldHeight||20)+"px",l._fake&&(l._fake.rowsAr[n.idd].style.height=(n.oldHeight||20)+"px",l._fake.rowsAr[n.idd].firstChild.style.height=(n.oldHeight||20)+"px");for(var r=0;r<n.cells.length;r++)n.cells[r].style.verticalAlign="middle";delete l._flow[n.idd],l._correctMonolite(),n._expanded.ctrl=null}else if(!n._expanded&&!i){var a;if(l._sub_row_editor._setState("minus.gif",s),n.oldHeight=s.offsetHeight-4,s._previous_content)(a=s._previous_content).ctrl=s,l.objBox.appendChild(a),l._detectHeight(a,s,parseInt(a.style.height));else(a=document.createElement("DIV")).ctrl=s,s._sub_row_type?l._sub_row_render[s._sub_row_type](l,a,s,o):a.innerHTML=o,a.style.cssText="position:absolute; left:0px; top:0px; overflow:auto; font-family:Tahoma; font-size:8pt; margin-top:2px; margin-left:4px;",a.className="dhx_sub_row",l.objBox.appendChild(a),l._detectHeight(a,s);l._flow||(l.attachEvent("onGridReconstructed",function(){this.pagingOn&&!this.parentGrid||this._srnd?this._collapsMonolite():this._correctMonolite()}),l.attachEvent("onResizeEnd",function(){this._correctMonolite(!0)}),l.attachEvent("onAfterCMove",function(){this._correctMonolite(!0)}),l.attachEvent("onDrop",function(){this._correctMonolite(!0)}),l.attachEvent("onBeforePageChanged",function(){return this._collapsMonolite(),!0}),l.attachEvent("onGroupStateChanged",function(){return this._correctMonolite(),!0}),l.attachEvent("onFilterEnd",function(){this._collapsMonolite()}),l.attachEvent("onUnGroup",function(){this._collapsMonolite()}),l.attachEvent("onPageChanged",function(){this._collapsMonolite()}),l.attachEvent("onXLE",function(){this._collapsMonolite()}),l.attachEvent("onClearAll",function(){for(var t in this._flow)this._flow[t]&&this._flow[t].parentNode&&this._flow[t].parentNode.removeChild(this._flow[t]);this._flow=[]}),l.attachEvent("onEditCell",function(t,e,i){return 2!==t&&this._flow[e]&&"ch"!=this.cellType[i]&&"ra"!=this.cellType[i]&&this._expandMonolite.apply(this._flow[e].ctrl.firstChild,[0,!1,!0]),!0}),l.attachEvent("onCellChanged",function(t,e){this._flow[t]&&(this.cells(t,e).cell.style.verticalAlign="top")}),l._flow=[]),l._flow[n.idd]=a,l._correctMonolite();l._srdh;l.multiLine&&0;for(r=0;r<n.cells.length;r++)n.cells[r].style.verticalAlign="top";if(l._fake){var h=l._fake.rowsAr[n.idd];for(r=0;r<h.cells.length;r++)h.cells[r].style.verticalAlign="top"}n._expanded=a}l._ahgr&&l.setSizes(),l.parentGrid&&l.callEvent("onGridReconstructed",[]),l.callEvent("onSubRowOpen",[n.idd,!!n._expanded])}},dhtmlXGridObject.prototype._sub_row_render={ajax:function(that,d,td,c){d.innerHTML="Loading...",dhx4.ajax.get(c,function(xml){d.innerHTML=xml.xmlDoc.responseText;var z=xml.xmlDoc.responseText.match(/<script[^>]*>([^\f]+?)<\/script>/g);if(z)for(var i=0;i<z.length;i++)eval(z[i].replace(/<([\/]{0,1})s[^>]*>/g,""));that._detectHeight(d,td),that._correctMonolite(),that.setUserData(td.parentNode.idd,"__sub_row",xml.xmlDoc.responseText),td._sub_row_type=null,that._ahgr&&that.setSizes(),that.callEvent("onSubAjaxLoad",[td.parentNode.idd,xml.xmlDoc.responseText])})},grid:function(t,e,i,s){i._sub_grid=new dhtmlXGridObject(e),t.skin_name&&i._sub_grid.setSkin(t.skin_name),i._sub_grid.parentGrid=t,i._sub_grid.imgURL=t.imgURL,i._sub_grid.iconURL=t.iconURL,i._sub_grid.enableAutoHeight(!0),i._sub_grid._delta_x=i._sub_grid._delta_y=null,i._sub_grid.attachEvent("onGridReconstructed",function(){t._detectHeight(e,i,i._sub_grid.objBox.scrollHeight+i._sub_grid.hdr.offsetHeight+(this.ftr?this.ftr.offsetHeight:0)),t._correctMonolite(),this.setSizes(),t.parentGrid&&t.callEvent("onGridReconstructed",[])}),t.callEvent("onSubGridCreated",[i._sub_grid,i.parentNode.idd,i._cellIndex,s])?i._sub_grid.loadXML(s,function(){t._detectHeight(e,i,i._sub_grid.objBox.scrollHeight+i._sub_grid.hdr.offsetHeight+(i._sub_grid.ftr?i._sub_grid.ftr.offsetHeight:0)),i._sub_grid.objBox.style.overflow="hidden",t._correctMonolite(),i._sub_row_type=null,t.callEvent("onSubGridLoaded",[i._sub_grid,i.parentNode.idd,i._cellIndex,s])&&t._ahgr&&t.setSizes()}):(i._sub_grid.objBox.style.overflow="hidden",i._sub_row_type=null)}},dhtmlXGridObject.prototype._detectHeight=function(t,e,i){var s=e.offsetLeft+e.offsetWidth;t.style.left=s+"px",t.style.width=Math.max(0,e.parentNode.offsetWidth-s-4)+"px";i=i||t.scrollHeight;t.style.overflow="hidden",t.style.height=i+"px";var n=e.parentNode;if(e.parentNode.style.height=(n.oldHeight||20)+1*i+"px",e.style.height=(n.oldHeight||20)+1*i+"px",this._fake){var l=this._fake.rowsAr[e.parentNode.idd];l.style.height=(n.oldHeight||20)+1*i+"px",l.firstChild.style.height=(n.oldHeight||20)+1*i+"px"}},dhtmlXGridObject.prototype._correctMonolite=function(t){if(!this._in_correction){for(var e in this._in_correction=!0,this._flow)if(this._flow[e]&&"DIV"==this._flow[e].tagName)if(this.rowsAr[e]){if("none"==this.rowsAr[e].style.display){this.cells4(this._flow[e].ctrl).close();continue}if(this._flow[e].style.top=this.rowsAr[e].offsetTop+(this.rowsAr[e].oldHeight||20)+"px",t){var i=this._flow[e].ctrl.offsetLeft+this._flow[e].ctrl.offsetWidth;this._flow[e].style.left=i+"px",this._flow[e].style.width=this.rowsAr[e].offsetWidth-i-4+"px"}}else this._flow[e].ctrl=null,this.objBox.removeChild(this._flow[e]),delete this._flow[e];this._in_correction=!1}},dhtmlXGridObject.prototype._collapsMonolite=function(){for(var t in this._flow)this._flow[t]&&"DIV"==this._flow[t].tagName&&this.rowsAr[t]&&this.cells4(this._flow[t].ctrl).close()},eXcell_ra_str.prototype=new eXcell_ch,eXcell_ra_str.prototype.setValue=function(t){if(this.cell.style.verticalAlign="middle",t&&("false"!=(t=t.toString()._dhx_trim())&&"0"!=t||(t="")),t){if(this.grid.rowsAr[this.cell.parentNode.idd])for(var e=0;e<this.grid._cCount;e++)if(e!==this.cell._cellIndex){var i=this.grid.cells(this.cell.parentNode.idd,e);if("ra_str"!=(i.cell._cellType||this.grid.cellType[i.cell._cellIndex]))continue;i.getValue()&&i.setValue("0")}t="1",this.cell.chstate="1"}else t="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+t+".gif' onclick='new eXcell_ra_str(this.parentNode).changeState()'>",this.cell.chstate)},dhx4.attachEvent("onGridCreated",function(t){window.dhx_globalImgPath||(window.dhx_globalImgPath=t.imgURL),t._col_combos=[];for(var e=0;e<t._cCount;e++)0==t.cellType[e].indexOf("combo")&&(t._col_combos[e]=eXcell_combo.prototype.initCombo.call({grid:t},e));t._loading_handler_set||(t._loading_handler_set=t.attachEvent("onXLE",function(t,e,i,s){eXcell_combo.prototype.fillColumnCombos(this,s),this.detachEvent(this._loading_handler_set),this._loading_handler_set=null}))}),eXcell_combo.prototype=new eXcell,eXcell_combo_v=function(t){var e=new eXcell_combo(t);return e._combo_pre="<img src='"+(window.dhx_globalImgPath?window.dhx_globalImgPath:this.grid.imgURL)+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif' class='dhxgrid_combo_icon'/>",e},eXcell_combo.prototype.initCombo=function(t){var e=document.createElement("DIV");e.className="dhxcombo_in_grid_parent";var i=new dhtmlXCombo(e,"combo",0,this.grid.defVal[arguments.length?t:this.cell._cellIndex]);this.grid.defVal[arguments.length?t:this.cell._cellIndex]="";var s=this.grid;return i.DOMelem.onmousedown=i.DOMelem.onclick=function(t){(t=t||event).cancelBubble=!0},i.DOMelem.onselectstart=function(t){return(t=t||event).cancelBubble=!0,!0},i.attachEvent("onKeyPressed",function(t){13!=t&&27!=t||(s.editStop(),s._fake&&s._fake.editStop())}),i},eXcell_combo.prototype.fillColumnCombos=function(t,e){if(e){var i=dhx4.ajax.xmltop("rows",e,-1);if(i&&"DIV"!==i.tagName){t.combo_columns=t.combo_columns||[],columns=dhx4.ajax.xpath("//column",i);for(var s=0;s<columns.length;s++)0==(columns[s].getAttribute("type")||"").indexOf("combo")&&(t.combo_columns[t.combo_columns.length]=s,this.setComboOptions(t._col_combos[s],columns[s],t,s))}}},eXcell_combo.prototype.setComboCValue=function(t,e){if(""!=this._combo_pre){this.cell.offsetHeight&&this.cell.offsetHeight;t="<div style='width:100%;position:relative;height:100%;overflow:hidden;'>"+this._combo_pre+"<span>"+t+"</span></div>"}arguments.length>1?this.setCValue(t,e):this.setCValue(t)},eXcell_combo.prototype.setComboOptions=function(t,e,i,s,n){if(window.dhx4.s2b(e.getAttribute("xmlcontent"))&&!e.getAttribute("source")){options=e.childNodes;for(var l=[],o=0;o<options.length;o++)if("option"==options[o].tagName){var r=options[o].firstChild?options[o].firstChild.data:"";l[l.length]=[options[o].getAttribute("value"),r]}if(t.addOption(l),4==arguments.length)i.forEachRowA(function(e){var n=i.cells(e,s);n.cell._brval||n.cell._cellType||n.cell._cellIndex!=s||(""==n.cell.combo_value?n.setComboCValue("&nbsp;",""):t.getOption(n.cell.combo_value)?n.setComboCValue(t.getOption(n.cell.combo_value).text):n.setComboCValue(n.cell.combo_value))});else{var a=this.cell?this:i.cells(n,s);e.getAttribute("text")?""==e.getAttribute("text")._dhx_trim()?a.setComboCValue("&nbsp;",""):a.setComboCValue(e.getAttribute("text")):a.cell.combo_value&&""!=a.cell.combo_value._dhx_trim()?t.getOption(a.cell.combo_value)?a.setComboCValue(t.getOption(a.cell.combo_value).text):a.setComboCValue(a.cell.combo_value):a.setComboCValue("&nbsp;","")}}if(e.getAttribute("source"))if(e.getAttribute("auto")&&window.dhx4.s2b(e.getAttribute("auto"))){if(e.getAttribute("xmlcontent")){a=this.cell?this:i.cells(n,s);e.getAttribute("text")&&a.setComboCValue(e.getAttribute("text"))}else i.forEachRowA(function(t){var e=i.cells(t,s);if(!e.cell._brval&&!e.cell._cellType){var n=e.cell.combo_value.toString();if(-1!=n.indexOf("^")){var l=n.split("^");e.cell.combo_value=l[0],e.setComboCValue(l[1])}}});t.enableFilteringMode(!0,e.getAttribute("source"),window.dhx4.s2b(e.getAttribute("cache")||!0),window.dhx4.s2b(e.getAttribute("sub")||!1))}else{var h=arguments.length;t.load(e.getAttribute("source"),function(){if(4==h)i.forEachRow(function(e){var n=i.cells(e,s);n.cell._brval||n.cell._cellType||(t.getOption(n.cell.combo_value)?n.setComboCValue(t.getOption(n.cell.combo_value).text):""==(n.cell.combo_value||"").toString()._dhx_trim()?(n.setComboCValue("&nbsp;",""),n.cell._clearCell=!0):n.setComboCValue(n.cell.combo_value))});else{var e=i.cells(n,s);t.getOption(e.cell.combo_value)?e.setComboCValue(t.getOption(e.cell.combo_value).text):e.setComboCValue(e.cell.combo_value)}})}e.getAttribute("auto")&&window.dhx4.s2b(e.getAttribute("auto"))||(e.getAttribute("editable")&&!window.dhx4.s2b(e.getAttribute("editable"))&&t.readonly(!0),e.getAttribute("filter")&&window.dhx4.s2b(e.getAttribute("filter"))&&t.enableFilteringMode(!0))},eXcell_combo.prototype.getCellCombo=function(){return this.cell._brval?this.cell._brval:(this.cell._brval=this.initCombo(),this.cell._brval)},eXcell_combo.prototype.refreshCell=function(){this.setValue(this.getValue())},dhtmlXGridObject.prototype.getColumnCombo=function(t){return this._col_combos&&this._col_combos[t]?this._col_combos[t]:(this._col_combos||(this._col_combos=[]),this._col_combos[t]=eXcell_combo.prototype.initCombo.call({grid:this},t),this._col_combos[t])},dhtmlXGridObject.prototype.refreshComboColumn=function(t){this.forEachRow(function(e){this.cells(e,t).refreshCell&&this.cells(e,t).refreshCell()})},eXcell_clist.prototype=new eXcell,eXcell_clist.prototype.setValue=function(t){if("object"==typeof t){var e=dhx4.ajax.xpath("./option",t);e.length&&(this.cell._combo=[]);for(var i=0;i<e.length;i++)this.cell._combo.push(e[i].firstChild?e[i].firstChild.data:"");t=t.firstChild.data}""===t||t===this.undefined?(this.setCTxtValue(" ",t),this.cell._clearCell=!0):(t=t.replace(/,[ ]*/g,", "),this.setCTxtValue(t),this.cell._clearCell=!1)},dhtmlXGridObject.prototype.registerCList=function(t,e){this.clists||(this.clists=new Array),"object"!=typeof e&&(e=e.split(",")),this.clists[t]=e},eXcell_calck.prototype=new eXcell,eXcell_calck.prototype.setValue=function(t){t&&""!=t.toString()._dhx_trim()||(t="0"),this.setCValue(this.grid._aplNF(t,this.cell._cellIndex),t)},window.dhtmlx||(window.dhtmlx={}),function(){var t=null;function e(e,i){var n=e.callback;s(!1),e.box.parentNode.removeChild(e.box),t=e.box=null,n&&n(i)}function i(i){if(t){var s=(i=i||event).which||event.keyCode;return dhtmlx.message.keyboard&&(13!=s&&32!=s||e(t,!0),27==s&&e(t,!1)),i.preventDefault&&i.preventDefault(),!(i.cancelBubble=!0)}}function s(t){s.cover||(s.cover=document.createElement("DIV"),s.cover.onkeydown=i,s.cover.className="dhx_modal_cover",document.body.appendChild(s.cover));document.body.scrollHeight;s.cover.style.display=t?"inline-block":"none"}function n(t,e){return"<div class='dhtmlx_popup_button' result='"+e+"' ><div>"+t+"</div></div>"}function l(l,o,r){var a=l.tagName?l:function(i,s,l){var o=document.createElement("DIV");o.className=" dhtmlx_modal_box dhtmlx-"+i.type,o.setAttribute("dhxbox",1);var r="";if(i.width&&(o.style.width=i.width),i.height&&(o.style.height=i.height),i.title&&(r+='<div class="dhtmlx_popup_title">'+i.title+"</div>"),r+='<div class="dhtmlx_popup_text"><span>'+(i.content?"":i.text)+'</span></div><div  class="dhtmlx_popup_controls">',s&&(r+=n(i.ok||"OK",!0)),l&&(r+=n(i.cancel||"Cancel",!1)),i.buttons)for(var a=0;a<i.buttons.length;a++)r+=n(i.buttons[a],a);if(r+="</div>",o.innerHTML=r,i.content){var h=i.content;"string"==typeof h&&(h=document.getElementById(h)),"none"==h.style.display&&(h.style.display=""),o.childNodes[i.title?1:0].appendChild(h)}return o.onclick=function(t){var s=(t=t||event).target||t.srcElement;if(s.className||(s=s.parentNode),"dhtmlx_popup_button"==s.className){var n=s.getAttribute("result");e(i,n="true"==n||"false"!=n&&n)}},i.box=o,(s||l)&&(t=i),o}(l,o,r);l.hidden||s(!0),document.body.appendChild(a);var h=l.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-a.offsetWidth)/2)),d=l.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-a.offsetHeight)/2));return"top"==l.position?a.style.top="-3px":a.style.top=d+"px",a.style.left=h+"px",a.onkeydown=i,a.focus(),l.hidden&&dhtmlx.modalbox.hide(a),a}function o(t){return l(t,!0,!1)}function r(t){return l(t,!0,!0)}function a(t){return l(t)}function h(t,e,i){return"object"!=typeof t&&("function"==typeof e&&(i=e,e=""),t={text:t,type:e,callback:i}),t}document.attachEvent?document.attachEvent("onkeydown",i):document.addEventListener("keydown",i,!0),dhtmlx.alert=function(){var t=h.apply(this,arguments);return t.type=t.type||"confirm",o(t)},dhtmlx.confirm=function(){var t=h.apply(this,arguments);return t.type=t.type||"alert",r(t)},dhtmlx.modalbox=function(){var t=h.apply(this,arguments);return t.type=t.type||"alert",a(t)},dhtmlx.modalbox.hide=function(e){for(;e&&e.getAttribute&&!e.getAttribute("dhxbox");)e=e.parentNode;e&&(e.parentNode.removeChild(e),s(!1),t=null)};var d=dhtmlx.message=function(t,e,i,s){switch((t=function(t,e,i,s){return"object"!=typeof t&&(t={text:t,type:e,expire:i,id:s}),t.id=t.id||d.uid(),t.expire=t.expire||d.expire,t}.apply(this,arguments)).type=t.type||"info",t.type.split("-")[0]){case"alert":return o(t);case"confirm":return r(t);case"modalbox":return a(t);default:return function(t){d.area||(d.area=document.createElement("DIV"),d.area.className="dhtmlx_message_area",d.area.style[d.position]="5px",document.body.appendChild(d.area)),d.hide(t.id);var e=document.createElement("DIV");return e.innerHTML="<div>"+t.text+"</div>",e.className="dhtmlx-info dhtmlx-"+t.type,e.onclick=function(){t&&d.hide(t.id),t=null},"bottom"==d.position&&d.area.firstChild?d.area.insertBefore(e,d.area.firstChild):d.area.appendChild(e),t.expire>0&&(d.timers[t.id]=window.setTimeout(function(){d.hide(t.id)},t.expire)),d.pull[t.id]=e,e=null,t.id}(t)}};d.seed=(new Date).valueOf(),d.uid=function(){return d.seed++},d.expire=4e3,d.keyboard=!0,d.position="top",d.pull={},d.timers={},d.hideAll=function(){for(var t in d.pull)d.hide(t)},d.hide=function(t){var e=d.pull[t];e&&e.parentNode&&(window.setTimeout(function(){e.parentNode.removeChild(e),e=null},2e3),e.className+=" hidden",d.timers[t]&&window.clearTimeout(d.timers[t]),delete d.pull[t])}}(),window.dhtmlXScheduler=window.scheduler={version:"4.3.25"},window.dhtmlx||(dhtmlx=function(t){for(var e in t)dhtmlx[e]=t[e];return dhtmlx}),dhtmlx.extend_api=function(t,e,i){var s=window[t];s&&(window[t]=function(t){var i;if(t&&"object"==typeof t&&!t.tagName){for(var n in i=s.apply(this,e._init?e._init(t):arguments),dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(var n in t)e[n]?this[e[n]](t[n]):0===n.indexOf("on")&&this.attachEvent(n,t[n])}else i=s.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=s.prototype,i&&dhtmlXHeir(window[t].prototype,i))},dhtmlxAjax={get:function(t,e){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=e,i.loadXML(t),i},post:function(t,e,i){var s=new dtmlXMLLoaderObject(!0);return s.async=arguments.length<4,s.waitCall=i,s.loadXML(t,!0,e),s},getSync:function(t){return this.get(t,null,!0)},postSync:function(t,e){return this.post(t,e,null,!0)}},dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(t){var e=!0;return this.check=function(){if(t&&t.onloadAction&&(!t.xmlDoc.readyState||4==t.xmlDoc.readyState)){if(!e)return;e=!1,dtmlXMLLoaderObject.count++,"function"==typeof t.onloadAction&&t.onloadAction(t.mainObject,null,null,null,t),t.waitCall&&(t.waitCall.call(this,t),t.waitCall=null)}},this.check},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(t,e){var i;if(this.xmlDoc.responseXML){if(0===(s=this.xmlDoc.responseXML.getElementsByTagName(t)).length&&-1!=t.indexOf(":"))var s=this.xmlDoc.responseXML.getElementsByTagName(t.split(":")[1]);i=s[0]}else i=this.xmlDoc.documentElement;if(i)return this._retry=!1,i;if(!this._retry&&_isIE){this._retry=!0;e=this.xmlDoc;return this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(t,e)}return dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),document.createElement("DIV")},dtmlXMLLoaderObject.prototype.loadXMLString=function(t,e){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(t);else{var i=new DOMParser;this.xmlDoc=i.parseFromString(t,"text/xml")}e||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(t,e,i,s){this.rSeed&&(t+=(-1!=t.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=t,!_isIE&&window.XMLHttpRequest?this.xmlDoc=new XMLHttpRequest:this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),"string"==typeof e?this.xmlDoc.open(e,t,this.async):this.xmlDoc.open(e?"POST":"GET",t,this.async),s?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):e&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(i),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(t){for(var e={},i=0;i<t.attributes.length;i++)e[t.attributes[i].name]=t.attributes[i].value;e._tagvalue=t.firstChild?t.firstChild.nodeValue:"";for(i=0;i<t.childNodes.length;i++){var s=t.childNodes[i].tagName;s&&(e[s]||(e[s]=[]),e[s].push(this.xmlNodeToJSON(t.childNodes[i])))}return e},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){t||(t=window.event);var e=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-e.downtime<100)){if(!e.dragNode){if(!e.waitDrag)return e.stopDrag(t,!0);if(e.dragNode=e.dragStartObject._createDragNode(e.dragStartNode,t),!e.dragNode)return e.stopDrag();e.dragNode.onselectstart=function(){return!1},e.gldragNode=e.dragNode,document.body.appendChild(e.dragNode),document.body.onmouseup=e.stopDrag,e.waitDrag=0,e.dragNode.pWindow=window,e.initFrameRoute()}if(e.dragNode.parentNode!=window.document.body&&e.gldragNode){var i=e.gldragNode;e.gldragNode.old&&(i=e.gldragNode.old),i.parentNode.removeChild(i);var s=e.dragNode.pWindow;if(i.pWindow&&i.pWindow.dhtmlDragAndDrop.lastLanding&&i.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(i.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var n=document.createElement("Div");n.innerHTML=e.dragNode.outerHTML,e.dragNode=n.childNodes[0]}else e.dragNode=e.dragNode.cloneNode(!0);e.dragNode.pWindow=window,e.gldragNode.old=e.dragNode,document.body.appendChild(e.dragNode),s.dhtmlDragAndDrop.dragNode=e.dragNode}var l;e.dragNode.style.left=t.clientX+15+(e.fx?-1*e.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",e.dragNode.style.top=t.clientY+3+(e.fy?-1*e.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",l=t.srcElement?t.srcElement:t.target,e.checkLanding(l,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,s=0;e;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var n=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*n.split("_")[0],s+=1*n.split("_")[1]}if(t)return i+"_"+s;this.fx=i,this.fy=s}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){var i=window.dhtmlDragAndDrop;if(!e){i.stopFrameRoute();var s=i.lastLanding;i.lastLanding=null,s&&s.dragLanding._drag(i.dragStartNode,i.dragStartObject,s,_isIE?event.srcElement:t.target)}i.lastLanding=null,i.dragNode&&i.dragNode.parentNode==document.body&&i.dragNode.parentNode.removeChild(i.dragNode),i.dragNode=0,i.gldragNode=0,i.fx=0,i.fy=0,i.dragStartNode=0,i.dragStartObject=0,document.body.onmouseup=i.tempDOMU,document.body.onmousemove=i.tempDOMM,i.tempDOMU=null,i.tempDOMM=null,i.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,-1==navigator.appVersion.indexOf("MSIE 8.0")&&-1==navigator.appVersion.indexOf("MSIE 9.0")&&-1==navigator.appVersion.indexOf("MSIE 10.0")||"BackCompat"==document.compatMode||(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(t,e,i,s){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(t,e);if(_isIE)return e||(e=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),e||dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),i&&e.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),"single"==s?e.selectSingleNode(t):e.selectNodes(t)||new Array(0);var n=e;e||(e=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),e||dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),-1!=e.nodeName.indexOf("document")?n=e:(n=e,e=e.ownerDocument);var l=XPathResult.ANY_TYPE;"single"==s&&(l=XPathResult.FIRST_ORDERED_NODE_TYPE);var o=[],r=e.evaluate(t,n,function(t){return i},l,null);if(l==XPathResult.FIRST_ORDERED_NODE_TYPE)return r.singleNodeValue;for(var a=r.iterateNext();a;)o[o.length]=a,a=r.iterateNext();return o},_dhtmlxError.prototype.catchError=function(t,e){this.catches[t]=e},_dhtmlxError.prototype.throwError=function(t,e,i){return this.catches[t]?this.catches[t](t,e,i):this.catches.ALL?this.catches.ALL(t,e,i):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)},window.dhtmlxError=new _dhtmlxError,dtmlXMLLoaderObject.prototype.doXPathOpera=function(t,e){var i=t.replace(/[\/]+/gi,"/").split("/"),s=null,n=1;if(!i.length)return[];if("."==i[0])s=[e];else{if(""!==i[0])return[];s=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[n].replace(/\[[^\]]*\]/g,"")),n++}for(;n<i.length;n++)s=this._getAllNamedChilds(s,i[n]);return-1!=i[n-1].indexOf("[")&&(s=this._filterXPath(s,i[n-1])),s},dtmlXMLLoaderObject.prototype._filterXPath=function(t,e){for(var i=[],s=(e=e.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),0);s<t.length;s++)t[s].getAttribute(e)&&(i[i.length]=t[s]);return i},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(t,e){var i=[];_isKHTML&&(e=e.toUpperCase());for(var s=0;s<t.length;s++)for(var n=0;n<t[s].childNodes.length;n++)_isKHTML?t[s].childNodes[n].tagName&&t[s].childNodes[n].tagName.toUpperCase()==e&&(i[i.length]=t[s].childNodes[n]):t[s].childNodes[n].tagName==e&&(i[i.length]=t[s].childNodes[n]);return i},void 0===window.dhtmlxEvent&&(window.dhtmlxEvent=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}),dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(t,e,i){i||(i=this.xslDoc),i.responseXML&&(i=i.responseXML);var s=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+t+"']",i,"http://www.w3.org/1999/XSL/Transform","single");s&&(s.firstChild.nodeValue=e)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(t,e){var i;if(t||(t=this.xslDoc),t.responseXML&&(t=t.responseXML),e||(e=this.xmlDoc),e.responseXML&&(e=e.responseXML),_isIE){i=new ActiveXObject("Msxml2.DOMDocument.3.0");try{e.transformNodeToObject(t,i)}catch(s){i=e.transformNode(t)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(t)),i=this.XSLProcessor.transformToDocument(e);return i},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(t,e){var i=this.doXSLTransToObject(t,e);return"string"==typeof i?i:this.doSerialization(i)},dtmlXMLLoaderObject.prototype.doSerialization=function(t){return t||(t=this.xmlDoc),t.responseXML&&(t=t.responseXML),_isIE?t.xml:(new XMLSerializer).serializeToString(t)},dhtmlxEventable=function(obj){obj.attachEvent=function(t,e,i){return this[t="ev_"+t.toLowerCase()]||(this[t]=new this.eventCatcher(i||this)),t+":"+this[t].addEvent(e)},obj.callEvent=function(t,e){return!this[t="ev_"+t.toLowerCase()]||this[t].apply(this,e)},obj.checkEvent=function(t){return!!this["ev_"+t.toLowerCase()]},obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){for(var t=!0,e=0;e<dhx_catch.length;e++)if(dhx_catch[e]){var i=dhx_catch[e].apply(obj,arguments);t=t&&i}return t};return z.addEvent=function(ev){return"function"!=typeof ev&&(ev=eval(ev)),!!ev&&dhx_catch.push(ev)-1},z.removeEvent=function(t){dhx_catch[t]=null},z},obj.detachEvent=function(t){if(t){var e=t.split(":");this[e[0]].removeEvent(e[1])}},obj.detachAllEvents=function(){for(var t in this)0===t.indexOf("ev_")&&(this.detachEvent(t),this[t]=null)},obj=null},window.dhtmlx||(window.dhtmlx={}),function(){var t=null;function e(e,i){var n=e.callback;s(!1),e.box.parentNode.removeChild(e.box),t=e.box=null,n&&n(i)}function i(i){if(t){var s=(i=i||event).which||event.keyCode;return dhtmlx.message.keyboard&&(13!=s&&32!=s||e(t,!0),27==s&&e(t,!1)),i.preventDefault&&i.preventDefault(),!(i.cancelBubble=!0)}}function s(t){s.cover||(s.cover=document.createElement("DIV"),s.cover.onkeydown=i,s.cover.className="dhx_modal_cover",document.body.appendChild(s.cover));document.body.scrollHeight;s.cover.style.display=t?"inline-block":"none"}function n(t,e,i){return"<div class='dhtmlx_popup_button "+("dhtmlx_"+(i||(t||"")).toLowerCase().replace(/ /g,"_")+"_button")+"' result='"+e+"' ><div>"+t+"</div></div>"}function l(l,o,r){var a=l.tagName?l:function(i,s,l){var o=document.createElement("DIV");o.className=" dhtmlx_modal_box dhtmlx-"+i.type,o.setAttribute("dhxbox",1);var r="";if(i.width&&(o.style.width=i.width),i.height&&(o.style.height=i.height),i.title&&(r+='<div class="dhtmlx_popup_title">'+i.title+"</div>"),r+='<div class="dhtmlx_popup_text"><span>'+(i.content?"":i.text)+'</span></div><div  class="dhtmlx_popup_controls">',s){var a=i.ok||scheduler.locale.labels.message_ok;void 0===a&&(a="OK"),r+=n(a,!0,"ok")}if(l){var h=i.cancel||scheduler.locale.labels.message_cancel;void 0===h&&(h="Cancel"),r+=n(h,!1,"cancel")}if(i.buttons)for(var d=0;d<i.buttons.length;d++)r+=n(i.buttons[d],d);if(r+="</div>",o.innerHTML=r,i.content){var c=i.content;"string"==typeof c&&(c=document.getElementById(c)),"none"==c.style.display&&(c.style.display=""),o.childNodes[i.title?1:0].appendChild(c)}return o.onclick=function(t){var s=(t=t||event).target||t.srcElement;if(s.className||(s=s.parentNode),"dhtmlx_popup_button"==s.className.split(" ")[0]){var n=s.getAttribute("result");e(i,n="true"==n||"false"!=n&&n)}},i.box=o,(s||l)&&(t=i),o}(l,o,r);l.hidden||s(!0),document.body.appendChild(a);var h=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-a.offsetWidth)/2)),d=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-a.offsetHeight)/2));return"top"==l.position?a.style.top="-3px":a.style.top=d+"px",a.style.left=h+"px",a.onkeydown=i,a.focus(),l.hidden&&dhtmlx.modalbox.hide(a),a}function o(t){return l(t,!0,!1)}function r(t){return l(t,!0,!0)}function a(t){return l(t)}function h(t,e,i){return"object"!=typeof t&&("function"==typeof e&&(i=e,e=""),t={text:t,type:e,callback:i}),t}document.attachEvent?document.attachEvent("onkeydown",i):document.addEventListener("keydown",i,!0),dhtmlx.alert=function(){var t=h.apply(this,arguments);return t.type=t.type||"confirm",o(t)},dhtmlx.confirm=function(){var t=h.apply(this,arguments);return t.type=t.type||"alert",r(t)},dhtmlx.modalbox=function(){var t=h.apply(this,arguments);return t.type=t.type||"alert",a(t)},dhtmlx.modalbox.hide=function(t){for(;t&&t.getAttribute&&!t.getAttribute("dhxbox");)t=t.parentNode;t&&(t.parentNode.removeChild(t),s(!1))};var d=dhtmlx.message=function(t,e,i,s){switch((t=function(t,e,i,s){return"object"!=typeof t&&(t={text:t,type:e,expire:i,id:s}),t.id=t.id||d.uid(),t.expire=t.expire||d.expire,t}.apply(this,arguments)).type=t.type||"info",t.type.split("-")[0]){case"alert":return o(t);case"confirm":return r(t);case"modalbox":return a(t);default:return function(t){d.area||(d.area=document.createElement("DIV"),d.area.className="dhtmlx_message_area",d.area.style[d.position]="5px",document.body.appendChild(d.area)),d.hide(t.id);var e=document.createElement("DIV");return e.innerHTML="<div>"+t.text+"</div>",e.className="dhtmlx-info dhtmlx-"+t.type,e.onclick=function(){d.hide(t.id),t=null},"bottom"==d.position&&d.area.firstChild?d.area.insertBefore(e,d.area.firstChild):d.area.appendChild(e),t.expire>0&&(d.timers[t.id]=window.setTimeout(function(){d.hide(t.id)},t.expire)),d.pull[t.id]=e,e=null,t.id}(t)}};d.seed=(new Date).valueOf(),d.uid=function(){return d.seed++},d.expire=4e3,d.keyboard=!0,d.position="top",d.pull={},d.timers={},d.hideAll=function(){for(var t in d.pull)d.hide(t)},d.hide=function(t){var e=d.pull[t];e&&e.parentNode&&(window.setTimeout(function(){e.parentNode.removeChild(e),e=null},2e3),e.className+=" hidden",d.timers[t]&&window.clearTimeout(d.timers[t]),delete d.pull[t])}}(),dataProcessor.prototype={setTransactionMode:function(t,e){this._tMode=t,this._tSend=e,"REST"==t&&(this._tSend=!1,this._endnm=!0)},escape:function(t){return this._utf?encodeURIComponent(t):escape(t)},enableUTFencoding:function(t){this._utf=convertStringToBoolean(t)},setDataColumns:function(t){this._columns="string"==typeof t?t.split(","):t},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(t){this._endnm=convertStringToBoolean(t)},enablePartialDataSend:function(t){this._changed=convertStringToBoolean(t)},setUpdateMode:function(t,e){this.autoUpdate="cell"==t,this.updateMode=t,this.dnd=e},ignore:function(t,e){this._silent_mode=!0,t.call(e||window),this._silent_mode=!1},setUpdated:function(t,e,i){if(!this._silent_mode){var s=this.findRow(t);i=i||"updated";var n=this.obj.getUserData(t,this.action_param);n&&"updated"==i&&(i=n),e?(this.set_invalid(t,!1),this.updatedRows[s]=t,this.obj.setUserData(t,this.action_param,i),this._in_progress[t]&&(this._in_progress[t]="wait")):this.is_invalid(t)||(this.updatedRows.splice(s,1),this.obj.setUserData(t,this.action_param,"")),e||this._clearUpdateFlag(t),this.markRow(t,e,i),e&&this.autoUpdate&&this.sendData(t)}},_clearUpdateFlag:function(t){},markRow:function(t,e,i){var s="",n=this.is_invalid(t);if(n&&(s=this.styles[n],e=!0),this.callEvent("onRowMark",[t,e,i,n])&&(s=this.styles[e?i:"clear"]+s,this.obj[this._methods[0]](t,s),n&&n.details)){s+=this.styles[n+"_cell"];for(var l=0;l<n.details.length;l++)n.details[l]&&this.obj[this._methods[1]](t,l,s)}},getState:function(t){return this.obj.getUserData(t,this.action_param)},is_invalid:function(t){return this._invalid[t]},set_invalid:function(t,e,i){i&&(e={value:e,details:i,toString:function(){return this.value.toString()}}),this._invalid[t]=e},checkBeforeUpdate:function(t){return!0},sendData:function(t){if(!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2){if(this.obj.editStop&&this.obj.editStop(),void 0===t||this._tSend)return this.sendAllData();if(this._in_progress[t])return!1;if(this.messages=[],!this.checkBeforeUpdate(t)&&this.callEvent("onValidationError",[t,this.messages]))return!1;this._beforeSendData(this._getRowData(t),t)}},_beforeSendData:function(t,e){if(!this.callEvent("onBeforeUpdate",[e,this.getState(e),t]))return!1;this._sendData(t,e)},serialize:function(t,e){if("string"==typeof t)return t;if(void 0!==e)return this.serialize_one(t,"");var i=[],s=[];for(var n in t)t.hasOwnProperty(n)&&(i.push(this.serialize_one(t[n],n+this.post_delim)),s.push(n));return i.push("ids="+this.escape(s.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(t,e){if("string"==typeof t)return t;var i=[];for(var s in t)if(t.hasOwnProperty(s)){if(("id"==s||s==this.action_param)&&"REST"==this._tMode)continue;i.push(this.escape((e||"")+s)+"="+this.escape(t[s]))}return i.join("&")},_sendData:function(t,e){if(t){if(!this.callEvent("onBeforeDataSending",e?[e,this.getState(e),t]:[null,null,t]))return!1;e&&(this._in_progress[e]=(new Date).valueOf());var i=new dtmlXMLLoaderObject(function(i,s,n,l,o){var r=[];if(e)r.push(e);else if(t)for(var a in t)r.push(a);return i.afterUpdate(i,o,r)},this,!0),s=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode)i.loadXML(s+(-1!=s.indexOf("?")?"&":"?")+this.serialize(t,e));else if("POST"==this._tMode)i.loadXML(s,!0,this.serialize(t,e));else if("REST"==this._tMode){var n=this.getState(e),l=s.replace(/(\&|\?)editing\=true/,"");"inserted"==n?i.loadXML(l+e,"POST",this.serialize(t,e)):"deleted"==n?i.loadXML(l+e,"DELETE",""):i.loadXML(l+e,"PUT",this.serialize(t,e))}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var t=!0,e=0;e<this.updatedRows.length;e++)t&=this.checkBeforeUpdate(this.updatedRows[e]);if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(e=0;e<this.updatedRows.length;e++)if(!this._in_progress[this.updatedRows[e]]){if(this.is_invalid(this.updatedRows[e]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[e]),this.updatedRows[e]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(t){for(var e={},i=!1,s=0;s<this.updatedRows.length;s++){var n=this.updatedRows[s];this._in_progress[n]||this.is_invalid(n)||this.callEvent("onBeforeUpdate",[n,this.getState(n),this._getRowData(n)])&&(e[n]=this._getRowData(n,n+this.post_delim),i=!0,this._in_progress[n]=(new Date).valueOf())}return i?e:null},setVerificator:function(t,e){this.mandatoryFields[t]=e||function(t){return""!==t}},clearVerificator:function(t){this.mandatoryFields[t]=!1},findRow:function(t){var e=0;for(e=0;e<this.updatedRows.length&&t!=this.updatedRows[e];e++);return e},defineAction:function(t,e){this._uActions||(this._uActions=[]),this._uActions[t]=e},afterUpdateCallback:function(t,e,i,s){var n=t,l="error"!=i&&"invalid"!=i;if(l||this.set_invalid(t,i),this._uActions&&this._uActions[i]&&!this._uActions[i](s))return delete this._in_progress[n];"wait"!=this._in_progress[n]&&this.setUpdated(t,!1);var o=t;switch(i){case"inserted":case"insert":e!=t&&(this.obj[this._methods[2]](t,e),t=e);break;case"delete":case"deleted":return this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj[this._methods[3]](t,e),delete this._in_progress[n],this.callEvent("onAfterUpdate",[t,i,e,s])}"wait"!=this._in_progress[n]?(l&&this.obj.setUserData(t,this.action_param,""),delete this._in_progress[n]):(delete this._in_progress[n],this.setUpdated(e,!0,this.obj.getUserData(t,this.action_param))),this.callEvent("onAfterUpdate",[o,i,e,s])},afterUpdate:function(t,e,i){if(window.JSON)try{var s=JSON.parse(e.xmlDoc.responseText),n=s.action||this.getState(i)||"updated",l=s.sid||i[0],o=s.tid||i[0];return t.afterUpdateCallback(l,o,n,s),void t.finalizeUpdate()}catch(t){}if(e.getXMLTopNode("data"),!e.xmlDoc.responseXML)return this.obj&&this.obj.callEvent&&this.obj.callEvent("onSaveError",[i,e.xmlDoc]),this.cleanUpdate(i);var r=e.doXPath("//data/action");if(!r.length)return this.cleanUpdate(i);for(var a=0;a<r.length;a++){var h=r[a];n=h.getAttribute("type"),l=h.getAttribute("sid"),o=h.getAttribute("tid");t.afterUpdateCallback(l,o,n,h)}t.finalizeUpdate()},cleanUpdate:function(t){if(t)for(var e=0;e<t.length;e++)delete this._in_progress[t[e]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(t){this.obj=t,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(t){this.attachEvent("onAfterUpdate",t)},enableDebug:function(t){},setOnBeforeUpdateHandler:function(t){this.attachEvent("onBeforeDataSending",t)},setAutoUpdate:function(t,e){t=t||2e3,this._user=e||(new Date).valueOf(),this._need_update=!1,this._loader=null,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(t,e,i,s){this.afterAutoUpdate(t,e,i,s)}),this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},t)},afterAutoUpdate:function(t,e,i,s){return"collision"!=e||(this._need_update=!0,!1)},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(t,e){if(this._update_busy)return!1;this._update_busy=!0,this._loader=this._loader||new dtmlXMLLoaderObject(!0),this._loader.async=!0,this._loader.waitCall=e,this._loader.loadXML(t)},_v:function(t){return t.firstChild?t.firstChild.nodeValue:""},_a:function(t){for(var e=[],i=0;i<t.length;i++)e[i]=this._v(t[i]);return e},loadUpdate:function(){var t=this,e=this.obj.getUserData(0,"version"),i=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&");i=i.replace("editing=true&",""),this.getUpdates(i,function(){var e;try{e=t._loader.doXPath("//userdata")}catch(e){return void(t._update_busy=!1)}t.obj.setUserData(0,"version",t._v(e[0]));var i=t._loader.doXPath("//update");if(i.length){t._silent_mode=!0;for(var s=0;s<i.length;s++){var n=i[s].getAttribute("status"),l=i[s].getAttribute("id"),o=i[s].getAttribute("parent");switch(n){case"inserted":t.callEvent("insertCallback",[i[s],l,o]);break;case"updated":t.callEvent("updateCallback",[i[s],l,o]);break;case"deleted":t.callEvent("deleteCallback",[i[s],l,o])}}t._silent_mode=!1}t._update_busy=!1,t=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(t){this.init_original(t),t._dataprocessor=this,this.setTransactionMode("POST",!0),this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"}),dhtmlxError.catchError("LoadXML",function(t,e,i){var s=i[0].responseText;switch(scheduler.config.ajax_error){case"alert":window.alert(s);break;case"console":window.console.log(s)}}),window.Scheduler={_seed:0},Scheduler.plugin=function(t){this._schedulerPlugins.push(t),t(window.scheduler)},Scheduler._schedulerPlugins=[],Scheduler.getSchedulerInstance=function(){var scheduler={version:"4.3.25"},$,counter,methods;dhtmlxEventable(scheduler),scheduler._detachDomEvent=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i)},scheduler._init_once=function(){var t=e();function e(){return{w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight}}dhtmlxEvent(window,"resize",function(){var i,s,n=e();s=n,((i=t).w!=s.w||i.h!=s.h)&&(window.clearTimeout(scheduler._resize_timer),scheduler._resize_timer=window.setTimeout(function(){scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))},100)),t=n}),scheduler._init_once=function(){}},scheduler.init=function(t,e,i){e=e||scheduler._currentDate(),i=i||"week",this._obj&&this.unset_actions(),this._obj="string"==typeof t?document.getElementById(t):t,this._skin_init&&scheduler._skin_init(),scheduler.date.init(),this._els=[],this._scroll=!0,this._quirks=_isIE&&"BackCompat"==document.compatMode,this._quirks7=_isIE&&-1==navigator.appVersion.indexOf("MSIE 8"),this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),scheduler.callEvent("onSchedulerReady",[]),this.setCurrentView(e,i)},scheduler.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22},scheduler.keys={edit_save:13,edit_cancel:27},scheduler.set_sizes=function(){var t=this._x=this._obj.clientWidth-this.xy.margin_left,e=this._y=this._obj.clientHeight-this.xy.margin_top,i=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,s=this._table_view?-1:this.xy.scale_width;this.set_xy(this._els.dhx_cal_navline[0],t,this.xy.nav_height,0,0),this.set_xy(this._els.dhx_cal_header[0],t-i,this.xy.scale_height,s,this.xy.nav_height+(this._quirks?-1:1));var n=this._els.dhx_cal_navline[0].offsetHeight;n>0&&(this.xy.nav_height=n);var l=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],t,e-(l+2),0,l+2)},scheduler.set_xy=function(t,e,i,s,n){t.style.width=Math.max(0,e)+"px",t.style.height=Math.max(0,i)+"px",arguments.length>3&&(t.style.left=s+"px",t.style.top=n+"px")},scheduler.get_elements=function(){for(var t=this._obj.getElementsByTagName("DIV"),e=0;e<t.length;e++){var i=t[e].className||"",s=t[e].getAttribute("name")||"";i&&(i=i.split(" ")[0]),this._els[i]||(this._els[i]=[]),this._els[i].push(t[e]);var n=scheduler.locale.labels[s||i];"string"!=typeof n&&s&&!t[e].innerHTML&&(n=s.split("_")[0]),n&&(t[e].innerHTML=n)}},scheduler.unset_actions=function(){for(var t in this._els)if(this._click[t])for(var e=0;e<this._els[t].length;e++)this._els[t][e].onclick=null;this._obj.onselectstart=null,this._obj.onmousemove=null,this._obj.onmousedown=null,this._obj.onmouseup=null,this._obj.ondblclick=null,this._obj.oncontextmenu=null},scheduler.set_actions=function(){for(var t in this._els)if(this._click[t])for(var e=0;e<this._els[t].length;e++)this._els[t][e].onclick=scheduler._click[t];this._obj.onselectstart=function(t){return!1},this._obj.onmousemove=function(t){scheduler._temp_touch_block||scheduler._on_mouse_move(t||event)},this._obj.onmousedown=function(t){scheduler._ignore_next_click||scheduler._on_mouse_down(t||event)},this._obj.onmouseup=function(t){scheduler._ignore_next_click||scheduler._on_mouse_up(t||event)},this._obj.ondblclick=function(t){scheduler._on_dbl_click(t||event)},this._obj.oncontextmenu=function(t){var e=t||event,i=e.target||e.srcElement;return scheduler.callEvent("onContextMenu",[scheduler._locate_event(i),e])}},scheduler.select=function(t){this._select_id!=t&&(scheduler._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=t,this.updateEvent(t))},scheduler.unselect=function(t){if(!t||t==this._select_id){var e=this._select_id;this._select_id=null,e&&this.getEvent(e)&&this.updateEvent(e)}},scheduler.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}},scheduler._click={dhx_cal_data:function(t){if(scheduler._ignore_next_click)return t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,scheduler._ignore_next_click=!1,!1;var e=t?t.target:event.srcElement,i=scheduler._locate_event(e);if(t=t||event,i){if(!scheduler.callEvent("onClick",[i,t])||scheduler.config.readonly)return}else scheduler.callEvent("onEmptyClick",[scheduler.getActionData(t).date,t]);if(i&&scheduler.config.select){scheduler.select(i);var s=e.className;-1!=s.indexOf("_icon")&&scheduler._click.buttons[s.split(" ")[1].replace("icon_","")](i)}else scheduler._close_not_saved(),(new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler.unselect()},dhx_cal_prev_button:function(){scheduler._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(t,e){scheduler.setCurrentView(scheduler.date.add(scheduler.date[scheduler._mode+"_start"](scheduler._date),e||1,scheduler._mode))},dhx_cal_today_button:function(){scheduler.callEvent("onBeforeTodayDisplayed",[])&&scheduler.setCurrentView(scheduler._currentDate())},dhx_cal_tab:function(){var t=this.getAttribute("name"),e=t.substring(0,t.search("_tab"));scheduler.setCurrentView(scheduler._date,e)},buttons:{delete:function(t){var e=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(e,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(t)})},edit:function(t){scheduler.edit(t)},save:function(t){scheduler.editStop(!0)},details:function(t){scheduler.showLightbox(t)},cancel:function(t){scheduler.editStop(!1)}}},scheduler._dhtmlx_confirm=function(t,e,i){if(!t)return i();var s={text:t};e&&(s.title=e),i&&(s.callback=function(t){t&&i()}),dhtmlx.confirm(s)},scheduler.addEventNow=function(t,e,i){var s={};t&&null!==t.constructor.toString().match(/object/i)&&(s=t,t=null);var n=6e4*(this.config.event_duration||this.config.time_step);t||(t=s.start_date||Math.round(scheduler._currentDate().valueOf()/n)*n);var l=new Date(t);if(!e){var o=this.config.first_hour;o>l.getHours()&&(l.setHours(o),t=l.valueOf()),e=t.valueOf()+n}var r=new Date(e);l.valueOf()==r.valueOf()&&r.setTime(r.valueOf()+n),s.start_date=s.start_date||l,s.end_date=s.end_date||r,s.text=s.text||this.locale.labels.new_event,s.id=this._drag_id=s.id||this.uid(),this._drag_mode="new-size",this._loading=!0,this.addEvent(s),this.callEvent("onEventCreated",[this._drag_id,i]),this._loading=!1,this._drag_event={},this._on_mouse_up(i)},scheduler._on_dbl_click=function(t,e){if(e=e||t.target||t.srcElement,!this.config.readonly){var i=(e.className||"").split(" ")[0];switch(i){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!scheduler.config.dblclick_create)break;this.addEventNow(this.getActionData(t).date,null,t);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":var s=this._locate_event(e);if(!this.callEvent("onDblClick",[s,t]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(s)._timed||!this.config.select?this.showLightbox(s):this.edit(s);break;case"dhx_time_block":case"dhx_cal_container":return;default:var n=this["dblclick_"+i];if(n)n.call(this,t);else if(e.parentNode&&e!=this)return scheduler._on_dbl_click(t,e.parentNode)}}},scheduler._get_column_index=function(t){var e=0;if(this._cols){for(var i=0,s=0;s<this._cols.length&&!i;s++)i=this._cols[s];if(e=i?t/i:0,this._ignores)for(s=0;s<=e;s++)this._ignores[s]&&e++}return e},scheduler._week_indexes_from_pos=function(t){if(this._cols){var e=this._get_column_index(t.x);return t.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(e)-1)),t.y=Math.max(0,Math.ceil(60*t.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),t}return t},scheduler._mouse_coords=function(t){var e,i=document.body,s=document.documentElement;(e=_isIE||!t.pageX&&!t.pageY?{x:t.clientX+(i.scrollLeft||s.scrollLeft||0)-i.clientLeft,y:t.clientY+(i.scrollTop||s.scrollTop||0)-i.clientTop}:{x:t.pageX,y:t.pageY}).x-=getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),e.y-=getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,e.ev=t;var n=this["mouse_"+this._mode];if(n)e=n.call(this,e);else if(this._table_view){var l=this._get_column_index(e.x);if(!this._cols||!this._colsS)return e;var o=0;for(o=1;o<this._colsS.heights.length&&!(this._colsS.heights[o]>e.y);o++);e.y=Math.ceil(24*(Math.max(0,l)+7*Math.max(0,o-1))*60/this.config.time_step),(scheduler._drag_mode||"month"==this._mode)&&(e.y=24*(Math.max(0,Math.ceil(l)-1)+7*Math.max(0,o-1))*60/this.config.time_step),"move"==this._drag_mode&&scheduler._ignores_detected&&scheduler.config.preserve_length&&(e._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"}))),e.x=0}else e=this._week_indexes_from_pos(e);return e.timestamp=+new Date,e},scheduler._close_not_saved=function(){if((new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler._edit_id){var t=scheduler.locale.labels.confirm_closing;scheduler._dhtmlx_confirm(t,scheduler.locale.labels.title_confirm_closing,function(){scheduler.editStop(scheduler.config.positive_closing)}),t&&(this._drag_id=this._drag_pos=this._drag_mode=null)}},scheduler._correct_shift=function(t,e){return t-6e4*(new Date(scheduler._min_date).getTimezoneOffset()-new Date(t).getTimezoneOffset())*(e?-1:1)},scheduler._is_pos_changed=function(t,e){function i(t,e,i){return!!(Math.abs(t-e)>i)}if(!t||!this._drag_pos)return!0;return!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||e.timestamp-this._drag_pos.timestamp>100||i(t.ev.clientX,e.ev.clientX,5)||i(t.ev.clientY,e.ev.clientY,5))},scheduler._correct_drag_start_date=function(t){var e;scheduler.matrix&&(e=scheduler.matrix[scheduler._mode]),e=e||{x_step:1,x_unit:"day"},t=new Date(t);var i=1;return(e._start_correction||e._end_correction)&&(i=60*(e.last_hour||0)-(60*t.getHours()+t.getMinutes())||1),1*t+(scheduler._get_fictional_event_length(t,i,e)-i)},scheduler._correct_drag_end_date=function(t,e){var i;scheduler.matrix&&(i=scheduler.matrix[scheduler._mode]),i=i||{x_step:1,x_unit:"day"};var s=1*t+scheduler._get_fictional_event_length(t,e,i);return new Date(1*s-(scheduler._get_fictional_event_length(s,-1,i,-1)+1))},scheduler._on_mouse_move=function(t){if(this._drag_mode){var e=this._mouse_coords(t);if(this._is_pos_changed(this._drag_pos,e)){var i,s;if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;if(this._drag_pos=e,this._drag_pos.has_moved=!0,"create"==this._drag_mode){if(this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,i=this._get_date_from_pos(e).valueOf(),!this._drag_start)return this.callEvent("onBeforeEventCreated",[t,this._drag_id])?(this._loading=!1,void(this._drag_start=i)):void(this._loading=!1);s=i,this._drag_start;var n=new Date(this._drag_start),l=new Date(s);"day"!=this._mode&&"week"!=this._mode||n.getHours()!=l.getHours()||n.getMinutes()!=l.getMinutes()||(l=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(n,l,this.locale.labels.new_event,this._drag_id,e.fields),this.callEvent("onEventCreated",[this._drag_id,t]),this._loading=!1,this._drag_mode="new-size"}var o,r=this.getEvent(this._drag_id);if(scheduler.matrix&&(o=scheduler.matrix[scheduler._mode]),o=o||{x_step:1,x_unit:"day"},"move"==this._drag_mode)i=this._min_date.valueOf()+6e4*(e.y*this.config.time_step+24*e.x*60-(scheduler._move_pos_shift||0)),!e.custom&&this._table_view&&(i+=1e3*this.date.time_part(r.start_date)),i=this._correct_shift(i),e._ignores&&this.config.preserve_length&&this._table_view?(i=scheduler._correct_drag_start_date(i),s=scheduler._correct_drag_end_date(i,this._drag_event._event_length)):s=r.end_date.valueOf()-(r.start_date.valueOf()-i);else{if(i=r.start_date.valueOf(),s=r.end_date.valueOf(),this._table_view){var a=this._min_date.valueOf()+e.y*this.config.time_step*6e4+(e.custom?0:864e5);if("month"==this._mode)if(a=this._correct_shift(a,!1),this._drag_from_start){var h=864e5;a<=scheduler.date.date_part(new Date(s+h-1)).valueOf()&&(i=a-h)}else s=a;else e.resize_from_start?i=scheduler._correct_drag_start_date(a):s=scheduler._correct_drag_end_date(a,0)}else{var d=this.date.date_part(new Date(r.end_date.valueOf()-1)).valueOf(),c=new Date(d);s=d+e.y*this.config.time_step*6e4,s+=6e4*(new Date(s).getTimezoneOffset()-c.getTimezoneOffset()),this._els.dhx_cal_data[0].style.cursor="s-resize","week"!=this._mode&&"day"!=this._mode||(s=this._correct_shift(s))}if("new-size"==this._drag_mode)if(s<=this._drag_start){var _=e.shift||(this._table_view&&!e.custom?864e5:0);i=s-(e.shift?0:_),s=this._drag_start+(_||6e4*this.config.time_step)}else i=this._drag_start;else s<=i&&(s=i+6e4*this.config.time_step)}var u=new Date(s-1),f=new Date(i);if("move"==this._drag_mode&&scheduler.config.limit_drag_out&&(+f<+scheduler._min_date||+s>+scheduler._max_date)){if(+r.start_date<+scheduler._min_date||+r.end_date>+scheduler._max_date)f=new Date(r.start_date),s=new Date(r.end_date);else{var p=s-f;+f<+scheduler._min_date?(f=new Date(scheduler._min_date),e._ignores&&this.config.preserve_length&&this._table_view?(f=new Date(scheduler._correct_drag_start_date(f)),o._start_correction&&(f=new Date(f.valueOf()+o._start_correction)),s=new Date(1*f+this._get_fictional_event_length(f,this._drag_event._event_length,o))):s=new Date(+f+p)):(s=new Date(scheduler._max_date),e._ignores&&this.config.preserve_length&&this._table_view?(o._end_correction&&(s=new Date(s.valueOf()-o._end_correction)),s=new Date(1*s-this._get_fictional_event_length(s,0,o,!0)),f=new Date(1*s-this._get_fictional_event_length(s,this._drag_event._event_length,o,!0)),this._ignores_detected&&(f=scheduler.date.add(f,o.x_step,o.x_unit),s=new Date(1*s-this._get_fictional_event_length(s,0,o,!0)),s=scheduler.date.add(s,o.x_step,o.x_unit))):f=new Date(+s-p))}u=new Date(s-1)}if(!this._table_view&&!scheduler.config.all_timed&&(!scheduler._get_section_view()&&e.x!=this._get_event_sday({start_date:new Date(s),end_date:new Date(s)})||new Date(s).getHours()>=this.config.last_hour)){p=s-f,h=this._min_date.valueOf()+24*e.x*60*6e4;(s=scheduler.date.date_part(new Date(h))).setHours(this.config.last_hour),u=new Date(s-1),"move"==this._drag_mode&&(f=new Date(+s-p))}if(this._table_view||u.getDate()==f.getDate()&&u.getHours()<this.config.last_hour||scheduler._allow_dnd)if(r.start_date=f,r.end_date=new Date(s),this.config.update_render){var m=scheduler._els.dhx_cal_data[0].scrollTop;this.update_view(),scheduler._els.dhx_cal_data[0].scrollTop=m}else this.updateEvent(this._drag_id);this._table_view&&this.for_rendered(this._drag_id,function(t){t.className+=" dhx_in_move"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,t])}}else if(scheduler.checkEvent("onMouseMove")){var g=this._locate_event(t.target||t.srcElement);this.callEvent("onMouseMove",[g,t])}},scheduler._on_mouse_down=function(t,e){if(2!=t.button&&!this.config.readonly&&!this._drag_mode){var i=(e=e||t.target||t.srcElement).className&&e.className.split(" ")[0];switch(i){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",(e.className||"").indexOf("dhx_event_resize_end")<0?scheduler._drag_from_start=!0:scheduler._drag_from_start=!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(e.parentNode)return scheduler._on_mouse_down(t,e.parentNode);break;default:if((!scheduler.checkEvent("onMouseDown")||scheduler.callEvent("onMouseDown",[i]))&&e.parentNode&&e!=this&&"dhx_body"!=i)return scheduler._on_mouse_down(t,e.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var s=this._locate_event(e);if(this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[s,this._drag_mode,t])){if(this._drag_id=s,(this._edit_id!=this._drag_id||this._edit_id&&"create"==this._drag_mode)&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=scheduler._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(t)}else this._drag_mode=this._drag_id=0}this._drag_start=null}},scheduler._get_private_properties=function(t){var e={};for(var i in t)0===i.indexOf("_")&&(e[i]=!0);return e},scheduler._clear_temporary_properties=function(t,e){var i=this._get_private_properties(t),s=this._get_private_properties(e);for(var n in s)i[n]||delete e[n]},scheduler._on_mouse_up=function(t){if(!t||2!=t.button||!scheduler.config.touch){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var e=this._drag_id,i=this._drag_mode,s=!this._drag_pos||this._drag_pos.has_moved,n=this.getEvent(this._drag_id);if(s&&(this._drag_event._dhx_changed||!this._drag_event.start_date||n.start_date.valueOf()!=this._drag_event.start_date.valueOf()||n.end_date.valueOf()!=this._drag_event.end_date.valueOf())){var l="new-size"==this._drag_mode;if(this.callEvent("onBeforeEventChanged",[n,t,l,this._drag_event]))if(this._drag_id=this._drag_mode=null,l&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select)return scheduler.callEvent("onDragEnd",[e,i,t]),this.showLightbox(e);this._drag_pos=!0,this._select_id=this._edit_id=e}else this._new_event||this.callEvent(l?"onEventAdded":"onEventChanged",[e,this.getEvent(e)]);else l?this.deleteEvent(n.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(n,this._drag_event),scheduler._lame_copy(n,this._drag_event),this.updateEvent(n.id))}this._drag_pos&&(this._drag_pos.has_moved||!0===this._drag_pos)&&(this._drag_id=this._drag_mode=null,this.render_view_data()),scheduler.callEvent("onDragEnd",[e,i,t])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null}},scheduler._trigger_dyn_loading=function(){return!(!this._load_mode||!this._load())&&(this._render_wait=!0,!0)},scheduler.update_view=function(){var t=this[this._mode+"_view"];if(t?t(!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()},scheduler.isViewExists=function(t){return!!(scheduler[t+"_view"]||scheduler.date[t+"_start"]&&scheduler.templates[t+"_date"]&&scheduler.templates[t+"_scale_date"])},scheduler.updateView=function(t,e){t=t||this._date,e=e||this._mode;if(this._obj){this._mode?this._obj.className=this._obj.className.replace("dhx_scheduler_"+this._mode,"dhx_scheduler_"+e):this._obj.className+=" dhx_scheduler_"+e;var i=!(this._mode!=e||!this.config.preserve_scroll)&&this._els.dhx_cal_data[0].scrollTop;this[this._mode+"_view"]&&e&&this._mode!=e&&this[this._mode+"_view"](!1),this._close_not_saved();this._els.dhx_multi_day&&(this._els.dhx_multi_day[0].parentNode.removeChild(this._els.dhx_multi_day[0]),this._els.dhx_multi_day=null),this._mode=e,this._date=t,this._table_view="month"==this._mode,this._dy_shift=0;var s=this._els.dhx_cal_tab;if(s)for(var n=0;n<s.length;n++){var l=s[n].className;l=l.replace(/ active/g,""),s[n].getAttribute("name")==this._mode+"_tab"&&(l+=" active"),s[n].className=l}this.update_view(),"number"==typeof i&&(this._els.dhx_cal_data[0].scrollTop=i)}},scheduler.setCurrentView=function(t,e){this.callEvent("onBeforeViewChange",[this._mode,this._date,e||this._mode,t||this._date])&&(this.updateView(t,e),this.callEvent("onViewChange",[this._mode,this._date]))},scheduler._render_x_header=function(t,e,i,s,n){n=n||0;var l=document.createElement("DIV");l.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(l.className+=" "+this.templates[this._mode+"_scalex_class"](i));var o=this._cols[t]-1;"month"==this._mode&&0===t&&this.config.left_border&&(l.className+=" dhx_scale_bar_border",e+=1),this.set_xy(l,o,this.xy.scale_height-2,e,n),l.innerHTML=this.templates[this._mode+"_scale_date"](i,this._mode),s.appendChild(l)},scheduler._get_columns_num=function(t,e){var i=7;if(!scheduler._table_view){var s=scheduler.date["get_"+scheduler._mode+"_end"];s&&(e=s(t)),i=Math.round((e.valueOf()-t.valueOf())/864e5)}return i},scheduler._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},scheduler._get_view_end=function(){var t=this._get_timeunit_start(),e=scheduler.date.add(t,1,this._mode);if(!scheduler._table_view){var i=scheduler.date["get_"+scheduler._mode+"_end"];i&&(e=i(t))}return e},scheduler._calc_scale_sizes=function(t,e,i){var s=t,n=this._get_columns_num(e,i);this._process_ignores(e,n,"day",1);for(var l=n-this._ignores_detected,o=0;o<n;o++)this._ignores[o]?(this._cols[o]=0,l++):this._cols[o]=Math.floor(s/(l-o)),s-=this._cols[o],this._colsS[o]=(this._cols[o-1]||0)+(this._colsS[o-1]||(this._table_view?0:this.xy.scale_width+2));this._colsS.col_length=n,this._colsS[n]=this._cols[n-1]+this._colsS[n-1]||0},scheduler._set_scale_col_size=function(t,e,i){var s=this.config;this.set_xy(t,e-1,s.hour_size_px*(s.last_hour-s.first_hour),i+this.xy.scale_width+1,0)},scheduler._render_scales=function(t,e){var i=new Date(scheduler._min_date),s=new Date(scheduler._max_date),n=this.date.date_part(scheduler._currentDate()),l=parseInt(t.style.width,10),o=new Date(this._min_date),r=this._get_columns_num(i,s);this._calc_scale_sizes(l,i,s);var a=0;t.innerHTML="";for(var h=0;h<r;h++){if(this._ignores[h]||this._render_x_header(h,a,o,t),!this._table_view){var d=document.createElement("DIV"),c="dhx_scale_holder";o.valueOf()==n.valueOf()&&(c="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[h]&&(c+=" dhx_scale_ignore"),d.className=c+" "+this.templates.week_date_class(o,n),this._set_scale_col_size(d,this._cols[h],a),e.appendChild(d),this.callEvent("onScaleAdd",[d,o])}a+=this._cols[h],o=this.date.add(o,1,"day"),o=this.date.day_start(o)}},scheduler._reset_scale=function(){if(this.templates[this._mode+"_date"]){var t=this._els.dhx_cal_header[0],e=this._els.dhx_cal_data[0],i=this.config;t.innerHTML="",e.innerHTML="";var s,n,l=(i.readonly||!i.drag_resize?" dhx_resize_denied":"")+(i.readonly||!i.drag_move?" dhx_move_denied":"");e.className="dhx_cal_data"+l,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes();var o=this._get_timeunit_start(),r=scheduler._get_view_end();if(s=n=this._table_view?scheduler.date.week_start(o):o,this._min_date=s,this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](o,r,this._mode),this._max_date=r,scheduler._render_scales(t,e),this._table_view)this._reset_month_scale(e,o,n);else if(this._reset_hours_scale(e,o,n),i.multi_day){this._els.dhx_multi_day&&(this._els.dhx_multi_day[0].parentNode.removeChild(this._els.dhx_multi_day[0]),this._els.dhx_multi_day=null);var a=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,h=document.createElement("DIV");h.className="dhx_multi_day",h.style.visibility="hidden",this.set_xy(h,Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width-2,0),0,0,a),e.parentNode.insertBefore(h,e);var d=h.cloneNode(!0);d.className="dhx_multi_day_icon",d.style.visibility="hidden",this.set_xy(d,this.xy.scale_width,0,0,a),h.appendChild(d),this._els.dhx_multi_day=[h,d],this._els.dhx_multi_day[0].onclick=this._click.dhx_cal_data}}},scheduler._reset_hours_scale=function(t,e,i){var s=document.createElement("DIV");s.className="dhx_scale_holder";for(var n=new Date(1980,1,1,this.config.first_hour,0,0),l=1*this.config.first_hour;l<this.config.last_hour;l++){var o=document.createElement("DIV");o.className="dhx_scale_hour",o.style.height=this.config.hour_size_px-(this._quirks?0:1)+"px";var r=this.xy.scale_width;this.config.left_border&&(r-=1,o.className+=" dhx_scale_hour_border"),o.style.width=r+"px",o.innerHTML=scheduler.templates.hour_scale(n),s.appendChild(o),n=this.date.add(n,1,"hour")}t.appendChild(s),this.config.scroll_hour&&(t.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},scheduler._currentDate=function(){return scheduler.config.now_date?new Date(scheduler.config.now_date):new Date},scheduler._process_ignores=function(t,e,i,s,n){this._ignores={},this._ignores_detected=0;var l=scheduler["ignore_"+this._mode];if(l)for(var o=new Date(t),r=0;r<e;r++)l(o)&&(this._ignores_detected+=1,this._ignores[r]=!0,n&&e++),o=scheduler.date.add(o,s,i),scheduler.date[i+"_start"]&&(o=scheduler.date[i+"_start"](o))},scheduler._render_month_scale=function(t,e,i){var s=scheduler.date.add(e,1,"month"),n=new Date(i),l=scheduler._currentDate();this.date.date_part(l),this.date.date_part(i);for(var o=Math.ceil(Math.round((s.valueOf()-i.valueOf())/864e5)/7),r=[],a=0;a<=7;a++){var h=(this._cols[a]||0)-1;0===a&&this.config.left_border&&(h-=1),r[a]=h+"px"}function d(t){var e=scheduler._colsS.height;return void 0!==scheduler._colsS.heights[t+1]&&(e=scheduler._colsS.heights[t+1]-(scheduler._colsS.heights[t]||0)),e}var c=0,_=document.createElement("table");_.setAttribute("cellpadding","0"),_.setAttribute("cellspacing","0");var u=document.createElement("tbody");_.appendChild(u);var f=[];for(a=0;a<o;a++){var p=document.createElement("tr");u.appendChild(p);for(var m=Math.max(d(a)-scheduler.xy.month_head_height,0),g=0;g<7;g++){var v=document.createElement("td");p.appendChild(v);var b="";i<e?b="dhx_before":i>=s?b="dhx_after":i.valueOf()==l.valueOf()&&(b="dhx_now"),this._ignores_detected&&this._ignores[g]&&(b+=" dhx_scale_ignore"),v.className=b+" "+this.templates.month_date_class(i,l);var x="dhx_month_body",w="dhx_month_head";if(0===g&&this.config.left_border&&(x+=" dhx_month_body_border",w+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[g])v.appendChild(document.createElement("div")),v.appendChild(document.createElement("div"));else{var y=document.createElement("DIV");y.className=w,y.innerHTML=this.templates.month_day(i),v.appendChild(y);var C=document.createElement("DIV");C.className=x,C.style.height=m+"px",C.style.width=r[g],v.appendChild(C)}f.push(i);var N=i.getDate();(i=this.date.add(i,1,"day")).getDate()-N>1&&(i=new Date(i.getFullYear(),i.getMonth(),N+1,12,0))}scheduler._colsS.heights[a]=c,c+=d(a)}this._min_date=n,this._max_date=i,t.innerHTML="",t.appendChild(_),this._scales={};var k=t.getElementsByTagName("div");for(a=0;a<f.length;a++){t=k[2*a+1];var j=f[a];this._scales[+j]=t}for(a=0;a<f.length;a++){j=f[a];this.callEvent("onScaleAdd",[this._scales[+j],j])}return this._max_date},scheduler._reset_month_scale=function(t,e,i){var s=scheduler.date.add(e,1,"month"),n=scheduler._currentDate();this.date.date_part(n),this.date.date_part(i);var l=Math.ceil(Math.round((s.valueOf()-i.valueOf())/864e5)/7),o=Math.floor(t.clientHeight/l)-this.xy.month_head_height;return this._colsS.height=o+this.xy.month_head_height,this._colsS.heights=[],scheduler._render_month_scale(t,e,i)},scheduler.getLabel=function(t,e){for(var i=this.config.lightbox.sections,s=0;s<i.length;s++)if(i[s].map_to==t)for(var n=i[s].options,l=0;l<n.length;l++)if(n[l].key==e)return n[l].label;return""},scheduler.updateCollection=function(t,e){var i=scheduler.serverList(t);return!!i&&(i.splice(0,i.length),i.push.apply(i,e||[]),scheduler.callEvent("onOptionsLoad",[]),scheduler.resetLightbox(),!0)},scheduler._lame_clone=function(t,e){var i,s,n;for(e=e||[],i=0;i<e.length;i+=2)if(t===e[i])return e[i+1];if(t&&"object"==typeof t){for(n={},s=[Array,Date,Number,String,Boolean],i=0;i<s.length;i++)t instanceof s[i]&&(n=i?new s[i](t):new s[i]);for(i in e.push(t,n),t)Object.prototype.hasOwnProperty.apply(t,[i])&&(n[i]=scheduler._lame_clone(t[i],e))}return n||t},scheduler._lame_copy=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},scheduler._get_date_from_pos=function(t){var e=this._min_date.valueOf()+6e4*(t.y*this.config.time_step+24*(this._table_view?0:t.x)*60);return new Date(this._correct_shift(e))},scheduler.getActionData=function(t){var e=this._mouse_coords(t);return{date:this._get_date_from_pos(e),section:e.section}},scheduler._focus=function(t,e){t&&t.focus&&(this.config.touch?window.setTimeout(function(){t.focus()},100):(e&&t.select&&t.select(),t.focus()))},scheduler._get_real_event_length=function(t,e,i){var s,n=e-t,l=i._start_correction+i._end_correction||0,o=this["ignore_"+this._mode],r=0;i.render?(r=this._get_date_index(i,t),s=this._get_date_index(i,e)):s=Math.round(n/60/60/1e3/24);for(var a=!0;r<s;){var h=scheduler.date.add(e,-i.x_step,i.x_unit);o&&o(e)&&(!a||a&&o(h))?n-=e-h:(a=!1,n-=l),e=h,s--}return n},scheduler._get_fictional_event_length=function(t,e,i,s){var n=new Date(t),l=s?-1:1;if(i._start_correction||i._end_correction){var o;o=s?60*n.getHours()+n.getMinutes()-60*(i.first_hour||0):60*(i.last_hour||0)-(60*n.getHours()+n.getMinutes());var r=60*(i.last_hour-i.first_hour),a=Math.ceil((e/6e4-o)/r);a<0&&(a=0),e+=a*(1440-r)*60*1e3}var h,d=new Date(1*t+e*l),c=this["ignore_"+this._mode],_=0;for(i.render?(_=this._get_date_index(i,n),h=this._get_date_index(i,d)):h=Math.round(e/60/60/1e3/24);_*l<=h*l;){var u=scheduler.date.add(n,i.x_step*l,i.x_unit);c&&c(n)&&(e+=(u-n)*l,h+=l),n=u,_+=l}return e},scheduler._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null},scheduler._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},scheduler._is_initialized=function(){var t=this.getState();return this._obj&&t.date&&t.mode},scheduler._is_lightbox_open=function(){var t=this.getState();return null!==t.lightbox_id&&void 0!==t.lightbox_id},scheduler.date={init:function(){for(var t=scheduler.locale.date.month_short,e=scheduler.locale.date.month_short_hash={},i=0;i<t.length;i++)e[t[i]]=i;for(t=scheduler.locale.date.month_full,e=scheduler.locale.date.month_full_hash={},i=0;i<t.length;i++)e[t[i]]=i},_bind_host_object:function(t){return t.bind?t.bind(scheduler):function(){return t.apply(scheduler,arguments)}},date_part:function(t){var e=new Date(t);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getHours()&&(t.getDate()<e.getDate()||t.getMonth()<e.getMonth()||t.getFullYear()<e.getFullYear())&&t.setTime(t.getTime()+36e5*(24-t.getHours())),t},time_part:function(t){return(t.valueOf()/1e3-60*t.getTimezoneOffset())%86400},week_start:function(t){var e=t.getDay();return scheduler.config.start_on_monday&&(0===e?e=6:e--),this.date_part(this.add(t,-1*e,"day"))},month_start:function(t){return t.setDate(1),this.date_part(t)},year_start:function(t){return t.setMonth(0),this.month_start(t)},day_start:function(t){return this.date_part(t)},_add_days:function(t,e){var i=new Date(t.valueOf());if(i.setDate(i.getDate()+e),e==Math.round(e)&&e>0){var s=(+i-+t)%864e5;if(s&&t.getTimezoneOffset()==i.getTimezoneOffset()){var n=s/36e5;i.setTime(i.getTime()+60*(24-n)*60*1e3)}}return e>=0&&!t.getHours()&&i.getHours()&&(i.getDate()<t.getDate()||i.getMonth()<t.getMonth()||i.getFullYear()<t.getFullYear())&&i.setTime(i.getTime()+36e5*(24-i.getHours())),i},add:function(t,e,i){var s=new Date(t.valueOf());switch(i){case"day":s=scheduler.date._add_days(s,e);break;case"week":s=scheduler.date._add_days(s,7*e);break;case"month":s.setMonth(s.getMonth()+e);break;case"year":s.setYear(s.getFullYear()+e);break;case"hour":s.setTime(s.getTime()+60*e*60*1e3);break;case"minute":s.setTime(s.getTime()+60*e*1e3);break;default:return scheduler.date["add_"+i](t,e,i)}return s},to_fixed:function(t){return t<10?"0"+t:t},copy:function(t){return new Date(t.valueOf())},date_to_str:function(t,e){t=t.replace(/%[a-zA-Z]/g,function(t){switch(t){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';default:return t}}),e&&(t=t.replace(/date\.get/g,"date.getUTC"));var i=new Function("date",'return "'+t+'";');return scheduler.date._bind_host_object(i)},str_to_date:function(t,e){for(var i="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",s=t.match(/%[a-zA-Z]/g),n=0;n<s.length;n++)switch(s[n]){case"%j":case"%d":i+="set[2]=temp["+n+"]||1;";break;case"%n":case"%m":i+="set[1]=(temp["+n+"]||1)-1;";break;case"%y":i+="set[0]=temp["+n+"]*1+(temp["+n+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":i+="set[3]=temp["+n+"]||0;";break;case"%i":i+="set[4]=temp["+n+"]||0;";break;case"%Y":i+="set[0]=temp["+n+"]||0;";break;case"%a":case"%A":i+="set[3]=set[3]%12+((temp["+n+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":i+="set[5]=temp["+n+"]||0;";break;case"%M":i+="set[1]=this.locale.date.month_short_hash[temp["+n+"]]||0;";break;case"%F":i+="set[1]=this.locale.date.month_full_hash[temp["+n+"]]||0;"}var l="set[0],set[1],set[2],set[3],set[4],set[5]";e&&(l=" Date.UTC("+l+")");var o=new Function("date","var set=[0,0,1,0,0,0]; "+i+" return new Date("+l+");");return scheduler.date._bind_host_object(o)},getISOWeek:function(t){if(!t)return!1;var e=t.getDay();0===e&&(e=7);var i=new Date(t.valueOf());i.setDate(t.getDate()+(4-e));var s=i.getFullYear(),n=Math.round((i.getTime()-new Date(s,0,1).getTime())/864e5);return 1+Math.floor(n/7)},getUTCISOWeek:function(t){return this.getISOWeek(this.convert_to_utc(t))},convert_to_utc:function(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}},scheduler.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel"}},scheduler.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",height:200,map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!1},scheduler.templates={},scheduler.init_templates=function(){var t=scheduler.locale.labels;t.dhx_save_btn=t.icon_save,t.dhx_cancel_btn=t.icon_cancel,t.dhx_delete_btn=t.icon_delete;var e=scheduler.date.date_to_str,i=scheduler.config;!function(t,e){for(var i in e)t[i]||(t[i]=e[i])}(scheduler.templates,{day_date:e(i.default_date),month_date:e(i.month_date),week_date:function(t,e){return scheduler.templates.day_date(t)+" &ndash; "+scheduler.templates.day_date(scheduler.date.add(e,-1,"day"))},day_scale_date:e(i.default_date),month_scale_date:e(i.week_date),week_scale_date:e(i.day_date),hour_scale:e(i.hour_date),time_picker:e(i.hour_date),event_date:e(i.hour_date),month_day:e(i.month_day),xml_date:scheduler.date.str_to_date(i.xml_date,i.server_utc),load_format:e(i.load_date,i.server_utc),xml_format:e(i.xml_date,i.server_utc),api_date:scheduler.date.str_to_date(i.api_date),event_header:function(t,e,i){return scheduler.templates.event_date(t)+" - "+scheduler.templates.event_date(e)},event_text:function(t,e,i){return i.text},event_class:function(t,e,i){return""},month_date_class:function(t){return""},week_date_class:function(t){return""},event_bar_date:function(t,e,i){return scheduler.templates.event_date(t)+" "},event_bar_text:function(t,e,i){return i.text},month_events_link:function(t,e){return"<a>View more("+e+" events)</a>"},drag_marker_class:function(t,e,i){return""},drag_marker_content:function(t,e,i){return""}}),this.callEvent("onTemplatesReady",[])},scheduler.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++},scheduler._events={},scheduler.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this.clear_view(),this.callEvent("onClearAll",[])},scheduler.addEvent=function(t,e,i,s,n){if(!arguments.length)return this.addEventNow();var l=t;1!=arguments.length&&((l=n||{}).start_date=t,l.end_date=e,l.text=i,l.id=s),l.id=l.id||scheduler.uid(),l.text=l.text||"","string"==typeof l.start_date&&(l.start_date=this.templates.api_date(l.start_date)),"string"==typeof l.end_date&&(l.end_date=this.templates.api_date(l.end_date));var o=6e4*(this.config.event_duration||this.config.time_step);l.start_date.valueOf()==l.end_date.valueOf()&&l.end_date.setTime(l.end_date.valueOf()+o),l._timed=this.isOneDayEvent(l);var r=!this._events[l.id];return this._events[l.id]=l,this.event_updated(l),this._loading||this.callEvent(r?"onEventAdded":"onEventChanged",[l.id,l]),l.id},scheduler.deleteEvent=function(t,e){var i=this._events[t];(e||this.callEvent("onBeforeEventDelete",[t,i])&&this.callEvent("onConfirmedBeforeEventDelete",[t,i]))&&(i&&(this._select_id=null,delete this._events[t],this.event_updated(i)),this.callEvent("onEventDeleted",[t,i]))},scheduler.getEvent=function(t){return this._events[t]},scheduler.setEvent=function(t,e){e.id||(e.id=t),this._events[t]=e},scheduler.for_rendered=function(t,e){for(var i=this._rendered.length-1;i>=0;i--)this._rendered[i].getAttribute("event_id")==t&&e(this._rendered[i],i)},scheduler.changeEventId=function(t,e){if(t!=e){var i=this._events[t];i&&(i.id=e,this._events[e]=i,delete this._events[t]),this.for_rendered(t,function(t){t.setAttribute("event_id",e)}),this._select_id==t&&(this._select_id=e),this._edit_id==t&&(this._edit_id=e),this.callEvent("onEventIdChange",[t,e])}},function(){for(var t=["text","Text","start_date","StartDate","end_date","EndDate"],e=function(t){return function(e){return scheduler.getEvent(e)[t]}},i=function(t){return function(e,i){var s=scheduler.getEvent(e);s[t]=i,s._changed=!0,s._timed=this.isOneDayEvent(s),scheduler.event_updated(s,!0)}},s=0;s<t.length;s+=2)scheduler["getEvent"+t[s+1]]=e(t[s]),scheduler["setEvent"+t[s+1]]=i(t[s])}(),scheduler.event_updated=function(t,e){this.is_visible_events(t)?this.render_view_data():this.clear_event(t.id)},scheduler.is_visible_events=function(t){if(t.start_date<this._max_date&&this._min_date<t.end_date){var e=t.start_date.getHours(),i=t.end_date.getHours()+t.end_date.getMinutes()/60,s=this.config.last_hour,n=this.config.first_hour;return!!(this._table_view||!((i>s||i<n)&&(e>=s||e<n)))||!!((t.end_date.valueOf()-t.start_date.valueOf())/36e5>24-(this.config.last_hour-this.config.first_hour)||e<s&&i>=n)}return!1},scheduler.isOneDayEvent=function(t){var e=t.end_date.getDate()-t.start_date.getDate();return e?(e<0&&(e=Math.ceil((t.end_date.valueOf()-t.start_date.valueOf())/864e5)),1==e&&!t.end_date.getHours()&&!t.end_date.getMinutes()&&(t.start_date.getHours()||t.start_date.getMinutes())):t.start_date.getMonth()==t.end_date.getMonth()&&t.start_date.getFullYear()==t.end_date.getFullYear()},scheduler.get_visible_events=function(t){var e=[];for(var i in this._events)this.is_visible_events(this._events[i])&&(t&&!this._events[i]._timed||this.filter_event(i,this._events[i])&&e.push(this._events[i]));return e},scheduler.filter_event=function(t,e){var i=this["filter_"+this._mode];return!i||i(t,e)},scheduler._is_main_area_event=function(t){return!!t._timed},scheduler.render_view_data=function(t,e){if(!t){if(this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),t=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var i=0,s=t.length;i<s;i++)this._recalculate_timed(t[i]);if(this.config.multi_day&&!this._table_view){var n=[],l=[];for(i=0;i<t.length;i++)this._is_main_area_event(t[i])?n.push(t[i]):l.push(t[i]);this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(l,e),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(n,e)}else this._rendered_location=this._els.dhx_cal_data[0],this.render_data(t,e)},scheduler._view_month_day=function(t){var e=scheduler.getActionData(t).date;scheduler.callEvent("onViewMoreClick",[e])&&scheduler.setCurrentView(e,"day")},scheduler._render_month_link=function(t){for(var e=this._rendered_location,i=this._lame_clone(t),s=t._sday;s<t._eday;s++){i._sday=s,i._eday=s+1;var n=scheduler.date,l=scheduler._min_date;l=n.add(l,i._sweek,"week"),l=n.add(l,i._sday,"day");var o=scheduler.getEvents(l,n.add(l,1,"day")).length,r=this._get_event_bar_pos(i),a=r.x2-r.x,h=document.createElement("div");h.onclick=function(t){scheduler._view_month_day(t||event)},h.className="dhx_month_link",h.style.top=r.y+"px",h.style.left=r.x+"px",h.style.width=a+"px",h.innerHTML=scheduler.templates.month_events_link(l,o),this._rendered.push(h),e.appendChild(h)}},scheduler._recalculate_timed=function(t){var e;t&&((e="object"!=typeof t?this._events[t]:t)&&(e._timed=scheduler.isOneDayEvent(e)))},scheduler.attachEvent("onEventChanged",scheduler._recalculate_timed),scheduler.attachEvent("onEventAdded",scheduler._recalculate_timed),scheduler.render_data=function(t,e){t=this._pre_render_events(t,e);for(var i=0;i<t.length;i++)if(this._table_view)if("month"!=scheduler._mode)this.render_event_bar(t[i]);else{var s=scheduler.config.max_month_events;s!==1*s||t[i]._sorder<s?this.render_event_bar(t[i]):void 0!==s&&t[i]._sorder==s&&scheduler._render_month_link(t[i])}else this.render_event(t[i])},scheduler._get_first_visible_cell=function(t){for(var e=0;e<t.length;e++)if(-1==(t[e].className||"").indexOf("dhx_scale_ignore"))return t[e];return t[0]},scheduler._pre_render_events=function(t,e){var i=this.xy.bar_height,s=this._colsS.heights,n=this._colsS.heights=[0,0,0,0,0,0,0],l=this._els.dhx_cal_data[0];if(t=this._table_view?this._pre_render_events_table(t,e):this._pre_render_events_line(t,e),this._table_view)if(e)this._colsS.heights=s;else{var o=l.firstChild;if(o.rows){for(var r=0;r<o.rows.length;r++){n[r]++;var a=o.rows[r].cells,h=this._colsS.height-this.xy.month_head_height;if(n[r]*i>h){var d=h;1*this.config.max_month_events!==this.config.max_month_events||n[r]<=this.config.max_month_events?d=n[r]*i:(this.config.max_month_events+1)*i>h&&(d=(this.config.max_month_events+1)*i);for(var c=0;c<a.length;c++)a[c].childNodes[1].style.height=d+"px"}n[r]=(n[r-1]||0)+scheduler._get_first_visible_cell(a).offsetHeight}if(n.unshift(0),o.parentNode.offsetHeight<o.parentNode.scrollHeight&&!scheduler._colsS.scroll_fix&&scheduler.xy.scroll_width){var _=scheduler._colsS,u=_[_.col_length],f=_.heights.slice();u-=scheduler.xy.scroll_width||0,this._calc_scale_sizes(u,this._min_date,this._max_date),scheduler._colsS.heights=f,this.set_xy(this._els.dhx_cal_header[0],u,this.xy.scale_height),scheduler._render_scales(this._els.dhx_cal_header[0]),scheduler._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),_.scroll_fix=!0}}else if(t.length||"visible"!=this._els.dhx_multi_day[0].style.visibility||(n[0]=-1),t.length||-1==n[0]){o.parentNode.childNodes;var p=(n[0]+1)*i+1,m=p,g=p+"px";this.config.multi_day_height_limit&&(g=(m=Math.min(p,this.config.multi_day_height_limit))+"px"),l.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+m+"px",l.style.height=this._obj.offsetHeight-parseInt(l.style.top,10)-(this.xy.margin_top||0)+"px";var v=this._els.dhx_multi_day[0];v.style.height=g,v.style.visibility=-1==n[0]?"hidden":"visible";var b=this._els.dhx_multi_day[1];b.style.height=g,b.style.visibility=-1==n[0]?"hidden":"visible",b.className=n[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(n[0]+1)*i,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),n[0]=0,m!=p&&(l.style.top=parseInt(l.style.top)+2+"px",v.style.overflowY="auto",b.style.position="fixed",b.style.top="",b.style.left="")}}return t},scheduler._get_event_sday=function(t){return Math.floor((t.start_date.valueOf()-this._min_date.valueOf())/864e5)},scheduler._get_event_mapped_end_date=function(t){var e=t.end_date;if(this.config.separate_short_events){var i=(t.end_date-t.start_date)/6e4;i<this._min_mapped_duration&&(e=this.date.add(e,this._min_mapped_duration-i,"minute"))}return e},scheduler._pre_render_events_line=function(t,e){t.sort(this.sort||function(t,e){return t.start_date.valueOf()==e.start_date.valueOf()?t.id>e.id?1:-1:t.start_date>e.start_date?1:-1});var i=[],s=[];this._min_mapped_duration=Math.ceil(60*this.xy.min_event_height/this.config.hour_size_px);for(var n=0;n<t.length;n++){var l=t[n],o=l.start_date,r=l.end_date,a=o.getHours(),h=r.getHours();if(l._sday=this._get_event_sday(l),this._ignores[l._sday])t.splice(n,1),n--;else{if(i[l._sday]||(i[l._sday]=[]),!e){l._inner=!1;for(var d=i[l._sday];d.length;){var c=d[d.length-1];if(!(this._get_event_mapped_end_date(c).valueOf()<=l.start_date.valueOf()))break;d.splice(d.length-1,1)}for(var _=d.length,u=!1,f=0;f<d.length;f++){c=d[f];if(this._get_event_mapped_end_date(c).valueOf()<=l.start_date.valueOf()){u=!0,l._sorder=c._sorder,_=f,l._inner=!0;break}}if(d.length&&(d[d.length-1]._inner=!0),!u)if(d.length)if(d.length<=d[d.length-1]._sorder){if(d[d.length-1]._sorder)for(f=0;f<d.length;f++){for(var p=!1,m=0;m<d.length;m++)if(d[m]._sorder==f){p=!0;break}if(!p){l._sorder=f;break}}else l._sorder=0;l._inner=!0}else{var g=d[0]._sorder;for(f=1;f<d.length;f++)d[f]._sorder>g&&(g=d[f]._sorder);l._sorder=g+1,l._inner=!1}else l._sorder=0;d.splice(_,_==d.length?0:1,l),d.length>(d.max_count||0)?(d.max_count=d.length,l._count=d.length):l._count=l._count?l._count:1}(a<this.config.first_hour||h>=this.config.last_hour)&&(s.push(l),t[n]=l=this._copy_event(l),a<this.config.first_hour&&(l.start_date.setHours(this.config.first_hour),l.start_date.setMinutes(0)),h>=this.config.last_hour&&(l.end_date.setMinutes(0),l.end_date.setHours(this.config.last_hour)),l.start_date>l.end_date||a==this.config.last_hour)&&(t.splice(n,1),n--)}}if(!e){for(n=0;n<t.length;n++)t[n]._count=i[t[n]._sday].max_count;for(n=0;n<s.length;n++)s[n]._count=i[s[n]._sday].max_count}return t},scheduler._time_order=function(t){t.sort(function(t,e){return t.start_date.valueOf()==e.start_date.valueOf()?t._timed&&!e._timed?1:!t._timed&&e._timed?-1:t.id>e.id?1:-1:t.start_date>e.start_date?1:-1})},scheduler._pre_render_events_table=function(t,e){this._time_order(t);for(var i,s=[],n=[[],[],[],[],[],[],[]],l=this._colsS.heights,o=this._cols.length,r={},a=0;a<t.length;a++){var h=t[a],d=h.id;r[d]||(r[d]={first_chunk:!0,last_chunk:!0});var c=r[d],_=i||h.start_date,u=h.end_date;_<this._min_date&&(c.first_chunk=!1,_=this._min_date),u>this._max_date&&(c.last_chunk=!1,u=this._max_date);var f=this.locate_holder_day(_,!1,h);if(h._sday=f%o,!this._ignores[h._sday]||!h._timed){var p=this.locate_holder_day(u,!0,h)||o;h._eday=p%o||o,h._length=p-f,h._sweek=Math.floor((this._correct_shift(_.valueOf(),1)-this._min_date.valueOf())/(864e5*o));var m,g=n[h._sweek];for(m=0;m<g.length&&!(g[m]._eday<=h._sday);m++);if(h._sorder&&e||(h._sorder=m),h._sday+h._length<=o)i=null,s.push(h),g[m]=h,l[h._sweek]=g.length-1,h._first_chunk=c.first_chunk,h._last_chunk=c.last_chunk;else{var v=this._copy_event(h);v.id=h.id,v._length=o-h._sday,v._eday=o,v._sday=h._sday,v._sweek=h._sweek,v._sorder=h._sorder,v.end_date=this.date.add(_,v._length,"day"),v._first_chunk=c.first_chunk,c.first_chunk&&(c.first_chunk=!1),s.push(v),g[m]=v,i=v.end_date,l[h._sweek]=g.length-1,a--}}}return s},scheduler._copy_dummy=function(){var t=new Date(this.start_date),e=new Date(this.end_date);this.start_date=t,this.end_date=e},scheduler._copy_event=function(t){return this._copy_dummy.prototype=t,new this._copy_dummy},scheduler._rendered=[],scheduler.clear_view=function(){for(var t=0;t<this._rendered.length;t++){var e=this._rendered[t];e.parentNode&&e.parentNode.removeChild(e)}this._rendered=[]},scheduler.updateEvent=function(t){var e=this.getEvent(t);this.clear_event(t),e&&this.is_visible_events(e)&&this.filter_event(t,e)&&(this._table_view||this.config.multi_day||e._timed)&&(this.config.update_render?this.render_view_data():"month"!=this.getState().mode||this.getState().drag_id||this.isOneDayEvent(e)?this.render_view_data([e],!0):this.render_view_data())},scheduler.clear_event=function(t){this.for_rendered(t,function(t,e){t.parentNode&&t.parentNode.removeChild(t),scheduler._rendered.splice(e,1)})},scheduler._y_from_date=function(t){var e=60*t.getHours()+t.getMinutes();return Math.round((60*e*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},scheduler._calc_event_y=function(t,e){e=e||0;var i=60*t.start_date.getHours()+t.start_date.getMinutes(),s=60*t.end_date.getHours()+t.end_date.getMinutes()||60*scheduler.config.last_hour;return{top:this._y_from_date(t.start_date),height:Math.max(e,(s-i)*this.config.hour_size_px/60)}},scheduler.render_event=function(t){var e=scheduler.xy.menu_width,i=this.config.use_select_menu_space?0:e;if(!(t._sday<0)){var s=scheduler.locate_holder(t._sday);if(s){var n=this._calc_event_y(t,scheduler.xy.min_event_height),l=n.top,o=n.height,r=t._count||1,a=t._sorder||0,h=Math.floor((s.clientWidth-i)/r),d=a*h+1;if(t._inner||(h*=r-a),this.config.cascade_event_display){var c=this.config.cascade_event_count,_=this.config.cascade_event_margin;d=a%c*_;var u=t._inner?(r-a-1)%c*_/2:0;h=Math.floor(s.clientWidth-i-d-u)}var f=this._render_v_bar(t,i+d,l,h,o,t._text_style,scheduler.templates.event_header(t.start_date,t.end_date,t),scheduler.templates.event_text(t.start_date,t.end_date,t));if(this._rendered.push(f),s.appendChild(f),d=d+parseInt(s.style.left,10)+i,this._edit_id==t.id){f.style.zIndex=1,h=Math.max(h-4,scheduler.xy.editor_width),(f=document.createElement("DIV")).setAttribute("event_id",t.id),this.set_xy(f,h,o-20,d,l+14),f.className="dhx_cal_event dhx_cal_editor";var p=scheduler.templates.event_class(t.start_date,t.end_date,t);p&&(f.className+=" "+p);var m=document.createElement("DIV");this.set_xy(m,h-6,o-26),m.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",f.appendChild(m),this._els.dhx_cal_data[0].appendChild(f),this._rendered.push(f),m.innerHTML="<textarea class='dhx_cal_editor'>"+t.text+"</textarea>",this._quirks7&&(m.firstChild.style.height=o-12+"px"),this._editor=m.firstChild,this._editor.onkeydown=function(t){if((t||event).shiftKey)return!0;var e=(t||event).keyCode;e==scheduler.keys.edit_save&&scheduler.editStop(!0),e==scheduler.keys.edit_cancel&&scheduler.editStop(!1)},this._editor.onselectstart=function(t){return(t||event).cancelBubble=!0,!0},scheduler._focus(m.firstChild,!0),this._els.dhx_cal_data[0].scrollLeft=0}if(0!==this.xy.menu_width&&this._select_id==t.id){this.config.cascade_event_display&&this._drag_mode&&(f.style.zIndex=1);for(var g=this.config["icons_"+(this._edit_id==t.id?"edit":"select")],v="",b=t.color?"background-color: "+t.color+";":"",x=t.textColor?"color: "+t.textColor+";":"",w=0;w<g.length;w++)v+="<div class='dhx_menu_icon "+g[w]+"' style='"+b+x+"' title='"+this.locale.labels[g[w]]+"'></div>";var y=this._render_v_bar(t,d-e+1,l,e,20*g.length+26-2,"","<div style='"+b+x+"' class='dhx_menu_head'></div>",v,!0);y.style.left=d-e+1,this._els.dhx_cal_data[0].appendChild(y),this._rendered.push(y)}this.config.drag_highlight&&this._drag_id==t.id&&this.highlightEventPosition(t)}}},scheduler._render_v_bar=function(t,e,i,s,n,l,o,r,a){var h=document.createElement("DIV"),d=t.id,c=a?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",_=scheduler.templates.event_class(t.start_date,t.end_date,t);_&&(c=c+" "+_);var u=t.color?"background:"+t.color+";":"",f=t.textColor?"color:"+t.textColor+";":"",p='<div event_id="'+d+'" class="'+c+'" style="position:absolute; top:'+i+"px; left:"+e+"px; width:"+(s-4)+"px; height:"+n+"px;"+(l||"")+'"></div>';h.innerHTML=p;var m=h.cloneNode(!0).firstChild;if(!a&&scheduler.renderEvent(m,t,s,n,o,r))return m;m=h.firstChild;var g='<div class="dhx_event_move dhx_header" style=" width:'+(s-6)+"px;"+u+'" >&nbsp;</div>';g+='<div class="dhx_event_move dhx_title" style="'+u+f+'">'+o+"</div>",g+='<div class="dhx_body" style=" width:'+(s-(this._quirks?4:14))+"px; height:"+(n-(this._quirks?20:30)+1)+"px;"+u+f+'">'+r+"</div>";var v="dhx_event_resize dhx_footer";return a&&(v="dhx_resize_denied "+v),g+='<div class="'+v+'" style=" width:'+(s-8)+"px;"+(a?" margin-top:-1px;":"")+u+f+'" ></div>',m.innerHTML=g,m},scheduler.renderEvent=function(){return!1},scheduler.locate_holder=function(t){return"day"==this._mode?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[t]},scheduler.locate_holder_day=function(t,e){var i=Math.floor((this._correct_shift(t,1)-this._min_date)/864e5);return e&&this.date.time_part(t)&&i++,i},scheduler._get_dnd_order=function(t,e,i){if(!this._drag_event)return t;this._drag_event._orig_sorder?t=this._drag_event._orig_sorder:this._drag_event._orig_sorder=t;for(var s=e*t;s+e>i;)t--,s-=e;return t=Math.max(t,0)},scheduler._get_event_bar_pos=function(t){var e=this._colsS[t._sday],i=this._colsS[t._eday];i==e&&(i=this._colsS[t._eday+1]);var s=this.xy.bar_height,n=t._sorder;if(t.id==this._drag_id){var l=this._colsS.heights[t._sweek+1]-this._colsS.heights[t._sweek]-this.xy.month_head_height;n=scheduler._get_dnd_order(n,s,l)}var o=n*s;return{x:e,x2:i,y:this._colsS.heights[t._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+o}},scheduler.render_event_bar=function(t){var e=this._rendered_location,i=this._get_event_bar_pos(t),s=i.y,n=i.x,l=i.x2,o="";if(l){var r=scheduler.config.resize_month_events&&"month"==this._mode&&(!t._timed||scheduler.config.resize_month_timed),a=document.createElement("DIV"),h=t.hasOwnProperty("_first_chunk")&&t._first_chunk,d=t.hasOwnProperty("_last_chunk")&&t._last_chunk,c=r&&(t._timed||h),_=r&&(t._timed||d),u="dhx_cal_event_clear";t._timed&&!r||(u="dhx_cal_event_line"),h&&(u+=" dhx_cal_event_line_start"),d&&(u+=" dhx_cal_event_line_end"),c&&(o+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),_&&(o+="<div class='dhx_event_resize dhx_event_resize_end'></div>");var f=scheduler.templates.event_class(t.start_date,t.end_date,t);f&&(u+=" "+f);var p=t.color?"background:"+t.color+";":"",m=["position:absolute","top:"+s+"px","left:"+n+"px","width:"+(l-n-15)+"px",t.textColor?"color:"+t.textColor+";":"",p,t._text_style||""].join(";"),g='<div event_id="'+t.id+'" class="'+u+'" style="'+m+'">';r&&(g+=o),"month"==scheduler.getState().mode&&(t=scheduler.getEvent(t.id)),t._timed&&(g+=scheduler.templates.event_bar_date(t.start_date,t.end_date,t)),g+=scheduler.templates.event_bar_text(t.start_date,t.end_date,t)+"</div>",g+="</div>",a.innerHTML=g,this._rendered.push(a.firstChild),e.appendChild(a.firstChild)}},scheduler._locate_event=function(t){for(var e=null;t&&!e&&t.getAttribute;)e=t.getAttribute("event_id"),t=t.parentNode;return e},scheduler.edit=function(t){this._edit_id!=t&&(this.editStop(!1,t),this._edit_id=t,this.updateEvent(t))},scheduler.editStop=function(t,e){if(!e||this._edit_id!=e){var i=this.getEvent(this._edit_id);i&&(t&&(i.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(i.id),this._edit_stop_event(i,t))}},scheduler._edit_stop_event=function(t,e){this._new_event?(e?this.callEvent("onEventAdded",[t.id,t]):t&&this.deleteEvent(t.id,!0),this._new_event=null):e&&this.callEvent("onEventChanged",[t.id,t])},scheduler.getEvents=function(t,e){var i=[];for(var s in this._events){var n=this._events[s];n&&(!t&&!e||n.start_date<e&&n.end_date>t)&&i.push(n)}return i},scheduler.getRenderedEvent=function(t){if(t){for(var e=scheduler._rendered,i=0;i<e.length;i++){var s=e[i];if(s.getAttribute("event_id")==t)return s}return null}},scheduler.showEvent=function(t,e){var i="number"==typeof t||"string"==typeof t?scheduler.getEvent(t):t;if(e=e||scheduler._mode,i&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[i,e]))){var s=scheduler.config.scroll_hour;scheduler.config.scroll_hour=i.start_date.getHours();var n=scheduler.config.preserve_scroll;scheduler.config.preserve_scroll=!1;var l=i.color,o=i.textColor;if(scheduler.config.highlight_displayed_event&&(i.color=scheduler.config.displayed_event_color,i.textColor=scheduler.config.displayed_event_text_color),scheduler.setCurrentView(new Date(i.start_date),e),i.color=l,i.textColor=o,scheduler.config.scroll_hour=s,scheduler.config.preserve_scroll=n,scheduler.matrix&&scheduler.matrix[e]){var r=scheduler.getRenderedEvent(i.id);r&&(scheduler._els.dhx_cal_data[0].scrollTop=getAbsoluteTop(r)-getAbsoluteTop(scheduler._els.dhx_cal_data[0])-20)}scheduler.callEvent("onAfterEventDisplay",[i,e])}},scheduler._append_drag_marker=function(t){if(!t.parentNode){var e=scheduler._els.dhx_cal_data[0].lastChild;e.className&&e.className.indexOf("dhx_scale_holder")<0&&e.previousSibling&&(e=e.previousSibling),e&&0===e.className.indexOf("dhx_scale_holder")&&e.appendChild(t)}},scheduler._update_marker_position=function(t,e){var i=scheduler._calc_event_y(e,0);t.style.top=i.top+"px",t.style.height=i.height+"px"},scheduler.highlightEventPosition=function(t){var e=document.createElement("div");e.setAttribute("event_id",t.id),this._rendered.push(e),this._update_marker_position(e,t);var i=this.templates.drag_marker_class(t.start_date,t.end_date,t),s=this.templates.drag_marker_content(t.start_date,t.end_date,t);e.className="dhx_drag_marker",i&&(e.className+=" "+i),s&&(e.innerHTML=s),this._append_drag_marker(e)},scheduler._loaded={},scheduler._load=function(t,e){if(t=t||this._load_url){var i;if(t+=(-1==t.indexOf("?")?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(t+="&uid="+this.uid()),e=e||this._date,this._load_mode){var s=this.templates.load_format;for(e=this.date[this._load_mode+"_start"](new Date(e.valueOf()));e>this._min_date;)e=this.date.add(e,-1,this._load_mode);i=e;for(var n=!0;i<this._max_date;)i=this.date.add(i,1,this._load_mode),this._loaded[s(e)]&&n?e=this.date.add(e,1,this._load_mode):n=!1;var l=i;do{i=l,l=this.date.add(i,-1,this._load_mode)}while(l>e&&this._loaded[s(l)]);if(i<=e)return!1;for(dhtmlxAjax.get(t+"&from="+s(e)+"&to="+s(i),function(t){scheduler.on_load(t)});e<i;)this._loaded[s(e)]=!0,e=this.date.add(e,1,this._load_mode)}else dhtmlxAjax.get(t,function(t){scheduler.on_load(t)});return this.callEvent("onXLS",[]),!0}},scheduler.on_load=function(t){var e,i=!1;if(this._process&&"xml"!=this._process)try{e=this[this._process].parse(t.xmlDoc.responseText)}catch(t){i=!0}else(e=this._magic_parser(t))||(i=!0);i&&(this.callEvent("onLoadError",[t.xmlDoc]),e=[]),scheduler._process_loading(e),this.callEvent("onXLE",[])},scheduler._process_loading=function(t){this._loading=!0,this._not_render=!0;for(var e=0;e<t.length;e++)this.callEvent("onEventLoading",[t[e]])&&this.addEvent(t[e]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},scheduler._init_event=function(t){t.text=t.text||t._tagvalue||"",t.start_date=scheduler._init_date(t.start_date),t.end_date=scheduler._init_date(t.end_date)},scheduler._init_date=function(t){return t?"string"==typeof t?scheduler.templates.xml_date(t):new Date(t):null},scheduler.json={},scheduler.json.parse=function(data){"string"==typeof data&&(scheduler._temp=eval("("+data+")"),data=scheduler._temp?scheduler._temp.data||scheduler._temp.d||scheduler._temp:[]),data.dhx_security&&(dhtmlx.security_key=data.dhx_security);var collections=scheduler._temp&&scheduler._temp.collections?scheduler._temp.collections:{},collections_loaded=!1;for(var key in collections)if(collections.hasOwnProperty(key)){collections_loaded=!0;var collection=collections[key],arr=scheduler.serverList[key];if(!arr)continue;arr.splice(0,arr.length);for(var j=0;j<collection.length;j++){var option=collection[j],obj={key:option.value,label:option.label};for(var option_key in option)if(option.hasOwnProperty(option_key)){if("value"==option_key||"label"==option_key)continue;obj[option_key]=option[option_key]}arr.push(obj)}}collections_loaded&&scheduler.callEvent("onOptionsLoad",[]);for(var evs=[],i=0;i<data.length;i++){var event=data[i];scheduler._init_event(event),evs.push(event)}return evs},scheduler.parse=function(t,e){this._process=e,this.on_load({xmlDoc:{responseText:t}})},scheduler.load=function(t,e){"string"==typeof e&&(this._process=e,e=arguments[2]),this._load_url=t,this._after_call=e,this._load(t,this._date)},scheduler.setLoadMode=function(t){"all"==t&&(t=""),this._load_mode=t},scheduler.serverList=function(t,e){return e?(this.serverList[t]=e.slice(0),this.serverList[t]):(this.serverList[t]=this.serverList[t]||[],this.serverList[t])},scheduler._userdata={},scheduler._magic_parser=function(t){var e;if(!t.getXMLTopNode){var i=t.xmlDoc.responseText;(t=new dtmlXMLLoaderObject(function(){})).loadXMLString(i)}if("data"!=(e=t.getXMLTopNode("data")).tagName)return null;var s=e.getAttribute("dhx_security");s&&(dhtmlx.security_key=s);for(var n=t.doXPath("//coll_options"),l=0;l<n.length;l++){var o=n[l].getAttribute("for"),r=this.serverList[o];if(r){r.splice(0,r.length);for(var a=t.doXPath(".//item",n[l]),h=0;h<a.length;h++){for(var d=a[h].attributes,c={key:a[h].getAttribute("value"),label:a[h].getAttribute("label")},_=0;_<d.length;_++){var u=d[_];"value"!=u.nodeName&&"label"!=u.nodeName&&(c[u.nodeName]=u.nodeValue)}r.push(c)}}}n.length&&scheduler.callEvent("onOptionsLoad",[]);var f=t.doXPath("//userdata");for(l=0;l<f.length;l++){var p=this._xmlNodeToJSON(f[l]);this._userdata[p.name]=p.text}var m=[];e=t.doXPath("//event");for(l=0;l<e.length;l++){var g=m[l]=this._xmlNodeToJSON(e[l]);scheduler._init_event(g)}return m},scheduler._xmlNodeToJSON=function(t){for(var e={},i=0;i<t.attributes.length;i++)e[t.attributes[i].name]=t.attributes[i].value;for(i=0;i<t.childNodes.length;i++){var s=t.childNodes[i];1==s.nodeType&&(e[s.tagName]=s.firstChild?s.firstChild.nodeValue:"")}return e.text||(e.text=t.firstChild?t.firstChild.nodeValue:""),e},scheduler.attachEvent("onXLS",function(){var t;!0===this.config.show_loading&&((t=this.config.show_loading=document.createElement("DIV")).className="dhx_loading",t.style.left=Math.round((this._x-128)/2)+"px",t.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(t))}),scheduler.attachEvent("onXLE",function(){var t=this.config.show_loading;t&&"object"==typeof t&&(this._obj.removeChild(t),this.config.show_loading=!0)}),scheduler.ical={parse:function(t){var e=t.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(e.length){e[0]=e[0].replace(/[\r\n]+(?=[a-z \t])/g," "),e[0]=e[0].replace(/\;[^:\r\n]*:/g,":");for(var i,s=[],n=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");null!==(i=n.exec(e));){for(var l,o={},r=/[^\r\n]+[\r\n]+/g;null!==(l=r.exec(i[1]));)this.parse_param(l.toString(),o);o.uid&&!o.id&&(o.id=o.uid),s.push(o)}return s}},parse_param:function(t,e){var i=t.indexOf(":");if(-1!=i){var s=t.substr(0,i).toLowerCase(),n=t.substr(i+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,"");"summary"==s?s="text":"dtstart"==s?(s="start_date",n=this.parse_date(n,0,0)):"dtend"==s&&(s="end_date",n=this.parse_date(n,0,0)),e[s]=n}},parse_date:function(t,e,i){var s=t.split("T");s[1]&&(e=s[1].substr(0,2),i=s[1].substr(2,2));var n=s[0].substr(0,4),l=parseInt(s[0].substr(4,2),10)-1,o=s[0].substr(6,2);return scheduler.config.server_utc&&!s[1]?new Date(Date.UTC(n,l,o,e,i)):new Date(n,l,o,e,i)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"},scheduler._lightbox_controls={},scheduler.formSection=function(t){for(var e=this.config.lightbox.sections,i=0;i<e.length&&e[i].name!=t;i++);var s=e[i];scheduler._lightbox||scheduler.getLightbox();var n=document.getElementById(s.id),l=n.nextSibling,o={section:s,header:n,node:l,getValue:function(t){return scheduler.form_blocks[s.type].get_value(l,t||{},s)},setValue:function(t,e){return scheduler.form_blocks[s.type].set_value(l,t,e||{},s)}},r=scheduler._lightbox_controls["get_"+s.type+"_control"];return r?r(o):o},scheduler._lightbox_controls.get_template_control=function(t){return t.control=t.node,t},scheduler._lightbox_controls.get_select_control=function(t){return t.control=t.node.getElementsByTagName("select")[0],t},scheduler._lightbox_controls.get_textarea_control=function(t){return t.control=t.node.getElementsByTagName("textarea")[0],t},scheduler._lightbox_controls.get_time_control=function(t){return t.control=t.node.getElementsByTagName("select"),t},scheduler.form_blocks={template:{render:function(t){return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+((t.height||"30")+"px")+";'></div>"},set_value:function(t,e,i,s){t.innerHTML=e||""},get_value:function(t,e,i){return t.innerHTML||""},focus:function(t){}},textarea:{render:function(t){return"<div class='dhx_cal_ltext' style='height:"+((t.height||"130")+"px")+";'><textarea></textarea></div>"},set_value:function(t,e,i){scheduler.form_blocks.textarea._get_input(t).value=e||""},get_value:function(t,e){return scheduler.form_blocks.textarea._get_input(t).value},focus:function(t){var e=scheduler.form_blocks.textarea._get_input(t);scheduler._focus(e,!0)},_get_input:function(t){return t.getElementsByTagName("textarea")[0]}},select:{render:function(t){for(var e="<div class='dhx_cal_ltext' style='height:"+((t.height||"23")+"px")+";'><select style='width:100%;'>",i=0;i<t.options.length;i++)e+="<option value='"+t.options[i].key+"'>"+t.options[i].label+"</option>";return e+="</select></div>"},set_value:function(t,e,i,s){var n=t.firstChild;!n._dhx_onchange&&s.onchange&&(n.onchange=s.onchange,n._dhx_onchange=!0),void 0===e&&(e=(n.options[0]||{}).value),n.value=e||""},get_value:function(t,e){return t.firstChild.value},focus:function(t){var e=t.firstChild;scheduler._focus(e,!0)}},time:{render:function(t){t.time_format||(t.time_format=["%H:%i","%d","%m","%Y"]),t._time_format_order={};var e=t.time_format,i=scheduler.config,s=this.date.date_part(scheduler._currentDate()),n=1440,l=0;scheduler.config.limit_time_select&&(n=60*i.last_hour+1,l=60*i.first_hour,s.setHours(i.first_hour));for(var o="",r=0;r<e.length;r++){var a=e[r];switch(r>0&&(o+=" "),a){case"%Y":t._time_format_order[3]=r,o+="<select>";for(var h=s.getFullYear()-5,d=0;d<10;d++)o+="<option value='"+(h+d)+"'>"+(h+d)+"</option>";o+="</select> ";break;case"%m":t._time_format_order[2]=r,o+="<select>";for(d=0;d<12;d++)o+="<option value='"+d+"'>"+this.locale.date.month_full[d]+"</option>";o+="</select>";break;case"%d":t._time_format_order[1]=r,o+="<select>";for(d=1;d<32;d++)o+="<option value='"+d+"'>"+d+"</option>";o+="</select>";break;case"%H:%i":t._time_format_order[0]=r,o+="<select>";d=l;var c=s.getDate();for(t._time_values=[];d<n;){o+="<option value='"+d+"'>"+this.templates.time_picker(s)+"</option>",t._time_values.push(d),s.setTime(s.valueOf()+60*this.config.time_step*1e3),d=24*(s.getDate()!=c?1:0)*60+60*s.getHours()+s.getMinutes()}o+="</select>"}}return"<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+o+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+o+"</div>"},set_value:function(t,e,i,s){var n,l,o=scheduler.config,r=t.getElementsByTagName("select"),a=s._time_format_order;if(o.full_day){if(!t._full_day){var h="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+scheduler.locale.labels.full_day+"&nbsp;</label></input>";scheduler.config.wide_form||(h=t.previousSibling.innerHTML+h),t.previousSibling.innerHTML=h,t._full_day=!0}var d=t.previousSibling.getElementsByTagName("input")[0];d.checked=0===scheduler.date.time_part(i.start_date)&&0===scheduler.date.time_part(i.end_date),r[a[0]].disabled=d.checked,r[a[0]+r.length/2].disabled=d.checked,d.onclick=function(){if(d.checked){var e={};scheduler.form_blocks.time.get_value(t,e,s),n=scheduler.date.date_part(e.start_date),(+(l=scheduler.date.date_part(e.end_date))==+n||+l>=+n&&(0!==i.end_date.getHours()||0!==i.end_date.getMinutes()))&&(l=scheduler.date.add(l,1,"day"))}else n=null,l=null;r[a[0]].disabled=d.checked,r[a[0]+r.length/2].disabled=d.checked,u(r,0,n||i.start_date),u(r,4,l||i.end_date)}}if(o.auto_end_date&&o.event_duration)for(var c=function(){n=new Date(r[a[3]].value,r[a[2]].value,r[a[1]].value,0,r[a[0]].value),l=new Date(n.getTime()+60*scheduler.config.event_duration*1e3),u(r,4,l)},_=0;_<4;_++)r[_].onchange=c;function u(t,e,i){for(var n=s._time_values,l=60*i.getHours()+i.getMinutes(),o=l,r=!1,h=0;h<n.length;h++){var d=n[h];if(d===l){r=!0;break}d<l&&(o=d)}t[e+a[0]].value=r?l:o,r||o||(t[e+a[0]].selectedIndex=-1),t[e+a[1]].value=i.getDate(),t[e+a[2]].value=i.getMonth(),t[e+a[3]].value=i.getFullYear()}u(r,0,i.start_date),u(r,4,i.end_date)},get_value:function(t,e,i){var s=t.getElementsByTagName("select"),n=i._time_format_order;if(e.start_date=new Date(s[n[3]].value,s[n[2]].value,s[n[1]].value,0,s[n[0]].value),e.end_date=new Date(s[n[3]+4].value,s[n[2]+4].value,s[n[1]+4].value,0,s[n[0]+4].value),!s[n[3]].value||!s[n[3]+4].value){var l=this.getEvent(this._lightbox_id);l&&(e.start_date=l.start_date,e.end_date=l.end_date)}return e.end_date<=e.start_date&&(e.end_date=scheduler.date.add(e.start_date,scheduler.config.time_step,"minute")),{start_date:new Date(e.start_date),end_date:new Date(e.end_date)}},focus:function(t){scheduler._focus(t.getElementsByTagName("select")[0])}}},scheduler.showCover=function(t){if(t){t.style.display="block";var e=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,i=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,s=window.innerHeight||document.documentElement.clientHeight;t.style.top=e?Math.round(e+Math.max((s-t.offsetHeight)/2,0))+"px":Math.round(Math.max((s-t.offsetHeight)/2,0)+9)+"px",document.documentElement.scrollWidth>document.body.offsetWidth?t.style.left=Math.round(i+(document.body.offsetWidth-t.offsetWidth)/2)+"px":t.style.left=Math.round((document.body.offsetWidth-t.offsetWidth)/2)+"px"}this.show_cover()},scheduler.showLightbox=function(t){if(t)if(this.callEvent("onBeforeLightbox",[t])){var e=this.getLightbox();this.showCover(e),this._fill_lightbox(t,e),this.callEvent("onLightbox",[t])}else this._new_event&&(this._new_event=null)},scheduler._fill_lightbox=function(t,e){var i=this.getEvent(t),s=e.getElementsByTagName("span");scheduler.templates.lightbox_header?(s[1].innerHTML="",s[2].innerHTML=scheduler.templates.lightbox_header(i.start_date,i.end_date,i)):(s[1].innerHTML=this.templates.event_header(i.start_date,i.end_date,i),s[2].innerHTML=(this.templates.event_bar_text(i.start_date,i.end_date,i)||"").substr(0,70));for(var n=this.config.lightbox.sections,l=0;l<n.length;l++){var o=n[l],r=document.getElementById(o.id).nextSibling,a=this.form_blocks[o.type],h=void 0!==i[o.map_to]?i[o.map_to]:o.default_value;a.set_value.call(this,r,h,i,o),n[l].focus&&a.focus.call(this,r)}scheduler._lightbox_id=t},scheduler._lightbox_out=function(t){for(var e=this.config.lightbox.sections,i=0;i<e.length;i++){var s=document.getElementById(e[i].id);s=s?s.nextSibling:s;var n=this.form_blocks[e[i].type].get_value.call(this,s,t,e[i]);"auto"!=e[i].map_to&&(t[e[i].map_to]=n)}return t},scheduler._empty_lightbox=function(t){var e=scheduler._lightbox_id,i=this.getEvent(e);this.getLightbox();this._lame_copy(i,t),this.setEvent(i.id,i),this._edit_stop_event(i,!0),this.render_view_data()},scheduler.hide_lightbox=function(t){this.hideCover(this.getLightbox()),this._lightbox_id=null,this.callEvent("onAfterLightbox",[])},scheduler.hideCover=function(t){t&&(t.style.display="none"),this.hide_cover()},scheduler.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},scheduler.show_cover=function(){if(!this._cover){this._cover=document.createElement("DIV"),this._cover.className="dhx_cal_cover";var t=void 0!==document.height?document.height:document.body.offsetHeight,e=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(t,e)+"px",document.body.appendChild(this._cover)}},scheduler.save_lightbox=function(){var t=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));this.checkEvent("onEventSave")&&!this.callEvent("onEventSave",[this._lightbox_id,t,this._new_event])||(this._empty_lightbox(t),this.hide_lightbox())},scheduler.startLightbox=function(t,e){this._lightbox_id=t,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=e,this.showCover(e)},scheduler.endLightbox=function(t,e){this._edit_stop_event(scheduler.getEvent(this._lightbox_id),t),t&&scheduler.render_view_data(),this.hideCover(e),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null},scheduler.resetLightbox=function(){scheduler._lightbox&&!scheduler._custom_lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),scheduler._lightbox=null},scheduler.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]),this.endLightbox(!1),this.hide_lightbox()},scheduler._init_lightbox_events=function(){this.getLightbox().onclick=function(t){var e=t?t.target:event.srcElement;if(e.className||(e=e.previousSibling),e&&e.className)switch(e.className){case"dhx_save_btn":scheduler.save_lightbox();break;case"dhx_delete_btn":var i=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(i,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(scheduler._lightbox_id),scheduler._new_event=null,scheduler.hide_lightbox()});break;case"dhx_cancel_btn":scheduler.cancel_lightbox();break;default:var s,n;if(e.getAttribute("dhx_button"))scheduler.callEvent("onLightboxButton",[e.className,e,t]);else-1!=e.className.indexOf("dhx_custom_button")&&(-1!=e.className.indexOf("dhx_custom_button_")?(s=e.parentNode.getAttribute("index"),n=e.parentNode.parentNode):(s=e.getAttribute("index"),n=e.parentNode,e=e.firstChild)),s&&scheduler.form_blocks[scheduler.config.lightbox.sections[s].type].button_click(s,e,n,n.nextSibling)}},this.getLightbox().onkeydown=function(t){switch((t||event).keyCode){case scheduler.keys.edit_save:if((t||event).shiftKey)return;scheduler.save_lightbox();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}},scheduler.setLightboxSize=function(){var t=this._lightbox;if(t){var e=t.childNodes[1];e.style.height="0px",e.style.height=e.scrollHeight+"px",t.style.height=e.scrollHeight+scheduler.xy.lightbox_additional_height+"px",e.style.height=e.scrollHeight+"px"}},scheduler._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",scheduler._move_while_dnd),dhtmlxEvent(document.body,"mouseup",scheduler._finish_dnd),scheduler._init_dnd_events=function(){}},scheduler._move_while_dnd=function(t){if(scheduler._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var e=scheduler.getLightbox(),i=t&&t.target?[t.pageX,t.pageY]:[event.clientX,event.clientY];e.style.top=scheduler._lb_start[1]+i[1]-scheduler._dnd_start_lb[1]+"px",e.style.left=scheduler._lb_start[0]+i[0]-scheduler._dnd_start_lb[0]+"px"}},scheduler._ready_to_dnd=function(t){var e=scheduler.getLightbox();scheduler._lb_start=[parseInt(e.style.left,10),parseInt(e.style.top,10)],scheduler._dnd_start_lb=t&&t.target?[t.pageX,t.pageY]:[event.clientX,event.clientY]},scheduler._finish_dnd=function(){scheduler._lb_start&&(scheduler._lb_start=scheduler._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)},scheduler.getLightbox=function(){if(!this._lightbox){var t=document.createElement("DIV");t.className="dhx_cal_light",scheduler.config.wide_form&&(t.className+=" dhx_cal_light_wide"),scheduler.form_blocks.recurring&&(t.className+=" dhx_cal_light_rec"),/msie|MSIE 6/.test(navigator.userAgent)&&(t.className+=" dhx_ie6"),t.style.visibility="hidden";for(var e=this._lightbox_template,i=this.config.buttons_left,s=0;s<i.length;s++)e+="<div class='dhx_btn_set dhx_left_btn_set "+i[s]+"_set'><div dhx_button='1' class='"+i[s]+"'></div><div>"+scheduler.locale.labels[i[s]]+"</div></div>";i=this.config.buttons_right;for(s=0;s<i.length;s++)e+="<div class='dhx_btn_set dhx_right_btn_set "+i[s]+"_set' style='float:right;'><div dhx_button='1' class='"+i[s]+"'></div><div>"+scheduler.locale.labels[i[s]]+"</div></div>";e+="</div>",t.innerHTML=e,scheduler.config.drag_lightbox&&(t.firstChild.onmousedown=scheduler._ready_to_dnd,t.firstChild.onselectstart=function(){return!1},t.firstChild.style.cursor="pointer",scheduler._init_dnd_events()),document.body.insertBefore(t,document.body.firstChild),this._lightbox=t;var n=this.config.lightbox.sections;e="";for(s=0;s<n.length;s++){var l=this.form_blocks[n[s].type];if(l){n[s].id="area_"+this.uid();var o="";n[s].button&&(o="<div class='dhx_custom_button' index='"+s+"'><div class='dhx_custom_button_"+n[s].button+"'></div><div>"+this.locale.labels["button_"+n[s].button]+"</div></div>"),this.config.wide_form&&(e+="<div class='dhx_wrap_section'>");var r=this.locale.labels["section_"+n[s].name];"string"!=typeof r&&(r=n[s].name),e+="<div id='"+n[s].id+"' class='dhx_cal_lsection'>"+o+r+"</div>"+l.render.call(this,n[s]),e+="</div>"}}var a=t.getElementsByTagName("div");for(s=0;s<a.length;s++){var h=a[s];if("dhx_cal_larea"==h.className){h.innerHTML=e;break}}this.setLightboxSize(),this._init_lightbox_events(this),t.style.display="none",t.style.visibility="visible"}return this._lightbox},scheduler.attachEvent("onEventIdChange",function(t,e){this._lightbox_id==t&&(this._lightbox_id=e)}),scheduler._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>",scheduler._init_touch_events=function(){"force"!=this.config.touch&&(this.config.touch=this.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch"))),this.config.touch&&(this.xy.scroll_width=0,window.navigator.msPointerEnabled?(this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(t){return t.pointerType==t.MSPOINTER_TYPE_MOUSE?null:t},function(t){return!t||t.pointerType==t.MSPOINTER_TYPE_MOUSE}),this._obj.ondblclick=function(){}):this._touch_events(["touchmove","touchstart","touchend"],function(t){return t.touches&&t.touches.length>1?null:t.touches[0]?{target:t.target,pageX:t.touches[0].pageX,pageY:t.touches[0].pageY}:t},function(){return!1}))},scheduler._touch_events=function(t,e,i){-1!=navigator.userAgent.indexOf("Android")&&navigator.userAgent.indexOf("WebKit");var s,n,l,o,r,a,h=0;function d(t,e,i){dhtmlxEvent(t,e,function(t){return!!scheduler._is_lightbox_open()||i(t)})}function c(t){scheduler._hide_global_tip(),o&&(scheduler._on_mouse_up(e(t||event)),scheduler._temp_touch_block=!1),scheduler._drag_id=null,scheduler._drag_mode=null,scheduler._drag_pos=null,clearTimeout(l),o=a=!1,r=!0}d(document.body,t[0],function(t){if(!i(t)){if(o)return function(t){var e=scheduler.getState().drag_mode,i=!!scheduler.matrix&&scheduler.matrix[scheduler._mode],s=scheduler.render_view_data;"create"==e&&i&&(scheduler.render_view_data=function(){for(var t=scheduler.getState().drag_id,e=scheduler.getEvent(t),s=i.y_property,n=scheduler.getEvents(e.start_date,e.end_date),l=0;l<n.length;l++)n[l][s]!=e[s]&&(n.splice(l,1),l--);e._sorder=n.length-1,e._count=n.length,this.render_data([e],scheduler.getState().mode)}),scheduler._on_mouse_move(t),"create"==e&&i&&(scheduler.render_view_data=s)}(e(t)),scheduler._update_global_tip(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1;n=e(t),a&&(n?(s.target!=n.target||Math.abs(s.pageX-n.pageX)>5||Math.abs(s.pageY-n.pageY)>5)&&(r=!0,clearTimeout(l)):r=!0)}}),d(this._els.dhx_cal_data[0],"scroll",c),d(this._els.dhx_cal_data[0],"touchcancel",c),d(this._els.dhx_cal_data[0],"contextmenu",function(t){if(a)return t&&t.preventDefault&&t.preventDefault(),(t||event).cancelBubble=!0,!1}),d(this._obj,t[1],function(t){var d;if(!i(t))if(o=r=!1,a=!0,scheduler._temp_touch_block=!0,d=n=e(t)){var c=new Date;if(!r&&!o&&c-h<250)return scheduler._click.dhx_cal_data(d),window.setTimeout(function(){scheduler._on_dbl_click(d)},50),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,scheduler._block_next_stop=!0,!1;if(h=c,!r&&!o&&scheduler.config.touch_drag){var _=scheduler._locate_event(document.activeElement),u=scheduler._locate_event(d.target),f=s?scheduler._locate_event(s.target):null;if(_&&u&&_==u&&_!=f)return t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,scheduler._ignore_next_click=!1,scheduler._click.dhx_cal_data(d),s=d,!1;l=setTimeout(function(){o=!0;var t=s.target;t&&t.className&&-1!=t.className.indexOf("dhx_body")&&(t=t.previousSibling),scheduler._on_mouse_down(s,t),scheduler._drag_mode&&"create"!=scheduler._drag_mode&&scheduler.for_rendered(scheduler._drag_id,function(t,e){t.style.display="none",scheduler._rendered.splice(e,1)}),scheduler.config.touch_tip&&scheduler._show_global_tip(),scheduler.updateEvent(scheduler._drag_id)},scheduler.config.touch_drag),s=d}}else r=!0}),d(this._els.dhx_cal_data[0],t[2],function(t){if(!i(t))return o||function(t,e,i,s){if(t&&e){for(var n=t.target;n&&n!=scheduler._obj;)n=n.parentNode;if(n==scheduler._obj){var l=Math.abs(t.pageY-e.pageY),o=Math.abs(t.pageX-e.pageX);l<s&&o>i&&(!l||o/l>3)&&(t.pageX>e.pageX?scheduler._click.dhx_cal_next_button():scheduler._click.dhx_cal_prev_button())}}}(s,n,200,100),o&&(scheduler._ignore_next_click=!0),c(t),scheduler._block_next_stop?(scheduler._block_next_stop=!1,t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1):void 0}),dhtmlxEvent(document.body,t[2],c)},scheduler._show_global_tip=function(){scheduler._hide_global_tip();var t=scheduler._global_tip=document.createElement("DIV");t.className="dhx_global_tip",scheduler._update_global_tip(1),document.body.appendChild(t)},scheduler._update_global_tip=function(t){var e=scheduler._global_tip;if(e){var i="";if(scheduler._drag_id&&!t){var s=scheduler.getEvent(scheduler._drag_id);s&&(i="<div>"+(s._timed?scheduler.templates.event_header(s.start_date,s.end_date,s):scheduler.templates.day_date(s.start_date,s.end_date,s))+"</div>")}"create"==scheduler._drag_mode||"new-size"==scheduler._drag_mode?e.innerHTML=(scheduler.locale.labels.drag_to_create||"Drag to create")+i:e.innerHTML=(scheduler.locale.labels.drag_to_move||"Drag to move")+i}},scheduler._hide_global_tip=function(){var t=scheduler._global_tip;t&&t.parentNode&&(t.parentNode.removeChild(t),scheduler._global_tip=0)},scheduler._dp_init=function(t){t._methods=["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"],this._dp_change_event_id=function(t,e){scheduler.getEvent(t)&&scheduler.changeEventId(t,e)},this._dp_hook_delete=function(e,i){if(scheduler.getEvent(e))return e!=i&&("true_deleted"==this.getUserData(e,t.action_param)&&this.setUserData(e,t.action_param,"updated"),this.changeEventId(e,i)),this.deleteEvent(i,!0)},this.attachEvent("onEventAdded",function(e){!this._loading&&this._validId(e)&&t.setUpdated(e,!0,"inserted")}),this.attachEvent("onConfirmedBeforeEventDelete",function(e){if(this._validId(e)){var i=t.getState(e);return"inserted"==i||this._new_event?(t.setUpdated(e,!1),!0):"deleted"!=i&&("true_deleted"==i||(t.setUpdated(e,!0,"deleted"),!1))}}),this.attachEvent("onEventChanged",function(e){!this._loading&&this._validId(e)&&t.setUpdated(e,!0,"updated")}),scheduler.attachEvent("onClearAll",function(){t._in_progress={},t._invalid={},t.updatedRows=[],t._waitMode=0}),t._objToJson=function(e,i,s){for(var n in s=s||"",i=i||{},e)0!==n.indexOf("_")&&(e[n]&&e[n].getUTCFullYear?i[s+n]=this.obj.templates.xml_format(e[n]):e[n]&&"object"==typeof e[n]?t._objToJson(e[n],i,s+n+"."):i[s+n]=e[n]);return i},t._getRowData=function(t,e){var i=this.obj.getEvent(t);return this._objToJson(i)},t._clearUpdateFlag=function(){},t.attachEvent("insertCallback",scheduler._update_callback),t.attachEvent("updateCallback",scheduler._update_callback),t.attachEvent("deleteCallback",function(t,e){this.obj.getEvent(e)?(this.obj.setUserData(e,this.action_param,"true_deleted"),this.obj.deleteEvent(e)):this.obj._add_rec_marker&&this.obj._update_callback(t,e)})},scheduler._validId=function(t){return!0},scheduler.setUserData=function(t,e,i){if(t){var s=this.getEvent(t);s&&(s[e]=i)}else this._userdata[e]=i},scheduler.getUserData=function(t,e){if(t){var i=this.getEvent(t);return i?i[e]:null}return this._userdata[e]},scheduler._set_event_text_style=function(t,e){if(scheduler.getEvent(t)){this.for_rendered(t,function(t){t.style.cssText+=";"+e});var i=this.getEvent(t);i._text_style=e,this.event_updated(i)}},scheduler._update_callback=function(t,e){var i=scheduler._xmlNodeToJSON(t.firstChild);"none"==i.rec_type&&(i.rec_pattern="none"),i.text=i.text||i._tagvalue,i.start_date=scheduler.templates.xml_date(i.start_date),i.end_date=scheduler.templates.xml_date(i.end_date),scheduler.addEvent(i),scheduler._add_rec_marker&&scheduler.setCurrentView()},scheduler._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},scheduler._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},scheduler._configure=function(t,e,i){for(var s in e)void 0===t[s]&&(t[s]=e[s][i])},scheduler._skin_init=function(){if(!scheduler.skin)for(var t=document.getElementsByTagName("link"),e=0;e<t.length;e++){var i=t[e].href.match("dhtmlxscheduler_([a-z]+).css");if(i){scheduler.skin=i[1];break}}var s=0;if(!scheduler.skin||"classic"!==scheduler.skin&&"glossy"!==scheduler.skin||(s=1),this._configure(scheduler.config,scheduler._skin_settings,s),this._configure(scheduler.xy,scheduler._skin_xy,s),"flat"===scheduler.skin&&(scheduler.xy.scale_height=35,scheduler.templates.hour_scale=function(t){var e=t.getMinutes();return e=e<10?"0"+e:e,"<span class='dhx_scale_h'>"+t.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+e+"</span>"}),!s){var n=scheduler.config.minicalendar;n&&(n.padding=14),scheduler.templates.event_bar_date=function(t,e,i){return"• <b>"+scheduler.templates.event_date(t)+"</b> "},scheduler.attachEvent("onTemplatesReady",function(){var t=scheduler.date.date_to_str("%d");scheduler.templates._old_month_day||(scheduler.templates._old_month_day=scheduler.templates.month_day);var e=scheduler.templates._old_month_day;if(scheduler.templates.month_day=function(i){if("month"==this._mode){var s=t(i);return 1==i.getDate()&&(s=scheduler.locale.date.month_full[i.getMonth()]+" "+s),+i==+scheduler.date.date_part(new Date)&&(s=scheduler.locale.labels.dhx_cal_today_button+" "+s),s}return e.call(this,i)},scheduler.config.fix_tab_position){for(var i=scheduler._els.dhx_cal_navline[0].getElementsByTagName("div"),s=null,n=211,l=0;l<i.length;l++){var o=i[l],r=o.getAttribute("name");if(r)switch(o.style.right="auto",r){case"day_tab":o.style.left="14px",o.className+=" dhx_cal_tab_first";break;case"week_tab":o.style.left="75px";break;case"month_tab":o.style.left="136px",o.className+=" dhx_cal_tab_last";break;default:o.style.left=n+"px",o.className+=" dhx_cal_tab_standalone",n=n+14+o.offsetWidth}else 0===(o.className||"").indexOf("dhx_minical_icon")&&o.parentNode==scheduler._els.dhx_cal_navline[0]&&(s=o)}s&&(s.style.left=n+"px")}}),scheduler._skin_init=function(){}}},window.jQuery&&($=jQuery,counter=0,methods=[],$.fn.dhx_scheduler=function(t){if("string"!=typeof t){var e=[];return this.each(function(){if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))e.push(window[this.getAttribute("dhxscheduler")]);else{var i="scheduler";counter&&(i="scheduler"+(counter+1),window[i]=Scheduler.getSchedulerInstance());var s=window[i];for(var n in this.setAttribute("dhxscheduler",i),t)"data"!=n&&(s.config[n]=t[n]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',this.className+=" dhx_cal_container"),s.init(this,s.config.date,s.config.mode),t.data&&s.parse(t.data),e.push(s),counter++}}),1===e.length?e[0]:e}if(methods[t])return methods[t].apply(this,[]);$.error("Method "+t+" does not exist on jQuery.dhx_scheduler")}),function(){var t=scheduler.setCurrentView,e=scheduler.updateView,i=null,s=null,n=function(t,n){var l=this;window.clearTimeout(s),window.clearTimeout(i),o(this,t,n),s=setTimeout(function(){l.callEvent("onBeforeViewChange",[l._mode,l._date,n||l._mode,t||l._date])&&(e.call(l,t,n),l.callEvent("onViewChange",[l._mode,l._date]),window.clearTimeout(i),s=0)},scheduler.config.delay_render)},l=function(t,n){var l=this,r=arguments;o(this,t,n),window.clearTimeout(i),i=setTimeout(function(){s||e.apply(l,r)},scheduler.config.delay_render)};function o(t,e,i){e&&(t._date=e),i&&(t._mode=i)}scheduler.attachEvent("onSchedulerReady",function(){scheduler.config.delay_render?(scheduler.setCurrentView=n,scheduler.updateView=l):(scheduler.setCurrentView=t,scheduler.updateView=e)})}();for(var i=0;i<Scheduler._schedulerPlugins.length;i++)Scheduler._schedulerPlugins[i](scheduler);return scheduler._internal_id=Scheduler._seed++,Scheduler.$syncFactory&&Scheduler.$syncFactory(scheduler),scheduler},window.scheduler=Scheduler.getSchedulerInstance(),dhtmlx&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(t,e,i,s){i=i||'<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>';var n=document.createElement("DIV");return n.id="dhxSchedObj_"+this._genStr(12),n.innerHTML='<div id="'+n.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+i+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>',document.body.appendChild(n.firstChild),this.attachObject(n.id,!1,!0),this.vs[this.av].sched=s,this.vs[this.av].schedId=n.id,s.setSizes=s.updateView,s.destructor=function(){},s.init(n.id,t,e),this.vs[this._viewRestore()].sched}),Scheduler.plugin(function(t){t.config.limit_start=null,t.config.limit_end=null,t.config.limit_view=!1,t.config.check_limits=!0,t.config.mark_now=!0,t.config.display_marked_timespans=!0,t._temp_limit_scope=function(){var e=null,i=function(t,e,i){var s="object"==typeof t?t:{days:t};return s.type="dhx_time_block",s.css="",e&&(i&&(s.sections=i),s=function(t,e,i){return e instanceof Date&&i instanceof Date?(t.start_date=e,t.end_date=i):(t.days=e,t.zones=i),t}(s,t,e)),s};t.blockTime=function(e,s,n){var l=i(e,s,n);return t.addMarkedTimespan(l)},t.unblockTime=function(e,s,n){var l=i(e,s=s||"fullday",n);return t.deleteMarkedTimespan(l)},t.attachEvent("onBeforeViewChange",function(e,i,s,n){function l(e,i){var s=t.config.limit_start,n=t.config.limit_end,l=t.date.add(e,1,i);return e.valueOf()>n.valueOf()||l<=s.valueOf()}return!t.config.limit_view||!l(n=n||i,s=s||e)||i.valueOf()==n.valueOf()||(setTimeout(function(){var e=l(i,s)?t.config.limit_start:i;t.setCurrentView(l(e,s)?null:e,s)},1),!1)}),t.checkInMarkedTimespan=function(e,i,s){i=i||"default";for(var l=!0,o=new Date(e.start_date.valueOf()),r=t.date.add(o,1,"day"),a=t._marked_timespans;o<e.end_date;o=t.date.date_part(r),r=t.date.add(o,1,"day")){var h=+t.date.date_part(new Date(o)),d=n(e,a,o.getDay(),h,i);if(d)for(var c=0;c<d.length;c+=2){var _=t._get_zone_minutes(o),u=e.end_date>r||e.end_date.getDate()!=o.getDate()?1440:t._get_zone_minutes(e.end_date),f=d[c],p=d[c+1];if(f<u&&p>_&&!(l="function"==typeof s&&s(e,_,u,f,p)))break}}return!l};var s=t.checkLimitViolation=function(e){if(!e)return!0;if(!t.config.check_limits)return!0;var i=t,s=i.config,n=[];if(e.rec_type)for(var l=t.getRecDates(e),o=0;o<l.length;o++){var r=t._copy_event(e);t._lame_copy(r,l[o]),n.push(r)}else n=[e];for(var a=!0,h=0;h<n.length;h++){var d=!0;(r=n[h])._timed=t.isOneDayEvent(r),(d=!s.limit_start||!s.limit_end||r.start_date.valueOf()>=s.limit_start.valueOf()&&r.end_date.valueOf()<=s.limit_end.valueOf())&&(d=!t.checkInMarkedTimespan(r,"dhx_time_block",function(t,e,s,n,l){var o=!0;return e<=l&&e>=n&&((1440==l||s<l)&&(o=!1),t._timed&&i._drag_id&&"new-size"==i._drag_mode?(t.start_date.setHours(0),t.start_date.setMinutes(l)):o=!1),(s>=n&&s<l||e<n&&s>l)&&(t._timed&&i._drag_id&&"new-size"==i._drag_mode?(t.end_date.setHours(0),t.end_date.setMinutes(n)):o=!1),o})),d||(d=i.checkEvent("onLimitViolation")?i.callEvent("onLimitViolation",[r.id,r]):d),a=a&&d}return a||(i._drag_id=null,i._drag_mode=null),a};function n(e,i,s,n,l){var o=t,r=[],a={_props:"map_to",matrix:"y_property"};for(var h in a){var d=a[h];if(o[h])for(var c in o[h]){var _=o[h][c][d];e[_]&&(r=o._add_timespan_zones(r,t._get_blocked_zones(i[c],e[_],s,n,l)))}}return r=o._add_timespan_zones(r,t._get_blocked_zones(i,"global",s,n,l))}t._get_blocked_zones=function(t,e,i,s,n){var l=[];if(t&&t[e])for(var o=t[e],r=this._get_relevant_blocked_zones(i,s,o,n),a=0;a<r.length;a++)l=this._add_timespan_zones(l,r[a].zones);return l},t._get_relevant_blocked_zones=function(t,e,i,s){return i[e]&&i[e][s]?i[e][s]:i[t]&&i[t][s]?i[t][s]:[]},t.attachEvent("onMouseDown",function(t){return!("dhx_time_block"==t)}),t.attachEvent("onBeforeDrag",function(e){return!e||s(t.getEvent(e))}),t.attachEvent("onClick",function(e,i){return s(t.getEvent(e))}),t.attachEvent("onBeforeLightbox",function(i){var n=t.getEvent(i);return e=[n.start_date,n.end_date],s(n)}),t.attachEvent("onEventSave",function(e,i,n){if(!i.start_date||!i.end_date){var l=t.getEvent(e);i.start_date=new Date(l.start_date),i.end_date=new Date(l.end_date)}if(i.rec_type){var o=t._lame_clone(i);return t._roll_back_dates(o),s(o)}return s(i)}),t.attachEvent("onEventAdded",function(e){if(!e)return!0;var i=t.getEvent(e);return!s(i)&&t.config.limit_start&&t.config.limit_end&&(i.start_date<t.config.limit_start&&(i.start_date=new Date(t.config.limit_start)),i.start_date.valueOf()>=t.config.limit_end.valueOf()&&(i.start_date=this.date.add(t.config.limit_end,-1,"day")),i.end_date<t.config.limit_start&&(i.end_date=new Date(t.config.limit_start)),i.end_date.valueOf()>=t.config.limit_end.valueOf()&&(i.end_date=this.date.add(t.config.limit_end,-1,"day")),i.start_date.valueOf()>=i.end_date.valueOf()&&(i.end_date=this.date.add(i.start_date,this.config.event_duration||this.config.time_step,"minute")),i._timed=this.isOneDayEvent(i)),!0}),t.attachEvent("onEventChanged",function(i){if(!i)return!0;var n=t.getEvent(i);if(!s(n)){if(!e)return!1;n.start_date=e[0],n.end_date=e[1],n._timed=this.isOneDayEvent(n)}return!0}),t.attachEvent("onBeforeEventChanged",function(t,e,i){return s(t)}),t.attachEvent("onBeforeEventCreated",function(e){var i=t.getActionData(e).date,n={_timed:!0,start_date:i,end_date:t.date.add(i,t.config.time_step,"minute")};return s(n)}),t.attachEvent("onViewChange",function(){t._mark_now()}),t.attachEvent("onSchedulerResize",function(){return window.setTimeout(function(){t._mark_now()},1),!0}),t.attachEvent("onTemplatesReady",function(){t._mark_now_timer=window.setInterval(function(){t._is_initialized()&&t._mark_now()},6e4)}),t._mark_now=function(e){this._els.dhx_now_time||(this._els.dhx_now_time=[]);var i=t._currentDate(),s=this.config;if(t._remove_mark_now(),!e&&s.mark_now&&i<this._max_date&&i>this._min_date&&i.getHours()>=s.first_hour&&i.getHours()<s.last_hour){var n=this.locate_holder_day(i);this._els.dhx_now_time=t._append_mark_now(n,i)}},t._append_mark_now=function(e,i){var s=t._get_zone_minutes(i),n={zones:[s,s+1],css:"dhx_now_time",type:"dhx_now_time"};if(!this._table_view){if(this._props&&this._props[this._mode]){for(var l=this._props[this._mode],o=e,r=e+(l.size||l.options.length),a=(this._els.dhx_cal_data[0].childNodes,[]),h=o;h<r;h++){var d=h;n.days=d;var c=t._render_marked_timespan(n,null,d)[0];a.push(c)}return a}return n.days=e,t._render_marked_timespan(n,null,e)}if("month"==this._mode)return n.days=+t.date.date_part(i),t._render_marked_timespan(n,null,null)},t._remove_mark_now=function(){for(var t=this._els.dhx_now_time,e=0;e<t.length;e++){var i=t[e],s=i.parentNode;s&&s.removeChild(i)}this._els.dhx_now_time=[]},t._marked_timespans={global:{}},t._get_zone_minutes=function(t){return 60*t.getHours()+t.getMinutes()},t._prepare_timespan_options=function(e){var i=[],s=[];if("fullweek"==e.days&&(e.days=[0,1,2,3,4,5,6]),e.days instanceof Array){for(var n=e.days.slice(),l=0;l<n.length;l++){var o=t._lame_clone(e);o.days=n[l],i.push.apply(i,t._prepare_timespan_options(o))}return i}if(!e||!(e.start_date&&e.end_date&&e.end_date>e.start_date||void 0!==e.days&&e.zones))return i;"fullday"==e.zones&&(e.zones=[0,1440]),e.zones&&e.invert_zones&&(e.zones=t.invertZones(e.zones)),e.id=t.uid(),e.css=e.css||"",e.type=e.type||"default";var r=e.sections;if(r){for(var a in r)if(r.hasOwnProperty(a)){var h=r[a];h instanceof Array||(h=[h]);for(l=0;l<h.length;l++){(m=t._lame_copy({},e)).sections={},m.sections[a]=h[l],s.push(m)}}}else s.push(e);for(var d=0;d<s.length;d++){var c=s[d],_=c.start_date,u=c.end_date;if(_&&u)for(var f=t.date.date_part(new Date(_)),p=t.date.add(f,1,"day");f<u;){var m;delete(m=t._lame_copy({},c)).start_date,delete m.end_date,m.days=f.valueOf();var g=_>f?t._get_zone_minutes(_):0,v=u>p||u.getDate()!=f.getDate()?1440:t._get_zone_minutes(u);m.zones=[g,v],i.push(m),f=p,p=t.date.add(p,1,"day")}else c.days instanceof Date&&(c.days=t.date.date_part(c.days).valueOf()),c.zones=e.zones.slice(),i.push(c)}return i},t._get_dates_by_index=function(e,i,s){var n=[];i=t.date.date_part(new Date(i||t._min_date)),s=new Date(s||t._max_date);for(var l=i.getDay(),o=e-l>=0?e-l:7-i.getDay()+e,r=t.date.add(i,o,"day");r<s;r=t.date.add(r,1,"week"))n.push(r);return n},t._get_css_classes_by_config=function(t){var e=[];return"dhx_time_block"==t.type&&(e.push("dhx_time_block"),t.css&&e.push("dhx_time_block_reset")),e.push("dhx_marked_timespan",t.css),e.join(" ")},t._get_block_by_config=function(t){var e=document.createElement("DIV");return t.html&&("string"==typeof t.html?e.innerHTML=t.html:e.appendChild(t.html)),e},t._render_marked_timespan=function(e,i,s){var n=[],l=t.config,o=this._min_date,r=this._max_date,a=!1;if(!l.display_marked_timespans)return n;if(!s&&0!==s){if(e.days<7)s=e.days;else{var h=new Date(e.days);if(a=+h,!(+r>+h&&+o<=+h))return n;s=h.getDay()}var d=o.getDay();d>s?s=7-(d-s):s-=d}var c=e.zones,_=t._get_css_classes_by_config(e);if(t._table_view&&"month"==t._mode){var u=[],f=[];if(i)u.push(i),f.push(s);else{f=a?[a]:t._get_dates_by_index(s);for(var p=0;p<f.length;p++)u.push(this._scales[f[p]])}for(p=0;p<u.length;p++){i=u[p],s=f[p];var m=Math.floor((this._correct_shift(s,1)-o.valueOf())/(864e5*this._cols.length)),g=this.locate_holder_day(s,!1)%this._cols.length;if(!this._ignores[g]){var v=t._get_block_by_config(e),b=Math.max(i.offsetHeight-1,0),x=Math.max(i.offsetWidth-1,0),w=this._colsS[g],y=this._colsS.heights[m]+(this._colsS.height?this.xy.month_scale_height+2:2)-1;v.className=_,v.style.top=y+"px",v.style.lineHeight=v.style.height=b+"px";for(var C=0;C<c.length;C+=2){var N=c[p];if((D=c[p+1])<=N)return[];(I=v.cloneNode(!0)).style.left=w+Math.round(N/1440*x)+"px",I.style.width=Math.round((D-N)/1440*x)+"px",i.appendChild(I),n.push(I)}}}}else{var k=s;if(this._ignores[this.locate_holder_day(s,!1)])return n;if(this._props&&this._props[this._mode]&&e.sections&&e.sections[this._mode]){var j=this._props[this._mode];k=j.order[e.sections[this._mode]];var S=j.order[e.sections[this._mode]];if(j.days>1)k=k*(j.size||j.options.length)+S;else k=S,j.size&&k>j.position+j.size&&(k=0)}i=i||t.locate_holder(k);for(p=0;p<c.length;p+=2){var D,I;N=Math.max(c[p],60*l.first_hour);if((D=Math.min(c[p+1],60*l.last_hour))<=N){if(p+2<c.length)continue;return[]}(I=t._get_block_by_config(e)).className=_;var E=24*this.config.hour_size_px+1;I.style.top=Math.round((60*N*1e3-36e5*this.config.first_hour)*this.config.hour_size_px/36e5)%E+"px",I.style.lineHeight=I.style.height=Math.max(Math.round(60*(D-N)*1e3*this.config.hour_size_px/36e5)%E,1)+"px",i.appendChild(I),n.push(I)}}return n},t._mark_timespans=function(){for(var e=this._els.dhx_cal_data[0],i=[],s=new Date(t._min_date),n=0,l=e.childNodes.length;n<l;n++){var o=e.childNodes[n];o.firstChild&&(o.firstChild.className||"").indexOf("dhx_scale_hour")>-1||(i.push.apply(i,t._on_scale_add_marker(o,s)),s=t.date.add(s,1,"day"))}return i},t.markTimespan=function(e){var i=!1;this._els.dhx_cal_data||(t.get_elements(),i=!0);var s=t._marked_timespans_ids,n=t._marked_timespans_types,l=t._marked_timespans;t.deleteMarkedTimespan(),t.addMarkedTimespan(e);var o=t._mark_timespans();return i&&(t._els=[]),t._marked_timespans_ids=s,t._marked_timespans_types=n,t._marked_timespans=l,o},t.unmarkTimespan=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];i.parentNode&&i.parentNode.removeChild(i)}},t._marked_timespans_ids={},t.addMarkedTimespan=function(e){var i=t._prepare_timespan_options(e);if(i.length){var s=i[0].id,n=t._marked_timespans,l=t._marked_timespans_ids;l[s]||(l[s]=[]);for(var o=0;o<i.length;o++){var r=i[o],a=r.days,h=(r.zones,r.css,r.sections),d=r.type;if(r.id=s,h){for(var c in h)if(h.hasOwnProperty(c)){n[c]||(n[c]={});var _=h[c],u=n[c];u[_]||(u[_]={}),u[_][a]||(u[_][a]={}),u[_][a][d]||(u[_][a][d]=[],t._marked_timespans_types||(t._marked_timespans_types={}),t._marked_timespans_types[d]||(t._marked_timespans_types[d]=!0));var f=u[_][a][d];r._array=f,f.push(r),l[s].push(r)}}else{n.global[a]||(n.global[a]={}),n.global[a][d]||(n.global[a][d]=[]),t._marked_timespans_types||(t._marked_timespans_types={}),t._marked_timespans_types[d]||(t._marked_timespans_types[d]=!0);f=n.global[a][d];r._array=f,f.push(r),l[s].push(r)}}return s}},t._add_timespan_zones=function(t,e){var i=t.slice();if(e=e.slice(),!i.length)return e;for(var s=0;s<i.length;s+=2)for(var n=i[s],l=i[s+1],o=s+2==i.length,r=0;r<e.length;r+=2){var a=e[r],h=e[r+1];if(h>l&&a<=l||a<n&&h>=n)i[s]=Math.min(n,a),i[s+1]=Math.max(l,h),s-=2;else{if(!o)continue;var d=n>a?0:2;i.splice(s+d,0,a,h)}e.splice(r--,2);break}return i},t._subtract_timespan_zones=function(t,e){for(var i=t.slice(),s=0;s<i.length;s+=2)for(var n=i[s],l=i[s+1],o=0;o<e.length;o+=2){var r=e[o],a=e[o+1];if(a>n&&r<l){var h=!1;n>=r&&l<=a&&i.splice(s,2),n<r&&(i.splice(s,2,n,r),h=!0),l>a&&i.splice(h?s+2:s,h?0:2,a,l),s-=2;break}}return i},t.invertZones=function(e){return t._subtract_timespan_zones([0,1440],e.slice())},t._delete_marked_timespan_by_id=function(e){var i=t._marked_timespans_ids[e];if(i)for(var s=0;s<i.length;s++)for(var n=i[s],l=n._array,o=0;o<l.length;o++)if(l[o]==n){l.splice(o,1);break}},t._delete_marked_timespan_by_config=function(e){var i=t._marked_timespans,s=e.sections,n=e.days,l=e.type||"default",o=[];if(s){for(var r in s)if(s.hasOwnProperty(r)&&i[r]){var a=s[r];i[r][a]&&i[r][a][n]&&i[r][a][n][l]&&(o=i[r][a][n][l])}}else i.global[n]&&i.global[n][l]&&(o=i.global[n][l]);for(var h=0;h<o.length;h++){var d=o[h],c=t._subtract_timespan_zones(d.zones,e.zones);if(c.length)d.zones=c;else{o.splice(h,1),h--;for(var _=t._marked_timespans_ids[d.id],u=0;u<_.length;u++)if(_[u]==d){_.splice(u,1);break}}}for(var h in t._marked_timespans.timeline)for(var f in t._marked_timespans.timeline[h])for(var u in t._marked_timespans.timeline[h][f])u===l&&delete t._marked_timespans.timeline[h][f][u]},t.deleteMarkedTimespan=function(e){if(arguments.length||(t._marked_timespans={global:{}},t._marked_timespans_ids={},t._marked_timespans_types={}),"object"!=typeof e)t._delete_marked_timespan_by_id(e);else{e.start_date&&e.end_date||(e.days||(e.days="fullweek"),e.zones||(e.zones="fullday"));var i=[];if(e.type)i.push(e.type);else for(var s in t._marked_timespans_types)i.push(s);for(var n=t._prepare_timespan_options(e),l=0;l<n.length;l++)for(var o=n[l],r=0;r<i.length;r++){var a=t._lame_clone(o);a.type=i[r],t._delete_marked_timespan_by_config(a)}}},t._get_types_to_render=function(t,e){var i=t||{};for(var s in e||{})e.hasOwnProperty(s)&&(i[s]=e[s]);return i},t._get_configs_to_render=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push.apply(e,t[i]);return e},t._on_scale_add_marker=function(e,i){if(!t._table_view||"month"==t._mode){var s=i.getDay(),n=i.valueOf(),l=this._mode,o=t._marked_timespans,r=[],a=[];if(this._props&&this._props[l]){var h=this._props[l],d=h.options,c=d[t._get_unit_index(h,i)];if(h.days>1){var _=Math.floor((i-t._min_date)/864e5);i=t.date.add(t._min_date,Math.floor(_/d.length),"day"),i=t.date.date_part(i)}else i=t.date.date_part(new Date(this._date));if(s=i.getDay(),n=i.valueOf(),o[l]&&o[l][c.key]){var u=o[l][c.key],f=t._get_types_to_render(u[s],u[n]);r.push.apply(r,t._get_configs_to_render(f))}}var p=o.global,m=p[n]||p[s];r.push.apply(r,t._get_configs_to_render(m));for(var g=0;g<r.length;g++)a.push.apply(a,t._render_marked_timespan(r[g],e,i));return a}},t.attachEvent("onScaleAdd",function(){t._on_scale_add_marker.apply(t,arguments)}),t.dblclick_dhx_marked_timespan=function(e,i){t.config.dblclick_create||t.callEvent("onScaleDblClick",[t.getActionData(e).date,i,e]),t.addEventNow(t.getActionData(e).date,null,e)}},t._temp_limit_scope()}),Scheduler.plugin(function(t){t._props={},t.createUnitsView=function(e,i,s,n,l,o,r){"object"==typeof e&&(s=e.list,i=e.property,n=e.size||0,l=e.step||1,o=e.skip_incorrect,r=e.days||1,e=e.name),t._props[e]={map_to:i,options:s,step:l,position:0,days:r},n>t._props[e].options.length&&(t._props[e]._original_size=n,n=0),t._props[e].size=n,t._props[e].skip_incorrect=o||!1,t.date[e+"_start"]=t.date.day_start,t.templates[e+"_date"]=function(i,s){return t._props[e].days>1?t.templates.week_date(i,s):t.templates.day_date(i)},t._get_unit_index=function(e,i){var s=e.position||0,n=Math.round((t._correct_shift(+i,1)-+t._min_date)/864e5),l=e.options.length;return n>=l&&(n%=l),s+n},t.templates[e+"_scale_text"]=function(t,e,i){return i.css?"<span class='"+i.css+"'>"+e+"</span>":e},t.templates[e+"_scale_date"]=function(i){var s=t._props[e],n=s.options;if(!n.length)return"";var l=n[t._get_unit_index(s,i)];return t.templates[e+"_scale_text"](l.key,l.label,l)},t.templates[e+"_second_scale_date"]=function(e){return t.templates.week_scale_date(e)},t.date["add_"+e]=function(i,s){return t.date.add(i,s*t._props[e].days,"day")},t.date["get_"+e+"_end"]=function(i){return t.date.add(i,(t._props[e].size||t._props[e].options.length)*t._props[e].days,"day")},t.attachEvent("onOptionsLoad",function(){for(var i=t._props[e],s=i.order={},n=i.options,l=0;l<n.length;l++)s[n[l].key]=l;i._original_size&&0===i.size&&(i.size=i._original_size,delete i.original_size),i.size>n.length?(i._original_size=i.size,i.size=0):i.size=i._original_size||i.size,t._date&&t._mode==e&&t.setCurrentView(t._date,t._mode)}),t["mouse_"+e]=function(e){var i=t._props[this._mode];if(i){if(e=this._week_indexes_from_pos(e),this._drag_event||(this._drag_event={}),this._drag_id&&this._drag_mode&&(this._drag_event._dhx_changed=!0),this._drag_mode&&"new-size"==this._drag_mode){var s=t._get_event_sday(t._events[t._drag_id]);Math.floor(e.x/i.options.length)!=Math.floor(s/i.options.length)&&(e.x=s)}var n=e.x%i.options.length,l=Math.min(n+i.position,i.options.length-1);e.section=(i.options[l]||{}).key,e.x=Math.floor(e.x/i.options.length);var o=this.getEvent(this._drag_id);this._update_unit_section({view:i,event:o,pos:e})}return e.force_redraw=!0,e},t.callEvent("onOptionsLoad",[])},t._update_unit_section=function(t){var e=t.view,i=t.event,s=t.pos;i&&(i[e.map_to]=s.section)},t.scrollUnit=function(e){var i=t._props[this._mode];i&&(i.position=Math.min(Math.max(0,i.position+e),i.options.length-i.size),this.setCurrentView())},function(){var e=function(e){var i=t._props[t._mode];if(i&&i.order&&i.skip_incorrect){for(var s=[],n=0;n<e.length;n++)void 0!==i.order[e[n][i.map_to]]&&s.push(e[n]);e.splice(0,e.length),e.push.apply(e,s)}return e},i=t._pre_render_events_table;t._pre_render_events_table=function(t,s){return t=e(t),i.apply(this,[t,s])};var s=t._pre_render_events_line;t._pre_render_events_line=function(t,i){return t=e(t),s.apply(this,[t,i])};var n=function(e,i){if(e&&void 0===e.order[i[e.map_to]]){var s=t,n=Math.floor((i.end_date-s._min_date)/864e5);return e.options.length&&(i[e.map_to]=e.options[Math.min(n+e.position,e.options.length-1)].key),!0}},l=t.is_visible_events;t.is_visible_events=function(e){var i=l.apply(this,arguments);if(i){var s=t._props[this._mode];if(s&&s.size){var n=s.order[e[s.map_to]];if(n<s.position||n>=s.size+s.position)return!1}}return i};var o=t._process_ignores;t._process_ignores=function(e,i,s,n,l){if(t._props[this._mode]){this._ignores={},this._ignores_detected=0;var r=t["ignore_"+this._mode];if(r){var a=t._props&&t._props[this._mode]?t._props[this._mode].size||t._props[this._mode].options.length:1;i/=a;for(var h=new Date(e),d=0;d<i;d++){if(r(h))for(var c=(d+1)*a,_=d*a;_<c;_++)this._ignores_detected+=1,this._ignores[_]=!0,l&&i++;h=t.date.add(h,n,s),t.date[s+"_start"]&&(h=t.date[s+"_start"](h))}}}else o.call(this,e,i,s,n,l)};var r=t._reset_scale;t._reset_scale=function(){var e=t._props[this._mode],i=r.apply(this,arguments);if(e){this._max_date=this.date.add(this._min_date,e.days,"day");for(var s=this._els.dhx_cal_data[0].childNodes,n=0;n<s.length;n++)s[n].className=s[n].className.replace("_now","");var l=new Date;if(l.valueOf()>=this._min_date&&l.valueOf()<this._max_date){var o=Math.floor((l-t._min_date)/864e5),a=e.options.length,h=o*a,d=h+a;for(n=h;n<d;n++)s[n]&&(s[n].className=s[n].className.replace("dhx_scale_holder","dhx_scale_holder_now"))}if(e.size&&e.size<e.options.length){var c=this._els.dhx_cal_header[0],_=document.createElement("DIV");e.position&&(_.className="dhx_cal_prev_button",_.style.cssText="left:1px;top:2px;position:absolute;",_.innerHTML="&nbsp;",c.firstChild.appendChild(_),_.onclick=function(){t.scrollUnit(-1*e.step)}),e.position+e.size<e.options.length&&((_=document.createElement("DIV")).className="dhx_cal_next_button",_.style.cssText="left:auto; right:0px;top:2px;position:absolute;",_.innerHTML="&nbsp;",c.lastChild.appendChild(_),_.onclick=function(){t.scrollUnit(e.step)})}}return i};var a=t._reset_scale;t._reset_scale=function(){var e=t._props[this._mode],i=t.xy.scale_height;e&&e.days>1?this._header_resized||(this._header_resized=t.xy.scale_height,t.xy.scale_height=2*i):this._header_resized&&(t.xy.scale_height/=2,this._header_resized=!1),a.apply(this,arguments)};var h=t._get_view_end;t._get_view_end=function(){var e=t._props[this._mode];if(e&&e.days>1){var i=this._get_timeunit_start();return t.date.add(i,e.days,"day")}return h.apply(this,arguments)};var d=t._render_x_header;t._render_x_header=function(e,i,s,n){var l=t._props[this._mode];if(!l||l.days<=1)return d.apply(this,arguments);if(l.days>1){var o=t.xy.scale_height;t.xy.scale_height=Math.ceil(o/2),d.call(this,e,i,s,n,Math.ceil(t.xy.scale_height));var r=l.options.length;if((e+1)%r==0){var a=document.createElement("DIV");a.className="dhx_scale_bar dhx_second_scale_bar";var h=this.date.add(this._min_date,Math.floor(e/r),"day");this.templates[this._mode+"_second_scalex_class"]&&(a.className+=" "+this.templates[this._mode+"_second_scalex_class"](new Date(h)));var c,_=this._cols[e]*r-1;c=r>1?this._colsS[e-(r-1)]-this.xy.scale_width-2:i,this.set_xy(a,_,this.xy.scale_height-2,c,0),a.innerHTML=this.templates[this._mode+"_second_scale_date"](new Date(h),this._mode),n.appendChild(a)}t.xy.scale_height=o}};var c=t._get_event_sday;t._get_event_sday=function(e){var i=t._props[this._mode];if(i){if(i.days<=1)return n(i,e),this._get_section_sday(e[i.map_to]);return Math.floor((e.end_date.valueOf()-1-60*e.end_date.getTimezoneOffset()*1e3-(t._min_date.valueOf()-60*t._min_date.getTimezoneOffset()*1e3))/864e5)*i.options.length+i.order[e[i.map_to]]-i.position}return c.call(this,e)},t._get_section_sday=function(e){var i=t._props[this._mode];return i.order[e]-i.position};var _=t.locate_holder_day;t.locate_holder_day=function(e,i,s){var l,o=t._props[this._mode];if(!o)return _.apply(this,arguments);if(s?n(o,s):(s={start_date:e,end_date:e},l=0),o.days<=1)return 1*(void 0===l?o.order[s[o.map_to]]:l)+(i?1:0)-o.position;return Math.floor((s.start_date.valueOf()-t._min_date.valueOf())/864e5)*o.options.length+1*(void 0===l?o.order[s[o.map_to]]:l)+(i?1:0)-o.position};var u=t._time_order;t._time_order=function(e){var i=t._props[this._mode];i?e.sort(function(t,e){return i.order[t[i.map_to]]>i.order[e[i.map_to]]?1:-1}):u.apply(this,arguments)};var f=t._pre_render_events_table;t._pre_render_events_table=function(e,i){var s=t._props[this._mode];if(s&&s.days>1&&!this.config.all_timed){for(var n={},l=0;l<e.length;l++){var o=e[l];if(this.isOneDayEvent(e[l])){n[h=+t.date.date_part(new Date(o.start_date))]||(n[h]=[]),n[h].push(o)}else{var r=new Date(Math.min(+o.end_date,+this._max_date)),a=new Date(Math.max(+o.start_date,+this._min_date));for(e.splice(l,1);+a<+r;){var h,d=this._copy_event(o);d.start_date=a,d.end_date=_(d.start_date),a=t.date.add(a,1,"day"),n[h=+t.date.date_part(new Date(a))]||(n[h]=[]),n[h].push(d),e.splice(l,0,d),l++}l--}}var c=[];for(var l in n)c.splice.apply(c,[c.length-1,0].concat(f.apply(this,[n[l],i])));for(l=0;l<c.length;l++)this._ignores[c[l]._sday]?(c.splice(l,1),l--):c[l]._first_chunk=c[l]._last_chunk=!1;c.sort(function(t,e){return t.start_date.valueOf()==e.start_date.valueOf()?t.id>e.id?1:-1:t.start_date>e.start_date?1:-1}),e=c}else e=f.apply(this,[e,i]);function _(e){var i=t.date.add(e,1,"day");return i=t.date.date_part(i)}return e},t.attachEvent("onEventAdded",function(e,i){if(this._loading)return!0;for(var s in t._props){var n=t._props[s];void 0===i[n.map_to]&&(i[n.map_to]=n.options[0].key)}return!0}),t.attachEvent("onEventCreated",function(e,i){var s=t._props[this._mode];if(s&&i){var l=this.getEvent(e);n(s,l);var o=this._mouse_coords(i);this._update_unit_section({view:s,event:l,pos:o}),this.event_updated(l)}return!0})}()}),Scheduler.plugin(function(t){var e;(e=t.dhtmlXTooltip=t.tooltip={}).config={className:"dhtmlXTooltip tooltip",timeout_to_display:50,timeout_to_hide:50,delta_x:15,delta_y:-20},e.tooltip=document.createElement("div"),e.tooltip.className=e.config.className,e.show=function(i,s){if(!t.config.touch||t.config.touch_tooltip){var n=e,l=this.tooltip.style;n.tooltip.className=n.config.className;var o=this.position(i),r=i.target||i.srcElement;if(!this.isTooltip(r)){var a=o.x+(n.config.delta_x||0),h=o.y-(n.config.delta_y||0);l.visibility="hidden",l.removeAttribute?(l.removeAttribute("right"),l.removeAttribute("bottom")):(l.removeProperty("right"),l.removeProperty("bottom")),l.left="0",l.top="0",this.tooltip.innerHTML=s,document.body.appendChild(this.tooltip);var d=this.tooltip.offsetWidth,c=this.tooltip.offsetHeight;document.body.offsetWidth-a-d<0?(l.removeAttribute?l.removeAttribute("left"):l.removeProperty("left"),l.right=document.body.offsetWidth-a+2*(n.config.delta_x||0)+"px"):l.left=a<0?o.x+Math.abs(n.config.delta_x||0)+"px":a+"px",document.body.offsetHeight-h-c<0?(l.removeAttribute?l.removeAttribute("top"):l.removeProperty("top"),l.bottom=document.body.offsetHeight-h-2*(n.config.delta_y||0)+"px"):l.top=h<0?o.y+Math.abs(n.config.delta_y||0)+"px":h+"px",l.visibility="visible",this.tooltip.onmouseleave=function(e){e=e||window.event;for(var i=t.dhtmlXTooltip,s=e.relatedTarget;s!=t._obj&&s;)s=s.parentNode;s!=t._obj&&i.delay(i.hide,i,[],i.config.timeout_to_hide)},t.callEvent("onTooltipDisplayed",[this.tooltip,this.tooltip.event_id])}}},e._clearTimeout=function(){this.tooltip._timeout_id&&window.clearTimeout(this.tooltip._timeout_id)},e.hide=function(){if(this.tooltip.parentNode){var e=this.tooltip.event_id;this.tooltip.event_id=null,this.tooltip.onmouseleave=null,this.tooltip.parentNode.removeChild(this.tooltip),t.callEvent("onAfterTooltip",[e])}this._clearTimeout()},e.delay=function(t,e,i,s){this._clearTimeout(),this.tooltip._timeout_id=setTimeout(function(){var s=t.apply(e,i);return t=e=i=null,s},s||this.config.timeout_to_display)},e.isTooltip=function(t){var e=!1;for(t.className.split(" ")[0];t&&!e;)e=t.className==this.tooltip.className,t=t.parentNode;return e},e.position=function(t){if((t=t||window.event).pageX||t.pageY)return{x:t.pageX,y:t.pageY};var e=window._isIE&&"BackCompat"!=document.compatMode?document.documentElement:document.body;return{x:t.clientX+e.scrollLeft-e.clientLeft,y:t.clientY+e.scrollTop-e.clientTop}},t.attachEvent("onMouseMove",function(i,s){var n=window.event||s,l=n.target||n.srcElement,o=e,r=o.isTooltip(l),a=o.isTooltipTarget&&o.isTooltipTarget(l);if(i||r||a){var h,d;if(i||o.tooltip.event_id){var c=t.getEvent(i)||t.getEvent(o.tooltip.event_id);if(!c)return;if(o.tooltip.event_id=c.id,!(h=t.templates.tooltip_text(c.start_date,c.end_date,c)))return o.hide()}if(a&&(h=""),_isIE)for(var _ in d={pageX:void 0,pageY:void 0,clientX:void 0,clientY:void 0,target:void 0,srcElement:void 0})d[_]=n[_];if(!t.callEvent("onBeforeTooltip",[i])||!h)return;o.delay(o.show,o,[d||n,h])}else o.delay(o.hide,o,[],o.config.timeout_to_hide)}),t.attachEvent("onBeforeDrag",function(){return e.hide(),!0}),t.attachEvent("onEventDeleted",function(){return e.hide(),!0}),t.templates.tooltip_date_format=t.date.date_to_str("%Y-%m-%d %H:%i"),t.templates.tooltip_text=function(e,i,s){return"<b>Event:</b> "+s.text+"<br/><b>Start date:</b> "+t.templates.tooltip_date_format(e)+"<br/><b>End date:</b> "+t.templates.tooltip_date_format(i)}}),Scheduler.plugin(function(t){t._temp_matrix_scope=function(){function e(e,i,s){var n=0,l=s._step,o=s.round_position,r=0,a=i?e.end_date:e.start_date;a.valueOf()>t._max_date.valueOf()&&(a=t._max_date);var h=a-t._min_date_timeline;if(h>0){var d=t._get_date_index(s,a);t._ignores[d]&&(o=!0);for(var c=0;c<d;c++)n+=t._cols[c];var _=t.date.add(t._min_date_timeline,t.matrix[t._mode].x_step*d,t.matrix[t._mode].x_unit);o?+a>+_&&i&&(r=t._cols[d]):(h=a-_,s.first_hour||s.last_hour?((h-=s._start_correction)<0&&(h=0),(r=Math.round(h/l))>t._cols[d]&&(r=t._cols[d])):r=Math.round(h/l))}return n+=i?0===h||o?r-14:r-12:r+1}function i(e,i){var s=t._get_date_index(this,e),n=this._trace_x[s];return i&&+e!=+this._trace_x[s]&&(n=this._trace_x[s+1]?this._trace_x[s+1]:t.date.add(this._trace_x[s],this.x_step,this.x_unit)),new Date(n)}function s(e){var s="";if(e&&"cell"!=this.render){(function(e){if(t._ignores_detected)for(var i,s,n,l,o=0;o<e.length;o++){for(l=e[o],n=!1,i=t._get_date_index(this,l.start_date),s=t._get_date_index(this,l.end_date);i<s;){if(!t._ignores[i]){n=!0;break}i++}n||i!=s||t._ignores[s]||+l.end_date>+this._trace_x[s]&&(n=!0),n||(e.splice(o,1),o--)}}).call(this,e),e.sort(this.sort||function(t,e){return t.start_date.valueOf()==e.start_date.valueOf()?t.id>e.id?1:-1:t.start_date>e.start_date?1:-1});for(var n=[],l=e.length,o=0;o<l;o++){var r=e[o];r._inner=!1;var a=this.round_position?i.apply(this,[r.start_date,!1]):r.start_date;for(this.round_position?i.apply(this,[r.end_date,!0]):r.end_date;n.length;){if(!(n[n.length-1].end_date.valueOf()<=a.valueOf()))break;n.splice(n.length-1,1)}for(var h=!1,d=0;d<n.length;d++){var c=n[d];if(c.end_date.valueOf()<=a.valueOf()){h=!0,r._sorder=c._sorder,n.splice(d,1),r._inner=!0;break}}if(n.length&&(n[n.length-1]._inner=!0),!h)if(n.length)if(n.length<=n[n.length-1]._sorder){if(n[n.length-1]._sorder)for(var _=0;_<n.length;_++){for(var u=!1,f=0;f<n.length;f++)if(n[f]._sorder==_){u=!0;break}if(!u){r._sorder=_;break}}else r._sorder=0;r._inner=!0}else{for(var p=n[0]._sorder,m=1;m<n.length;m++)n[m]._sorder>p&&(p=n[m]._sorder);r._sorder=p+1,r._inner=!1}else r._sorder=0;n.push(r),n.length>(n.max_count||0)?(n.max_count=n.length,r._count=n.length):r._count=r._count?r._count:1}for(var g=0;g<e.length;g++)e[g]._count=n.max_count;for(var v=0;v<l;v++)s+=t.render_timeline_event.call(this,e[v],!1)}return s}function n(e){var i="<table style='table-layout:fixed;' cellspacing='0' cellpadding='0'>",n=[];if(t._load_mode&&t._load(),"cell"==this.render)n=function(){for(var e,i=t.get_visible_events(),s=[],n=0;n<this.y_unit.length;n++)s[n]=[];for(s[e]||(s[e]=[]),n=0;n<i.length;n++){e=this.order[i[n][this.y_property]];for(var l=0;this._trace_x[l+1]&&i[n].start_date>=this._trace_x[l+1];)l++;for(;this._trace_x[l]&&i[n].end_date>this._trace_x[l];)s[e][l]||(s[e][l]=[]),s[e][l].push(i[n]),l++}return s}.call(this);else for(var l=t.get_visible_events(),o=this.order,r=0;r<l.length;r++){var a=l[r],h=a[this.y_property],d=this.order[h];if(this.show_unassigned&&!h){for(var c in o)if(o.hasOwnProperty(c)){n[d=o[c]]||(n[d]=[]);var _=t._lame_copy({},a);_[this.y_property]=c,n[d].push(_)}}else n[d]||(n[d]=[]),n[d].push(a)}for(var u=0,f=0;f<t._cols.length;f++)u+=t._cols[f];var p=new Date,m=t._cols.length-t._ignores_detected;p=(t.date.add(p,this.x_step*m,this.x_unit)-p-(this._start_correction+this._end_correction)*m)/u,this._step=p,this._summ=u;var g=t._colsS.heights=[],v=[];this._events_height={},this._section_height={};for(f=0;f<this.y_unit.length;f++){var b=this._logic(this.render,this.y_unit[f],this);t._merge(b,{height:this.dy}),this.section_autoheight&&(this.y_unit.length*b.height<e.offsetHeight&&(b.height=Math.max(b.height,Math.floor((e.offsetHeight-1)/this.y_unit.length))),this._section_height[this.y_unit[f].key]=b.height),b.td_className||(b.td_className="dhx_matrix_scell"+(t.templates[this.name+"_scaley_class"](this.y_unit[f].key,this.y_unit[f].label,this.y_unit[f])?" "+t.templates[this.name+"_scaley_class"](this.y_unit[f].key,this.y_unit[f].label,this.y_unit[f]):"")),b.td_content||(b.td_content=t.templates[this.name+"_scale_label"](this.y_unit[f].key,this.y_unit[f].label,this.y_unit[f])),t._merge(b,{tr_className:"",style_height:"height:"+b.height+"px;",style_width:"width:"+(this.dx-1)+"px;",summ_width:"width:"+u+"px;",table_className:""});var x=s.call(this,n[f]);if(this.fit_events){var w=this._events_height[this.y_unit[f].key]||0;b.height=w>b.height?w:b.height,b.style_height="height:"+b.height+"px;",this._section_height[this.y_unit[f].key]=b.height}if(i+="<tr class='"+b.tr_className+"' style='"+b.style_height+"'><td class='"+b.td_className+"' style='"+b.style_width+" height:"+(b.height-1)+"px;'>"+b.td_content+"</td>","cell"==this.render)for(r=0;r<t._cols.length;r++)t._ignores[r]?i+="<td></td>":i+="<td class='dhx_matrix_cell "+t.templates[this.name+"_cell_class"](n[f][r],this._trace_x[r],this.y_unit[f])+"' style='width:"+(t._cols[r]-1)+"px'><div style='width:"+(t._cols[r]-1)+"px'>"+t.templates[this.name+"_cell_value"](n[f][r],this._trace_x[r],this.y_unit[f])+"</div></td>";else{i+="<td><div style='"+b.summ_width+" "+b.style_height+" position:relative;' class='dhx_matrix_line'>",i+=x,i+="<table class='"+b.table_className+"' cellpadding='0' cellspacing='0' style='"+b.summ_width+" "+b.style_height+"' >";for(r=0;r<t._cols.length;r++)t._ignores[r]?i+="<td></td>":i+="<td class='dhx_matrix_cell "+t.templates[this.name+"_cell_class"](n[f],this._trace_x[r],this.y_unit[f])+"' style='width:"+(t._cols[r]-1)+"px'><div style='width:"+(t._cols[r]-1)+"px'></div></td>";i+="</table>",i+="</div></td>"}i+="</tr>",v.push(b)}i+="</table>",this._matrix=n,e.innerHTML=i,t._rendered=[];var y=t._obj.getElementsByTagName("DIV");for(f=0;f<y.length;f++)y[f].getAttribute("event_id")&&t._rendered.push(y[f]);this._scales={};for(var C=e.firstChild.rows,N=null,k=(f=0,v.length);f<k;f++){N=this.y_unit[f],g.push(v[f].height);var j=N.key,S=this._scales[j]=t._isRender("cell")?C[f]:C[f].childNodes[1].getElementsByTagName("div")[0];t.callEvent("onScaleAdd",[S,j])}}function l(e){var i=t.xy.scale_height,s=this._header_resized||t.xy.scale_height;t._cols=[],t._colsS={height:0},this._trace_x=[];var n=t._x-this.dx-t.xy.scroll_width,l=[this.dx];t._els.dhx_cal_header[0].style.width=l[0]+n+"px";for(var r=t._min_date_timeline=t._min_date,a=t.config.preserve_scale_length,d=function(e){var i=t._min_date,s=t._max_date;t._process_ignores(i,this.x_size,this.x_unit,this.x_step,e),this.x_size,e&&t._ignores_detected;for(var n=0,l=0;+i<+s;)if(this._trace_x[l]=new Date(i),i=t.date.add(i,this.x_step,this.x_unit),t.date[this.x_unit+"_start"]&&(i=t.date[this.x_unit+"_start"](i)),t._ignores[l]||n++,l++,e)if(n<this.x_size&&!(+i<+s))s=t.date["add_"+this.name+"_private"](s,(this.x_length||this.x_size)*this.x_step);else if(n>=this.x_size){t._max_date=i;break}return{total:l,displayed:n}}.call(this,a),c=d.displayed,_=d.total,u=0;u<_;u++)t._ignores[u]?(t._cols[u]=0,c++):t._cols[u]=Math.floor(n/(c-u)),n-=t._cols[u],l[u+1]=l[u]+t._cols[u];if(e.innerHTML="<div></div>",this.second_scale){for(var f=this.second_scale.x_unit,p=[this._trace_x[0]],m=[],g=[this.dx,this.dx],v=0,b=0;b<this._trace_x.length;b++){var x=this._trace_x[b];o(f,x,p[v])&&(p[++v]=x,g[v+1]=g[v]);var w=v+1;m[v]=t._cols[b]+(m[v]||0),g[w]+=t._cols[b]}e.innerHTML="<div></div><div></div>";var y=e.firstChild;y.style.height=s+"px",e.lastChild.style.position="relative";for(var C=0;C<p.length;C++){var N=p[C],k=t.templates[this.name+"_second_scalex_class"](N),j=document.createElement("DIV");j.className="dhx_scale_bar dhx_second_scale_bar"+(k?" "+k:""),t.set_xy(j,m[C]-1,s-3,g[C],0),j.innerHTML=t.templates[this.name+"_second_scale_date"](N),y.appendChild(j)}}t.xy.scale_height=s,e=e.lastChild;for(var S=0;S<this._trace_x.length;S++)if(!t._ignores[S]){r=this._trace_x[S],t._render_x_header(S,l[S],r,e);var D=t.templates[this.name+"_scalex_class"](r);D&&(e.lastChild.className+=" "+D)}t.xy.scale_height=i;var I=this._trace_x;e.onclick=function(e){var i=h(e);i&&t.callEvent("onXScaleClick",[i.x,I[i.x],e||event])},e.ondblclick=function(e){var i=h(e);i&&t.callEvent("onXScaleDblClick",[i.x,I[i.x],e||event])}}function o(e,i,s){switch(e){case"hour":return i.getHours()!=s.getHours()||o("day",i,s);case"day":return!(i.getDate()==s.getDate()&&i.getMonth()==s.getMonth()&&i.getFullYear()==s.getFullYear());case"week":return!(t.date.week_start(new Date(i)).valueOf()==t.date.week_start(new Date(s)).valueOf());case"month":return!(i.getMonth()==s.getMonth()&&i.getFullYear()==s.getFullYear());case"year":return!(i.getFullYear()==s.getFullYear());default:return!1}}function r(e){if(this._header_resized&&(!e||!this.second_scale)){t.xy.scale_height/=2,this._header_resized=!1;var i=t._els.dhx_cal_header[0];i.className=i.className.replace(/ dhx_second_cal_header/gi,"")}}function a(){t._tooltip&&(t._tooltip.style.display="none",t._tooltip.date="")}function h(t){for(var e=(t=t||event).target?t.target:t.srcElement;e&&"DIV"!=e.tagName;)e=e.parentNode;if(e&&"DIV"==e.tagName&&"dhx_scale_bar"==e.className.split(" ")[0])return{x:function(t){for(var e=t.parentNode.childNodes,i=0;i<e.length;i++)if(e[i]==t)return i;return-1}(e),y:-1,src:e,scale:!0}}t.matrix={},t._merge=function(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i])},t.createTimelineView=function(e){t._skin_init(),t._merge(e,{section_autoheight:!0,name:"matrix",x:"time",y:"time",x_step:1,x_unit:"hour",y_unit:"day",y_step:1,x_start:0,x_size:24,y_start:0,y_size:7,render:"cell",dx:200,dy:50,event_dy:t.xy.bar_height-5,event_min_dy:t.xy.bar_height-5,resize_events:!0,fit_events:!0,show_unassigned:!1,second_scale:!1,round_position:!1,_logic:function(e,i,s){var n={};return t.checkEvent("onBeforeSectionRender")&&(n=t.callEvent("onBeforeSectionRender",[e,i,s])),n}}),e._original_x_start=e.x_start,"day"!=e.x_unit&&(e.first_hour=e.last_hour=0),e._start_correction=e.first_hour?60*e.first_hour*60*1e3:0,e._end_correction=e.last_hour?60*(24-e.last_hour)*60*1e3:0,t.checkEvent("onTimelineCreated")&&t.callEvent("onTimelineCreated",[e]);var s=t.render_data;t.render_data=function(i,n){if(this._mode!=e.name)return s.apply(this,arguments);if(n&&!e.show_unassigned&&"cell"!=e.render)for(var l=0;l<i.length;l++)this.clear_event(i[l]),this.render_timeline_event.call(this.matrix[this._mode],i[l],!0);else t._renderMatrix.call(e,!0,!0)},t.matrix[e.name]=e,t.templates[e.name+"_cell_value"]=function(t){return t?t.length:""},t.templates[e.name+"_cell_class"]=function(t){return""},t.templates[e.name+"_scalex_class"]=function(t){return""},t.templates[e.name+"_second_scalex_class"]=function(t){return""},t.templates[e.name+"_scaley_class"]=function(t,e,i){return""},t.templates[e.name+"_scale_label"]=function(t,e,i){return e},t.templates[e.name+"_tooltip"]=function(t,e,i){return i.text},t.templates[e.name+"_date"]=function(e,i){return e.getDay()==i.getDay()&&i-e<864e5||+e==+t.date.date_part(new Date(i))||+t.date.add(e,1,"day")==+i&&0===i.getHours()&&0===i.getMinutes()?t.templates.day_date(e):e.getDay()!=i.getDay()&&i-e<864e5?t.templates.day_date(e)+" &ndash; "+t.templates.day_date(i):t.templates.week_date(e,i)},t.templates[e.name+"_scale_date"]=t.date.date_to_str(e.x_date||t.config.hour_date),t.templates[e.name+"_second_scale_date"]=t.date.date_to_str(e.second_scale&&e.second_scale.x_date?e.second_scale.x_date:t.config.hour_date),t.date["add_"+e.name+"_private"]=function(i,s){var n=s,l=e.x_unit;if("minute"==e.x_unit||"hour"==e.x_unit){var o=n;"hour"==e.x_unit&&(o*=60),o%1440||(n=o/1440,l="day")}return t.date.add(i,n,l)},t.date["add_"+e.name]=function(i,s,n){var l=t.date["add_"+e.name+"_private"](i,(e.x_length||e.x_size)*e.x_step*s);if("minute"==e.x_unit||"hour"==e.x_unit){var o=e.x_length||e.x_size,r="hour"==e.x_unit?60*e.x_step:e.x_step;if(r*o%1440)if(+t.date.date_part(new Date(i))==+t.date.date_part(new Date(l)))e.x_start+=s*o;else{var a=1440/(o*r)-1,h=Math.round(a*o);e.x_start=s>0?e.x_start-h:h+e.x_start}}return l},t.date[e.name+"_start"]=function(i){var s=(t.date[e.x_unit+"_start"]||t.date.day_start).call(t.date,i);return s=t.date.add(s,e.x_step*e.x_start,e.x_unit)},t.callEvent("onOptionsLoad",[e]),t[e.name+"_view"]=function(i){i?t._set_timeline_dates(e):t._renderMatrix.apply(e,arguments)};var n=new Date;t.date.add(n,e.x_step,e.x_unit).valueOf(),n.valueOf();t["mouse_"+e.name]=function(s){var n=this._drag_event;this._drag_id&&(n=this.getEvent(this._drag_id)),s.x-=e.dx;var l=t._timeline_drag_date(e,s.x);if(s.x=0,s.force_redraw=!0,s.custom=!0,"move"==this._drag_mode&&this._drag_id&&this._drag_event){n=this.getEvent(this._drag_id);var o=this._drag_event;if(s._ignores=this._ignores_detected||e._start_correction||e._end_correction,void 0===o._move_delta&&(o._move_delta=(n.start_date-l)/6e4,this.config.preserve_length&&s._ignores&&(o._move_delta=this._get_real_event_length(n.start_date,l,e),o._event_length=this._get_real_event_length(n.start_date,n.end_date,e))),this.config.preserve_length&&s._ignores){o._event_length;var r=this._get_fictional_event_length(l,o._move_delta,e,!0);l=new Date(l-r)}else l=t.date.add(l,o._move_delta,"minute")}if("resize"==this._drag_mode&&n&&(!this.config.timeline_swap_resize&&this._drag_id&&(this._drag_from_start&&+l>+n.end_date?this._drag_from_start=!1:!this._drag_from_start&&+l<+n.start_date&&(this._drag_from_start=!0)),s.resize_from_start=this._drag_from_start,!this.config.timeline_swap_resize&&this._drag_id&&this._drag_from_start&&+l>=+t.date.add(n.end_date,-t.config.time_step,"minute")&&(l=t.date.add(n.end_date,-t.config.time_step,"minute"))),e.round_position)switch(this._drag_mode){case"move":this.config.preserve_length||(l=i.call(e,l,!1),"day"==e.x_unit&&(s.custom=!1));break;case"resize":this._drag_event&&(null!==this._drag_event._resize_from_start&&void 0!==this._drag_event._resize_from_start||(this._drag_event._resize_from_start=s.resize_from_start),s.resize_from_start=this._drag_event._resize_from_start,l=i.call(e,l,!this._drag_event._resize_from_start))}this._resolve_timeline_section(e,s),s.section&&this._update_timeline_section({pos:s,event:this.getEvent(this._drag_id),view:e}),s.y=Math.round((this._correct_shift(l,1)-this._min_date)/(6e4*this.config.time_step)),s.shift=this.config.time_step;var a=this._is_pos_changed(this._drag_pos,s);return this._drag_pos&&a&&(this._drag_event._dhx_changed=!0),a||this._drag_pos.has_moved||(s.force_redraw=!1),s}},t._get_timeline_event_height=function(t,e){var i=t[e.y_property],s=e.event_dy;return"full"==e.event_dy&&(s=e.section_autoheight?e._section_height[i]-6:e.dy-3),e.resize_events&&(s=Math.max(Math.floor(s/t._count),e.event_min_dy)),s},t._get_timeline_event_y=function(e,i){var s=e,n=2+s*i+(s?2*s:0);return t.config.cascade_event_display&&(n=2+s*t.config.cascade_event_margin+(s?2*s:0)),n},t.render_timeline_event=function(i,s){var n=i[this.y_property];if(!n)return"";var l=i._sorder,o=e(i,!1,this),r=e(i,!0,this),a=t._get_timeline_event_height(i,this),h=a-2;i._inner||"full"!=this.event_dy||(h=(h+2)*(i._count-l)-2);var d=t._get_timeline_event_y(i._sorder,a),c=a+d+2;(!this._events_height[n]||this._events_height[n]<c)&&(this._events_height[n]=c);var _=t.templates.event_class(i.start_date,i.end_date,i);_="dhx_cal_event_line "+(_||""),i._no_drag_move&&(_+=" no_drag_move");var u=i.color?"background:"+i.color+";":"",f=i.textColor?"color:"+i.textColor+";":"",p=t.templates.event_bar_text(i.start_date,i.end_date,i),m='<div event_id="'+i.id+'" class="'+_+'" style="'+u+f+"position:absolute; top:"+d+"px; height: "+h+"px; left:"+o+"px; width:"+Math.max(0,r-o)+"px;"+(i._text_style||"")+'">';if(t.config.drag_resize&&!t.config.readonly){var g="<div class='dhx_event_resize dhx_event_resize_start' style='height: "+h+"px;'></div>",v="<div class='dhx_event_resize dhx_event_resize_end' style='height: "+h+"px;'></div>";m+=(i._no_resize_start?"":g)+(i._no_resize_end?"":v)}if(m+=p+"</div>",!s)return m;var b=document.createElement("DIV");b.innerHTML=m;var x=this.order[n],w=t._els.dhx_cal_data[0].firstChild.rows[x];if(w){var y=w.cells[1].firstChild;t._rendered.push(b.firstChild),y.appendChild(b.firstChild)}},t._matrix_tooltip_handler=function(e){var i=t.matrix[t._mode];if(i&&"cell"==i.render){if(i){var s=t._locate_cell_timeline(e);(e=e||event).target||e.srcElement;if(s)return function(e,i,s){if("cell"==e.render){var n=i.x+"_"+i.y,l=e._matrix[i.y][i.x];if(!l)return a();if(l.sort(function(t,e){return t.start_date>e.start_date?1:-1}),t._tooltip){if(t._tooltip.date==n)return;t._tooltip.innerHTML=""}else{var o=t._tooltip=document.createElement("DIV");o.className="dhx_year_tooltip",document.body.appendChild(o),o.onclick=t._click.dhx_cal_data}for(var r="",h=0;h<l.length;h++){var d=l[h].color?"background-color:"+l[h].color+";":"",c=l[h].textColor?"color:"+l[h].textColor+";":"";r+="<div class='dhx_tooltip_line' event_id='"+l[h].id+"' style='"+d+c+"'>",r+="<div class='dhx_tooltip_date'>"+(l[h]._timed?t.templates.event_date(l[h].start_date):"")+"</div>",r+="<div class='dhx_event_icon icon_details'>&nbsp;</div>",r+=t.templates[e.name+"_tooltip"](l[h].start_date,l[h].end_date,l[h])+"</div>"}t._tooltip.style.display="",t._tooltip.style.top="0px",document.body.offsetWidth-s.left-t._tooltip.offsetWidth<0?t._tooltip.style.left=s.left-t._tooltip.offsetWidth+"px":t._tooltip.style.left=s.left+i.src.offsetWidth+"px",t._tooltip.date=n,t._tooltip.innerHTML=r,document.body.offsetHeight-s.top-t._tooltip.offsetHeight<0?t._tooltip.style.top=s.top-t._tooltip.offsetHeight+i.src.offsetHeight+"px":t._tooltip.style.top=s.top+"px"}}(i,s,getOffset(s.src))}a()}},t._init_matrix_tooltip=function(){t._detachDomEvent(t._els.dhx_cal_data[0],"mouseover",t._matrix_tooltip_handler),dhtmlxEvent(t._els.dhx_cal_data[0],"mouseover",t._matrix_tooltip_handler)},t._set_timeline_dates=function(e){t._min_date=t.date[e.name+"_start"](new Date(t._date)),t._max_date=t.date["add_"+e.name+"_private"](t._min_date,e.x_size*e.x_step),t.date[e.x_unit+"_start"]&&(t._max_date=t.date[e.x_unit+"_start"](t._max_date)),t._table_view=!0},t._renderMatrix=function(e,i){i||(t._els.dhx_cal_data[0].scrollTop=0),t._set_timeline_dates(this),function(e){if(r.call(this,e),e){this.second_scale&&!this._header_resized&&(this._header_resized=t.xy.scale_height,t.xy.scale_height*=2,t._els.dhx_cal_header[0].className+=" dhx_second_cal_header"),t.set_sizes(),t._init_matrix_tooltip();var i=t._min_date;l.call(this,t._els.dhx_cal_header[0]),n.call(this,t._els.dhx_cal_data[0]),t._min_date=i,t._els.dhx_cal_date[0].innerHTML=t.templates[this.name+"_date"](t._min_date,t._max_date),t._mark_now&&t._mark_now(),r.call(this,e)}a()}.call(this,e)},t._locate_cell_timeline=function(e){for(var i=(e=e||event).target?e.target:e.srcElement,s={},n=t.matrix[t._mode],l=t.getActionData(e),o=t._ignores,r=0,a=0;a<n._trace_x.length-1&&!(+l.date<n._trace_x[a+1]);a++)o[a]||r++;s.x=0===r?0:a,s.y=n.order[l.section];var h=t._isRender("cell")?1:0;s.src=n._scales[l.section]?n._scales[l.section].getElementsByTagName("td")[a+h]:null;for(var d=!1;0===s.x&&"dhx_cal_data"!=i.className&&i.parentNode;){if("dhx_matrix_scell"==i.className.split(" ")[0]){d=!0;break}i=i.parentNode}return d?(s.x=-1,s.src=i,s.scale=!0):s.x=a,s};var d=t._click.dhx_cal_data;t._click.dhx_marked_timespan=t._click.dhx_cal_data=function(e){var i=d.apply(this,arguments),s=t.matrix[t._mode];if(s){var n=t._locate_cell_timeline(e);n&&(n.scale?t.callEvent("onYScaleClick",[n.y,s.y_unit[n.y],e||event]):t.callEvent("onCellClick",[n.x,n.y,s._trace_x[n.x],(s._matrix[n.y]||{})[n.x]||[],e||event]))}return i},t.dblclick_dhx_matrix_cell=function(e){var i=t.matrix[t._mode];if(i){var s=t._locate_cell_timeline(e);s&&(s.scale?t.callEvent("onYScaleDblClick",[s.y,i.y_unit[s.y],e||event]):t.callEvent("onCellDblClick",[s.x,s.y,i._trace_x[s.x],(i._matrix[s.y]||{})[s.x]||[],e||event]))}};var c=t.dblclick_dhx_marked_timespan||function(){};t.dblclick_dhx_marked_timespan=function(e){return t.matrix[t._mode]?t.dblclick_dhx_matrix_cell(e):c.apply(this,arguments)},t.dblclick_dhx_matrix_scell=function(e){return t.dblclick_dhx_matrix_cell(e)},t._isRender=function(e){return t.matrix[t._mode]&&t.matrix[t._mode].render==e},t.attachEvent("onCellDblClick",function(e,i,s,n,l){if(!this.config.readonly&&("dblclick"!=l.type||this.config.dblclick_create)){var o=t.matrix[t._mode],r={};r.start_date=o._trace_x[e],r.end_date=o._trace_x[e+1]?o._trace_x[e+1]:t.date.add(o._trace_x[e],o.x_step,o.x_unit),o._start_correction&&(r.start_date=new Date(1*r.start_date+o._start_correction)),o._end_correction&&(r.end_date=new Date(r.end_date-o._end_correction)),r[o.y_property]=o.y_unit[i].key,t.addEventNow(r,null,l)}}),t.attachEvent("onBeforeDrag",function(e,i,s){return!t._isRender("cell")}),t.attachEvent("onEventChanged",function(t,e){e._timed=this.isOneDayEvent(e)}),t.attachEvent("onBeforeEventChanged",function(t,e,i,s){return t&&(t._move_delta=void 0),s&&(s._move_delta=void 0),!0}),t._is_column_visible=function(e){var i=t.matrix[t._mode],s=t._get_date_index(i,e);return!t._ignores[s]};var _=t._render_marked_timespan;t._render_marked_timespan=function(i,s,n,l,o){if(!t.config.display_marked_timespans)return[];if(t.matrix&&t.matrix[t._mode]){if(t._isRender("cell"))return;var r=t._lame_copy({},t.matrix[t._mode]);r.round_position=!1;var a=[],h=[],d=[],c=i.sections?i.sections.units||i.sections.timeline:null;if(n)d=[s],h=[n];else{var u=r.order;if(c)u.hasOwnProperty(c)&&(h.push(c),d.push(r._scales[c]));else for(var f in u)u.hasOwnProperty(f)&&(h.push(f),d.push(r._scales[f]))}l=l?new Date(l):t._min_date,o=o?new Date(o):t._max_date;l.valueOf()<t._min_date.valueOf()&&(l=new Date(t._min_date)),o.valueOf()>t._max_date.valueOf()&&(o=new Date(t._max_date));for(var p=0;p<r._trace_x.length&&!t._is_column_visible(r._trace_x[p]);p++);if(p==r._trace_x.length)return;var m=[];if(i.days>6){var g=new Date(i.days);t.date.date_part(new Date(l))<=+g&&+o>=+g&&m.push(g)}else m.push.apply(m,t._get_dates_by_index(i.days));for(var v=i.zones,b=t._get_css_classes_by_config(i),x=0;x<h.length;x++){s=d[x],n=h[x];for(p=0;p<m.length;p++)for(var w=m[p],y=0;y<v.length;y+=2){var C=v[y],N=v[y+1],k=new Date(+w+60*C*1e3),j=new Date(+w+60*N*1e3);if(l<j&&o>k){var S=t._get_block_by_config(i);S.className=b;var D=e({start_date:k},!1,r)-1,I=e({start_date:j},!1,r)-1,E=Math.max(1,I-D-1),O=r._section_height[n]-1||r.dy-1;S.style.cssText="height: "+O+"px; left: "+D+"px; width: "+E+"px; top: 0;",s.insertBefore(S,s.firstChild),a.push(S)}}}return a}return _.apply(t,[i,s,n])};var u=t._append_mark_now;t._append_mark_now=function(e,i){if(t.matrix&&t.matrix[t._mode]){var s=t._currentDate(),n=t._get_zone_minutes(s),l={days:+t.date.date_part(s),zones:[n,n+1],css:"dhx_matrix_now_time",type:"dhx_now_time"};return t._render_marked_timespan(l)}return u.apply(t,[e,i])};var f=t._mark_timespans;t._mark_timespans=function(){if(t.matrix&&t.matrix[t.getState().mode]){for(var e=[],i=t.matrix[t.getState().mode],s=i.y_unit,n=0;n<s.length;n++){var l=s[n].key,o=i._scales[l],r=t._on_scale_add_marker(o,l);e.push.apply(e,r)}return e}return f.apply(this,arguments)};var p=t._on_scale_add_marker;t._on_scale_add_marker=function(e,i){if(t.matrix&&t.matrix[t._mode]){var s=[],n=t._marked_timespans;if(n&&t.matrix&&t.matrix[t._mode])for(var l=t._mode,o=t._min_date,r=t._max_date,a=n.global,h=t.date.date_part(new Date(o));h<r;h=t.date.add(h,1,"day")){var d=+h,c=h.getDay(),_=[],u=a[d]||a[c];if(_.push.apply(_,t._get_configs_to_render(u)),n[l]&&n[l][i]){var f=[],m=t._get_types_to_render(n[l][i][c],n[l][i][d]);f.push.apply(f,t._get_configs_to_render(m)),f.length&&(_=f)}for(var g=0;g<_.length;g++){var v=_[g],b=v.days;b<7?(b=d,s.push.apply(s,t._render_marked_timespan(v,e,i,h,t.date.add(h,1,"day"))),b=c):s.push.apply(s,t._render_marked_timespan(v,e,i,h,t.date.add(h,1,"day")))}}return s}return p.apply(this,arguments)},t._resolve_timeline_section=function(t,e){for(var i=0,s=0;i<this._colsS.heights.length&&!((s+=this._colsS.heights[i])>e.y);i++);t.y_unit[i]||(i=t.y_unit.length-1),this._drag_event&&!this._drag_event._orig_section&&(this._drag_event._orig_section=t.y_unit[i].key),e.fields={},i>=0&&t.y_unit[i]&&(e.section=e.fields[t.y_property]=t.y_unit[i].key)},t._update_timeline_section=function(t){var e=t.view,i=t.event,s=t.pos;if(i){if(i[e.y_property]!=s.section){var n=this._get_timeline_event_height(i,e);i._sorder=this._get_dnd_order(i._sorder,n,e._section_height[s.section])}i[e.y_property]=s.section}},t._get_date_index=function(t,e){for(var i=0,s=t._trace_x;i<s.length-1&&+e>=+s[i+1];)i++;return i},t._timeline_drag_date=function(e,i){for(var s,n,l,o=e,r=i,a=0,h=0;h<=this._cols.length-1;h++)if((a+=n=this._cols[h])>r){s=(s=(r-(a-n))/n)<0?0:s;break}if(o.round_position){var d=1;t.getState().drag_mode&&"move"!=t.getState().drag_mode&&(d=.5),s>=d&&h++,s=0}if(0===h&&this._ignores[0])for(h=1,s=0;this._ignores[h];)h++;else if(h==this._cols.length&&this._ignores[h-1]){for(h=this._cols.length-1,s=0;this._ignores[h];)h--;h++}if(h>=o._trace_x.length)l=t.date.add(o._trace_x[o._trace_x.length-1],o.x_step,o.x_unit),o._end_correction&&(l=new Date(l-o._end_correction));else{var c=s*n*o._step+o._start_correction;l=new Date(+o._trace_x[h]+c)}return l},t.attachEvent("onBeforeTodayDisplayed",function(){for(var e in t.matrix){var i=t.matrix[e];i.x_start=i._original_x_start}return!0}),t.attachEvent("onOptionsLoad",function(){for(var e in t.matrix){var i=t.matrix[e];i.order={},t.callEvent("onOptionsLoadStart",[]);for(e=0;e<i.y_unit.length;e++)i.order[i.y_unit[e].key]=e;t.callEvent("onOptionsLoadFinal",[]),t._date&&i.name==t._mode&&t.setCurrentView(t._date,t._mode)}}),t.attachEvent("onSchedulerResize",function(){if(t.matrix[this._mode]){var e=t.matrix[this._mode];return t._renderMatrix.call(e,!0,!0),!1}return!0}),t.attachEvent("onBeforeDrag",function(e,i,s){"resize"==i&&(((s.target||s.srcElement).className||"").indexOf("dhx_event_resize_end")<0?t._drag_from_start=!0:t._drag_from_start=!1);return!0})},t._temp_matrix_scope()}),Scheduler.plugin(function(t){!function(){var e,i;function s(i){t._get_section_view()&&i&&(e=t.getEvent(i)[t._get_section_property()])}t.config.collision_limit=1,t.attachEvent("onBeforeDrag",function(t){return s(t),!0}),t.attachEvent("onBeforeLightbox",function(e){var n=t.getEvent(e);return i=[n.start_date,n.end_date],s(e),!0}),t.attachEvent("onEventChanged",function(e){if(!e||!t.getEvent(e))return!0;var s=t.getEvent(e);if(!t.checkCollision(s)){if(!i)return!1;s.start_date=i[0],s.end_date=i[1],s._timed=this.isOneDayEvent(s)}return!0}),t.attachEvent("onBeforeEventChanged",function(e,i,s){return t.checkCollision(e)}),t.attachEvent("onEventAdded",function(e,i){t.checkCollision(i)||t.deleteEvent(e)}),t.attachEvent("onEventSave",function(e,i,s){if((i=t._lame_clone(i)).id=e,!i.start_date||!i.end_date){var n=t.getEvent(e);i.start_date=new Date(n.start_date),i.end_date=new Date(n.end_date)}return i.rec_type&&t._roll_back_dates(i),t.checkCollision(i)}),t._check_sections_collision=function(e,i){var s=t._get_section_property();return e[s]==i[s]&&e.id!=i.id},t.checkCollision=function(i){var s=[],n=t.config.collision_limit;if(i.rec_type)for(var l=t.getRecDates(i),o=0;o<l.length;o++)for(var r=t.getEvents(l[o].start_date,l[o].end_date),a=0;a<r.length;a++)(r[a].event_pid||r[a].id)!=i.id&&s.push(r[a]);else{s=t.getEvents(i.start_date,i.end_date);for(var h=0;h<s.length;h++)if(s[h].id==i.id){s.splice(h,1);break}}var d=t._get_section_view(),c=t._get_section_property(),_=!0;if(d){var u=0;for(h=0;h<s.length;h++)s[h].id!=i.id&&this._check_sections_collision(s[h],i)&&u++;u>=n&&(_=!1)}else s.length>=n&&(_=!1);if(!_){var f=!t.callEvent("onEventCollision",[i,s]);return f||(i[c]=e||i[c]),f}return _}}()}),Scheduler.plugin(function(t){var e;t.attachEvent("onTimelineCreated",function(e){"tree"==e.render&&(e.y_unit_original=e.y_unit,e.y_unit=t._getArrayToDisplay(e.y_unit_original),t.attachEvent("onOptionsLoadStart",function(){e.y_unit=t._getArrayToDisplay(e.y_unit_original)}),t.form_blocks[e.name]={render:function(t){return"<div class='dhx_section_timeline' style='overflow: hidden; height: "+t.height+"px'></div>"},set_value:function(e,i,s,n){var l=t._getArrayForSelect(t.matrix[n.type].y_unit_original,n.type);e.innerHTML="";var o=document.createElement("select");e.appendChild(o);var r=e.getElementsByTagName("select")[0];!r._dhx_onchange&&n.onchange&&(r.onchange=n.onchange,r._dhx_onchange=!0);for(var a=0;a<l.length;a++){var h=document.createElement("option");h.value=l[a].key,h.value==s[t.matrix[n.type].y_property]&&(h.selected=!0),h.innerHTML=l[a].label,r.appendChild(h)}},get_value:function(t,e,i){return t.firstChild.value},focus:function(t){}})}),t.attachEvent("onBeforeSectionRender",function(e,i,s){var n,l,o,r,a,h,d={};"tree"==e&&(r="dhx_matrix_scell",i.children?(n=s.folder_dy||s.dy,s.folder_dy&&!s.section_autoheight&&(o="height:"+s.folder_dy+"px;"),l="dhx_row_folder",r+=" folder",a="<div class='dhx_scell_expand'>"+(i.open?"-":"+")+"</div>",h=s.folder_events_available?"dhx_data_table folder_events":"dhx_data_table folder"):(n=s.dy,l="dhx_row_item",r+=" item",a="",h="dhx_data_table"),d={height:n,style_height:o,tr_className:l,td_className:r+=t.templates[s.name+"_scaley_class"](i.key,i.label,i)?" "+t.templates[s.name+"_scaley_class"](i.key,i.label,i):"",td_content:"<div class='dhx_scell_level"+i.level+"'>"+a+"<div class='dhx_scell_name'>"+(t.templates[s.name+"_scale_label"](i.key,i.label,i)||i.label)+"</div></div>",table_className:h});return d}),t.attachEvent("onBeforeEventChanged",function(i,s,n){if(t._isRender("tree"))for(var l=t._get_event_sections?t._get_event_sections(i):[i[t.matrix[t._mode].y_property]],o=0;o<l.length;o++){var r=t.getSection(l[o]);if(r&&r.children&&!t.matrix[t._mode].folder_events_available)return n||(i[t.matrix[t._mode].y_property]=e),!1}return!0}),t.attachEvent("onBeforeDrag",function(i,s,n){if(t._isRender("tree")){var l,o=t._locate_cell_timeline(n);if(o&&(l=t.matrix[t._mode].y_unit[o.y].key,t.matrix[t._mode].y_unit[o.y].children&&!t.matrix[t._mode].folder_events_available))return!1;var r=t.getEvent(i),a=t.matrix[t._mode].y_property;e=r&&r[a]?r[a]:l}return!0}),t._getArrayToDisplay=function(e){var i=[],s=function(e,n){for(var l=n||0,o=0;o<e.length;o++)e[o].level=l,e[o].children&&void 0===e[o].key&&(e[o].key=t.uid()),i.push(e[o]),e[o].open&&e[o].children&&s(e[o].children,l+1)};return s(e),i},t._getArrayForSelect=function(e,i){var s=[],n=function(e){for(var l=0;l<e.length;l++)t.matrix[i].folder_events_available?s.push(e[l]):e[l].children||s.push(e[l]),e[l].children&&n(e[l].children,i)};return n(e),s},t._toggleFolderDisplay=function(e,i,s){var n=function(t,e,i,s){for(var l=0;l<e.length&&(e[l].key!=t&&!s||!e[l].children||(e[l].open=void 0!==i?i:!e[l].open,s||!!0));l++)e[l].children&&n(t,e[l].children,i,s)},l=t.getSection(e);void 0!==i||s||(i=!l.open),t.callEvent("onBeforeFolderToggle",[l,i,s])&&(n(e,t.matrix[t._mode].y_unit_original,i,s),t.matrix[t._mode].y_unit=t._getArrayToDisplay(t.matrix[t._mode].y_unit_original),t.callEvent("onOptionsLoad",[]),t.callEvent("onAfterFolderToggle",[l,i,s]))},t.attachEvent("onCellClick",function(e,i,s,n,l){t._isRender("tree")&&(t.matrix[t._mode].folder_events_available||void 0!==t.matrix[t._mode].y_unit[i]&&t.matrix[t._mode].y_unit[i].children&&t._toggleFolderDisplay(t.matrix[t._mode].y_unit[i].key))}),t.attachEvent("onYScaleClick",function(e,i,s){t._isRender("tree")&&i.children&&t._toggleFolderDisplay(i.key)}),t.getSection=function(e){if(t._isRender("tree")){var i,s=function(t,e){for(var n=0;n<e.length;n++)e[n].key==t&&(i=e[n]),e[n].children&&s(t,e[n].children)};return s(e,t.matrix[t._mode].y_unit_original),i||null}},t.deleteSection=function(e){if(t._isRender("tree")){var i=!1,s=function(t,e){for(var n=0;n<e.length&&(e[n].key==t&&(e.splice(n,1),i=!0),!i);n++)e[n].children&&s(t,e[n].children)};return s(e,t.matrix[t._mode].y_unit_original),t.matrix[t._mode].y_unit=t._getArrayToDisplay(t.matrix[t._mode].y_unit_original),t.callEvent("onOptionsLoad",[]),i}},t.deleteAllSections=function(){t._isRender("tree")&&(t.matrix[t._mode].y_unit_original=[],t.matrix[t._mode].y_unit=t._getArrayToDisplay(t.matrix[t._mode].y_unit_original),t.callEvent("onOptionsLoad",[]))},t.addSection=function(e,i){if(t._isRender("tree")){var s=!1,n=function(t,e,l){if(i)for(var o=0;o<l.length&&(l[o].key==e&&l[o].children&&(l[o].children.push(t),s=!0),!s);o++)l[o].children&&n(t,e,l[o].children);else l.push(t),s=!0};return n(e,i,t.matrix[t._mode].y_unit_original),t.matrix[t._mode].y_unit=t._getArrayToDisplay(t.matrix[t._mode].y_unit_original),t.callEvent("onOptionsLoad",[]),s}},t.openAllSections=function(){t._isRender("tree")&&t._toggleFolderDisplay(1,!0,!0)},t.closeAllSections=function(){t._isRender("tree")&&t._toggleFolderDisplay(1,!1,!0)},t.openSection=function(e){t._isRender("tree")&&t._toggleFolderDisplay(e,!0)},t.closeSection=function(e){t._isRender("tree")&&t._toggleFolderDisplay(e,!1)}}),Scheduler.plugin(function(t){!function(){t.config.all_timed="short";var e=function(t){return!((t.end_date-t.start_date)/36e5>=24)};t._safe_copy=function(e){var i=null,s=null;return e.event_pid&&(i=t.getEvent(e.event_pid)),i&&i.isPrototypeOf(e)?(delete(s=t._copy_event(e)).event_length,delete s.event_pid,delete s.rec_pattern,delete s.rec_type):s=t._lame_clone(e),s};var i=t._pre_render_events_line;t._pre_render_events_line=function(s,n){function l(t){var e=o(t.start_date);return+t.end_date>+e}function o(e){var i=t.date.add(e,1,"day");return t.date.date_part(i)}function r(e,i){var s=t.date.date_part(new Date(e));return s.setHours(i),s}if(!this.config.all_timed)return i.call(this,s,n);for(var a=0;a<s.length;a++){var h=s[a];if(!h._timed)if("short"!=this.config.all_timed||e(h)){var d=this._safe_copy(h);d.start_date=new Date(d.start_date),l(h)?(d.end_date=o(d.start_date),24!=this.config.last_hour&&(d.end_date=r(d.start_date,this.config.last_hour))):d.end_date=new Date(h.end_date);var c=!1;d.start_date<this._max_date&&d.end_date>this._min_date&&d.start_date<d.end_date&&(s[a]=d,c=!0);var _=this._safe_copy(h);if(_.end_date=new Date(_.end_date),_.start_date<this._min_date?_.start_date=r(this._min_date,this.config.first_hour):_.start_date=r(o(h.start_date),this.config.first_hour),_.start_date<this._max_date&&_.start_date<_.end_date){if(!c){s[a--]=_;continue}s.splice(a+1,0,_)}}else s.splice(a--,1)}var u="move"!=this._drag_mode&&n;return i.call(this,s,u)};var s=t.get_visible_events;t.get_visible_events=function(t){return this.config.all_timed&&this.config.multi_day?s.call(this,!1):s.call(this,t)},t.attachEvent("onBeforeViewChange",function(e,i,s,n){return t._allow_dnd="day"==s||"week"==s,!0}),t._is_main_area_event=function(t){return!!(t._timed||!0===this.config.all_timed||"short"==this.config.all_timed&&e(t))};var n=t.updateEvent;t.updateEvent=function(e){var i,s=t.config.all_timed&&!(t.isOneDayEvent(t._events[e])||t.getState().drag_id);s&&(i=t.config.update_render,t.config.update_render=!0),n.apply(t,arguments),s&&(t.config.update_render=i)}}()});