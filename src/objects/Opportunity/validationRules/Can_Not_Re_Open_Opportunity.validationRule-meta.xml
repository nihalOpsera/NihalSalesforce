<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Can_Not_Re_Open_Opportunity</fullName>
    <active>true</active>
    <errorConditionFormula>AND( 
$Profile.Name &lt;&gt; $Label.System_Admin_Profile, 
$Profile.Name &lt;&gt; $Label.Global_Process_Admin_Profile , 
$Profile.Name &lt;&gt; $Label.Accenture_Admin , 
$Profile.Name &lt;&gt; $Label.Nokia_Admin_Profile, 
$Profile.Name &lt;&gt; $Label.SDC_Admin, 
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name , 
IF($User.Email &lt;&gt; $Setup.AllowReopenOpptyAndAccountChange__c.Email__c ,true,IF($Setup.AllowReopenOpptyAndAccountChange__c.Allow_Reopening_of_Closed_opportunity__c = True,False,true)),
  ISCHANGED(StageName),
ISPICKVAL(PRIORVALUE(StageName),&apos;Completed&apos;),
 Is_Automated__c=false,
OR( 
ISPICKVAL(StageName,&apos;Identify Opportunity&apos;), 
ISPICKVAL(StageName,&apos;Develop Opportunity&apos;), 
ISPICKVAL(StageName,&apos;Create Offer (Bid)&apos;), 
ISPICKVAL(StageName,&apos;Handover (Prepare for Delivery)&apos;) , 
ISPICKVAL(StageName,&apos;Execute (Start Delivery)&apos;),
ISPICKVAL(StageName,&apos;Win the Case (Negotiate)&apos;)

 
) 
)</errorConditionFormula>
    <errorMessage>An open OIF line must exist to switch the phase back to an earlier stage.</errorMessage>
</ValidationRule>
