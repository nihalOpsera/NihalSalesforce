<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>NF_PSRAvoid_Changing_Submission_ExePhase</fullName>
    <active>true</active>
    <description>IWA Requirement
3786
Sprint 12</description>
    <errorConditionFormula>AND( 
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name, 
OR($RecordType.DeveloperName = &apos;Pre_Sales_Risk_Opportunity&apos;, 
$RecordType.DeveloperName=&apos;Pre_Sales_Risk_Opportunity_read_only&apos;
), 

OR(
AND(
OR( 
ISPICKVAL(StageName , &apos;Preparation&apos;), 
ISPICKVAL(StageName , &apos;In Execution&apos;), 
ISPICKVAL(StageName , &apos;Completed&apos;), 
ISPICKVAL(StageName , &apos;Cancelled&apos;) 
), 
ISPICKVAL(PRIORVALUE(StageName),&apos;Submitted For Approval&apos;), 
!OR( 

NF_PRE_Tech_Field__c=&apos;Gate Approved&apos;, 
NF_PRE_Tech_Field__c=&apos;Gate Rejected&apos; 

)
),
AND(
OR( 
ISPICKVAL(StageName ,&apos;Submitted For Approval&apos;), 
ISPICKVAL(StageName ,&apos;Preparation&apos;) 

), 
ISPICKVAL(PRIORVALUE(StageName),&apos;In Execution&apos;), 
NOT(ISBLANK(NF_PRE_Tech_Field__c)) 
)
)
)</errorConditionFormula>
    <errorDisplayField>Legal_Entity__c</errorDisplayField>
    <errorMessage>You cannot change the Sales Phase manually.</errorMessage>
</ValidationRule>
