<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>PreOppty_PreOppClosure</fullName>
    <active>true</active>
    <errorConditionFormula>AND($RecordType.DeveloperName = &apos;Pre_opportunity&apos;,
	$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name,
	OR(AND(ISCHANGED(StageName),
			TEXT(PRIORVALUE(StageName)) &lt;&gt; &apos;Business Development&apos;,
			TEXT(StageName) = &apos;Closed&apos;),
		AND(ISNEW(),
			TEXT(StageName) &lt;&gt; &apos;Business Development&apos;),
		AND(TEXT(PRIORVALUE(StageName)) = &apos;Closed&apos;,
					 $Profile.Name &lt;&gt; $Label.System_Admin_Profile,
      $Profile.Name &lt;&gt; $Label.Nokia_Admin_Profile,
      $Profile.Name &lt;&gt; $Label.Global_Process_Admin_Profile_Name,
     	ISBLANK(PRIORVALUE(NF_PRE_Tech_Field__c)))
	)
)</errorConditionFormula>
    <errorMessage>Pre-opportunities can only be closed and open from Business Development Stage. Once closed they cannot be edited.</errorMessage>
</ValidationRule>
