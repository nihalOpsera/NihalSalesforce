<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>PSR_Avoid_Creating_PreSales</fullName>
    <active>true</active>
    <description>PreSales Requirement: 3459, Sprint 11</description>
    <errorConditionFormula>AND( 
AND( 
ISNEW(), 
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name, 
RecordType.DeveloperName = &apos;Pre_Sales_Risk_Opportunity&apos;
), 

OR( 
OR( 
PSR_Reference_Opportunity__r.RecordType.DeveloperName = &apos;Pre_Sales_Risk_Opportunity&apos;, 
PSR_Reference_Opportunity__r.RecordType.DeveloperName = &apos;Pre_Sales_Risk_Opportunity_read_only&apos;
), 
OR( 
PSR_Reference_Opportunity__r.RecordType.DeveloperName = &apos;Read_Only&apos;, 
PSR_Reference_Opportunity__r.RecordType.DeveloperName = &apos;Read_Only_Indirect&apos; 
), 
OR( 
ISPICKVAL( PSR_Reference_Opportunity__r.StageName, &apos;Identify Opportunity&apos;), 
ISPICKVAL( PSR_Reference_Opportunity__r.StageName, &apos;Completed&apos;) 
) 
) 
)</errorConditionFormula>
    <errorMessage>You cannot create a Pre-Sales Risk Opportunity from another Pre-Sales Risk Opportunity or from a Sales Opportunity, that is either in the Identify, Closed or Cancelled stage.</errorMessage>
</ValidationRule>
