<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>PSR_Restrict_Completed_When_Cancel</fullName>
    <active>true</active>
    <description>Req: 3127, Restrict selecting &quot;Completed&quot; when cancelling</description>
    <errorConditionFormula>AND( 
$RecordType.DeveloperName = &apos;Pre_Sales_Risk_Opportunity&apos;,  
ISPICKVAL(StageName,&apos;Completed&apos;),
OR(ISPICKVAL(StageName,&apos;Preparation&apos;),ISPICKVAL(PRIORVALUE(StageName),&apos;Preparation&apos;)) , 
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name 
)</errorConditionFormula>
    <errorMessage>Prior approval you cannot mark a Pre-Sales Risk Opportunity as completed. Please either submit the Pre-Sales Risk Opportunity for approval or select “Cancelled” to cancel it</errorMessage>
</ValidationRule>
