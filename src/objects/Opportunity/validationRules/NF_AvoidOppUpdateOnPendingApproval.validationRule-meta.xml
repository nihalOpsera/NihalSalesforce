<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>NF_AvoidOppUpdateOnPendingApproval</fullName>
    <active>true</active>
    <description>Opportunity should not be saved when it&apos;s on pending approval

NOT(ISCHANGED(NokiaCPQ_Quote_Count__c)) -- Added by CPQ team on 07/10/2017</description>
    <errorConditionFormula>AND(
NOT(ISNEW()),
$Profile.Name&lt;&gt;$Label.Data_Loader_Profile_Name,
NOT(ISCHANGED(Apttus_Approval__Approval_Status__c)),
NOT(ISCHANGED( Approval_Cancel_Info__c )),
NOT(ISCHANGED(NokiaCPQ_Quote_Count__c)),
NOT(ISCHANGED(CQ_Count__c)),
Is_Automated__c=False,
ISPICKVAL(Apttus_Approval__Approval_Status__c , &apos;Pending Approval&apos;), 
$Profile.Name &lt;&gt; &apos;System Administrator&apos;,
$Profile.Name&lt;&gt;&apos;Global Process Admin Profile&apos;,
$Profile.Name&lt;&gt;&apos;Integration API Only Profile&apos;,
$Profile.Name&lt;&gt;&apos;Data Loader Profile&apos;
)</errorConditionFormula>
    <errorMessage>You cannot update the opportunity, when it is pending for approval</errorMessage>
</ValidationRule>
