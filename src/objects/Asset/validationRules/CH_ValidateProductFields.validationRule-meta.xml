<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>CH_ValidateProductFields</fullName>
    <active>true</active>
    <description>When a Network Elemen Asset record is created/editied the fields Product, Product Release, Product Variant and Solution must be the same as the asset of the related Contract Line Item- NOKIASC-24277</description>
    <errorConditionFormula>OR(	
		
		AND($RecordType.Name = &quot;Network Element Asset&quot;,
		CH_ContractLineItem__c!=null,
				CH_ContractLineItem__r.CH_ServiceClassification__c ==&apos;HWS Service&apos;,
		 OR(
			CH_ContractLineItem__r.ServiceContract.AccountId &lt;&gt; AccountId,
			CH_ContractLineItem__r.Asset.CH_CountryISOName__c &lt;&gt; CH_CountryISOName__c,
			CH_ContractLineItem__r.Asset.Product2Id != Product2Id
			)
 
		)
		
		,
		
		AND(
		$RecordType.Name = &quot;Network Element Asset&quot;,
		CH_ContractLineItem__c!=null,
		CH_ContractLineItem__r.CH_ServiceClassification__c !=&apos;HWS Service&apos;,
		 OR(
			CH_ContractLineItem__r.ServiceContract.AccountId  &lt;&gt; AccountId,
			CH_ContractLineItem__r.Asset.CH_CountryISOName__c &lt;&gt; CH_CountryISOName__c,
			CH_ContractLineItem__r.Asset.Product2Id &lt;&gt; Product2Id,
			AND(
							CH_ContractLineItem__r.Asset.CH_ProductVariant__c &lt;&gt; CH_ProductVariant__c,
							CH_ContractLineItem__r.Asset.CH_ProductVariant__c &lt;&gt; null,
							CH_ProductVariant__c &lt;&gt; null
			),
			AND(
							CH_ContractLineItem__r.Asset.CH_Solution__c &lt;&gt; CH_Solution__c,
							CH_ContractLineItem__r.Asset.CH_Solution__c &lt;&gt; null,
							CH_Solution__c &lt;&gt; null
			),
			AND(
							CH_ProductRelease__c !=null,
				   CH_ContractLineItem__r.Asset.CH_ProductRelease__c &lt;&gt; CH_ProductRelease__c
				)
			)
		)
	)</errorConditionFormula>
    <errorMessage>The NEA Product, Release, Variant, Country, Account or solution does not match the asset of the related Contract Line Item</errorMessage>
</ValidationRule>
