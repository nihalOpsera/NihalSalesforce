<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>CH_Nokia_Email_Validation</fullName>
    <active>false</active>
    <description>Requirement NOKIASC-4989. Contact type must be Nokia Employee for nokia email domains.</description>
    <errorConditionFormula>AND (
	$Profile.Name&lt;&gt;$Label.Data_Loader_Profile_Name, 
	NOT(ISBLANK(Email)), 
	OR(
		AND(ISPICKVAL(CH_ContactType__c, &apos;Nokia Employee&apos;), 
			NOT(CONTAINS(LOWER($Setup.Nokia_Employee_Email_Domains__c.Nokia_Valid_Domain__c), 
				&apos;&quot;&apos; &amp; LOWER(TRIM(RIGHT(Email, LEN(Email) - FIND(&quot;@&quot;, Email)))) &amp; &apos;&quot;&apos;
			))
		),
		AND(NOT(ISPICKVAL(CH_ContactType__c, &apos;Nokia Employee&apos;)), 
			CONTAINS(LOWER($Setup.Nokia_Employee_Email_Domains__c.Nokia_Invalid_Domain__c), 
				&apos;&quot;&apos; &amp; LOWER(TRIM(MID(Email, FIND(&quot;@&quot;, Email) + 1, FIND(&quot;.&quot;, RIGHT(Email, LEN(Email) - FIND(&quot;@&quot;, Email))) - 1))) &amp; &apos;&quot;&apos;
			)
		)
	)
)</errorConditionFormula>
    <errorMessage>Please enter valid Contact Type or Email.</errorMessage>
</ValidationRule>
