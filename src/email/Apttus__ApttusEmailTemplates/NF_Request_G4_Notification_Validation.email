<messaging:emailTemplate subject="{!relatedTo.NF_Remaninder_Subject__c} {!if(relatedTo.Apttus_Approval__Related_Opportunity__r.Blanket_Approval_Condition__c<>null,'Blanket Approval - ','')} {!if(relatedTo.NF_Assignee_Type__c='Validator','Validation Request','Approval Info')} (G4, {!relatedTo.Apttus_Approval__Related_Opportunity__r.LOA_Level__c}, {!relatedTo.Apttus_Approval__Related_Opportunity__r.Lead_BG__c}): {!relatedTo.Apttus_Approval__Related_Opportunity__r.Opportunity_ID__c}- {!relatedTo.Apttus_Approval__Related_Opportunity__r.Name} - {!relatedTo.Apttus_Approval__Related_Opportunity__r.Account.Name} - {!relatedTo.Apttus_Approval__Related_Opportunity__r.Country__c}"
                         recipientType="User" 
                         relatedToType="Apttus_Approval__Approval_Request__c"
                          replyTo="{!$Label.NF_ValidationEmail}"
                         language="{!recipient.LanguageLocaleKey}"> 

                             
    <messaging:htmlEmailBody >
        <html>
        <style type="text/css">

            table {
                border-collapse: collapse;
                width: 100%;
            }
            
            th, td {
                text-align: left;
                padding: 8px;
            }
            
            
            th {
                background-color: #f2f2f2;
                color: black;
            }
            
            table, td, th {    
                 border: 1px solid #ddd;
            }
            </style>
            <body>
                <div id="main">
                    <!-- TSALEM - reference nokia singleCRM logo -->
                       <!-- <apex:image id="Nokia_HeaderLogo" value="{!$Label.HeaderLogo}" width="50%" height="25%"/><br/><br/>-->
                        <apex:outputPanel rendered="{!relatedTo.Apttus_Approval__Assigned_To_Name__c==null}">
                        Dear {!recipient.Name} 
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!relatedTo.Apttus_Approval__Assigned_To_Name__c!=null}">
                        Dear {!relatedTo.Apttus_Approval__Assigned_To_Name__c}
                        </apex:outputPanel> 
                    <br/><br/>
                    
                       <apex:outputPanel rendered="{!relatedTo.NF_Assignee_Type__c=='Validator'}">
                       As "{!relatedTo.NF_Assignee_Type__c}" you have been requested to provide G4 {!if(relatedTo.Apttus_Approval__Related_Opportunity__r.Blanket_Approval_Condition__c<>null,'Blanket','')} Approvals Validation for opportunity "{!relatedTo.Apttus_Approval__Related_Opportunity__r.Name}" with completion date {!relatedTo.Apttus_Approval__DateAssigned__c+1}
                       </apex:outputPanel>
                       <apex:outputPanel rendered="{!relatedTo.NF_Assignee_Type__c!='Validator'}">
                       Please be informed that a G4 {!if(relatedTo.Apttus_Approval__Related_Opportunity__r.Blanket_Approval_Condition__c<>null,'Blanket','')} Approvals for opportunity "{!relatedTo.Apttus_Approval__Related_Opportunity__r.Name}" has been submitted
                       </apex:outputPanel>
                    <br/><br/>
                        <apex:image id="Nokia_ProgressBar1" value="{!$Label.NF_Identify_Opportunity}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Identify Opportunity'}"/>                        
                        <apex:image id="Nokia_ProgressBar2" value="{!$Label.NF_Develop_Opportunity}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Develop Opportunity'}"/>                        
                        <apex:image id="Nokia_ProgressBar3" value="{!$Label.NF_Create_Offer_Bid}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Create Offer (Bid)'}"/>                        
                        <apex:image id="Nokia_ProgressBar4" value="{!$Label.NF_Win_the_Case_Negotiate}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Win the Case (Negotiate)'}"/>                        
                        <apex:image id="Nokia_ProgressBar5" value="{!$Label.NF_Handover_Prepare_for_Delivery}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Handover (Prepare for Delivery)'}"/>                        
                        <apex:image id="Nokia_ProgressBar6" value="{!$Label.NF_Execute_Start_Delivery}" width="100%" height="50" rendered="{!relatedTo.Apttus_Approval__Related_Opportunity__r.StageName=='Execute (Start Delivery)'}"/>                
                         <br/><br/>
                        <apex:outputText value="To Validate or reject this request, click “Validate” or “Reject”. Afterwards you will be able to add comments." rendered="{!relatedTo.NF_Assignee_Type__c=='Validator'}"> 
                        </apex:outputText>
                        <apex:outputPanel rendered="{!relatedTo.NF_Assignee_Type__c=='Validator'}">
                        <p> If you need to see more additional Gate Approval details, please click here to navigate to the <c:ApprovalNotificationSubCompG4G5 Opp_Id="{!relatedTo.Apttus_Approval__Related_Opportunity__c}" /> or navigate to the&nbsp;<apex:outputLink value="{!$Label.Email_URL}/{!relatedTo.Apttus_Approval__Related_Opportunity__r.Id}" id="theLink">Opportunity </apex:outputLink> and go directly to the <b>Approval Center.</b></p><br/> 
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!relatedTo.NF_Assignee_Type__c!='Validator'}">
                        If you need to see additional details, please click here to view the&nbsp;<apex:outputLink value="{!$Label.Email_URL}/{!relatedTo.Apttus_Approval__Related_Opportunity__r.Id}" id="Link">Opportunity </apex:outputLink> and go directly to the <b>Approval Center.</b><br/>
                        </apex:outputPanel>
                        <apex:outputLink value="mailto:{!$Label.NF_ValidationEmail}?Subject=Approved {!relatedTo.ID}- Submit your Decision &Body={!$Label.NF_Validation_comments}" target="_top" rendered="{!relatedTo.NF_Assignee_Type__c=='Validator'}"><button type="button"  class="button1">Validate</button></apex:outputLink>&nbsp;&nbsp;

                        <apex:outputLink value="mailto:{!$Label.NF_ValidationEmail}?Subject=Rejected {!relatedTo.ID} - Submit your Decision &Body= {!$Label.NF_Validation_comments}" target="_top" rendered="{!relatedTo.NF_Assignee_Type__c=='Validator'}"><button type="button"  class="button2">Reject</button></apex:outputLink>   

                     <br/><br/>
                     
                        <apex:outputText value="{!$Label.apttus_validation_complete_note}" escape="false" style="color: red;"/>
                    <br/><br/> 
                    <apex:outputText value="{!$Label.apttus_approval_Thanks}" escape="false" />
                    <br/><br/>
                    <apex:outputText value="{!$Label.apttus_approval_NokiaSF}" escape="false" /> {!relatedTo.Opportunity_Owner__c} 
                    <br/><br/>        
               </div>
               <br/>
               <div id="Lists">
                   <u>Approval request comment :</u>&nbsp;{!relatedTo.Apttus_Approval__Related_Opportunity__r.Submission_Comments__c}
                   <br/>
                   <c:ApprovalValidationNotificationCompG4G5 Opp_Id="{!relatedTo.Apttus_Approval__Related_Opportunity__c}"/>
               </div>
                              
               <br/>
               <div id="footer" style="color: red;">
                   <apex:outputText value="{!$Label.apttus_approval_ImportantNotice}" escape="false" />
                   <apex:outputText value="{!$Label.apttus_approval_Notice}" escape="false" /> 
                   <apex:outputText value="{!$Label.apttus_approval_Notice2}" escape="false" />
                   <br/><br/>
                   <apex:image id="Nokia_FooterLogo" value="{!$Label.FooterLogo}" width="120" height="30"/>                        
               </div>
            </body>
        </html>
    </messaging:htmlEmailBody>
</messaging:emailTemplate>